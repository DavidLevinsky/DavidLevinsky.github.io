!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b._mproj4_=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function Point(a,b,c){if(!(this instanceof Point))return new Point(a,b,c);if(Array.isArray(a))this.x=a[0],this.y=a[1],this.z=a[2]||0;else if("object"==typeof a)this.x=a.x,this.y=a.y,this.z=a.z||0;else if("string"==typeof a&&"undefined"==typeof b){var d=a.split(",");this.x=parseFloat(d[0],10),this.y=parseFloat(d[1],10),this.z=parseFloat(d[2],10)||0}else this.x=a,this.y=b,this.z=c||0;console.warn("_mproj4_.Point will be removed in version 3, use _mproj4_.toPoint")}var d=a("mgrs");Point.fromMGRS=function(a){return new Point(d.toPoint(a))},Point.prototype.toMGRS=function(a){return d.forward([this.x,this.y],a)},b.exports=Point},{mgrs:68}],2:[function(a,b,c){function Projection(a,b){if(!(this instanceof Projection))return new Projection(a);b=b||function(a){if(a)throw a};var c=d(a);if("object"!=typeof c)return void b(a);var f=g(c),h=Projection.projections.get(f.projName);h?(e(this,f),e(this,h),this.init(),b(null,this)):b(a)}var d=a("./parseCode"),e=a("./extend"),f=a("./projections"),g=a("./deriveConstants");Projection.projections=f,Projection.projections.start(),b.exports=Projection},{"./deriveConstants":33,"./extend":34,"./parseCode":37,"./projections":39}],3:[function(a,b,c){b.exports=function(a,b,c){var d,e,f,g=c.x,h=c.y,i=c.z||0;for(f=0;3>f;f++)if(!b||2!==f||void 0!==c.z)switch(0===f?(d=g,e="x"):1===f?(d=h,e="y"):(d=i,e="z"),a.axis[f]){case"e":c[e]=d;break;case"w":c[e]=-d;break;case"n":c[e]=d;break;case"s":c[e]=-d;break;case"u":void 0!==c[e]&&(c.z=d);break;case"d":void 0!==c[e]&&(c.z=-d);break;default:return null}return c}},{}],4:[function(a,b,c){var d=Math.PI/2,e=a("./sign");b.exports=function(a){return Math.abs(a)<d?a:a-e(a)*Math.PI}},{"./sign":21}],5:[function(a,b,c){var d=2*Math.PI,e=3.14159265359,f=a("./sign");b.exports=function(a){return Math.abs(a)<=e?a:a-f(a)*d}},{"./sign":21}],6:[function(a,b,c){b.exports=function(a){return Math.abs(a)>1&&(a=a>1?1:-1),Math.asin(a)}},{}],7:[function(a,b,c){b.exports=function(a){return 1-.25*a*(1+a/16*(3+1.25*a))}},{}],8:[function(a,b,c){b.exports=function(a){return.375*a*(1+.25*a*(1+.46875*a))}},{}],9:[function(a,b,c){b.exports=function(a){return.05859375*a*a*(1+.75*a)}},{}],10:[function(a,b,c){b.exports=function(a){return a*a*a*(35/3072)}},{}],11:[function(a,b,c){b.exports=function(a,b,c){var d=b*c;return a/Math.sqrt(1-d*d)}},{}],12:[function(a,b,c){b.exports=function(a,b,c,d,e){var f,g;f=a/b;for(var h=0;15>h;h++)if(g=(a-(b*f-c*Math.sin(2*f)+d*Math.sin(4*f)-e*Math.sin(6*f)))/(b-2*c*Math.cos(2*f)+4*d*Math.cos(4*f)-6*e*Math.cos(6*f)),f+=g,Math.abs(g)<=1e-10)return f;return NaN}},{}],13:[function(a,b,c){var d=Math.PI/2;b.exports=function(a,b){var c=1-(1-a*a)/(2*a)*Math.log((1-a)/(1+a));if(Math.abs(Math.abs(b)-c)<1e-6)return 0>b?-1*d:d;for(var e,f,g,h,i=Math.asin(.5*b),j=0;30>j;j++)if(f=Math.sin(i),g=Math.cos(i),h=a*f,e=Math.pow(1-h*h,2)/(2*g)*(b/(1-a*a)-f/(1-h*h)+.5/a*Math.log((1-h)/(1+h))),i+=e,Math.abs(e)<=1e-10)return i;return NaN}},{}],14:[function(a,b,c){b.exports=function(a,b,c,d,e){return a*e-b*Math.sin(2*e)+c*Math.sin(4*e)-d*Math.sin(6*e)}},{}],15:[function(a,b,c){b.exports=function(a,b,c){var d=a*b;return c/Math.sqrt(1-d*d)}},{}],16:[function(a,b,c){var d=Math.PI/2;b.exports=function(a,b){for(var c,e,f=.5*a,g=d-2*Math.atan(b),h=0;15>=h;h++)if(c=a*Math.sin(g),e=d-2*Math.atan(b*Math.pow((1-c)/(1+c),f))-g,g+=e,Math.abs(e)<=1e-10)return g;return-9999}},{}],17:[function(a,b,c){var d=1,e=.25,f=.046875,g=.01953125,h=.01068115234375,i=.75,j=.46875,k=.013020833333333334,l=.007120768229166667,m=.3645833333333333,n=.005696614583333333,o=.3076171875;b.exports=function(a){var b=[];b[0]=d-a*(e+a*(f+a*(g+a*h))),b[1]=a*(i-a*(f+a*(g+a*h)));var c=a*a;return b[2]=c*(j-a*(k+a*l)),c*=a,b[3]=c*(m-a*n),b[4]=c*a*o,b}},{}],18:[function(a,b,c){var d=a("./pj_mlfn"),e=1e-10,f=20;b.exports=function(a,b,c){for(var g=1/(1-b),h=a,i=f;i;--i){var j=Math.sin(h),k=1-b*j*j;if(k=(d(h,j,Math.cos(h),c)-a)*(k*Math.sqrt(k))*g,h-=k,Math.abs(k)<e)return h}return h}},{"./pj_mlfn":19}],19:[function(a,b,c){b.exports=function(a,b,c,d){return c*=b,b*=b,d[0]*a-c*(d[1]+b*(d[2]+b*(d[3]+b*d[4])))}},{}],20:[function(a,b,c){b.exports=function(a,b){var c;return a>1e-7?(c=a*b,(1-a*a)*(b/(1-c*c)-.5/a*Math.log((1-c)/(1+c)))):2*b}},{}],21:[function(a,b,c){b.exports=function(a){return 0>a?-1:1}},{}],22:[function(a,b,c){b.exports=function(a,b){return Math.pow((1-a)/(1+a),b)}},{}],23:[function(a,b,c){b.exports=function(a){var b={x:a[0],y:a[1]};return a.length>2&&(b.z=a[2]),a.length>3&&(b.m=a[3]),b}},{}],24:[function(a,b,c){var d=Math.PI/2;b.exports=function(a,b,c){var e=a*c,f=.5*a;return e=Math.pow((1-e)/(1+e),f),Math.tan(.5*(d-b))/e}},{}],25:[function(a,b,c){c.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},c.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},c.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},c.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},c.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},c.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},c.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},c.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},c.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},c.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},c.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},c.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},c.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},c.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},c.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},c.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(a,b,c){c.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},c.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},c.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},c.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},c.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},c.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},c.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},c.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},c.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},c.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},c.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},c.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},c.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},c.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},c.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},c.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},c.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},c.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},c.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},c.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},c.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},c.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},c.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},c.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},c.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},c.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},c.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},c.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},c.hough={a:6378270,rf:297,ellipseName:"Hough"},c.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},c.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},c.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},c.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},c.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},c.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},c.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},c.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},c.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},c.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},c.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},c.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},c.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},c.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(a,b,c){c.greenwich=0,c.lisbon=-9.131906111111,c.paris=2.337229166667,c.bogota=-74.080916666667,c.madrid=-3.687938888889,c.rome=12.452333333333,c.bern=7.439583333333,c.jakarta=106.807719444444,c.ferro=-17.666666666667,c.brussels=4.367975,c.stockholm=18.058277777778,c.athens=23.7163375,c.oslo=10.722916666667},{}],28:[function(a,b,c){c.ft={to_meter:.3048},c["us-ft"]={to_meter:1200/3937}},{}],29:[function(a,b,c){function d(a,b,c){var d;return Array.isArray(c)?(d=g(a,b,c),3===c.length?[d.x,d.y,d.z]:[d.x,d.y]):g(a,b,c)}function e(a){return a instanceof f?a:a.oProj?a.oProj:f(a)}function _mproj4_(a,b,c,_dddd_){a=e(a);if(_dddd_) return a; var f,g=!1;return"undefined"==typeof b?(b=a,a=h,g=!0):("undefined"!=typeof b.x||Array.isArray(b))&&(c=b,b=a,a=h,g=!0),b=e(b),c?d(a,b,c):(f={forward:function(c){return d(a,b,c)},inverse:function(c){return d(b,a,c)},info:function(){return{a:b.a,b:b.b,ra:b.R_A,"proj-name":b.projName}}},g&&(f.oProj=b),f)}var f=a("./Proj"),g=a("./transform"),h=f("WGS84");b.exports=_mproj4_},{"./Proj":2,"./transform":66}],30:[function(a,b,c){var d=Math.PI/2,e=1,f=2,g=3,h=4,i=5,j=484813681109536e-20,k=1.0026,l=.3826834323650898,m=function(a){if(!(this instanceof m))return new m(a);if(this.datum_type=h,a){if(a.datumCode&&"none"===a.datumCode&&(this.datum_type=i),a.datum_params){for(var b=0;b<a.datum_params.length;b++)a.datum_params[b]=parseFloat(a.datum_params[b]);(0!==a.datum_params[0]||0!==a.datum_params[1]||0!==a.datum_params[2])&&(this.datum_type=e),a.datum_params.length>3&&(0!==a.datum_params[3]||0!==a.datum_params[4]||0!==a.datum_params[5]||0!==a.datum_params[6])&&(this.datum_type=f,a.datum_params[3]*=j,a.datum_params[4]*=j,a.datum_params[5]*=j,a.datum_params[6]=a.datum_params[6]/1e6+1)}this.datum_type=a.grids?g:this.datum_type,this.a=a.a,this.b=a.b,this.es=a.es,this.ep2=a.ep2,this.datum_params=a.datum_params,this.datum_type===g&&(this.grids=a.grids)}};m.prototype={compare_datums:function(a){return this.datum_type!==a.datum_type?!1:this.a!==a.a||Math.abs(this.es-a.es)>5e-11?!1:this.datum_type===e?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===a.datum_params[2]:this.datum_type===f?this.datum_params[0]===a.datum_params[0]&&this.datum_params[1]===a.datum_params[1]&&this.datum_params[2]===a.datum_params[2]&&this.datum_params[3]===a.datum_params[3]&&this.datum_params[4]===a.datum_params[4]&&this.datum_params[5]===a.datum_params[5]&&this.datum_params[6]===a.datum_params[6]:this.datum_type===g||a.datum_type===g?this.nadgrids===a.nadgrids:!0},geodetic_to_geocentric:function(a){var b,c,e,f,g,h,i,j=a.x,k=a.y,l=a.z?a.z:0,m=0;if(-d>k&&k>-1.001*d)k=-d;else if(k>d&&1.001*d>k)k=d;else if(-d>k||k>d)return null;return j>Math.PI&&(j-=2*Math.PI),g=Math.sin(k),i=Math.cos(k),h=g*g,f=this.a/Math.sqrt(1-this.es*h),b=(f+l)*i*Math.cos(j),c=(f+l)*i*Math.sin(j),e=(f*(1-this.es)+l)*g,a.x=b,a.y=c,a.z=e,m},geocentric_to_geodetic:function(a){var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=1e-12,u=t*t,v=30,w=a.x,x=a.y,y=a.z?a.z:0;if(o=!1,b=Math.sqrt(w*w+x*x),c=Math.sqrt(w*w+x*x+y*y),b/this.a<t){if(o=!0,q=0,c/this.a<t)return r=d,void(s=-this.b)}else q=Math.atan2(x,w);e=y/c,f=b/c,g=1/Math.sqrt(1-this.es*(2-this.es)*f*f),j=f*(1-this.es)*g,k=e*g,p=0;do p++,i=this.a/Math.sqrt(1-this.es*k*k),s=b*j+y*k-i*(1-this.es*k*k),h=this.es*i/(i+s),g=1/Math.sqrt(1-h*(2-h)*f*f),l=f*(1-h)*g,m=e*g,n=m*j-l*k,j=l,k=m;while(n*n>u&&v>p);return r=Math.atan(m/Math.abs(l)),a.x=q,a.y=r,a.z=s,a},geocentric_to_geodetic_noniter:function(a){var b,c,e,f,g,h,i,j,m,n,o,p,q,r,s,t,u,v=a.x,w=a.y,x=a.z?a.z:0;if(v=parseFloat(v),w=parseFloat(w),x=parseFloat(x),u=!1,0!==v)b=Math.atan2(w,v);else if(w>0)b=d;else if(0>w)b=-d;else if(u=!0,b=0,x>0)c=d;else{if(!(0>x))return c=d,void(e=-this.b);c=-d}return g=v*v+w*w,f=Math.sqrt(g),h=x*k,j=Math.sqrt(h*h+g),n=h/j,p=f/j,o=n*n*n,i=x+this.b*this.ep2*o,t=f-this.a*this.es*p*p*p,m=Math.sqrt(i*i+t*t),q=i/m,r=t/m,s=this.a/Math.sqrt(1-this.es*q*q),e=r>=l?f/r-s:-l>=r?f/-r-s:x/q+s*(this.es-1),u===!1&&(c=Math.atan(q/r)),a.x=b,a.y=c,a.z=e,a},geocentric_to_wgs84:function(a){if(this.datum_type===e)a.x+=this.datum_params[0],a.y+=this.datum_params[1],a.z+=this.datum_params[2];else if(this.datum_type===f){var b=this.datum_params[0],c=this.datum_params[1],d=this.datum_params[2],g=this.datum_params[3],h=this.datum_params[4],i=this.datum_params[5],j=this.datum_params[6],k=j*(a.x-i*a.y+h*a.z)+b,l=j*(i*a.x+a.y-g*a.z)+c,m=j*(-h*a.x+g*a.y+a.z)+d;a.x=k,a.y=l,a.z=m}},geocentric_from_wgs84:function(a){if(this.datum_type===e)a.x-=this.datum_params[0],a.y-=this.datum_params[1],a.z-=this.datum_params[2];else if(this.datum_type===f){var b=this.datum_params[0],c=this.datum_params[1],d=this.datum_params[2],g=this.datum_params[3],h=this.datum_params[4],i=this.datum_params[5],j=this.datum_params[6],k=(a.x-b)/j,l=(a.y-c)/j,m=(a.z-d)/j;a.x=k+i*l-h*m,a.y=-i*k+l+g*m,a.z=h*k-g*l+m}}},b.exports=m},{}],31:[function(a,b,c){var d=1,e=2,f=3,g=5,h=6378137,i=.006694379990141316;b.exports=function(a,b,c){function j(a){return a===d||a===e}var k,l,m;if(a.compare_datums(b))return c;if(a.datum_type===g||b.datum_type===g)return c;var n=a.a,o=a.es,p=b.a,q=b.es,r=a.datum_type;if(r===f)if(0===this.apply_gridshift(a,0,c))a.a=h,a.es=i;else{if(!a.datum_params)return a.a=n,a.es=a.es,c;for(k=1,l=0,m=a.datum_params.length;m>l;l++)k*=a.datum_params[l];if(0===k)return a.a=n,a.es=a.es,c;r=a.datum_params.length>3?e:d}return b.datum_type===f&&(b.a=h,b.es=i),(a.es!==b.es||a.a!==b.a||j(r)||j(b.datum_type))&&(a.geodetic_to_geocentric(c),j(a.datum_type)&&a.geocentric_to_wgs84(c),j(b.datum_type)&&b.geocentric_from_wgs84(c),b.geocentric_to_geodetic(c)),b.datum_type===f&&this.apply_gridshift(b,1,c),a.a=n,a.es=o,b.a=p,b.es=q,c}},{}],32:[function(a,b,c){function d(a){var b=this;if(2===arguments.length){var c=arguments[1];"string"==typeof c?"+"===c.charAt(0)?d[a]=f(arguments[1]):d[a]=g(arguments[1]):d[a]=c}else if(1===arguments.length){if(Array.isArray(a))return a.map(function(a){Array.isArray(a)?d.apply(b,a):d(a)});if("string"==typeof a){if(a in d)return d[a]}else"EPSG"in a?d["EPSG:"+a.EPSG]=a:"ESRI"in a?d["ESRI:"+a.ESRI]=a:"IAU2000"in a?d["IAU2000:"+a.IAU2000]=a:console.log(a);return}}var e=a("./global"),f=a("./projString"),g=a("./wkt");e(d),b.exports=d},{"./global":35,"./projString":38,"./wkt":67}],33:[function(a,b,c){var d=a("./constants/Datum"),e=a("./constants/Ellipsoid"),f=a("./extend"),g=a("./datum"),h=1e-10,i=.16666666666666666,j=.04722222222222222,k=.022156084656084655;b.exports=function(a){if(a.datumCode&&"none"!==a.datumCode){var b=d[a.datumCode];b&&(a.datum_params=b.towgs84?b.towgs84.split(","):null,a.ellps=b.ellipse,a.datumName=b.datumName?b.datumName:a.datumCode)}if(!a.a){var c=e[a.ellps]?e[a.ellps]:e.WGS84;f(a,c)}return a.rf&&!a.b&&(a.b=(1-1/a.rf)*a.a),(0===a.rf||Math.abs(a.a-a.b)<h)&&(a.sphere=!0,a.b=a.a),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=(a.a2-a.b2)/a.a2,a.e=Math.sqrt(a.es),a.R_A&&(a.a*=1-a.es*(i+a.es*(j+a.es*k)),a.a2=a.a*a.a,a.b2=a.b*a.b,a.es=0),a.ep2=(a.a2-a.b2)/a.b2,a.k0||(a.k0=1),a.axis||(a.axis="enu"),a.datum||(a.datum=g(a)),a}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":30,"./extend":34}],34:[function(a,b,c){b.exports=function(a,b){a=a||{};var c,d;if(!b)return a;for(d in b)c=b[d],void 0!==c&&(a[d]=c);return a}},{}],35:[function(a,b,c){b.exports=function(a){a("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),a("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),a("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),a.WGS84=a["EPSG:4326"],a["EPSG:3785"]=a["EPSG:3857"],a.GOOGLE=a["EPSG:3857"],a["EPSG:900913"]=a["EPSG:3857"],a["EPSG:102113"]=a["EPSG:3857"]}},{}],36:[function(a,b,c){var _mproj4_=a("./core");_mproj4_.defaultDatum="WGS84",_mproj4_.Proj=a("./Proj"),_mproj4_.WGS84=new _mproj4_.Proj("WGS84"),_mproj4_.Point=a("./Point"),_mproj4_.toPoint=a("./common/toPoint"),_mproj4_.defs=a("./defs"),_mproj4_.transform=a("./transform"),_mproj4_.mgrs=a("mgrs"),_mproj4_.version=a("../package.json").version,a("./includedProjections")(_mproj4_),b.exports=_mproj4_},{"../package.json":69,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":29,"./defs":32,"./includedProjections":"Pk/iAZ","./transform":66,mgrs:68}],37:[function(a,b,c){function d(a){return"string"==typeof a}function e(a){return a in i}function f(a){var b=["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"];return b.reduce(function(b,c){return b+1+a.indexOf(c)},0)}function g(a){return"+"===a[0]}function h(a){return d(a)?e(a)?i[a]:f(a)?j(a):g(a)?k(a):void 0:a}var i=a("./defs"),j=a("./wkt"),k=a("./projString");b.exports=h},{"./defs":32,"./projString":38,"./wkt":67}],38:[function(a,b,c){var d=.017453292519943295,e=a("./constants/PrimeMeridian"),f=a("./constants/units");b.exports=function(a){var b={},c={};a.split("+").map(function(a){return a.trim()}).filter(function(a){return a}).forEach(function(a){var b=a.split("=");b.push(!0),c[b[0].toLowerCase()]=b[1]});var g,h,i,j={proj:"projName",datum:"datumCode",rf:function(a){b.rf=parseFloat(a)},lat_0:function(a){b.lat0=a*d},lat_1:function(a){b.lat1=a*d},lat_2:function(a){b.lat2=a*d},lat_ts:function(a){b.lat_ts=a*d},lon_0:function(a){b.long0=a*d},lon_1:function(a){b.long1=a*d},lon_2:function(a){b.long2=a*d},alpha:function(a){b.alpha=parseFloat(a)*d},lonc:function(a){b.longc=a*d},x_0:function(a){b.x0=parseFloat(a)},y_0:function(a){b.y0=parseFloat(a)},k_0:function(a){b.k0=parseFloat(a)},k:function(a){b.k0=parseFloat(a)},a:function(a){b.a=parseFloat(a)},b:function(a){b.b=parseFloat(a)},r_a:function(){b.R_A=!0},zone:function(a){b.zone=parseInt(a,10)},south:function(){b.utmSouth=!0},towgs84:function(a){b.datum_params=a.split(",").map(function(a){return parseFloat(a)})},to_meter:function(a){b.to_meter=parseFloat(a)},units:function(a){b.units=a,f[a]&&(b.to_meter=f[a].to_meter)},from_greenwich:function(a){b.from_greenwich=a*d},pm:function(a){b.from_greenwich=(e[a]?e[a]:parseFloat(a))*d},nadgrids:function(a){"@null"===a?b.datumCode="none":b.nadgrids=a},axis:function(a){var c="ewnsud";3===a.length&&-1!==c.indexOf(a.substr(0,1))&&-1!==c.indexOf(a.substr(1,1))&&-1!==c.indexOf(a.substr(2,1))&&(b.axis=a)}};for(g in c)h=c[g],g in j?(i=j[g],"function"==typeof i?i(h):b[i]=h):b[g]=h;return"string"==typeof b.datumCode&&"WGS84"!==b.datumCode&&(b.datumCode=b.datumCode.toLowerCase()),b}},{"./constants/PrimeMeridian":27,"./constants/units":28}],39:[function(a,b,c){function d(a,b){var c=g.length;return a.names?(g[c]=a,a.names.forEach(function(a){f[a.toLowerCase()]=c}),this):(console.log(b),!0)}var e=[a("./projections/merc"),a("./projections/longlat")],f={},g=[];c.add=d,c.get=function(a){if(!a)return!1;var b=a.toLowerCase();return"undefined"!=typeof f[b]&&g[f[b]]?g[f[b]]:void 0},c.start=function(){e.forEach(d)}},{"./projections/longlat":52,"./projections/merc":53}],40:[function(a,b,c){var d=1e-10,e=a("../common/msfnz"),f=a("../common/qsfnz"),g=a("../common/adjust_lon"),h=a("../common/asinz");c.init=function(){Math.abs(this.lat1+this.lat2)<d||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=e(this.e3,this.sin_po,this.cos_po),this.qs1=f(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=e(this.e3,this.sin_po,this.cos_po),this.qs2=f(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=f(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>d?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},c.forward=function(a){var b=a.x,c=a.y;this.sin_phi=Math.sin(c),this.cos_phi=Math.cos(c);var d=f(this.e3,this.sin_phi,this.cos_phi),e=this.a*Math.sqrt(this.c-this.ns0*d)/this.ns0,h=this.ns0*g(b-this.long0),i=e*Math.sin(h)+this.x0,j=this.rh-e*Math.cos(h)+this.y0;return a.x=i,a.y=j,a},c.inverse=function(a){var b,c,d,e,f,h;return a.x-=this.x0,a.y=this.rh-a.y+this.y0,this.ns0>=0?(b=Math.sqrt(a.x*a.x+a.y*a.y),d=1):(b=-Math.sqrt(a.x*a.x+a.y*a.y),d=-1),e=0,0!==b&&(e=Math.atan2(d*a.x,d*a.y)),d=b*this.ns0/this.a,this.sphere?h=Math.asin((this.c-d*d)/(2*this.ns0)):(c=(this.c-d*d)/this.ns0,h=this.phi1z(this.e3,c)),f=g(e/this.ns0+this.long0),a.x=f,a.y=h,a},c.phi1z=function(a,b){var c,e,f,g,i,j=h(.5*b);if(d>a)return j;for(var k=a*a,l=1;25>=l;l++)if(c=Math.sin(j),e=Math.cos(j),f=a*c,g=1-f*f,i=.5*g*g/e*(b/(1-k)-c/g+.5/a*Math.log((1-f)/(1+f))),j+=i,Math.abs(i)<=1e-7)return j;return null},c.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],41:[function(a,b,c){var d=a("../common/adjust_lon"),e=Math.PI/2,f=1e-10,g=a("../common/mlfn"),h=a("../common/e0fn"),i=a("../common/e1fn"),j=a("../common/e2fn"),k=a("../common/e3fn"),l=a("../common/gN"),m=a("../common/asinz"),n=a("../common/imlfn");c.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},c.forward=function(a){var b,c,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=a.x,I=a.y,J=Math.sin(a.y),K=Math.cos(a.y),L=d(H-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=f?(a.x=this.x0+this.a*(e-I)*Math.sin(L),a.y=this.y0-this.a*(e-I)*Math.cos(L),a):Math.abs(this.sin_p12+1)<=f?(a.x=this.x0+this.a*(e+I)*Math.sin(L),a.y=this.y0+this.a*(e+I)*Math.cos(L),a):(B=this.sin_p12*J+this.cos_p12*K*Math.cos(L),z=Math.acos(B),A=z/Math.sin(z),a.x=this.x0+this.a*A*K*Math.sin(L),a.y=this.y0+this.a*A*(this.cos_p12*J-this.sin_p12*K*Math.cos(L)),a):(b=h(this.es),c=i(this.es),m=j(this.es),n=k(this.es),Math.abs(this.sin_p12-1)<=f?(o=this.a*g(b,c,m,n,e),p=this.a*g(b,c,m,n,I),a.x=this.x0+(o-p)*Math.sin(L),a.y=this.y0-(o-p)*Math.cos(L),a):Math.abs(this.sin_p12+1)<=f?(o=this.a*g(b,c,m,n,e),p=this.a*g(b,c,m,n,I),a.x=this.x0+(o+p)*Math.sin(L),a.y=this.y0+(o+p)*Math.cos(L),a):(q=J/K,r=l(this.a,this.e,this.sin_p12),s=l(this.a,this.e,J),t=Math.atan((1-this.es)*q+this.es*r*this.sin_p12/(s*K)),u=Math.atan2(Math.sin(L),this.cos_p12*Math.tan(t)-this.sin_p12*Math.cos(L)),C=0===u?Math.asin(this.cos_p12*Math.sin(t)-this.sin_p12*Math.cos(t)):Math.abs(Math.abs(u)-Math.PI)<=f?-Math.asin(this.cos_p12*Math.sin(t)-this.sin_p12*Math.cos(t)):Math.asin(Math.sin(L)*Math.cos(t)/Math.sin(u)),v=this.e*this.sin_p12/Math.sqrt(1-this.es),w=this.e*this.cos_p12*Math.cos(u)/Math.sqrt(1-this.es),x=v*w,y=w*w,D=C*C,E=D*C,F=E*C,G=F*C,z=r*C*(1-D*y*(1-y)/6+E/8*x*(1-2*y)+F/120*(y*(4-7*y)-3*v*v*(1-7*y))-G/48*x),a.x=this.x0+z*Math.sin(u),a.y=this.y0+z*Math.cos(u),a))},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;if(this.sphere){if(b=Math.sqrt(a.x*a.x+a.y*a.y),b>2*e*this.a)return;return c=b/this.a,o=Math.sin(c),p=Math.cos(c),q=this.long0,Math.abs(b)<=f?r=this.lat0:(r=m(p*this.sin_p12+a.y*o*this.cos_p12/b),s=Math.abs(this.lat0)-e,q=d(Math.abs(s)<=f?this.lat0>=0?this.long0+Math.atan2(a.x,-a.y):this.long0-Math.atan2(-a.x,a.y):this.long0+Math.atan2(a.x*o,b*this.cos_p12*p-a.y*this.sin_p12*o))),a.x=q,a.y=r,a}return t=h(this.es),u=i(this.es),v=j(this.es),w=k(this.es),Math.abs(this.sin_p12-1)<=f?(x=this.a*g(t,u,v,w,e),b=Math.sqrt(a.x*a.x+a.y*a.y),y=x-b,r=n(y/this.a,t,u,v,w),q=d(this.long0+Math.atan2(a.x,-1*a.y)),a.x=q,a.y=r,a):Math.abs(this.sin_p12+1)<=f?(x=this.a*g(t,u,v,w,e),b=Math.sqrt(a.x*a.x+a.y*a.y),y=b-x,r=n(y/this.a,t,u,v,w),q=d(this.long0+Math.atan2(a.x,a.y)),a.x=q,a.y=r,a):(b=Math.sqrt(a.x*a.x+a.y*a.y),B=Math.atan2(a.x,a.y),z=l(this.a,this.e,this.sin_p12),C=Math.cos(B),D=this.e*this.cos_p12*C,E=-D*D/(1-this.es),F=3*this.es*(1-E)*this.sin_p12*this.cos_p12*C/(1-this.es),G=b/z,H=G-E*(1+E)*Math.pow(G,3)/6-F*(1+3*E)*Math.pow(G,4)/24,I=1-E*H*H/2-G*H*H*H/6,A=Math.asin(this.sin_p12*Math.cos(H)+this.cos_p12*Math.sin(H)*C),q=d(this.long0+Math.asin(Math.sin(B)*Math.sin(H)/Math.cos(A))),r=Math.atan((1-this.es*I*this.sin_p12/Math.sin(A))*Math.tan(A)/(1-this.es)),a.x=q,a.y=r,a)},c.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(a,b,c){var d=a("../common/mlfn"),e=a("../common/e0fn"),f=a("../common/e1fn"),g=a("../common/e2fn"),h=a("../common/e3fn"),i=a("../common/gN"),j=a("../common/adjust_lon"),k=a("../common/adjust_lat"),l=a("../common/imlfn"),m=Math.PI/2,n=1e-10;c.init=function(){this.sphere||(this.e0=e(this.es),this.e1=f(this.es),this.e2=g(this.es),this.e3=h(this.es),this.ml0=this.a*d(this.e0,this.e1,this.e2,this.e3,this.lat0))},c.forward=function(a){var b,c,e=a.x,f=a.y;if(e=j(e-this.long0),this.sphere)b=this.a*Math.asin(Math.cos(f)*Math.sin(e)),c=this.a*(Math.atan2(Math.tan(f),Math.cos(e))-this.lat0);else{var g=Math.sin(f),h=Math.cos(f),k=i(this.a,this.e,g),l=Math.tan(f)*Math.tan(f),m=e*Math.cos(f),n=m*m,o=this.es*h*h/(1-this.es),p=this.a*d(this.e0,this.e1,this.e2,this.e3,f);b=k*m*(1-n*l*(1/6-(8-l+8*o)*n/120)),c=p-this.ml0+k*g/h*n*(.5+(5-l+6*o)*n/24)}return a.x=b+this.x0,a.y=c+this.y0,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,d=a.x/this.a,e=a.y/this.a;if(this.sphere){var f=e+this.lat0;b=Math.asin(Math.sin(f)*Math.cos(d)),c=Math.atan2(Math.tan(d),Math.cos(f))}else{var g=this.ml0/this.a+e,h=l(g,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(h)-m)<=n)return a.x=this.long0,a.y=m,0>e&&(a.y*=-1),a;var o=i(this.a,this.e,Math.sin(h)),p=o*o*o/this.a/this.a*(1-this.es),q=Math.pow(Math.tan(h),2),r=d*this.a/o,s=r*r;b=h-o*Math.tan(h)/p*r*r*(.5-(1+3*q)*r*r/24),c=r*(1-s*(q/3+(1+3*q)*q*s/15))/Math.cos(h)}return a.x=j(c+this.long0),a.y=k(b),a},c.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],43:[function(a,b,c){var d=a("../common/adjust_lon"),e=a("../common/qsfnz"),f=a("../common/msfnz"),g=a("../common/iqsfnz");c.init=function(){this.sphere||(this.k0=f(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},c.forward=function(a){var b,c,f=a.x,g=a.y,h=d(f-this.long0);if(this.sphere)b=this.x0+this.a*h*Math.cos(this.lat_ts),c=this.y0+this.a*Math.sin(g)/Math.cos(this.lat_ts);else{var i=e(this.e,Math.sin(g));b=this.x0+this.a*this.k0*h,c=this.y0+this.a*i*.5/this.k0}return a.x=b,a.y=c,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c;return this.sphere?(b=d(this.long0+a.x/this.a/Math.cos(this.lat_ts)),c=Math.asin(a.y/this.a*Math.cos(this.lat_ts))):(c=g(this.e,2*a.y*this.k0/this.a),b=d(this.long0+a.x/(this.a*this.k0))),a.x=b,a.y=c,a},c.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],44:[function(a,b,c){var d=a("../common/adjust_lon"),e=a("../common/adjust_lat");c.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},c.forward=function(a){var b=a.x,c=a.y,f=d(b-this.long0),g=e(c-this.lat0);return a.x=this.x0+this.a*f*this.rc,a.y=this.y0+this.a*g,a},c.inverse=function(a){var b=a.x,c=a.y;return a.x=d(this.long0+(b-this.x0)/(this.a*this.rc)),a.y=e(this.lat0+(c-this.y0)/this.a),a},c.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],45:[function(a,b,c){var d=a("../common/e0fn"),e=a("../common/e1fn"),f=a("../common/e2fn"),g=a("../common/e3fn"),h=a("../common/msfnz"),i=a("../common/mlfn"),j=a("../common/adjust_lon"),k=a("../common/adjust_lat"),l=a("../common/imlfn"),m=1e-10;c.init=function(){Math.abs(this.lat1+this.lat2)<m||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=d(this.es),this.e1=e(this.es),this.e2=f(this.es),this.e3=g(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=h(this.e,this.sinphi,this.cosphi),this.ml1=i(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<m?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=h(this.e,this.sinphi,this.cosphi),this.ml2=i(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=i(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},c.forward=function(a){var b,c=a.x,d=a.y;if(this.sphere)b=this.a*(this.g-d);else{var e=i(this.e0,this.e1,this.e2,this.e3,d);b=this.a*(this.g-e)}var f=this.ns*j(c-this.long0),g=this.x0+b*Math.sin(f),h=this.y0+this.rh-b*Math.cos(f);return a.x=g,a.y=h,a},c.inverse=function(a){a.x-=this.x0,a.y=this.rh-a.y+this.y0;var b,c,d,e;this.ns>=0?(c=Math.sqrt(a.x*a.x+a.y*a.y),b=1):(c=-Math.sqrt(a.x*a.x+a.y*a.y),b=-1);var f=0;if(0!==c&&(f=Math.atan2(b*a.x,b*a.y)),this.sphere)return e=j(this.long0+f/this.ns),d=k(this.g-c/this.a),a.x=e,a.y=d,a;var g=this.g-c/this.a;return d=l(g,this.e0,this.e1,this.e2,this.e3),e=j(this.long0+f/this.ns),a.x=e,a.y=d,a},c.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],46:[function(a,b,c){var d=Math.PI/4,e=a("../common/srat"),f=Math.PI/2,g=20;c.init=function(){var a=Math.sin(this.lat0),b=Math.cos(this.lat0);b*=b,this.rc=Math.sqrt(1-this.es)/(1-this.es*a*a),this.C=Math.sqrt(1+this.es*b*b/(1-this.es)),this.phic0=Math.asin(a/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+d)/(Math.pow(Math.tan(.5*this.lat0+d),this.C)*e(this.e*a,this.ratexp))},c.forward=function(a){var b=a.x,c=a.y;return a.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*c+d),this.C)*e(this.e*Math.sin(c),this.ratexp))-f,a.x=this.C*b,a},c.inverse=function(a){for(var b=1e-14,c=a.x/this.C,h=a.y,i=Math.pow(Math.tan(.5*h+d)/this.K,1/this.C),j=g;j>0&&(h=2*Math.atan(i*e(this.e*Math.sin(a.y),-.5*this.e))-f,!(Math.abs(h-a.y)<b));--j)a.y=h;return j?(a.x=c,a.y=h,a):null},c.names=["gauss"]},{"../common/srat":22}],47:[function(a,b,c){function d(a){return a;
}c.init=function(){this.isGeocent=!0},c.forward=d,c.inverse=d,c.names=["geocent"]},{}],48:[function(a,b,c){var d=a("../common/adjust_lon"),e=1e-10,f=a("../common/asinz");c.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},c.forward=function(a){var b,c,f,g,h,i,j,k,l=a.x,m=a.y;return f=d(l-this.long0),b=Math.sin(m),c=Math.cos(m),g=Math.cos(f),i=this.sin_p14*b+this.cos_p14*c*g,h=1,i>0||Math.abs(i)<=e?(j=this.x0+this.a*h*c*Math.sin(f)/i,k=this.y0+this.a*h*(this.cos_p14*b-this.sin_p14*c*g)/i):(j=this.x0+this.infinity_dist*c*Math.sin(f),k=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*c*g)),a.x=j,a.y=k,a},c.inverse=function(a){var b,c,e,g,h,i;return a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,(b=Math.sqrt(a.x*a.x+a.y*a.y))?(g=Math.atan2(b,this.rc),c=Math.sin(g),e=Math.cos(g),i=f(e*this.sin_p14+a.y*c*this.cos_p14/b),h=Math.atan2(a.x*c,b*this.cos_p14*e-a.y*this.sin_p14*c),h=d(this.long0+h)):(i=this.phic0,h=0),a.x=h,a.y=i,a},c.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],49:[function(a,b,c){var d=a("../common/adjust_lon");c.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},c.forward=function(a){var b,c,e,f,g,h,i,j=a.x,k=a.y,l=d(j-this.long0);return b=Math.pow((1+this.e*Math.sin(k))/(1-this.e*Math.sin(k)),this.alfa*this.e/2),c=2*(Math.atan(this.k*Math.pow(Math.tan(k/2+this.s45),this.alfa)/b)-this.s45),e=-l*this.alfa,f=Math.asin(Math.cos(this.ad)*Math.sin(c)+Math.sin(this.ad)*Math.cos(c)*Math.cos(e)),g=Math.asin(Math.cos(c)*Math.sin(e)/Math.cos(f)),h=this.n*g,i=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(f/2+this.s45),this.n),a.y=i*Math.cos(h)/1,a.x=i*Math.sin(h)/1,this.czech||(a.y*=-1,a.x*=-1),a},c.inverse=function(a){var b,c,d,e,f,g,h,i,j=a.x;a.x=a.y,a.y=j,this.czech||(a.y*=-1,a.x*=-1),g=Math.sqrt(a.x*a.x+a.y*a.y),f=Math.atan2(a.y,a.x),e=f/Math.sin(this.s0),d=2*(Math.atan(Math.pow(this.ro0/g,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),b=Math.asin(Math.cos(this.ad)*Math.sin(d)-Math.sin(this.ad)*Math.cos(d)*Math.cos(e)),c=Math.asin(Math.cos(d)*Math.sin(e)/Math.cos(b)),a.x=this.long0-c/this.alfa,h=b,i=0;var k=0;do a.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(h))/(1-this.e*Math.sin(h)),this.e/2))-this.s45),Math.abs(h-a.y)<1e-10&&(i=1),h=a.y,k+=1;while(0===i&&15>k);return k>=15?null:a},c.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],50:[function(a,b,c){var d=Math.PI/2,e=Math.PI/4,f=1e-10,g=a("../common/qsfnz"),h=a("../common/adjust_lon");c.S_POLE=1,c.N_POLE=2,c.EQUIT=3,c.OBLIQ=4,c.init=function(){var a=Math.abs(this.lat0);if(Math.abs(a-d)<f?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(a)<f?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var b;switch(this.qp=g(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),b=Math.sin(this.lat0),this.sinb1=g(this.e,b)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*b*b)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},c.forward=function(a){var b,c,i,j,k,l,m,n,o,p,q=a.x,r=a.y;if(q=h(q-this.long0),this.sphere){if(k=Math.sin(r),p=Math.cos(r),i=Math.cos(q),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c=this.mode===this.EQUIT?1+p*i:1+this.sinph0*k+this.cosph0*p*i,f>=c)return null;c=Math.sqrt(2/c),b=c*p*Math.sin(q),c*=this.mode===this.EQUIT?k:this.cosph0*k-this.sinph0*p*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(r+this.phi0)<f)return null;c=e-.5*r,c=2*(this.mode===this.S_POLE?Math.cos(c):Math.sin(c)),b=c*Math.sin(q),c*=i}}else{switch(m=0,n=0,o=0,i=Math.cos(q),j=Math.sin(q),k=Math.sin(r),l=g(this.e,k),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(m=l/this.qp,n=Math.sqrt(1-m*m)),this.mode){case this.OBLIQ:o=1+this.sinb1*m+this.cosb1*n*i;break;case this.EQUIT:o=1+n*i;break;case this.N_POLE:o=d+r,l=this.qp-l;break;case this.S_POLE:o=r-d,l=this.qp+l}if(Math.abs(o)<f)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:o=Math.sqrt(2/o),c=this.mode===this.OBLIQ?this.ymf*o*(this.cosb1*m-this.sinb1*n*i):(o=Math.sqrt(2/(1+n*i)))*m*this.ymf,b=this.xmf*o*n*j;break;case this.N_POLE:case this.S_POLE:l>=0?(b=(o=Math.sqrt(l))*j,c=i*(this.mode===this.S_POLE?o:-o)):b=c=0}}return a.x=this.a*b+this.x0,a.y=this.a*c+this.y0,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,e,g,i,j,k,l=a.x/this.a,m=a.y/this.a;if(this.sphere){var n,o=0,p=0;if(n=Math.sqrt(l*l+m*m),c=.5*n,c>1)return null;switch(c=2*Math.asin(c),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(p=Math.sin(c),o=Math.cos(c)),this.mode){case this.EQUIT:c=Math.abs(n)<=f?0:Math.asin(m*p/n),l*=p,m=o*n;break;case this.OBLIQ:c=Math.abs(n)<=f?this.phi0:Math.asin(o*this.sinph0+m*p*this.cosph0/n),l*=p*this.cosph0,m=(o-Math.sin(c)*this.sinph0)*n;break;case this.N_POLE:m=-m,c=d-c;break;case this.S_POLE:c-=d}b=0!==m||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(l,m):0}else{if(k=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(l/=this.dd,m*=this.dd,j=Math.sqrt(l*l+m*m),f>j)return a.x=0,a.y=this.phi0,a;g=2*Math.asin(.5*j/this.rq),e=Math.cos(g),l*=g=Math.sin(g),this.mode===this.OBLIQ?(k=e*this.sinb1+m*g*this.cosb1/j,i=this.qp*k,m=j*this.cosb1*e-m*this.sinb1*g):(k=m*g/j,i=this.qp*k,m=j*e)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(m=-m),i=l*l+m*m,!i)return a.x=0,a.y=this.phi0,a;k=1-i/this.qp,this.mode===this.S_POLE&&(k=-k)}b=Math.atan2(l,m),c=this.authlat(Math.asin(k),this.apa)}return a.x=h(this.long0+b),a.y=c,a},c.P00=.3333333333333333,c.P01=.17222222222222222,c.P02=.10257936507936508,c.P10=.06388888888888888,c.P11=.0664021164021164,c.P20=.016415012942191543,c.authset=function(a){var b,c=[];return c[0]=a*this.P00,b=a*a,c[0]+=b*this.P01,c[1]=b*this.P10,b*=a,c[0]+=b*this.P02,c[1]+=b*this.P11,c[2]=b*this.P20,c},c.authlat=function(a,b){var c=a+a;return a+b[0]*Math.sin(c)+b[1]*Math.sin(c+c)+b[2]*Math.sin(c+c+c)},c.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],51:[function(a,b,c){var d=1e-10,e=a("../common/msfnz"),f=a("../common/tsfnz"),g=Math.PI/2,h=a("../common/sign"),i=a("../common/adjust_lon"),j=a("../common/phi2z");c.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<d)){var a=this.b/this.a;this.e=Math.sqrt(1-a*a);var b=Math.sin(this.lat1),c=Math.cos(this.lat1),g=e(this.e,b,c),h=f(this.e,this.lat1,b),i=Math.sin(this.lat2),j=Math.cos(this.lat2),k=e(this.e,i,j),l=f(this.e,this.lat2,i),m=f(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>d?this.ns=Math.log(g/k)/Math.log(h/l):this.ns=b,isNaN(this.ns)&&(this.ns=b),this.f0=g/(this.ns*Math.pow(h,this.ns)),this.rh=this.a*this.f0*Math.pow(m,this.ns),this.title||(this.title="Lambert Conformal Conic")}},c.forward=function(a){var b=a.x,c=a.y;Math.abs(2*Math.abs(c)-Math.PI)<=d&&(c=h(c)*(g-2*d));var e,j,k=Math.abs(Math.abs(c)-g);if(k>d)e=f(this.e,c,Math.sin(c)),j=this.a*this.f0*Math.pow(e,this.ns);else{if(k=c*this.ns,0>=k)return null;j=0}var l=this.ns*i(b-this.long0);return a.x=this.k0*(j*Math.sin(l))+this.x0,a.y=this.k0*(this.rh-j*Math.cos(l))+this.y0,a},c.inverse=function(a){var b,c,d,e,f,h=(a.x-this.x0)/this.k0,k=this.rh-(a.y-this.y0)/this.k0;this.ns>0?(b=Math.sqrt(h*h+k*k),c=1):(b=-Math.sqrt(h*h+k*k),c=-1);var l=0;if(0!==b&&(l=Math.atan2(c*h,c*k)),0!==b||this.ns>0){if(c=1/this.ns,d=Math.pow(b/(this.a*this.f0),c),e=j(this.e,d),-9999===e)return null}else e=-g;return f=i(l/this.ns+this.long0),a.x=f,a.y=e,a},c.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],52:[function(a,b,c){function d(a){return a}c.init=function(){},c.forward=d,c.inverse=d,c.names=["longlat","identity"]},{}],53:[function(a,b,c){var d=a("../common/msfnz"),e=Math.PI/2,f=1e-10,g=57.29577951308232,h=a("../common/adjust_lon"),i=Math.PI/4,j=a("../common/tsfnz"),k=a("../common/phi2z");c.init=function(){var a=this.b/this.a;this.es=1-a*a,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=d(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},c.forward=function(a){var b=a.x,c=a.y;if(c*g>90&&-90>c*g&&b*g>180&&-180>b*g)return null;var d,k;if(Math.abs(Math.abs(c)-e)<=f)return null;if(this.sphere)d=this.x0+this.a*this.k0*h(b-this.long0),k=this.y0+this.a*this.k0*Math.log(Math.tan(i+.5*c));else{var l=Math.sin(c),m=j(this.e,c,l);d=this.x0+this.a*this.k0*h(b-this.long0),k=this.y0-this.a*this.k0*Math.log(m)}return a.x=d,a.y=k,a},c.inverse=function(a){var b,c,d=a.x-this.x0,f=a.y-this.y0;if(this.sphere)c=e-2*Math.atan(Math.exp(-f/(this.a*this.k0)));else{var g=Math.exp(-f/(this.a*this.k0));if(c=k(this.e,g),-9999===c)return null}return b=h(this.long0+d/(this.a*this.k0)),a.x=b,a.y=c,a},c.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],54:[function(a,b,c){var d=a("../common/adjust_lon");c.init=function(){},c.forward=function(a){var b=a.x,c=a.y,e=d(b-this.long0),f=this.x0+this.a*e,g=this.y0+this.a*Math.log(Math.tan(Math.PI/4+c/2.5))*1.25;return a.x=f,a.y=g,a},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b=d(this.long0+a.x/this.a),c=2.5*(Math.atan(Math.exp(.8*a.y/this.a))-Math.PI/4);return a.x=b,a.y=c,a},c.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],55:[function(a,b,c){var d=a("../common/adjust_lon"),e=1e-10;c.init=function(){},c.forward=function(a){for(var b=a.x,c=a.y,f=d(b-this.long0),g=c,h=Math.PI*Math.sin(c),i=0;!0;i++){var j=-(g+Math.sin(g)-h)/(1+Math.cos(g));if(g+=j,Math.abs(j)<e)break}g/=2,Math.PI/2-Math.abs(c)<e&&(f=0);var k=.900316316158*this.a*f*Math.cos(g)+this.x0,l=1.4142135623731*this.a*Math.sin(g)+this.y0;return a.x=k,a.y=l,a},c.inverse=function(a){var b,c;a.x-=this.x0,a.y-=this.y0,c=a.y/(1.4142135623731*this.a),Math.abs(c)>.999999999999&&(c=.999999999999),b=Math.asin(c);var e=d(this.long0+a.x/(.900316316158*this.a*Math.cos(b)));e<-Math.PI&&(e=-Math.PI),e>Math.PI&&(e=Math.PI),c=(2*b+Math.sin(2*b))/Math.PI,Math.abs(c)>1&&(c=1);var f=Math.asin(c);return a.x=e,a.y=f,a},c.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],56:[function(a,b,c){var d=484813681109536e-20;c.iterations=1,c.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},c.forward=function(a){var b,c=a.x,e=a.y,f=e-this.lat0,g=c-this.long0,h=f/d*1e-5,i=g,j=1,k=0;for(b=1;10>=b;b++)j*=h,k+=this.A[b]*j;var l,m,n=k,o=i,p=1,q=0,r=0,s=0;for(b=1;6>=b;b++)l=p*n-q*o,m=q*n+p*o,p=l,q=m,r=r+this.B_re[b]*p-this.B_im[b]*q,s=s+this.B_im[b]*p+this.B_re[b]*q;return a.x=s*this.a+this.x0,a.y=r*this.a+this.y0,a},c.inverse=function(a){var b,c,e,f=a.x,g=a.y,h=f-this.x0,i=g-this.y0,j=i/this.a,k=h/this.a,l=1,m=0,n=0,o=0;for(b=1;6>=b;b++)c=l*j-m*k,e=m*j+l*k,l=c,m=e,n=n+this.C_re[b]*l-this.C_im[b]*m,o=o+this.C_im[b]*l+this.C_re[b]*m;for(var p=0;p<this.iterations;p++){var q,r,s=n,t=o,u=j,v=k;for(b=2;6>=b;b++)q=s*n-t*o,r=t*n+s*o,s=q,t=r,u+=(b-1)*(this.B_re[b]*s-this.B_im[b]*t),v+=(b-1)*(this.B_im[b]*s+this.B_re[b]*t);s=1,t=0;var w=this.B_re[1],x=this.B_im[1];for(b=2;6>=b;b++)q=s*n-t*o,r=t*n+s*o,s=q,t=r,w+=b*(this.B_re[b]*s-this.B_im[b]*t),x+=b*(this.B_im[b]*s+this.B_re[b]*t);var y=w*w+x*x;n=(u*w+v*x)/y,o=(v*w-u*x)/y}var z=n,A=o,B=1,C=0;for(b=1;9>=b;b++)B*=z,C+=this.D[b]*B;var D=this.lat0+C*d*1e5,E=this.long0+A;return a.x=E,a.y=D,a},c.names=["New_Zealand_Map_Grid","nzmg"]},{}],57:[function(a,b,c){var d=a("../common/tsfnz"),e=a("../common/adjust_lon"),f=a("../common/phi2z"),g=Math.PI/2,h=Math.PI/4,i=1e-10;c.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var a=Math.sin(this.lat0),b=Math.cos(this.lat0),c=this.e*a;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(b,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-c*c);var f=d(this.e,this.lat0,a),g=this.bl/b*Math.sqrt((1-this.es)/(1-c*c));1>g*g&&(g=1);var h,i;if(isNaN(this.longc)){var j=d(this.e,this.lat1,Math.sin(this.lat1)),k=d(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(g+Math.sqrt(g*g-1))*Math.pow(f,this.bl):this.el=(g-Math.sqrt(g*g-1))*Math.pow(f,this.bl);var l=Math.pow(j,this.bl),m=Math.pow(k,this.bl);h=this.el/l,i=.5*(h-1/h);var n=(this.el*this.el-m*l)/(this.el*this.el+m*l),o=(m-l)/(m+l),p=e(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(n*Math.tan(.5*this.bl*p)/o)/this.bl,this.long0=e(this.long0);var q=e(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*q)/i),this.alpha=Math.asin(g*Math.sin(this.gamma0))}else h=this.lat0>=0?g+Math.sqrt(g*g-1):g-Math.sqrt(g*g-1),this.el=h*Math.pow(f,this.bl),i=.5*(h-1/h),this.gamma0=Math.asin(Math.sin(this.alpha)/g),this.long0=this.longc-Math.asin(i*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(g*g-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(g*g-1),Math.cos(this.alpha))},c.forward=function(a){var b,c,f,j=a.x,k=a.y,l=e(j-this.long0);if(Math.abs(Math.abs(k)-g)<=i)f=k>0?-1:1,c=this.al/this.bl*Math.log(Math.tan(h+f*this.gamma0*.5)),b=-1*f*g*this.al/this.bl;else{var m=d(this.e,k,Math.sin(k)),n=this.el/Math.pow(m,this.bl),o=.5*(n-1/n),p=.5*(n+1/n),q=Math.sin(this.bl*l),r=(o*Math.sin(this.gamma0)-q*Math.cos(this.gamma0))/p;c=Math.abs(Math.abs(r)-1)<=i?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-r)/(1+r))/this.bl,b=Math.abs(Math.cos(this.bl*l))<=i?this.al*this.bl*l:this.al*Math.atan2(o*Math.cos(this.gamma0)+q*Math.sin(this.gamma0),Math.cos(this.bl*l))/this.bl}return this.no_rot?(a.x=this.x0+b,a.y=this.y0+c):(b-=this.uc,a.x=this.x0+c*Math.cos(this.alpha)+b*Math.sin(this.alpha),a.y=this.y0+b*Math.cos(this.alpha)-c*Math.sin(this.alpha)),a},c.inverse=function(a){var b,c;this.no_rot?(c=a.y-this.y0,b=a.x-this.x0):(c=(a.x-this.x0)*Math.cos(this.alpha)-(a.y-this.y0)*Math.sin(this.alpha),b=(a.y-this.y0)*Math.cos(this.alpha)+(a.x-this.x0)*Math.sin(this.alpha),b+=this.uc);var d=Math.exp(-1*this.bl*c/this.al),h=.5*(d-1/d),j=.5*(d+1/d),k=Math.sin(this.bl*b/this.al),l=(k*Math.cos(this.gamma0)+h*Math.sin(this.gamma0))/j,m=Math.pow(this.el/Math.sqrt((1+l)/(1-l)),1/this.bl);return Math.abs(l-1)<i?(a.x=this.long0,a.y=g):Math.abs(l+1)<i?(a.x=this.long0,a.y=-1*g):(a.y=f(this.e,m),a.x=e(this.long0-Math.atan2(h*Math.cos(this.gamma0)-k*Math.sin(this.gamma0),Math.cos(this.bl*b/this.al))/this.bl)),a},c.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],58:[function(a,b,c){var d=a("../common/e0fn"),e=a("../common/e1fn"),f=a("../common/e2fn"),g=a("../common/e3fn"),h=a("../common/adjust_lon"),i=a("../common/adjust_lat"),j=a("../common/mlfn"),k=1e-10,l=a("../common/gN"),m=20;c.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=d(this.es),this.e1=e(this.es),this.e2=f(this.es),this.e3=g(this.es),this.ml0=this.a*j(this.e0,this.e1,this.e2,this.e3,this.lat0)},c.forward=function(a){var b,c,d,e=a.x,f=a.y,g=h(e-this.long0);if(d=g*Math.sin(f),this.sphere)Math.abs(f)<=k?(b=this.a*g,c=-1*this.a*this.lat0):(b=this.a*Math.sin(d)/Math.tan(f),c=this.a*(i(f-this.lat0)+(1-Math.cos(d))/Math.tan(f)));else if(Math.abs(f)<=k)b=this.a*g,c=-1*this.ml0;else{var m=l(this.a,this.e,Math.sin(f))/Math.tan(f);b=m*Math.sin(d),c=this.a*j(this.e0,this.e1,this.e2,this.e3,f)-this.ml0+m*(1-Math.cos(d))}return a.x=b+this.x0,a.y=c+this.y0,a},c.inverse=function(a){var b,c,d,e,f,g,i,l,n;if(d=a.x-this.x0,e=a.y-this.y0,this.sphere)if(Math.abs(e+this.a*this.lat0)<=k)b=h(d/this.a+this.long0),c=0;else{g=this.lat0+e/this.a,i=d*d/this.a/this.a+g*g,l=g;var o;for(f=m;f;--f)if(o=Math.tan(l),n=-1*(g*(l*o+1)-l-.5*(l*l+i)*o)/((l-g)/o-1),l+=n,Math.abs(n)<=k){c=l;break}b=h(this.long0+Math.asin(d*Math.tan(l)/this.a)/Math.sin(c))}else if(Math.abs(e+this.ml0)<=k)c=0,b=h(this.long0+d/this.a);else{g=(this.ml0+e)/this.a,i=d*d/this.a/this.a+g*g,l=g;var p,q,r,s,t;for(f=m;f;--f)if(t=this.e*Math.sin(l),p=Math.sqrt(1-t*t)*Math.tan(l),q=this.a*j(this.e0,this.e1,this.e2,this.e3,l),r=this.e0-2*this.e1*Math.cos(2*l)+4*this.e2*Math.cos(4*l)-6*this.e3*Math.cos(6*l),s=q/this.a,n=(g*(p*s+1)-s-.5*p*(s*s+i))/(this.es*Math.sin(2*l)*(s*s+i-2*g*s)/(4*p)+(g-s)*(p*r-2/Math.sin(2*l))-r),l-=n,Math.abs(n)<=k){c=l;break}p=Math.sqrt(1-this.es*Math.pow(Math.sin(c),2))*Math.tan(c),b=h(this.long0+Math.asin(d*p/this.a)/Math.sin(c))}return a.x=b,a.y=c,a},c.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],59:[function(a,b,c){var d=a("../common/adjust_lon"),e=a("../common/adjust_lat"),f=a("../common/pj_enfn"),g=20,h=a("../common/pj_mlfn"),i=a("../common/pj_inv_mlfn"),j=Math.PI/2,k=1e-10,l=a("../common/asinz");c.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=f(this.es)},c.forward=function(a){var b,c,e=a.x,f=a.y;if(e=d(e-this.long0),this.sphere){if(this.m)for(var i=this.n*Math.sin(f),j=g;j;--j){var l=(this.m*f+Math.sin(f)-i)/(this.m+Math.cos(f));if(f-=l,Math.abs(l)<k)break}else f=1!==this.n?Math.asin(this.n*Math.sin(f)):f;b=this.a*this.C_x*e*(this.m+Math.cos(f)),c=this.a*this.C_y*f}else{var m=Math.sin(f),n=Math.cos(f);c=this.a*h(f,m,n,this.en),b=this.a*e*n/Math.sqrt(1-this.es*m*m)}return a.x=b,a.y=c,a},c.inverse=function(a){var b,c,f,g;return a.x-=this.x0,f=a.x/this.a,a.y-=this.y0,b=a.y/this.a,this.sphere?(b/=this.C_y,f/=this.C_x*(this.m+Math.cos(b)),this.m?b=l((this.m*b+Math.sin(b))/this.n):1!==this.n&&(b=l(Math.sin(b)/this.n)),f=d(f+this.long0),b=e(b)):(b=i(a.y/this.a,this.es,this.en),g=Math.abs(b),j>g?(g=Math.sin(b),c=this.long0+a.x*Math.sqrt(1-this.es*g*g)/(this.a*Math.cos(b)),f=d(c)):j>g-k&&(f=this.long0)),a.x=f,a.y=b,a},c.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],60:[function(a,b,c){c.init=function(){var a=this.lat0;this.lambda0=this.long0;var b=Math.sin(a),c=this.a,d=this.rf,e=1/d,f=2*e-Math.pow(e,2),g=this.e=Math.sqrt(f);this.R=this.k0*c*Math.sqrt(1-f)/(1-f*Math.pow(b,2)),this.alpha=Math.sqrt(1+f/(1-f)*Math.pow(Math.cos(a),4)),this.b0=Math.asin(b/this.alpha);var h=Math.log(Math.tan(Math.PI/4+this.b0/2)),i=Math.log(Math.tan(Math.PI/4+a/2)),j=Math.log((1+g*b)/(1-g*b));this.K=h-this.alpha*i+this.alpha*g/2*j},c.forward=function(a){var b=Math.log(Math.tan(Math.PI/4-a.y/2)),c=this.e/2*Math.log((1+this.e*Math.sin(a.y))/(1-this.e*Math.sin(a.y))),d=-this.alpha*(b+c)+this.K,e=2*(Math.atan(Math.exp(d))-Math.PI/4),f=this.alpha*(a.x-this.lambda0),g=Math.atan(Math.sin(f)/(Math.sin(this.b0)*Math.tan(e)+Math.cos(this.b0)*Math.cos(f))),h=Math.asin(Math.cos(this.b0)*Math.sin(e)-Math.sin(this.b0)*Math.cos(e)*Math.cos(f));return a.y=this.R/2*Math.log((1+Math.sin(h))/(1-Math.sin(h)))+this.y0,a.x=this.R*g+this.x0,a},c.inverse=function(a){for(var b=a.x-this.x0,c=a.y-this.y0,d=b/this.R,e=2*(Math.atan(Math.exp(c/this.R))-Math.PI/4),f=Math.asin(Math.cos(this.b0)*Math.sin(e)+Math.sin(this.b0)*Math.cos(e)*Math.cos(d)),g=Math.atan(Math.sin(d)/(Math.cos(this.b0)*Math.cos(d)-Math.sin(this.b0)*Math.tan(e))),h=this.lambda0+g/this.alpha,i=0,j=f,k=-1e3,l=0;Math.abs(j-k)>1e-7;){if(++l>20)return;i=1/this.alpha*(Math.log(Math.tan(Math.PI/4+f/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(j))/2)),k=j,j=2*Math.atan(Math.exp(i))-Math.PI/2}return a.x=h,a.y=j,a},c.names=["somerc"]},{}],61:[function(a,b,c){var d=Math.PI/2,e=1e-10,f=a("../common/sign"),g=a("../common/msfnz"),h=a("../common/tsfnz"),i=a("../common/phi2z"),j=a("../common/adjust_lon");c.ssfn_=function(a,b,c){return b*=c,Math.tan(.5*(d+a))*Math.pow((1-b)/(1+b),.5*c)},c.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=e&&(this.k0=.5*(1+f(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=e&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=e&&(this.k0=.5*this.cons*g(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/h(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=g(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-d,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},c.forward=function(a){var b,c,f,g,i,k,l=a.x,m=a.y,n=Math.sin(m),o=Math.cos(m),p=j(l-this.long0);return Math.abs(Math.abs(l-this.long0)-Math.PI)<=e&&Math.abs(m+this.lat0)<=e?(a.x=NaN,a.y=NaN,a):this.sphere?(b=2*this.k0/(1+this.sinlat0*n+this.coslat0*o*Math.cos(p)),a.x=this.a*b*o*Math.sin(p)+this.x0,a.y=this.a*b*(this.coslat0*n-this.sinlat0*o*Math.cos(p))+this.y0,a):(c=2*Math.atan(this.ssfn_(m,n,this.e))-d,g=Math.cos(c),f=Math.sin(c),Math.abs(this.coslat0)<=e?(i=h(this.e,m*this.con,this.con*n),k=2*this.a*this.k0*i/this.cons,a.x=this.x0+k*Math.sin(l-this.long0),a.y=this.y0-this.con*k*Math.cos(l-this.long0),a):(Math.abs(this.sinlat0)<e?(b=2*this.a*this.k0/(1+g*Math.cos(p)),a.y=b*f):(b=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*f+this.cosX0*g*Math.cos(p))),a.y=b*(this.cosX0*f-this.sinX0*g*Math.cos(p))+this.y0),a.x=b*g*Math.sin(p)+this.x0,a))},c.inverse=function(a){a.x-=this.x0,a.y-=this.y0;var b,c,f,g,h,k=Math.sqrt(a.x*a.x+a.y*a.y);if(this.sphere){var l=2*Math.atan(k/(.5*this.a*this.k0));return b=this.long0,c=this.lat0,e>=k?(a.x=b,a.y=c,a):(c=Math.asin(Math.cos(l)*this.sinlat0+a.y*Math.sin(l)*this.coslat0/k),b=j(Math.abs(this.coslat0)<e?this.lat0>0?this.long0+Math.atan2(a.x,-1*a.y):this.long0+Math.atan2(a.x,a.y):this.long0+Math.atan2(a.x*Math.sin(l),k*this.coslat0*Math.cos(l)-a.y*this.sinlat0*Math.sin(l))),a.x=b,a.y=c,a)}if(Math.abs(this.coslat0)<=e){if(e>=k)return c=this.lat0,b=this.long0,a.x=b,a.y=c,a;a.x*=this.con,a.y*=this.con,f=k*this.cons/(2*this.a*this.k0),c=this.con*i(this.e,f),b=this.con*j(this.con*this.long0+Math.atan2(a.x,-1*a.y))}else g=2*Math.atan(k*this.cosX0/(2*this.a*this.k0*this.ms1)),b=this.long0,e>=k?h=this.X0:(h=Math.asin(Math.cos(g)*this.sinX0+a.y*Math.sin(g)*this.cosX0/k),b=j(this.long0+Math.atan2(a.x*Math.sin(g),k*this.cosX0*Math.cos(g)-a.y*this.sinX0*Math.sin(g)))),c=-1*i(this.e,Math.tan(.5*(d+h)));return a.x=b,a.y=c,a},c.names=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],62:[function(a,b,c){var d=a("./gauss"),e=a("../common/adjust_lon");c.init=function(){d.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},c.forward=function(a){var b,c,f,g;return a.x=e(a.x-this.long0),d.forward.apply(this,[a]),b=Math.sin(a.y),c=Math.cos(a.y),f=Math.cos(a.x),g=this.k0*this.R2/(1+this.sinc0*b+this.cosc0*c*f),a.x=g*c*Math.sin(a.x),a.y=g*(this.cosc0*b-this.sinc0*c*f),a.x=this.a*a.x+this.x0,a.y=this.a*a.y+this.y0,a},c.inverse=function(a){var b,c,f,g,h;if(a.x=(a.x-this.x0)/this.a,a.y=(a.y-this.y0)/this.a,a.x/=this.k0,a.y/=this.k0,h=Math.sqrt(a.x*a.x+a.y*a.y)){var i=2*Math.atan2(h,this.R2);b=Math.sin(i),c=Math.cos(i),g=Math.asin(c*this.sinc0+a.y*b*this.cosc0/h),f=Math.atan2(a.x*b,h*this.cosc0*c-a.y*this.sinc0*b)}else g=this.phic0,f=0;return a.x=f,a.y=g,d.inverse.apply(this,[a]),a.x=e(a.x+this.long0),a},c.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":46}],63:[function(a,b,c){var d=a("../common/e0fn"),e=a("../common/e1fn"),f=a("../common/e2fn"),g=a("../common/e3fn"),h=a("../common/mlfn"),i=a("../common/adjust_lon"),j=Math.PI/2,k=1e-10,l=a("../common/sign"),m=a("../common/asinz");c.init=function(){this.e0=d(this.es),this.e1=e(this.es),this.e2=f(this.es),this.e3=g(this.es),this.ml0=this.a*h(this.e0,this.e1,this.e2,this.e3,this.lat0)},c.forward=function(a){var b,c,d,e=a.x,f=a.y,g=i(e-this.long0),j=Math.sin(f),k=Math.cos(f);if(this.sphere){var l=k*Math.sin(g);if(Math.abs(Math.abs(l)-1)<1e-10)return 93;c=.5*this.a*this.k0*Math.log((1+l)/(1-l)),b=Math.acos(k*Math.cos(g)/Math.sqrt(1-l*l)),0>f&&(b=-b),d=this.a*this.k0*(b-this.lat0)}else{var m=k*g,n=Math.pow(m,2),o=this.ep2*Math.pow(k,2),p=Math.tan(f),q=Math.pow(p,2);b=1-this.es*Math.pow(j,2);var r=this.a/Math.sqrt(b),s=this.a*h(this.e0,this.e1,this.e2,this.e3,f);c=this.k0*r*m*(1+n/6*(1-q+o+n/20*(5-18*q+Math.pow(q,2)+72*o-58*this.ep2)))+this.x0,d=this.k0*(s-this.ml0+r*p*(n*(.5+n/24*(5-q+9*o+4*Math.pow(o,2)+n/30*(61-58*q+Math.pow(q,2)+600*o-330*this.ep2)))))+this.y0}return a.x=c,a.y=d,a},c.inverse=function(a){var b,c,d,e,f,g,h=6;if(this.sphere){var n=Math.exp(a.x/(this.a*this.k0)),o=.5*(n-1/n),p=this.lat0+a.y/(this.a*this.k0),q=Math.cos(p);b=Math.sqrt((1-q*q)/(1+o*o)),f=m(b),0>p&&(f=-f),g=0===o&&0===q?this.long0:i(Math.atan2(o,q)+this.long0)}else{var r=a.x-this.x0,s=a.y-this.y0;for(b=(this.ml0+s/this.k0)/this.a,c=b,e=0;!0&&(d=(b+this.e1*Math.sin(2*c)-this.e2*Math.sin(4*c)+this.e3*Math.sin(6*c))/this.e0-c,c+=d,!(Math.abs(d)<=k));e++)if(e>=h)return 95;if(Math.abs(c)<j){var t=Math.sin(c),u=Math.cos(c),v=Math.tan(c),w=this.ep2*Math.pow(u,2),x=Math.pow(w,2),y=Math.pow(v,2),z=Math.pow(y,2);b=1-this.es*Math.pow(t,2);var A=this.a/Math.sqrt(b),B=A*(1-this.es)/b,C=r/(A*this.k0),D=Math.pow(C,2);f=c-A*v*D/B*(.5-D/24*(5+3*y+10*w-4*x-9*this.ep2-D/30*(61+90*y+298*w+45*z-252*this.ep2-3*x))),g=i(this.long0+C*(1-D/6*(1+2*y+w-D/20*(5-2*w+28*y-3*x+8*this.ep2+24*z)))/u)}else f=j*l(s),g=this.long0}return a.x=g,a.y=f,a},c.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],64:[function(a,b,c){var d=.017453292519943295,e=a("./tmerc");c.dependsOn="tmerc",c.init=function(){this.zone&&(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*d,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,e.init.apply(this),this.forward=e.forward,this.inverse=e.inverse)},c.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":63}],65:[function(a,b,c){var d=a("../common/adjust_lon"),e=Math.PI/2,f=1e-10,g=a("../common/asinz");c.init=function(){this.R=this.a},c.forward=function(a){var b,c,h=a.x,i=a.y,j=d(h-this.long0);Math.abs(i)<=f&&(b=this.x0+this.R*j,c=this.y0);var k=g(2*Math.abs(i/Math.PI));(Math.abs(j)<=f||Math.abs(Math.abs(i)-e)<=f)&&(b=this.x0,c=i>=0?this.y0+Math.PI*this.R*Math.tan(.5*k):this.y0+Math.PI*this.R*-Math.tan(.5*k));var l=.5*Math.abs(Math.PI/j-j/Math.PI),m=l*l,n=Math.sin(k),o=Math.cos(k),p=o/(n+o-1),q=p*p,r=p*(2/n-1),s=r*r,t=Math.PI*this.R*(l*(p-s)+Math.sqrt(m*(p-s)*(p-s)-(s+m)*(q-s)))/(s+m);0>j&&(t=-t),b=this.x0+t;var u=m+p;return t=Math.PI*this.R*(r*u-l*Math.sqrt((s+m)*(m+1)-u*u))/(s+m),c=i>=0?this.y0+t:this.y0-t,a.x=b,a.y=c,a},c.inverse=function(a){var b,c,e,g,h,i,j,k,l,m,n,o,p;return a.x-=this.x0,a.y-=this.y0,n=Math.PI*this.R,e=a.x/n,g=a.y/n,h=e*e+g*g,i=-Math.abs(g)*(1+h),j=i-2*g*g+e*e,k=-2*i+1+2*g*g+h*h,p=g*g/k+(2*j*j*j/k/k/k-9*i*j/k/k)/27,l=(i-j*j/3/k)/k,m=2*Math.sqrt(-l/3),n=3*p/l/m,Math.abs(n)>1&&(n=n>=0?1:-1),o=Math.acos(n)/3,c=a.y>=0?(-m*Math.cos(o+Math.PI/3)-j/3/k)*Math.PI:-(-m*Math.cos(o+Math.PI/3)-j/3/k)*Math.PI,b=Math.abs(e)<f?this.long0:d(this.long0+Math.PI*(h-1+Math.sqrt(1+2*(e*e-g*g)+h*h))/2/e),a.x=b,a.y=c,a},c.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],66:[function(a,b,c){var d=.017453292519943295,e=57.29577951308232,f=1,g=2,h=a("./datum_transform"),i=a("./adjust_axis"),j=a("./Proj"),k=a("./common/toPoint");b.exports=function l(a,b,c){function m(a,b){return(a.datum.datum_type===f||a.datum.datum_type===g)&&"WGS84"!==b.datumCode}var n;return Array.isArray(c)&&(c=k(c)),a.datum&&b.datum&&(m(a,b)||m(b,a))&&(n=new j("WGS84"),l(a,n,c),a=n),"enu"!==a.axis&&i(a,!1,c),"longlat"===a.projName?(c.x*=d,c.y*=d):a.isGeocent?(a.to_meter&&(c.x*=a.to_meter,c.y*=a.to_meter,c.z*=a.to_meter),b.datum.geocentric_to_geodetic_noniter(c)):(a.to_meter&&(c.x*=a.to_meter,c.y*=a.to_meter),a.inverse(c)),a.from_greenwich&&(c.x+=a.from_greenwich),c=h(a.datum,b.datum,c),b.from_greenwich&&(c.x-=b.from_greenwich),"longlat"===b.projName?(c.x*=e,c.y*=e):b.isGeocent?(b.datum.geodetic_to_geocentric(c),b.to_meter&&(c.x/=b.to_meter,c.y/=b.to_meter,c.z/=b.to_meter)):(b.forward(c),b.to_meter&&(c.x/=b.to_meter,c.y/=b.to_meter)),"enu"!==b.axis&&i(b,!0,c),c}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":31}],67:[function(a,b,c){function d(a,b,c){a[b]=c.map(function(a){var b={};return e(a,b),b}).reduce(function(a,b){return j(a,b)},{})}function e(a,b){var c;return Array.isArray(a)?(c=a.shift(),"PARAMETER"===c&&(c=a.shift()),1===a.length?Array.isArray(a[0])?(b[c]={},e(a[0],b[c])):b[c]=a[0]:a.length?"TOWGS84"===c?b[c]=a:(b[c]={},["UNIT","PRIMEM","VERT_DATUM"].indexOf(c)>-1?(b[c]={name:a[0].toLowerCase(),convert:a[1]},3===a.length&&(b[c].auth=a[2])):"SPHEROID"===c?(b[c]={name:a[0],a:a[1],rf:a[2]},4===a.length&&(b[c].auth=a[3])):["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(c)>-1?(a[0]=["name",a[0]],d(b,c,a)):a.every(function(a){return Array.isArray(a)})?d(b,c,a):e(a,b[c])):b[c]=!0,
void 0):void(b[a]=!0)}function f(a,b){var c=b[0],d=b[1];!(c in a)&&d in a&&(a[c]=a[d],3===b.length&&(a[c]=b[2](a[c])))}function g(a){return a*i}function h(a){function b(b){var c=a.to_meter||1;return parseFloat(b,10)*c}"GEOGCS"===a.type?a.projName="longlat":"LOCAL_CS"===a.type?(a.projName="identity",a.local=!0):"object"==typeof a.PROJECTION?a.projName=Object.keys(a.PROJECTION)[0]:a.projName=a.PROJECTION,a.UNIT&&(a.units=a.UNIT.name.toLowerCase(),"metre"===a.units&&(a.units="meter"),a.UNIT.convert&&(a.to_meter=parseFloat(a.UNIT.convert,10))),a.GEOGCS&&(a.GEOGCS.DATUM?a.datumCode=a.GEOGCS.DATUM.name.toLowerCase():a.datumCode=a.GEOGCS.name.toLowerCase(),"d_"===a.datumCode.slice(0,2)&&(a.datumCode=a.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===a.datumCode||"new_zealand_1949"===a.datumCode)&&(a.datumCode="nzgd49"),"wgs_1984"===a.datumCode&&("Mercator_Auxiliary_Sphere"===a.PROJECTION&&(a.sphere=!0),a.datumCode="wgs84"),"_ferro"===a.datumCode.slice(-6)&&(a.datumCode=a.datumCode.slice(0,-6)),"_jakarta"===a.datumCode.slice(-8)&&(a.datumCode=a.datumCode.slice(0,-8)),~a.datumCode.indexOf("belge")&&(a.datumCode="rnb72"),a.GEOGCS.DATUM&&a.GEOGCS.DATUM.SPHEROID&&(a.ellps=a.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===a.ellps.toLowerCase().slice(0,13)&&(a.ellps="intl"),a.a=a.GEOGCS.DATUM.SPHEROID.a,a.rf=parseFloat(a.GEOGCS.DATUM.SPHEROID.rf,10)),~a.datumCode.indexOf("osgb_1936")&&(a.datumCode="osgb36")),a.b&&!isFinite(a.b)&&(a.b=a.a);var c=function(b){return f(a,b)},d=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",g],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",g],["x0","false_easting",b],["y0","false_northing",b],["long0","central_meridian",g],["lat0","latitude_of_origin",g],["lat0","standard_parallel_1",g],["lat1","standard_parallel_1",g],["lat2","standard_parallel_2",g],["alpha","azimuth",g],["srsCode","name"]];d.forEach(c),a.long0||!a.longc||"Albers_Conic_Equal_Area"!==a.projName&&"Lambert_Azimuthal_Equal_Area"!==a.projName||(a.long0=a.longc),a.lat_ts||!a.lat1||"Stereographic_South_Pole"!==a.projName&&"Polar Stereographic (variant B)"!==a.projName||(a.lat0=g(a.lat1>0?90:-90),a.lat_ts=a.lat1)}var i=.017453292519943295,j=a("./extend");b.exports=function(a,b){var c=JSON.parse((","+a).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]').replace(/,\["VERTCS".+/,"")),d=c.shift(),f=c.shift();c.unshift(["name",f]),c.unshift(["type",d]),c.unshift("output");var g={};return e(c,g),h(g.output),j(b,g.output)}},{"./extend":34}],68:[function(a,b,c){function d(a){return a*(Math.PI/180)}function e(a){return 180*(a/Math.PI)}function f(a){var b,c,e,f,g,i,j,k,l,m=a.lat,n=a.lon,o=6378137,p=.00669438,q=.9996,r=d(m),s=d(n);l=Math.floor((n+180)/6)+1,180===n&&(l=60),m>=56&&64>m&&n>=3&&12>n&&(l=32),m>=72&&84>m&&(n>=0&&9>n?l=31:n>=9&&21>n?l=33:n>=21&&33>n?l=35:n>=33&&42>n&&(l=37)),b=6*(l-1)-180+3,k=d(b),c=p/(1-p),e=o/Math.sqrt(1-p*Math.sin(r)*Math.sin(r)),f=Math.tan(r)*Math.tan(r),g=c*Math.cos(r)*Math.cos(r),i=Math.cos(r)*(s-k),j=o*((1-p/4-3*p*p/64-5*p*p*p/256)*r-(3*p/8+3*p*p/32+45*p*p*p/1024)*Math.sin(2*r)+(15*p*p/256+45*p*p*p/1024)*Math.sin(4*r)-35*p*p*p/3072*Math.sin(6*r));var t=q*e*(i+(1-f+g)*i*i*i/6+(5-18*f+f*f+72*g-58*c)*i*i*i*i*i/120)+5e5,u=q*(j+e*Math.tan(r)*(i*i/2+(5-f+9*g+4*g*g)*i*i*i*i/24+(61-58*f+f*f+600*g-330*c)*i*i*i*i*i*i/720));return 0>m&&(u+=1e7),{northing:Math.round(u),easting:Math.round(t),zoneNumber:l,zoneLetter:h(m)}}function g(a){var b=a.northing,c=a.easting,d=a.zoneLetter,f=a.zoneNumber;if(0>f||f>60)return null;var h,i,j,k,l,m,n,o,p,q,r=.9996,s=6378137,t=.00669438,u=(1-Math.sqrt(1-t))/(1+Math.sqrt(1-t)),v=c-5e5,w=b;"N">d&&(w-=1e7),o=6*(f-1)-180+3,h=t/(1-t),n=w/r,p=n/(s*(1-t/4-3*t*t/64-5*t*t*t/256)),q=p+(3*u/2-27*u*u*u/32)*Math.sin(2*p)+(21*u*u/16-55*u*u*u*u/32)*Math.sin(4*p)+151*u*u*u/96*Math.sin(6*p),i=s/Math.sqrt(1-t*Math.sin(q)*Math.sin(q)),j=Math.tan(q)*Math.tan(q),k=h*Math.cos(q)*Math.cos(q),l=s*(1-t)/Math.pow(1-t*Math.sin(q)*Math.sin(q),1.5),m=v/(i*r);var x=q-i*Math.tan(q)/l*(m*m/2-(5+3*j+10*k-4*k*k-9*h)*m*m*m*m/24+(61+90*j+298*k+45*j*j-252*h-3*k*k)*m*m*m*m*m*m/720);x=e(x);var y=(m-(1+2*j+k)*m*m*m/6+(5-2*k+28*j-3*k*k+8*h+24*j*j)*m*m*m*m*m/120)/Math.cos(q);y=o+e(y);var z;if(a.accuracy){var A=g({northing:a.northing+a.accuracy,easting:a.easting+a.accuracy,zoneLetter:a.zoneLetter,zoneNumber:a.zoneNumber});z={top:A.lat,right:A.lon,bottom:x,left:y}}else z={lat:x,lon:y};return z}function h(a){var b="Z";return 84>=a&&a>=72?b="X":72>a&&a>=64?b="W":64>a&&a>=56?b="V":56>a&&a>=48?b="U":48>a&&a>=40?b="T":40>a&&a>=32?b="S":32>a&&a>=24?b="R":24>a&&a>=16?b="Q":16>a&&a>=8?b="P":8>a&&a>=0?b="N":0>a&&a>=-8?b="M":-8>a&&a>=-16?b="L":-16>a&&a>=-24?b="K":-24>a&&a>=-32?b="J":-32>a&&a>=-40?b="H":-40>a&&a>=-48?b="G":-48>a&&a>=-56?b="F":-56>a&&a>=-64?b="E":-64>a&&a>=-72?b="D":-72>a&&a>=-80&&(b="C"),b}function i(a,b){var c=""+a.easting,d=""+a.northing;return a.zoneNumber+a.zoneLetter+j(a.easting,a.northing,a.zoneNumber)+c.substr(c.length-5,b)+d.substr(d.length-5,b)}function j(a,b,c){var d=k(c),e=Math.floor(a/1e5),f=Math.floor(b/1e5)%20;return l(e,f,d)}function k(a){var b=a%q;return 0===b&&(b=q),b}function l(a,b,c){var d=c-1,e=r.charCodeAt(d),f=s.charCodeAt(d),g=e+a-1,h=f+b,i=!1;g>x&&(g=g-x+t-1,i=!0),(g===u||u>e&&g>u||(g>u||u>e)&&i)&&g++,(g===v||v>e&&g>v||(g>v||v>e)&&i)&&(g++,g===u&&g++),g>x&&(g=g-x+t-1),h>w?(h=h-w+t-1,i=!0):i=!1,(h===u||u>f&&h>u||(h>u||u>f)&&i)&&h++,(h===v||v>f&&h>v||(h>v||v>f)&&i)&&(h++,h===u&&h++),h>w&&(h=h-w+t-1);var j=String.fromCharCode(g)+String.fromCharCode(h);return j}function m(a){if(a&&0===a.length)throw"MGRSPoint coverting from nothing";for(var b,c=a.length,d=null,e="",f=0;!/[A-Z]/.test(b=a.charAt(f));){if(f>=2)throw"MGRSPoint bad conversion from: "+a;e+=b,f++}var g=parseInt(e,10);if(0===f||f+3>c)throw"MGRSPoint bad conversion from: "+a;var h=a.charAt(f++);if("A">=h||"B"===h||"Y"===h||h>="Z"||"I"===h||"O"===h)throw"MGRSPoint zone letter "+h+" not handled: "+a;d=a.substring(f,f+=2);for(var i=k(g),j=n(d.charAt(0),i),l=o(d.charAt(1),i);l<p(h);)l+=2e6;var m=c-f;if(m%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+a;var q,r,s,t,u,v=m/2,w=0,x=0;return v>0&&(q=1e5/Math.pow(10,v),r=a.substring(f,f+v),w=parseFloat(r)*q,s=a.substring(f+v),x=parseFloat(s)*q),t=w+j,u=x+l,{easting:t,northing:u,zoneLetter:h,zoneNumber:g,accuracy:q}}function n(a,b){for(var c=r.charCodeAt(b-1),d=1e5,e=!1;c!==a.charCodeAt(0);){if(c++,c===u&&c++,c===v&&c++,c>x){if(e)throw"Bad character: "+a;c=t,e=!0}d+=1e5}return d}function o(a,b){if(a>"V")throw"MGRSPoint given invalid Northing "+a;for(var c=s.charCodeAt(b-1),d=0,e=!1;c!==a.charCodeAt(0);){if(c++,c===u&&c++,c===v&&c++,c>w){if(e)throw"Bad character: "+a;c=t,e=!0}d+=1e5}return d}function p(a){var b;switch(a){case"C":b=11e5;break;case"D":b=2e6;break;case"E":b=28e5;break;case"F":b=37e5;break;case"G":b=46e5;break;case"H":b=55e5;break;case"J":b=64e5;break;case"K":b=73e5;break;case"L":b=82e5;break;case"M":b=91e5;break;case"N":b=0;break;case"P":b=8e5;break;case"Q":b=17e5;break;case"R":b=26e5;break;case"S":b=35e5;break;case"T":b=44e5;break;case"U":b=53e5;break;case"V":b=62e5;break;case"W":b=7e6;break;case"X":b=79e5;break;default:b=-1}if(b>=0)return b;throw"Invalid zone letter: "+a}var q=6,r="AJSAJS",s="AFAFAF",t=65,u=73,v=79,w=86,x=90;c.forward=function(a,b){return b=b||5,i(f({lat:a[1],lon:a[0]}),b)},c.inverse=function(a){var b=g(m(a.toUpperCase()));return[b.left,b.bottom,b.right,b.top]},c.toPoint=function(a){var b=c.inverse(a);return[(b[2]+b[0])/2,(b[3]+b[1])/2]}},{}],69:[function(a,b,c){b.exports={name:"_mproj4_",version:"2.3.7-alpha",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/_mproj4_js/_mproj4_js.git"},author:"",license:"MIT",jam:{main:"dist/_mproj4_.js",include:["dist/_mproj4_.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~3.24.5","grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"0.0.0"}}},{}],"./includedProjections":[function(a,b,c){b.exports=a("Pk/iAZ")},{}],"Pk/iAZ":[function(a,b,c){var d=[a("./lib/projections/tmerc"),a("./lib/projections/utm"),a("./lib/projections/sterea"),a("./lib/projections/stere"),a("./lib/projections/somerc"),a("./lib/projections/omerc"),a("./lib/projections/lcc"),a("./lib/projections/krovak"),a("./lib/projections/cass"),a("./lib/projections/laea"),a("./lib/projections/aea"),a("./lib/projections/gnom"),a("./lib/projections/cea"),a("./lib/projections/eqc"),a("./lib/projections/poly"),a("./lib/projections/nzmg"),a("./lib/projections/mill"),a("./lib/projections/sinu"),a("./lib/projections/moll"),a("./lib/projections/eqdc"),a("./lib/projections/vandg"),a("./lib/projections/aeqd"),a("./lib/projections/geocent")];b.exports=function(_mproj4_){d.forEach(function(a){_mproj4_.Proj.projections.add(a)})}},{"./lib/projections/aea":40,"./lib/projections/aeqd":41,"./lib/projections/cass":42,"./lib/projections/cea":43,"./lib/projections/eqc":44,"./lib/projections/eqdc":45,"./lib/projections/geocent":47,"./lib/projections/gnom":48,"./lib/projections/krovak":49,"./lib/projections/laea":50,"./lib/projections/lcc":51,"./lib/projections/mill":54,"./lib/projections/moll":55,"./lib/projections/nzmg":56,"./lib/projections/omerc":57,"./lib/projections/poly":58,"./lib/projections/sinu":59,"./lib/projections/somerc":60,"./lib/projections/stere":61,"./lib/projections/sterea":62,"./lib/projections/tmerc":63,"./lib/projections/utm":64,"./lib/projections/vandg":65}]},{},[36])(36)});var GeographicLib={};GeographicLib.Constants={};GeographicLib.Math={};GeographicLib.Accumulator={};(function(c){c.WGS84={a:6378137,f:1/298.257223563};c.version={major:1,minor:45,patch:0};c.version_string="1.45"})(GeographicLib.Constants);
(function(m){m.digits=53;m.epsilon=Math.pow(.5,m.digits-1);m.degree=Math.PI/180;m.sq=function(x){return x*x};m.hypot=function(x,y){var a,b;x=Math.abs(x);y=Math.abs(y);a=Math.max(x,y);b=Math.min(x,y)/(a?a:1);return a*Math.sqrt(1+b*b)};m.cbrt=function(x){var y=Math.pow(Math.abs(x),1/3);return x<0?-y:y};m.log1p=function(x){var y=1+x,z=y-1;return z===0?x:x*Math.log(y)/z};m.atanh=function(x){var y=Math.abs(x);y=m.log1p(2*y/(1-y))/2;return x<0?-y:y};m.sum=function(u,v){var s=u+v,up=s-v,vpp=s-up,t;up-=u;
vpp-=v;t=-(up+vpp);return{s:s,t:t}};m.polyval=function(N,p,s,x){var y=N<0?0:p[s++];while(--N>=0)y=y*x+p[s++];return y};m.AngRound=function(x){var z=1/16,y=Math.abs(x);y=y<z?z-(z-y):y;return x<0?0-y:y};m.AngNormalize=function(x){x=x%360;return x<-180?x+360:x<180?x:x-360};m.LatFix=function(x){return Math.abs(x)>90?Number.NaN:x};m.AngDiff=function(x,y){var r=m.sum(m.AngNormalize(x),m.AngNormalize(-y)),d=-m.AngNormalize(r.s),t=r.t;return(d==180&&t<0?-180:d)-t};m.sincosd=function(x){var r,q,s,c,sinx,cosx;
r=x%360;q=Math.floor(r/90+.5);r-=90*q;r*=this.degree;s=Math.sin(r);c=Math.cos(r);switch(q&3){case 0:sinx=s;cosx=c;break;case 1:sinx=c;cosx=0-s;break;case 2:sinx=0-s;cosx=0-c;break;default:sinx=0-c;cosx=s;break}return{s:sinx,c:cosx}};m.atan2d=function(y,x){var q=0,t,ang;if(Math.abs(y)>Math.abs(x)){t=x;x=y;y=t;q=2}if(x<0){x=-x;++q}ang=Math.atan2(y,x)/this.degree;switch(q){case 1:ang=(y>0?180:-180)-ang;break;case 2:ang=90-ang;break;case 3:ang=-90+ang;break}return ang}})(GeographicLib.Math);
(function(a,m){a.Accumulator=function(y){this.Set(y)};a.Accumulator.prototype.Set=function(y){if(!y)y=0;if(y.constructor===a.Accumulator){this._s=y._s;this._t=y._t}else{this._s=y;this._t=0}};a.Accumulator.prototype.Add=function(y){var u=m.sum(y,this._t),v=m.sum(u.s,this._s);u=u.t;this._s=v.s;this._t=v.t;if(this._s===0)this._s=u;else this._t+=u};a.Accumulator.prototype.Sum=function(y){var b;if(!y)return this._s;else{b=new a.Accumulator(this);b.Add(y);return b._s}};a.Accumulator.prototype.Negate=function(){this._s*=
-1;this._t*=-1}})(GeographicLib.Accumulator,GeographicLib.Math);GeographicLib.DMS={};
(function(d){var lookup,zerofill,InternalDecode,NumMatch,hemispheres_="SNWE",signs_="-+",digits_="0123456789",dmsindicators_="D'\":",dmsindicatorsu_="\u00b0'\"",components_=["degrees","minutes","seconds"];lookup=function(s,c){return s.indexOf(c.toUpperCase())};zerofill=function(s,n){return String("0000").substr(0,Math.max(0,Math.min(4,n-s.length)))+s};d.NONE=0;d.LATITUDE=1;d.LONGITUDE=2;d.AZIMUTH=3;d.DEGREE=0;d.MINUTE=1;d.SECOND=2;d.Decode=function(dms){var dmsa=dms,end,v=0,i=0,mi,pi,vals,ind1=d.NONE,
ind2,p,pa,pb;dmsa=dmsa.replace(/\u00b0/g,"d").replace(/\u00ba/g,"d").replace(/\u2070/g,"d").replace(/\u02da/g,"d").replace(/\u2032/g,"'").replace(/\u00b4/g,"'").replace(/\u2019/g,"'").replace(/\u2033/g,'"').replace(/\u201d/g,'"').replace(/\u2212/g,"-").replace(/''/g,'"').trim();end=dmsa.length;for(p=0;p<end;p=pb,++i){pa=p;if(i===0&&lookup(hemispheres_,dmsa.charAt(pa))>=0)++pa;if(i>0||pa<end&&lookup(signs_,dmsa.charAt(pa))>=0)++pa;mi=dmsa.substr(pa,end-pa).indexOf("-");pi=dmsa.substr(pa,end-pa).indexOf("+");
if(mi<0)mi=end;else mi+=pa;if(pi<0)pi=end;else pi+=pa;pb=Math.min(mi,pi);vals=InternalDecode(dmsa.substr(p,pb-p));v+=vals.val;ind2=vals.ind;if(ind1==d.NONE)ind1=ind2;else if(!(ind2==d.NONE||ind1==ind2))throw new Error("Incompatible hemisphere specifies in "+dmsa.substr(0,pb));}if(i===0)throw new Error("Empty or incomplete DMS string "+dmsa);return{val:v,ind:ind1}};InternalDecode=function(dmsa){var vals={},errormsg="",sign,beg,end,ind1,k,ipieces,fpieces,npiece,icurrent,fcurrent,ncurrent,p,pointseen,
digcount,intcount,x;do{sign=1;beg=0;end=dmsa.length;ind1=d.NONE;k=-1;if(end>beg&&(k=lookup(hemispheres_,dmsa.charAt(beg)))>=0){ind1=k&2?d.LONGITUDE:d.LATITUDE;sign=k&1?1:-1;++beg}if(end>beg&&(k=lookup(hemispheres_,dmsa.charAt(end-1)))>=0)if(k>=0){if(ind1!==d.NONE){if(dmsa.charAt(beg-1).toUpperCase()===dmsa.charAt(end-1).toUpperCase())errormsg="Repeated hemisphere indicators "+dmsa.charAt(beg-1)+" in "+dmsa.substr(beg-1,end-beg+1);else errormsg="Contradictory hemisphere indicators "+dmsa.charAt(beg-
1)+" and "+dmsa.charAt(end-1)+" in "+dmsa.substr(beg-1,end-beg+1);break}ind1=k&2?d.LONGITUDE:d.LATITUDE;sign=k&1?1:-1;--end}if(end>beg&&(k=lookup(signs_,dmsa.charAt(beg)))>=0)if(k>=0){sign*=k?1:-1;++beg}if(end===beg){errormsg="Empty or incomplete DMS string "+dmsa;break}ipieces=[0,0,0];fpieces=[0,0,0];npiece=0;icurrent=0;fcurrent=0;ncurrent=0;p=beg;pointseen=false;digcount=0;intcount=0;while(p<end){x=dmsa.charAt(p++);if((k=lookup(digits_,x))>=0){++ncurrent;if(digcount>0)++digcount;else{icurrent=10*
icurrent+k;++intcount}}else if(x==="."){if(pointseen){errormsg="Multiple decimal points in "+dmsa.substr(beg,end-beg);break}pointseen=true;digcount=1}else if((k=lookup(dmsindicators_,x))>=0){if(k>=3){if(p===end){errormsg="Illegal for colon to appear at the end of "+dmsa.substr(beg,end-beg);break}k=npiece}if(k===npiece-1){errormsg="Repeated "+components_[k]+" component in "+dmsa.substr(beg,end-beg);break}else if(k<npiece){errormsg=components_[k]+" component follows "+components_[npiece-1]+" component in "+
dmsa.substr(beg,end-beg);break}if(ncurrent===0){errormsg="Missing numbers in "+components_[k]+" component of "+dmsa.substr(beg,end-beg);break}if(digcount>0){fcurrent=parseFloat(dmsa.substr(p-intcount-digcount-1,intcount+digcount));icurrent=0}ipieces[k]=icurrent;fpieces[k]=icurrent+fcurrent;if(p<end){npiece=k+1;icurrent=fcurrent=0;ncurrent=digcount=intcount=0}}else if(lookup(signs_,x)>=0){errormsg="Internal sign in DMS string "+dmsa.substr(beg,end-beg);break}else{errormsg="Illegal character "+x+" in DMS string "+
dmsa.substr(beg,end-beg);break}}if(errormsg.length)break;if(lookup(dmsindicators_,dmsa.charAt(p-1))<0){if(npiece>=3){errormsg="Extra text following seconds in DMS string "+dmsa.substr(beg,end-beg);break}if(ncurrent===0){errormsg="Missing numbers in trailing component of "+dmsa.substr(beg,end-beg);break}if(digcount>0){fcurrent=parseFloat(dmsa.substr(p-intcount-digcount,intcount+digcount));icurrent=0}ipieces[npiece]=icurrent;fpieces[npiece]=icurrent+fcurrent}if(pointseen&&digcount===0){errormsg="Decimal point in non-terminal component of "+
dmsa.substr(beg,end-beg);break}if(ipieces[1]>=60||fpieces[1]>60){errormsg="Minutes "+fpieces[1]+" not in range [0,60)";break}if(ipieces[2]>=60||fpieces[2]>60){errormsg="Seconds "+fpieces[2]+" not in range [0,60)";break}vals.ind=ind1;vals.val=sign*(fpieces[2]?(60*(60*fpieces[0]+fpieces[1])+fpieces[2])/3600:fpieces[1]?(60*fpieces[0]+fpieces[1])/60:fpieces[0]);return vals}while(false);vals.val=NumMatch(dmsa);if(vals.val===0)throw new Error(errormsg);else vals.ind=d.NONE;return vals};NumMatch=function(s){var t,
sign,p0,p1;if(s.length<3)return 0;t=s.toUpperCase().replace(/0+$/,"");sign=t.charAt(0)==="-"?-1:1;p0=t.charAt(0)==="-"||t.charAt(0)==="+"?1:0;p1=t.length-1;if(p1+1<p0+3)return 0;t=t.substr(p0,p1+1-p0);if(t==="NAN"||t==="1.#QNAN"||t==="1.#SNAN"||t==="1.#IND"||t==="1.#R")return Number.NaN;else if(t==="INF"||t==="1.#INF")return sign*Number.POSITIVE_INFINITY;return 0};d.DecodeLatLon=function(stra,strb,longfirst){var vals={},valsa=d.Decode(stra),valsb=d.Decode(strb),a=valsa.val,ia=valsa.ind,b=valsb.val,
ib=valsb.ind,lat,lon;if(!longfirst)longfirst=false;if(ia===d.NONE&&ib===d.NONE){ia=longfirst?d.LONGITUDE:d.LATITUDE;ib=longfirst?d.LATITUDE:d.LONGITUDE}else if(ia===d.NONE)ia=d.LATITUDE+d.LONGITUDE-ib;else if(ib===d.NONE)ib=d.LATITUDE+d.LONGITUDE-ia;if(ia===ib)throw new Error("Both "+stra+" and "+strb+" interpreted as "+(ia===d.LATITUDE?"latitudes":"longitudes"));lat=ia===d.LATITUDE?a:b;lon=ia===d.LATITUDE?b:a;if(Math.abs(lat)>90)throw new Error("Latitude "+lat+" not in [-90,90]");vals.lat=lat;vals.lon=
lon;return vals};d.DecodeAngle=function(angstr){var vals=d.Decode(angstr),ang=vals.val,ind=vals.ind;if(ind!==d.NONE)throw new Error("Arc angle "+angstr+" includes a hemisphere N/E/W/S");return ang};d.DecodeAzimuth=function(azistr){var vals=d.Decode(azistr),azi=vals.val,ind=vals.ind;if(ind===d.LATITUDE)throw new Error("Azimuth "+azistr+" has a latitude hemisphere N/S");return azi};d.Encode=function(angle,trailing,prec,ind){var scale=1,i,sign,idegree,fdegree,f,pieces,ip,fp,s;if(!ind)ind=d.NONE;if(!isFinite(angle))return angle<
0?String("-inf"):angle>0?String("inf"):String("nan");prec=Math.min(15-2*trailing,prec);for(i=0;i<trailing;++i)scale*=60;for(i=0;i<prec;++i)scale*=10;if(ind===d.AZIMUTH)angle-=Math.floor(angle/360)*360;sign=angle<0?-1:1;angle*=sign;idegree=Math.floor(angle);fdegree=(angle-idegree)*scale+.5;f=Math.floor(fdegree);fdegree=f==fdegree&&f&1?f-1:f;fdegree/=scale;fdegree=Math.floor((angle-idegree)*scale+.5)/scale;if(fdegree>=1){idegree+=1;fdegree-=1}pieces=[fdegree,0,0];for(i=1;i<=trailing;++i){ip=Math.floor(pieces[i-
1]);fp=pieces[i-1]-ip;pieces[i]=fp*60;pieces[i-1]=ip}pieces[0]+=idegree;s="";if(ind===d.NONE&&sign<0)s+="-";switch(trailing){case d.DEGREE:s+=zerofill(pieces[0].toFixed(prec),ind===d.NONE?0:1+Math.min(ind,2)+prec+(prec?1:0))+dmsindicatorsu_.charAt(0);break;default:s+=zerofill(pieces[0].toFixed(0),ind===d.NONE?0:1+Math.min(ind,2))+dmsindicatorsu_.charAt(0);switch(trailing){case d.MINUTE:s+=zerofill(pieces[1].toFixed(prec),2+prec+(prec?1:0))+dmsindicatorsu_.charAt(1);break;case d.SECOND:s+=zerofill(pieces[1].toFixed(0),
2)+dmsindicatorsu_.charAt(1);s+=zerofill(pieces[2].toFixed(prec),2+prec+(prec?1:0))+dmsindicatorsu_.charAt(2);break;default:break}}if(ind!==d.NONE&&ind!==d.AZIMUTH)s+=hemispheres_.charAt((ind===d.LATITUDE?0:2)+(sign<0?0:1));return s}})(GeographicLib.DMS);GeographicLib.Geodesic={};GeographicLib.GeodesicLine={};GeographicLib.PolygonArea={};
(function(g,l,p,m,c){var GEOGRAPHICLIB_GEODESIC_ORDER=6,nA1_=GEOGRAPHICLIB_GEODESIC_ORDER,nA2_=GEOGRAPHICLIB_GEODESIC_ORDER,nA3_=GEOGRAPHICLIB_GEODESIC_ORDER,nA3x_=nA3_,nC3x_,nC4x_,maxit1_=20,maxit2_=maxit1_+m.digits+10,tol0_=m.epsilon,tol1_=200*tol0_,tol2_=Math.sqrt(tol0_),tolb_=tol0_*tol1_,xthresh_=1E3*tol2_,CAP_NONE=0,CAP_ALL=31,CAP_MASK=CAP_ALL,OUT_ALL=32640,Astroid,A1m1f_coeff,C1f_coeff,C1pf_coeff,A2m1f_coeff,C2f_coeff,A3_coeff,C3_coeff,C4_coeff;g.tiny_=Math.sqrt(Number.MIN_VALUE);g.nC1_=GEOGRAPHICLIB_GEODESIC_ORDER;
g.nC1p_=GEOGRAPHICLIB_GEODESIC_ORDER;g.nC2_=GEOGRAPHICLIB_GEODESIC_ORDER;g.nC3_=GEOGRAPHICLIB_GEODESIC_ORDER;g.nC4_=GEOGRAPHICLIB_GEODESIC_ORDER;nC3x_=g.nC3_*(g.nC3_-1)/2;nC4x_=g.nC4_*(g.nC4_+1)/2,g.CAP_C1=1<<0;g.CAP_C1p=1<<1;g.CAP_C2=1<<2;g.CAP_C3=1<<3;g.CAP_C4=1<<4;g.NONE=0;g.LATITUDE=1<<7|CAP_NONE;g.LONGITUDE=1<<8|g.CAP_C3;g.AZIMUTH=1<<9|CAP_NONE;g.DISTANCE=1<<10|g.CAP_C1;g.STANDARD=g.LATITUDE|g.LONGITUDE|g.AZIMUTH|g.DISTANCE;g.DISTANCE_IN=1<<11|g.CAP_C1|g.CAP_C1p;g.REDUCEDLENGTH=1<<12|g.CAP_C1|
g.CAP_C2;g.GEODESICSCALE=1<<13|g.CAP_C1|g.CAP_C2;g.AREA=1<<14|g.CAP_C4;g.ALL=OUT_ALL|CAP_ALL;g.LONG_UNROLL=1<<15;g.OUT_MASK=OUT_ALL|g.LONG_UNROLL;g.SinCosSeries=function(sinp,sinx,cosx,c){var k=c.length,n=k-(sinp?1:0),ar=2*(cosx-sinx)*(cosx+sinx),y0=n&1?c[--k]:0,y1=0;n=Math.floor(n/2);while(n--){y1=ar*y0-y1+c[--k];y0=ar*y1-y0+c[--k]}return sinp?2*sinx*cosx*y0:cosx*(y0-y1)};Astroid=function(x,y){var k,p=m.sq(x),q=m.sq(y),r=(p+q-1)/6,S,r2,r3,disc,u,T3,T,ang,v,uv,w;if(!(q===0&&r<=0)){S=p*q/4;r2=m.sq(r);
r3=r*r2;disc=S*(S+2*r3);u=r;if(disc>=0){T3=S+r3;T3+=T3<0?-Math.sqrt(disc):Math.sqrt(disc);T=m.cbrt(T3);u+=T+(T!==0?r2/T:0)}else{ang=Math.atan2(Math.sqrt(-disc),-(S+r3));u+=2*r*Math.cos(ang/3)}v=Math.sqrt(m.sq(u)+q);uv=u<0?q/(v-u):u+v;w=(uv-q)/(2*v);k=uv/(Math.sqrt(uv+m.sq(w))+w)}else k=0;return k};A1m1f_coeff=[+1,4,64,0,256];g.A1m1f=function(eps){var p=Math.floor(nA1_/2),t=m.polyval(p,A1m1f_coeff,0,m.sq(eps))/A1m1f_coeff[p+1];return(t+eps)/(1-eps)};C1f_coeff=[-1,6,-16,32,-9,64,-128,2048,+9,-16,768,
+3,-5,512,-7,1280,-7,2048];g.C1f=function(eps,c){var eps2=m.sq(eps),d=eps,o=0,l,p;for(l=1;l<=g.nC1_;++l){p=Math.floor((g.nC1_-l)/2);c[l]=d*m.polyval(p,C1f_coeff,o,eps2)/C1f_coeff[o+p+1];o+=p+2;d*=eps}};C1pf_coeff=[+205,-432,768,1536,+4005,-4736,3840,12288,-225,116,384,-7173,2695,7680,+3467,7680,+38081,61440];g.C1pf=function(eps,c){var eps2=m.sq(eps),d=eps,o=0,l,p;for(l=1;l<=g.nC1p_;++l){p=Math.floor((g.nC1p_-l)/2);c[l]=d*m.polyval(p,C1pf_coeff,o,eps2)/C1pf_coeff[o+p+1];o+=p+2;d*=eps}};A2m1f_coeff=
[-11,-28,-192,0,256];g.A2m1f=function(eps){var p=Math.floor(nA2_/2),t=m.polyval(p,A2m1f_coeff,0,m.sq(eps))/A2m1f_coeff[p+1];return(t-eps)/(1+eps)};C2f_coeff=[+1,2,16,32,+35,64,384,2048,+15,80,768,+7,35,512,+63,1280,+77,2048];g.C2f=function(eps,c){var eps2=m.sq(eps),d=eps,o=0,l,p;for(l=1;l<=g.nC2_;++l){p=Math.floor((g.nC2_-l)/2);c[l]=d*m.polyval(p,C2f_coeff,o,eps2)/C2f_coeff[o+p+1];o+=p+2;d*=eps}};g.Geodesic=function(a,f){this.a=a;this.f=f;this._f1=1-this.f;this._e2=this.f*(2-this.f);this._ep2=this._e2/
m.sq(this._f1);this._n=this.f/(2-this.f);this._b=this.a*this._f1;this._c2=(m.sq(this.a)+m.sq(this._b)*(this._e2===0?1:(this._e2>0?m.atanh(Math.sqrt(this._e2)):Math.atan(Math.sqrt(-this._e2)))/Math.sqrt(Math.abs(this._e2))))/2;this._etol2=.1*tol2_/Math.sqrt(Math.max(.001,Math.abs(this.f))*Math.min(1,1-this.f/2)/2);if(!(isFinite(this.a)&&this.a>0))throw new Error("Major radius is not positive");if(!(isFinite(this._b)&&this._b>0))throw new Error("Minor radius is not positive");this._A3x=new Array(nA3x_);
this._C3x=new Array(nC3x_);this._C4x=new Array(nC4x_);this.A3coeff();this.C3coeff();this.C4coeff()};A3_coeff=[-3,128,-2,-3,64,-1,-3,-1,16,+3,-1,-2,8,+1,-1,2,+1,1];g.Geodesic.prototype.A3coeff=function(){var o=0,k=0,j,p;for(j=nA3_-1;j>=0;--j){p=Math.min(nA3_-j-1,j);this._A3x[k++]=m.polyval(p,A3_coeff,o,this._n)/A3_coeff[o+p+1];o+=p+2}};C3_coeff=[+3,128,+2,5,128,-1,3,3,64,-1,0,1,8,-1,1,4,+5,256,+1,3,128,-3,-2,3,64,+1,-3,2,32,+7,512,-10,9,384,+5,-9,5,192,+7,512,-14,7,512,+21,2560];g.Geodesic.prototype.C3coeff=
function(){var o=0,k=0,l,j,p;for(l=1;l<g.nC3_;++l)for(j=g.nC3_-1;j>=l;--j){p=Math.min(g.nC3_-j-1,j);this._C3x[k++]=m.polyval(p,C3_coeff,o,this._n)/C3_coeff[o+p+1];o+=p+2}};C4_coeff=[+97,15015,+1088,156,45045,-224,-4784,1573,45045,-10656,14144,-4576,-858,45045,+64,624,-4576,6864,-3003,15015,+100,208,572,3432,-12012,30030,45045,+1,9009,-2944,468,135135,+5792,1040,-1287,135135,+5952,-11648,9152,-2574,135135,-64,-624,4576,-6864,3003,135135,+8,10725,+1856,-936,225225,-8448,4992,-1144,225225,-1440,4160,
-4576,1716,225225,-136,63063,+1024,-208,105105,+3584,-3328,1144,315315,-128,135135,-2560,832,405405,+128,99099];g.Geodesic.prototype.C4coeff=function(){var o=0,k=0,l,j,p;for(l=0;l<g.nC4_;++l)for(j=g.nC4_-1;j>=l;--j){p=g.nC4_-j-1;this._C4x[k++]=m.polyval(p,C4_coeff,o,this._n)/C4_coeff[o+p+1];o+=p+2}};g.Geodesic.prototype.A3f=function(eps){return m.polyval(nA3x_-1,this._A3x,0,eps)};g.Geodesic.prototype.C3f=function(eps,c){var mult=1,o=0,l,p;for(l=1;l<g.nC3_;++l){p=g.nC3_-l-1;mult*=eps;c[l]=mult*m.polyval(p,
this._C3x,o,eps);o+=p+1}};g.Geodesic.prototype.C4f=function(eps,c){var mult=1,o=0,l,p;for(l=0;l<g.nC4_;++l){p=g.nC4_-l-1;c[l]=mult*m.polyval(p,this._C4x,o,eps);o+=p+1;mult*=eps}};g.Geodesic.prototype.Lengths=function(eps,sig12,ssig1,csig1,dn1,ssig2,csig2,dn2,cbet1,cbet2,outmask,C1a,C2a){outmask&=g.OUT_MASK;var vals={},m0x=0,J12=0,A1=0,A2=0,B1,B2,l,csig12,t;if(outmask&(g.DISTANCE|g.REDUCEDLENGTH|g.GEODESICSCALE)){A1=g.A1m1f(eps);g.C1f(eps,C1a);if(outmask&(g.REDUCEDLENGTH|g.GEODESICSCALE)){A2=g.A2m1f(eps);
g.C2f(eps,C2a);m0x=A1-A2;A2=1+A2}A1=1+A1}if(outmask&g.DISTANCE){B1=g.SinCosSeries(true,ssig2,csig2,C1a)-g.SinCosSeries(true,ssig1,csig1,C1a);vals.s12b=A1*(sig12+B1);if(outmask&(g.REDUCEDLENGTH|g.GEODESICSCALE)){B2=g.SinCosSeries(true,ssig2,csig2,C2a)-g.SinCosSeries(true,ssig1,csig1,C2a);J12=m0x*sig12+(A1*B1-A2*B2)}}else if(outmask&(g.REDUCEDLENGTH|g.GEODESICSCALE)){for(l=1;l<=g.nC2_;++l)C2a[l]=A1*C1a[l]-A2*C2a[l];J12=m0x*sig12+(g.SinCosSeries(true,ssig2,csig2,C2a)-g.SinCosSeries(true,ssig1,csig1,
C2a))}if(outmask&g.REDUCEDLENGTH){vals.m0=m0x;vals.m12b=dn2*(csig1*ssig2)-dn1*(ssig1*csig2)-csig1*csig2*J12}if(outmask&g.GEODESICSCALE){csig12=csig1*csig2+ssig1*ssig2;t=this._ep2*(cbet1-cbet2)*(cbet1+cbet2)/(dn1+dn2);vals.M12=csig12+(t*ssig2-csig2*J12)*ssig1/dn1;vals.M21=csig12-(t*ssig1-csig1*J12)*ssig2/dn2}return vals};g.Geodesic.prototype.InverseStart=function(sbet1,cbet1,dn1,sbet2,cbet2,dn2,lam12,C1a,C2a){var vals={},sbet12=sbet2*cbet1-cbet2*sbet1,cbet12=cbet2*cbet1+sbet2*sbet1,sbet12a,shortline,
omg12,sbetm2,somg12,comg12,t,ssig12,csig12,x,y,lamscale,betscale,k2,eps,cbet12a,bet12a,m12b,m0,nvals,k,omg12a;vals.sig12=-1;sbet12a=sbet2*cbet1;sbet12a+=cbet2*sbet1;shortline=cbet12>=0&&sbet12<.5&&cbet2*lam12<.5;omg12=lam12;if(shortline){sbetm2=m.sq(sbet1+sbet2);sbetm2/=sbetm2+m.sq(cbet1+cbet2);vals.dnm=Math.sqrt(1+this._ep2*sbetm2);omg12/=this._f1*vals.dnm}somg12=Math.sin(omg12);comg12=Math.cos(omg12);vals.salp1=cbet2*somg12;vals.calp1=comg12>=0?sbet12+cbet2*sbet1*m.sq(somg12)/(1+comg12):sbet12a-
cbet2*sbet1*m.sq(somg12)/(1-comg12);ssig12=m.hypot(vals.salp1,vals.calp1);csig12=sbet1*sbet2+cbet1*cbet2*comg12;if(shortline&&ssig12<this._etol2){vals.salp2=cbet1*somg12;vals.calp2=sbet12-cbet1*sbet2*(comg12>=0?m.sq(somg12)/(1+comg12):1-comg12);t=m.hypot(vals.salp2,vals.calp2);vals.salp2/=t;vals.calp2/=t;vals.sig12=Math.atan2(ssig12,csig12)}else if(Math.abs(this._n)>.1||csig12>=0||ssig12>=6*Math.abs(this._n)*Math.PI*m.sq(cbet1));else{if(this.f>=0){k2=m.sq(sbet1)*this._ep2;eps=k2/(2*(1+Math.sqrt(1+
k2))+k2);lamscale=this.f*cbet1*this.A3f(eps)*Math.PI;betscale=lamscale*cbet1;x=(lam12-Math.PI)/lamscale;y=sbet12a/betscale}else{cbet12a=cbet2*cbet1-sbet2*sbet1;bet12a=Math.atan2(sbet12a,cbet12a);nvals=this.Lengths(this._n,Math.PI+bet12a,sbet1,-cbet1,dn1,sbet2,cbet2,dn2,cbet1,cbet2,g.REDUCEDLENGTH,C1a,C2a);m12b=nvals.m12b;m0=nvals.m0;x=-1+m12b/(cbet1*cbet2*m0*Math.PI);betscale=x<-.01?sbet12a/x:-this.f*m.sq(cbet1)*Math.PI;lamscale=betscale/cbet1;y=(lam12-Math.PI)/lamscale}if(y>-tol1_&&x>-1-xthresh_)if(this.f>=
0){vals.salp1=Math.min(1,-x);vals.calp1=-Math.sqrt(1-m.sq(vals.salp1))}else{vals.calp1=Math.max(x>-tol1_?0:-1,x);vals.salp1=Math.sqrt(1-m.sq(vals.calp1))}else{k=Astroid(x,y);omg12a=lamscale*(this.f>=0?-x*k/(1+k):-y*(1+k)/k);somg12=Math.sin(omg12a);comg12=-Math.cos(omg12a);vals.salp1=cbet2*somg12;vals.calp1=sbet12a-cbet2*sbet1*m.sq(somg12)/(1-comg12)}}if(!(vals.salp1<=0)){t=m.hypot(vals.salp1,vals.calp1);vals.salp1/=t;vals.calp1/=t}else{vals.salp1=1;vals.calp1=0}return vals};g.Geodesic.prototype.Lambda12=
function(sbet1,cbet1,dn1,sbet2,cbet2,dn2,salp1,calp1,diffp,C1a,C2a,C3a){var vals={},t,salp0,calp0,somg1,comg1,somg2,comg2,omg12,B312,h0,k2,nvals;if(sbet1===0&&calp1===0)calp1=-g.tiny_;salp0=salp1*cbet1;calp0=m.hypot(calp1,salp1*sbet1);vals.ssig1=sbet1;somg1=salp0*sbet1;vals.csig1=comg1=calp1*cbet1;t=m.hypot(vals.ssig1,vals.csig1);vals.ssig1/=t;vals.csig1/=t;vals.salp2=cbet2!==cbet1?salp0/cbet2:salp1;vals.calp2=cbet2!==cbet1||Math.abs(sbet2)!==-sbet1?Math.sqrt(m.sq(calp1*cbet1)+(cbet1<-sbet1?(cbet2-
cbet1)*(cbet1+cbet2):(sbet1-sbet2)*(sbet1+sbet2)))/cbet2:Math.abs(calp1);vals.ssig2=sbet2;somg2=salp0*sbet2;vals.csig2=comg2=vals.calp2*cbet2;t=m.hypot(vals.ssig2,vals.csig2);vals.ssig2/=t;vals.csig2/=t;vals.sig12=Math.atan2(Math.max(0,vals.csig1*vals.ssig2-vals.ssig1*vals.csig2),vals.csig1*vals.csig2+vals.ssig1*vals.ssig2);omg12=Math.atan2(Math.max(0,comg1*somg2-somg1*comg2),comg1*comg2+somg1*somg2);k2=m.sq(calp0)*this._ep2;vals.eps=k2/(2*(1+Math.sqrt(1+k2))+k2);this.C3f(vals.eps,C3a);B312=g.SinCosSeries(true,
vals.ssig2,vals.csig2,C3a)-g.SinCosSeries(true,vals.ssig1,vals.csig1,C3a);h0=-this.f*this.A3f(vals.eps);vals.domg12=salp0*h0*(vals.sig12+B312);vals.lam12=omg12+vals.domg12;if(diffp)if(vals.calp2===0)vals.dlam12=-2*this._f1*dn1/sbet1;else{nvals=this.Lengths(vals.eps,vals.sig12,vals.ssig1,vals.csig1,dn1,vals.ssig2,vals.csig2,dn2,cbet1,cbet2,g.REDUCEDLENGTH,C1a,C2a);vals.dlam12=nvals.m12b;vals.dlam12*=this._f1/(vals.calp2*cbet2)}return vals};g.Geodesic.prototype.Inverse=function(lat1,lon1,lat2,lon2,
outmask){var vals={},lon12,lonsign,t,swapp,latsign,sbet1,cbet1,sbet2,cbet2,s12x,m12x,dn1,dn2,lam12,slam12,clam12,sig12,calp1,salp1,calp2,salp2,C1a,C2a,C3a,meridian,nvals,ssig1,csig1,ssig2,csig2,eps,omg12,dnm,numit,salp1a,calp1a,salp1b,calp1b,tripn,tripb,v,dv,dalp1,sdalp1,cdalp1,nsalp1,lengthmask,salp0,calp0,alp12,k2,A4,C4a,B41,B42,somg12,domg12,dbet1,dbet2,salp12,calp12;if(!outmask)outmask=g.STANDARD;if(outmask==g.LONG_UNROLL)outmask|=g.STANDARD;outmask&=g.OUT_MASK;vals.lat1=lat1=m.LatFix(lat1);vals.lat2=
lat2=m.LatFix(lat2);lon12=m.AngDiff(lon1,lon2);if(outmask&g.LONG_UNROLL){vals.lon1=lon1;vals.lon2=lon1+lon12}else{vals.lon1=m.AngNormalize(lon1);vals.lon2=m.AngNormalize(lon2)}lon12=m.AngRound(lon12);lonsign=lon12>=0?1:-1;lon12*=lonsign;lat1=m.AngRound(lat1);lat2=m.AngRound(lat2);swapp=Math.abs(lat1)<Math.abs(lat2)?-1:1;if(swapp<0){lonsign*=-1;t=lat1;lat1=lat2;lat2=t}latsign=lat1<0?1:-1;lat1*=latsign;lat2*=latsign;t=m.sincosd(lat1);sbet1=this._f1*t.s;cbet1=t.c;t=m.hypot(sbet1,cbet1);sbet1/=t;cbet1/=
t;cbet1=Math.max(g.tiny_,cbet1);t=m.sincosd(lat2);sbet2=this._f1*t.s;cbet2=t.c;t=m.hypot(sbet2,cbet2);sbet2/=t;cbet2/=t;cbet2=Math.max(g.tiny_,cbet2);if(cbet1<-sbet1){if(cbet2===cbet1)sbet2=sbet2<0?sbet1:-sbet1}else if(Math.abs(sbet2)===-sbet1)cbet2=cbet1;dn1=Math.sqrt(1+this._ep2*m.sq(sbet1));dn2=Math.sqrt(1+this._ep2*m.sq(sbet2));lam12=lon12*m.degree;t=m.sincosd(lon12);slam12=t.s;clam12=t.c;C1a=new Array(g.nC1_+1);C2a=new Array(g.nC2_+1);C3a=new Array(g.nC3_);meridian=lat1===-90||slam12===0;if(meridian){calp1=
clam12;salp1=slam12;calp2=1;salp2=0;ssig1=sbet1;csig1=calp1*cbet1;ssig2=sbet2;csig2=calp2*cbet2;sig12=Math.atan2(Math.max(0,csig1*ssig2-ssig1*csig2),csig1*csig2+ssig1*ssig2);nvals=this.Lengths(this._n,sig12,ssig1,csig1,dn1,ssig2,csig2,dn2,cbet1,cbet2,outmask|g.DISTANCE|g.REDUCEDLENGTH,C1a,C2a);s12x=nvals.s12b;m12x=nvals.m12b;if((outmask&g.GEODESICSCALE)!==0){vals.M12=nvals.M12;vals.M21=nvals.M21}if(sig12<1||m12x>=0){if(sig12<3*g.tiny_)sig12=m12x=s12x=0;m12x*=this._b;s12x*=this._b;vals.a12=sig12/m.degree}else meridian=
false}if(!meridian&&sbet1===0&&(this.f<=0||lam12<=Math.PI-this.f*Math.PI)){calp1=calp2=0;salp1=salp2=1;s12x=this.a*lam12;sig12=omg12=lam12/this._f1;m12x=this._b*Math.sin(sig12);if(outmask&g.GEODESICSCALE)vals.M12=vals.M21=Math.cos(sig12);vals.a12=lon12/this._f1}else if(!meridian){nvals=this.InverseStart(sbet1,cbet1,dn1,sbet2,cbet2,dn2,lam12,C1a,C2a);sig12=nvals.sig12;salp1=nvals.salp1;calp1=nvals.calp1;if(sig12>=0){salp2=nvals.salp2;calp2=nvals.calp2;dnm=nvals.dnm;s12x=sig12*this._b*dnm;m12x=m.sq(dnm)*
this._b*Math.sin(sig12/dnm);if(outmask&g.GEODESICSCALE)vals.M12=vals.M21=Math.cos(sig12/dnm);vals.a12=sig12/m.degree;omg12=lam12/(this._f1*dnm)}else{numit=0;salp1a=g.tiny_;calp1a=1;salp1b=g.tiny_;calp1b=-1;for(tripn=false,tripb=false;numit<maxit2_;++numit){nvals=this.Lambda12(sbet1,cbet1,dn1,sbet2,cbet2,dn2,salp1,calp1,numit<maxit1_,C1a,C2a,C3a);v=nvals.lam12-lam12;salp2=nvals.salp2;calp2=nvals.calp2;sig12=nvals.sig12;ssig1=nvals.ssig1;csig1=nvals.csig1;ssig2=nvals.ssig2;csig2=nvals.csig2;eps=nvals.eps;
omg12=nvals.domg12;dv=nvals.dlam12;if(tripb||!(Math.abs(v)>=(tripn?8:2)*tol0_))break;if(v>0&&(numit<maxit1_||calp1/salp1>calp1b/salp1b)){salp1b=salp1;calp1b=calp1}else if(v<0&&(numit<maxit1_||calp1/salp1<calp1a/salp1a)){salp1a=salp1;calp1a=calp1}if(numit<maxit1_&&dv>0){dalp1=-v/dv;sdalp1=Math.sin(dalp1);cdalp1=Math.cos(dalp1);nsalp1=salp1*cdalp1+calp1*sdalp1;if(nsalp1>0&&Math.abs(dalp1)<Math.PI){calp1=calp1*cdalp1-salp1*sdalp1;salp1=nsalp1;t=m.hypot(salp1,calp1);salp1/=t;calp1/=t;tripn=Math.abs(v)<=
16*tol0_;continue}}salp1=(salp1a+salp1b)/2;calp1=(calp1a+calp1b)/2;t=m.hypot(salp1,calp1);salp1/=t;calp1/=t;tripn=false;tripb=Math.abs(salp1a-salp1)+(calp1a-calp1)<tolb_||Math.abs(salp1-salp1b)+(calp1-calp1b)<tolb_}lengthmask=outmask|(outmask&(g.REDUCEDLENGTH|g.GEODESICSCALE)?g.DISTANCE:g.NONE);nvals=this.Lengths(eps,sig12,ssig1,csig1,dn1,ssig2,csig2,dn2,cbet1,cbet2,lengthmask,C1a,C2a);s12x=nvals.s12b;m12x=nvals.m12b;if((outmask&g.GEODESICSCALE)!==0){vals.M12=nvals.M12;vals.M21=nvals.M21}m12x*=this._b;
s12x*=this._b;vals.a12=sig12/m.degree;omg12=lam12-omg12}}if(outmask&g.DISTANCE)vals.s12=0+s12x;if(outmask&g.REDUCEDLENGTH)vals.m12=0+m12x;if(outmask&g.AREA){salp0=salp1*cbet1;calp0=m.hypot(calp1,salp1*sbet1);if(calp0!==0&&salp0!==0){ssig1=sbet1;csig1=calp1*cbet1;ssig2=sbet2;csig2=calp2*cbet2;k2=m.sq(calp0)*this._ep2;eps=k2/(2*(1+Math.sqrt(1+k2))+k2);A4=m.sq(this.a)*calp0*salp0*this._e2;t=m.hypot(ssig1,csig1);ssig1/=t;csig1/=t;t=m.hypot(ssig2,csig2);ssig2/=t;csig2/=t;C4a=new Array(g.nC4_);this.C4f(eps,
C4a);B41=g.SinCosSeries(false,ssig1,csig1,C4a);B42=g.SinCosSeries(false,ssig2,csig2,C4a);vals.S12=A4*(B42-B41)}else vals.S12=0;if(!meridian&&omg12<.75*Math.PI&&sbet2-sbet1<1.75){somg12=Math.sin(omg12);domg12=1+Math.cos(omg12);dbet1=1+cbet1;dbet2=1+cbet2;alp12=2*Math.atan2(somg12*(sbet1*dbet2+sbet2*dbet1),domg12*(sbet1*sbet2+dbet1*dbet2))}else{salp12=salp2*calp1-calp2*salp1;calp12=calp2*calp1+salp2*salp1;if(salp12===0&&calp12<0){salp12=g.tiny_*calp1;calp12=-1}alp12=Math.atan2(salp12,calp12)}vals.S12+=
this._c2*alp12;vals.S12*=swapp*lonsign*latsign;vals.S12+=0}if(swapp<0){t=salp1;salp1=salp2;salp2=t;t=calp1;calp1=calp2;calp2=t;if(outmask&g.GEODESICSCALE){t=vals.M12;vals.M12=vals.M21;vals.M21=t}}salp1*=swapp*lonsign;calp1*=swapp*latsign;salp2*=swapp*lonsign;calp2*=swapp*latsign;if(outmask&g.AZIMUTH){vals.azi1=m.atan2d(salp1,calp1);vals.azi2=m.atan2d(salp2,calp2)}return vals};g.Geodesic.prototype.GenDirect=function(lat1,lon1,azi1,arcmode,s12_a12,outmask){var line;if(!outmask)outmask=g.STANDARD;else if(outmask==
g.LONG_UNROLL)outmask|=g.STANDARD;line=new l.GeodesicLine(this,lat1,lon1,azi1,outmask|(arcmode?g.NONE:g.DISTANCE_IN));return line.GenPosition(arcmode,s12_a12,outmask)};g.Geodesic.prototype.Direct=function(lat1,lon1,azi1,s12,outmask){return this.GenDirect(lat1,lon1,azi1,false,s12,outmask)};g.Geodesic.prototype.ArcDirect=function(lat1,lon1,azi1,a12,outmask){return this.GenDirect(lat1,lon1,azi1,true,a12,outmask)};g.Geodesic.prototype.Line=function(lat1,lon1,azi1,caps){return new l.GeodesicLine(this,
lat1,lon1,azi1,caps)};g.Geodesic.prototype.Polygon=function(polyline){return new p.PolygonArea(this,polyline)};g.WGS84=new g.Geodesic(c.WGS84.a,c.WGS84.f)})(GeographicLib.Geodesic,GeographicLib.GeodesicLine,GeographicLib.PolygonArea,GeographicLib.Math,GeographicLib.Constants);
(function(g,l,m){l.GeodesicLine=function(geod,lat1,lon1,azi1,caps){var t,cbet1,sbet1,eps,s,c;if(!caps)caps=g.STANDARD|g.DISTANCE_IN;this.a=geod.a;this.f=geod.f;this._b=geod._b;this._c2=geod._c2;this._f1=geod._f1;this._caps=(!caps?g.ALL:caps|g.LATITUDE|g.AZIMUTH)|g.LONG_UNROLL;this.lat1=m.LatFix(lat1);this.lon1=lon1;this.azi1=m.AngNormalize(azi1);t=m.sincosd(m.AngRound(this.azi1));this._salp1=t.s;this._calp1=t.c;t=m.sincosd(m.AngRound(this.lat1));sbet1=this._f1*t.s;cbet1=t.c;t=m.hypot(sbet1,cbet1);
sbet1/=t;cbet1/=t;cbet1=Math.max(g.tiny_,cbet1);this._dn1=Math.sqrt(1+geod._ep2*m.sq(sbet1));this._salp0=this._salp1*cbet1;this._calp0=m.hypot(this._calp1,this._salp1*sbet1);this._ssig1=sbet1;this._somg1=this._salp0*sbet1;this._csig1=this._comg1=sbet1!==0||this._calp1!==0?cbet1*this._calp1:1;t=m.hypot(this._ssig1,this._csig1);this._ssig1/=t;this._csig1/=t;this._k2=m.sq(this._calp0)*geod._ep2;eps=this._k2/(2*(1+Math.sqrt(1+this._k2))+this._k2);if(this._caps&g.CAP_C1){this._A1m1=g.A1m1f(eps);this._C1a=
new Array(g.nC1_+1);g.C1f(eps,this._C1a);this._B11=g.SinCosSeries(true,this._ssig1,this._csig1,this._C1a);s=Math.sin(this._B11);c=Math.cos(this._B11);this._stau1=this._ssig1*c+this._csig1*s;this._ctau1=this._csig1*c-this._ssig1*s}if(this._caps&g.CAP_C1p){this._C1pa=new Array(g.nC1p_+1);g.C1pf(eps,this._C1pa)}if(this._caps&g.CAP_C2){this._A2m1=g.A2m1f(eps);this._C2a=new Array(g.nC2_+1);g.C2f(eps,this._C2a);this._B21=g.SinCosSeries(true,this._ssig1,this._csig1,this._C2a)}if(this._caps&g.CAP_C3){this._C3a=
new Array(g.nC3_);geod.C3f(eps,this._C3a);this._A3c=-this.f*this._salp0*geod.A3f(eps);this._B31=g.SinCosSeries(true,this._ssig1,this._csig1,this._C3a)}if(this._caps&g.CAP_C4){this._C4a=new Array(g.nC4_);geod.C4f(eps,this._C4a);this._A4=m.sq(this.a)*this._calp0*this._salp0*geod._e2;this._B41=g.SinCosSeries(false,this._ssig1,this._csig1,this._C4a)}};l.GeodesicLine.prototype.GenPosition=function(arcmode,s12_a12,outmask){var vals={},sig12,ssig12,csig12,B12,AB1,ssig2,csig2,tau12,s,c,serr,omg12,lam12,lon12,
E,sbet2,cbet2,somg2,comg2,salp2,calp2,dn2,B22,AB2,J12,t,B42,salp12,calp12;if(!outmask)outmask=g.STANDARD;else if(outmask==g.LONG_UNROLL)outmask|=g.STANDARD;outmask&=this._caps&g.OUT_MASK;vals.lat1=this.lat1;vals.azi1=this.azi1;vals.lon1=outmask&g.LONG_UNROLL?this.lon1:m.AngNormalize(this.lon1);if(arcmode)vals.a12=s12_a12;else vals.s12=s12_a12;if(!(arcmode||this._caps&g.DISTANCE_IN&g.OUT_MASK)){vals.a12=Number.NaN;return vals}B12=0;AB1=0;if(arcmode){sig12=s12_a12*m.degree;t=m.sincosd(s12_a12);ssig12=
t.s;csig12=t.c}else{tau12=s12_a12/(this._b*(1+this._A1m1));s=Math.sin(tau12);c=Math.cos(tau12);B12=-g.SinCosSeries(true,this._stau1*c+this._ctau1*s,this._ctau1*c-this._stau1*s,this._C1pa);sig12=tau12-(B12-this._B11);ssig12=Math.sin(sig12);csig12=Math.cos(sig12);if(Math.abs(this.f)>.01){ssig2=this._ssig1*csig12+this._csig1*ssig12;csig2=this._csig1*csig12-this._ssig1*ssig12;B12=g.SinCosSeries(true,ssig2,csig2,this._C1a);serr=(1+this._A1m1)*(sig12+(B12-this._B11))-s12_a12/this._b;sig12=sig12-serr/Math.sqrt(1+
this._k2*m.sq(ssig2));ssig12=Math.sin(sig12);csig12=Math.cos(sig12)}}ssig2=this._ssig1*csig12+this._csig1*ssig12;csig2=this._csig1*csig12-this._ssig1*ssig12;dn2=Math.sqrt(1+this._k2*m.sq(ssig2));if(outmask&(g.DISTANCE|g.REDUCEDLENGTH|g.GEODESICSCALE)){if(arcmode||Math.abs(this.f)>.01)B12=g.SinCosSeries(true,ssig2,csig2,this._C1a);AB1=(1+this._A1m1)*(B12-this._B11)}sbet2=this._calp0*ssig2;cbet2=m.hypot(this._salp0,this._calp0*csig2);if(cbet2===0)cbet2=csig2=g.tiny_;salp2=this._salp0;calp2=this._calp0*
csig2;if(arcmode&&outmask&g.DISTANCE)vals.s12=this._b*((1+this._A1m1)*sig12+AB1);if(outmask&g.LONGITUDE){somg2=this._salp0*ssig2;comg2=csig2;E=this._salp0<0?-1:1;omg12=outmask&g.LONG_UNROLL?E*(sig12-(Math.atan2(ssig2,csig2)-Math.atan2(this._ssig1,this._csig1))+(Math.atan2(E*somg2,comg2)-Math.atan2(E*this._somg1,this._comg1))):Math.atan2(somg2*this._comg1-comg2*this._somg1,comg2*this._comg1+somg2*this._somg1);lam12=omg12+this._A3c*(sig12+(g.SinCosSeries(true,ssig2,csig2,this._C3a)-this._B31));lon12=
lam12/m.degree;vals.lon2=outmask&g.LONG_UNROLL?this.lon1+lon12:m.AngNormalize(m.AngNormalize(this.lon1)+m.AngNormalize(lon12))}if(outmask&g.LATITUDE)vals.lat2=m.atan2d(sbet2,this._f1*cbet2);if(outmask&g.AZIMUTH)vals.azi2=m.atan2d(salp2,calp2);if(outmask&(g.REDUCEDLENGTH|g.GEODESICSCALE)){B22=g.SinCosSeries(true,ssig2,csig2,this._C2a);AB2=(1+this._A2m1)*(B22-this._B21);J12=(this._A1m1-this._A2m1)*sig12+(AB1-AB2);if(outmask&g.REDUCEDLENGTH)vals.m12=this._b*(dn2*(this._csig1*ssig2)-this._dn1*(this._ssig1*
csig2)-this._csig1*csig2*J12);if(outmask&g.GEODESICSCALE){t=this._k2*(ssig2-this._ssig1)*(ssig2+this._ssig1)/(this._dn1+dn2);vals.M12=csig12+(t*ssig2-csig2*J12)*this._ssig1/this._dn1;vals.M21=csig12-(t*this._ssig1-this._csig1*J12)*ssig2/dn2}}if(outmask&g.AREA){B42=g.SinCosSeries(false,ssig2,csig2,this._C4a);if(this._calp0===0||this._salp0===0){salp12=salp2*this._calp1-calp2*this._salp1;calp12=calp2*this._calp1+salp2*this._salp1;if(salp12===0&&calp12<0){salp12=g.tiny_*this._calp1;calp12=-1}}else{salp12=
this._calp0*this._salp0*(csig12<=0?this._csig1*(1-csig12)+ssig12*this._ssig1:ssig12*(this._csig1*ssig12/(1+csig12)+this._ssig1));calp12=m.sq(this._salp0)+m.sq(this._calp0)*this._csig1*csig2}vals.S12=this._c2*Math.atan2(salp12,calp12)+this._A4*(B42-this._B41)}if(!arcmode)vals.a12=sig12/m.degree;return vals};l.GeodesicLine.prototype.Position=function(s12,outmask){return this.GenPosition(false,s12,outmask)};l.GeodesicLine.prototype.ArcPosition=function(a12,outmask){return this.GenPosition(true,a12,outmask)}})(GeographicLib.Geodesic,
GeographicLib.GeodesicLine,GeographicLib.Math);
(function(p,g,m,a){var transit,transitdirect;transit=function(lon1,lon2){var lon12,cross;lon1=m.AngNormalize(lon1);lon2=m.AngNormalize(lon2);lon12=m.AngDiff(lon1,lon2);cross=lon1<0&&lon2>=0&&lon12>0?1:lon2<0&&lon1>=0&&lon12<0?-1:0;return cross};transitdirect=function(lon1,lon2){lon1=lon1%720;lon2=lon2%720;return(lon2>=0&&lon2<360||lon2<-360?0:1)-(lon1>=0&&lon1<360||lon1<-360?0:1)};p.PolygonArea=function(geod,polyline){this._geod=geod;this.a=this._geod.a;this.f=this._geod.f;this._area0=4*Math.PI*geod._c2;
this.polyline=!polyline?false:polyline;this._mask=g.LATITUDE|g.LONGITUDE|g.DISTANCE|(this.polyline?g.NONE:g.AREA|g.LONG_UNROLL);if(!this.polyline)this._areasum=new a.Accumulator(0);this._perimetersum=new a.Accumulator(0);this.Clear()};p.PolygonArea.prototype.Clear=function(){this.num=0;this._crossings=0;if(!this.polyline)this._areasum.Set(0);this._perimetersum.Set(0);this._lat0=this._lon0=this.lat=this.lon=Number.NaN};p.PolygonArea.prototype.AddPoint=function(lat,lon){var t;if(this.num===0){this._lat0=
this.lat=lat;this._lon0=this.lon=lon}else{t=this._geod.Inverse(this.lat,this.lon,lat,lon,this._mask);this._perimetersum.Add(t.s12);if(!this.polyline){this._areasum.Add(t.S12);this._crossings+=transit(this.lon,lon)}this.lat=lat;this.lon=lon}++this.num};p.PolygonArea.prototype.AddEdge=function(azi,s){var t;if(this.num){t=this._geod.Direct(this.lat,this.lon,azi,s,this._mask);this._perimetersum.Add(s);if(!this.polyline){this._areasum.Add(t.S12);this._crossings+=transitdirect(this.lon,t.lon2)}this.lat=
t.lat2;this.lon=t.lon2}++this.num};p.PolygonArea.prototype.Compute=function(reverse,sign){var vals={number:this.num},t,tempsum,crossings;if(this.num<2){vals.perimeter=0;if(!this.polyline)vals.area=0;return vals}if(this.polyline){vals.perimeter=this._perimetersum.Sum();return vals}t=this._geod.Inverse(this.lat,this.lon,this._lat0,this._lon0,this._mask);vals.perimeter=this._perimetersum.Sum(t.s12);tempsum=new a.Accumulator(this._areasum);tempsum.Add(t.S12);crossings=this._crossings+transit(this.lon,
this._lon0);if(crossings&1)tempsum.Add((tempsum.Sum()<0?1:-1)*this._area0/2);if(!reverse)tempsum.Negate();if(sign)if(tempsum.Sum()>this._area0/2)tempsum.Add(-this._area0);else{if(tempsum.Sum()<=-this._area0/2)tempsum.Add(+this._area0)}else if(tempsum.Sum()>=this._area0)tempsum.Add(-this._area0);else if(tempsum<0)tempsum.Add(-this._area0);vals.area=tempsum.Sum();return vals};p.PolygonArea.prototype.TestPoint=function(lat,lon,reverse,sign){var vals={number:this.num+1},t,tempsum,crossings,i;if(this.num===
0){vals.perimeter=0;if(!this.polyline)vals.area=0;return vals}vals.perimeter=this._perimetersum.Sum();tempsum=this.polyline?0:this._areasum.Sum();crossings=this._crossings;for(i=0;i<(this.polyline?1:2);++i){t=this._geod.Inverse(i===0?this.lat:lat,i===0?this.lon:lon,i!==0?this._lat0:lat,i!==0?this._lon0:lon,this._mask);vals.perimeter+=t.s12;if(!this.polyline){tempsum+=t.S12;crossings+=transit(i===0?this.lon:lon,i!==0?this._lon0:lon)}}if(this.polyline)return vals;if(crossings&1)tempsum+=(tempsum<0?
1:-1)*this._area0/2;if(!reverse)tempsum*=-1;if(sign)if(tempsum>this._area0/2)tempsum-=this._area0;else{if(tempsum<=-this._area0/2)tempsum+=this._area0}else if(tempsum>=this._area0)tempsum-=this._area0;else if(tempsum<0)tempsum+=this._area0;vals.area=tempsum;return vals};p.PolygonArea.prototype.TestEdge=function(azi,s,reverse,sign){var vals={number:this.num?this.num+1:0},t,tempsump,crossings;if(this.num===0)return vals;vals.perimeter=this._perimetersum.Sum()+s;if(this.polyline)return vals;tempsum=
this._areasum.Sum();crossings=this._crossings;t=this._geod.Direct(this.lat,this.lon,azi,s,this._mask);tempsum+=t.S12;crossings+=transitdirect(this.lon,t.lon2);t=this._geod(t.lat2,t.lon2,this._lat0,this._lon0,this._mask);perimeter+=t.s12;tempsum+=t.S12;crossings+=transit(t.lon2,this._lon0);if(crossings&1)tempsum+=(tempsum<0?1:-1)*this._area0/2;if(!reverse)tempsum*=-1;if(sign)if(tempsum>this._area0/2)tempsum-=this._area0;else{if(tempsum<=-this._area0/2)tempsum+=this._area0}else if(tempsum>=this._area0)tempsum-=
this._area0;else if(tempsum<0)tempsum+=this._area0;vals.area=tempsum;return vals}})(GeographicLib.PolygonArea,GeographicLib.Geodesic,GeographicLib.Math,GeographicLib.Accumulator);window["GeographicLib"]=GeographicLib;window["GeographicLib"]["Geodesic"]=GeographicLib.Geodesic;window["GeographicLib"]["Geodesic"]["Geodesic"]=GeographicLib.Geodesic.Geodesic;var l,ba="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},ea="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global?global:this;
function ha(a,b){if(b){for(var c=ea,d=a.split("."),e=0;e<d.length-1;e++){var f=d[e];f in c||(c[f]={});c=c[f]}d=d[d.length-1];e=c[d];f=b(e);f!=e&&null!=f&&ba(c,d,{configurable:!0,writable:!0,value:f})}}ha("Array.prototype.find",function(a){return a?a:function(a,c){var b;a:{b=this;b instanceof String&&(b=String(b));for(var e=b.length,f=0;f<e;f++){var g=b[f];if(a.call(c,g,f,b)){b=g;break a}}b=void 0}return b}});ha("Number.isNaN",function(a){return a?a:function(a){return"number"===typeof a&&isNaN(a)}});
var p={};window.M=p;window.Melown=p;window.ga=null!=window.ga?window.ga:{};window.MelownMap_=null!=window.MelownMap_?window.MelownMap_:null;window.Q=null!=window.Q?window.Q:{};window.$=null!=window.$?window.$:{};p.Fh=Array;p.Hy={};p.Hy.create=function(a){var b=new p.Fh(2);a&&(b[0]=a[0],b[1]=a[1]);return b};p.xi={};p.xi.create=function(a){var b=new p.Fh(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b};p.xi.Db=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};p.xi.$q=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]};p.D={};p.D.create=function(a){var b=new p.Fh(3);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return b};p.D.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};
p.D.add=function(a,b,c){if(!c||a==c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c};p.D.Iz=function(a,b,c){if(!c||a==c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c};p.D.uz=function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};p.D.scale=function(a,b,c){if(!c||a==c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c};
p.D.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=Math.sqrt(c*c+d*d+e*e);if(f){if(1==f)return b[0]=c,b[1]=d,b[2]=e,b}else return b[0]=0,b[1]=0,b[2]=0,b;f=1/f;b[0]=c*f;b[1]=d*f;b[2]=e*f;return b};p.D.bn=function(a,b,c){c||(c=a);var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1];b=b[2];c[0]=e*b-a*g;c[1]=a*f-d*b;c[2]=d*g-e*f;return c};p.D.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};p.D.Db=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};
p.D.Hz=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e};p.D.direction=function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1];a=a[2]-b[2];b=Math.sqrt(d*d+e*e+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=d*b;c[1]=e*b;c[2]=a*b;return c};p.D.kz=function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);return d};p.D.Up=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};p.Md={};
p.Md.create=function(a){var b=new p.Fh(9);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9]);return b};p.Md.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};p.Md.Ba=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};
p.Md.te=function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[5];a[1]=a[3];a[2]=a[6];a[3]=c;a[5]=a[7];a[6]=d;a[7]=e;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b};p.Md.zy=function(a,b){b||(b=p.i.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=0;b[4]=a[3];b[5]=a[4];b[6]=a[5];b[7]=0;b[8]=a[6];b[9]=a[7];b[10]=a[8];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
p.Md.Up=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"};p.i={};p.i.create=function(a){var b=new p.Fh(16);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b};
p.i.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};p.i.Ba=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};
p.i.te=function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],k=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=c;a[6]=a[9];a[7]=a[13];a[8]=d;a[9]=f;a[11]=a[14];a[12]=e;a[13]=g;a[14]=k;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b};
p.i.Yy=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],k=a[6],h=a[7],m=a[8],n=a[9],q=a[10],y=a[11],w=a[12],t=a[13],v=a[14];a=a[15];return w*n*k*e-m*t*k*e-w*g*q*e+f*t*q*e+m*g*v*e-f*n*v*e-w*n*d*h+m*t*d*h+w*c*q*h-b*t*q*h-m*c*v*h+b*n*v*h+w*g*d*y-f*t*d*y-w*c*k*y+b*t*k*y+f*c*v*y-b*g*v*y-m*g*d*a+f*n*d*a+m*c*k*a-b*n*k*a-f*c*q*a+b*g*q*a};
p.i.inverse=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],k=a[5],h=a[6],m=a[7],n=a[8],q=a[9],y=a[10],w=a[11],t=a[12],v=a[13],D=a[14],B=a[15],x=c*k-d*g,H=c*h-e*g,u=c*m-f*g,L=d*h-e*k,r=d*m-f*k,A=e*m-f*h,O=n*v-q*t,fa=n*D-y*t,C=n*B-w*t,da=q*D-y*v,ca=q*B-w*v,V=y*B-w*D,Y=1/(x*V-H*ca+u*da+L*C-r*fa+A*O);b[0]=(k*V-h*ca+m*da)*Y;b[1]=(-d*V+e*ca-f*da)*Y;b[2]=(v*A-D*r+B*L)*Y;b[3]=(-q*A+y*r-w*L)*Y;b[4]=(-g*V+h*C-m*fa)*Y;b[5]=(c*V-e*C+f*fa)*Y;b[6]=(-t*A+D*u-B*H)*Y;b[7]=(n*A-y*u+w*H)*Y;b[8]=(g*ca-
k*C+m*O)*Y;b[9]=(-c*ca+d*C-f*O)*Y;b[10]=(t*r-v*u+B*x)*Y;b[11]=(-n*r+q*u-w*x)*Y;b[12]=(-g*da+k*fa-h*O)*Y;b[13]=(c*da-d*fa+e*O)*Y;b[14]=(-t*L+v*H-D*x)*Y;b[15]=(n*L-q*H+y*x)*Y;return b};p.i.Lz=function(a,b){b||(b=p.i.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};
p.i.zt=function(a,b){b||(b=p.Md.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b};p.i.cq=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[4],g=a[5],k=a[6],h=a[8],m=a[9],n=a[10],q=n*g-k*m,y=-n*f+k*h,w=m*f-g*h,t=c*q+d*y+e*w;if(!t)return null;t=1/t;b||(b=p.Md.create());b[0]=q*t;b[1]=(-n*d+e*m)*t;b[2]=(k*d-e*g)*t;b[3]=y*t;b[4]=(n*c-e*h)*t;b[5]=(-k*c+e*f)*t;b[6]=w*t;b[7]=(-m*c+d*h)*t;b[8]=(g*c-d*f)*t;return b};
p.i.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2],g=a[3],k=a[4],h=a[5],m=a[6],n=a[7],q=a[8],y=a[9],w=a[10],t=a[11],v=a[12],D=a[13],B=a[14];a=a[15];var x=b[0],H=b[1],u=b[2],L=b[3],r=b[4],A=b[5],O=b[6],fa=b[7],C=b[8],da=b[9],ca=b[10],V=b[11],Y=b[12],ka=b[13],Ba=b[14];b=b[15];c[0]=x*d+H*k+u*q+L*v;c[1]=x*e+H*h+u*y+L*D;c[2]=x*f+H*m+u*w+L*B;c[3]=x*g+H*n+u*t+L*a;c[4]=r*d+A*k+O*q+fa*v;c[5]=r*e+A*h+O*y+fa*D;c[6]=r*f+A*m+O*w+fa*B;c[7]=r*g+A*n+O*t+fa*a;c[8]=C*d+da*k+ca*q+V*v;c[9]=C*e+da*h+ca*y+
V*D;c[10]=C*f+da*m+ca*w+V*B;c[11]=C*g+da*n+ca*t+V*a;c[12]=Y*d+ka*k+Ba*q+b*v;c[13]=Y*e+ka*h+Ba*y+b*D;c[14]=Y*f+ka*m+Ba*w+b*B;c[15]=Y*g+ka*n+Ba*t+b*a;return c};p.i.Ma=function(a,b,c){c||(c=b);var d=b[0],e=b[1];b=b[2];c[0]=a[0]*d+a[4]*e+a[8]*b+a[12];c[1]=a[1]*d+a[5]*e+a[9]*b+a[13];c[2]=a[2]*d+a[6]*e+a[10]*b+a[14];return c};
p.i.am=function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2];b=b[3];c[0]=a[0]*d+a[4]*e+a[8]*f+a[12]*b;c[1]=a[1]*d+a[5]*e+a[9]*f+a[13]*b;c[2]=a[2]*d+a[6]*e+a[10]*f+a[14]*b;c[3]=a[3]*d+a[7]*e+a[11]*f+a[15]*b;return c};
p.i.translate=function(a,b,c){var d=b[0],e=b[1];b=b[2];if(!c||a==c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;var f=a[0],g=a[1],k=a[2],h=a[3],m=a[4],n=a[5],q=a[6],y=a[7],w=a[8],t=a[9],v=a[10],D=a[11];c[0]=f;c[1]=g;c[2]=k;c[3]=h;c[4]=m;c[5]=n;c[6]=q;c[7]=y;c[8]=w;c[9]=t;c[10]=v;c[11]=D;c[12]=f*d+m*e+w*b+a[12];c[13]=g*d+n*e+t*b+a[13];c[14]=k*d+q*e+v*b+a[14];c[15]=h*d+y*e+D*b+a[15];return c};
p.i.scale=function(a,b,c){var d=b[0],e=b[1];b=b[2];if(!c||a==c)return a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*e;c[5]=a[5]*e;c[6]=a[6]*e;c[7]=a[7]*e;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};
p.i.rotate=function(a,b,c,d){var e=c[0],f=c[1];c=c[2];var g=Math.sqrt(e*e+f*f+c*c);if(!g)return null;1!=g&&(g=1/g,e*=g,f*=g,c*=g);var k=Math.sin(b),h=Math.cos(b),m=1-h;b=a[0];var g=a[1],n=a[2],q=a[3],y=a[4],w=a[5],t=a[6],v=a[7],D=a[8],B=a[9],x=a[10],H=a[11],u=e*e*m+h,L=f*e*m+c*k,r=c*e*m-f*k,A=e*f*m-c*k,O=f*f*m+h,fa=c*f*m+e*k,C=e*c*m+f*k,e=f*c*m-e*k,f=c*c*m+h;d?a!=d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=b*u+y*L+D*r;d[1]=g*u+w*L+B*r;d[2]=n*u+t*L+x*r;d[3]=q*u+v*L+H*r;d[4]=b*A+y*
O+D*fa;d[5]=g*A+w*O+B*fa;d[6]=n*A+t*O+x*fa;d[7]=q*A+v*O+H*fa;d[8]=b*C+y*e+D*f;d[9]=g*C+w*e+B*f;d[10]=n*C+t*e+x*f;d[11]=q*C+v*e+H*f;return d};p.i.Bz=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[4],f=a[5],g=a[6],k=a[7],h=a[8],m=a[9],n=a[10],q=a[11];c?a!=c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[4]=e*b+h*d;c[5]=f*b+m*d;c[6]=g*b+n*d;c[7]=k*b+q*d;c[8]=e*-d+h*b;c[9]=f*-d+m*b;c[10]=g*-d+n*b;c[11]=k*-d+q*b;return c};
p.i.Cz=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],f=a[1],g=a[2],k=a[3],h=a[8],m=a[9],n=a[10],q=a[11];c?a!=c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+h*-d;c[1]=f*b+m*-d;c[2]=g*b+n*-d;c[3]=k*b+q*-d;c[8]=e*d+h*b;c[9]=f*d+m*b;c[10]=g*d+n*b;c[11]=k*d+q*b;return c};
p.i.Dz=function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],f=a[1],g=a[2],k=a[3],h=a[4],m=a[5],n=a[6],q=a[7];c?a!=c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+h*d;c[1]=f*b+m*d;c[2]=g*b+n*d;c[3]=k*b+q*d;c[4]=e*-d+h*b;c[5]=f*-d+m*b;c[6]=g*-d+n*b;c[7]=k*-d+q*b;return c};
p.i.Ku=function(a,b,c,d,e,f,g){g||(g=p.i.create());var k=b-a,h=d-c,m=f-e;g[0]=2*e/k;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=2*e/h;g[6]=0;g[7]=0;g[8]=(b+a)/k;g[9]=(d+c)/h;g[10]=-(f+e)/m;g[11]=-1;g[12]=0;g[13]=0;g[14]=-(f*e*2)/m;g[15]=0;return g};p.i.perspective=function(a,b,c,d,e){a=c*Math.tan(a*Math.PI/360);b*=a;return p.i.Ku(-b,b,-a,a,c,d,e)};
p.i.xz=function(a,b,c,d,e,f,g){g||(g=p.i.create());var k=b-a,h=d-c,m=f-e;g[0]=2/k;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=2/h;g[6]=0;g[7]=0;g[8]=0;g[9]=0;g[10]=-2/m;g[11]=0;g[12]=-(a+b)/k;g[13]=-(d+c)/h;g[14]=-(f+e)/m;g[15]=1;return g};
p.i.nz=function(a,b,c,d){d||(d=p.i.create());var e=a[0],f=a[1];a=a[2];var g=c[0],k=c[1],h=c[2];c=b[1];var m=b[2];if(e==b[0]&&f==c&&a==m)return p.i.Ba(d);var n,q,y,w;c=e-b[0];m=f-b[1];b=a-b[2];w=1/Math.sqrt(c*c+m*m+b*b);c*=w;m*=w;b*=w;n=k*b-h*m;h=h*c-g*b;g=g*m-k*c;(w=Math.sqrt(n*n+h*h+g*g))?(w=1/w,n*=w,h*=w,g*=w):g=h=n=0;k=m*g-b*h;q=b*n-c*g;y=c*h-m*n;(w=Math.sqrt(k*k+q*q+y*y))?(w=1/w,k*=w,q*=w,y*=w):y=q=k=0;d[0]=n;d[1]=k;d[2]=c;d[3]=0;d[4]=h;d[5]=q;d[6]=m;d[7]=0;d[8]=g;d[9]=y;d[10]=b;d[11]=0;d[12]=
-(n*e+h*f+g*a);d[13]=-(k*e+q*f+y*a);d[14]=-(c*e+m*f+b*a);d[15]=1;return d};p.i.Up=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"};p.od={};p.od.create=function(a){var b=new p.Fh(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b};p.od.set=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};
p.od.Vy=function(a,b){var c=a[0],d=a[1],e=a[2];if(!b||a==b)return a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a;b[0]=c;b[1]=d;b[2]=e;b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b};p.od.inverse=function(a,b){if(!b||a==b)return a[0]*=1,a[1]*=1,a[2]*=1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b};p.od.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};
p.od.normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=a[3],g=Math.sqrt(c*c+d*d+e*e+f*f);if(0==g)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;g=1/g;b[0]=c*g;b[1]=d*g;b[2]=e*g;b[3]=f*g;return b};p.od.multiply=function(a,b,c){c||(c=a);var d=a[0],e=a[1],f=a[2];a=a[3];var g=b[0],k=b[1],h=b[2];b=b[3];c[0]=d*b+a*g+e*h-f*k;c[1]=e*b+a*k+f*g-d*h;c[2]=f*b+a*h+d*k-e*g;c[3]=a*b-d*g-e*k-f*h;return c};
p.od.Ma=function(a,b,c){c||(c=b);var d=b[0],e=b[1],f=b[2];b=a[0];var g=a[1],k=a[2];a=a[3];var h=a*d+g*f-k*e,m=a*e+k*d-b*f,n=a*f+b*e-g*d,d=-b*d-g*e-k*f;c[0]=h*a+d*-b+m*-k-n*-g;c[1]=m*a+d*-g+n*-b-h*-k;c[2]=n*a+d*-k+h*-g-m*-b;return c};p.od.zt=function(a,b){b||(b=p.Md.create());var c=a[0],d=a[1],e=a[2],f=a[3],g=c+c,k=d+d,h=e+e,m=c*g,n=c*k,c=c*h,q=d*k,d=d*h,e=e*h,g=f*g,k=f*k,f=f*h;b[0]=1-(q+e);b[1]=n-f;b[2]=c+k;b[3]=n+f;b[4]=1-(m+e);b[5]=d-g;b[6]=c-k;b[7]=d+g;b[8]=1-(m+q);return b};
p.od.zy=function(a,b){b||(b=p.i.create());var c=a[0],d=a[1],e=a[2],f=a[3],g=c+c,k=d+d,h=e+e,m=c*g,n=c*k,c=c*h,q=d*k,d=d*h,e=e*h,g=f*g,k=f*k,f=f*h;b[0]=1-(q+e);b[1]=n-f;b[2]=c+k;b[3]=0;b[4]=n+f;b[5]=1-(m+e);b[6]=d-g;b[7]=0;b[8]=c-k;b[9]=d+g;b[10]=1-(m+q);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};p.od.Gz=function(a,b,c,d){d||(d=a);var e=c;0>a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]&&(e=-1*c);d[0]=1-c*a[0]+e*b[0];d[1]=1-c*a[1]+e*b[1];d[2]=1-c*a[2]+e*b[2];d[3]=1-c*a[3]+e*b[3];return d};
p.od.Up=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};p.Math={};p.Math.mat4Multiply=p.i.multiply;p.Math.mat4Inverse=p.i.inverse;p.Math.mat4ToMat3=p.i.zt;p.Math.mat4ToInverseMat3=p.i.cq;p.Math.mat4Transpose=p.i.te;p.Math.mat3Transpose=p.Md.te;p.Math.vec3Normalize=p.D.normalize;p.Math.vec3Dot=p.D.Db;p.Math.vec3Cross=p.D.bn;p.Math.vec3Length=p.D.length;
p.Lu=function(a,b,c,d,e,f){var g=b-a,k=d-c,h=f-e;a=p.i.create([2*e/g,0,(b+a)/g,0,0,2*e/k,(d+c)/k,0,0,0,-(f+e)/h,-2*f*e/h,0,0,-1,0]);p.i.te(a);return a};p.Qw=function(a,b,c,d){a=c*Math.tan(a*Math.PI/180);b*=a;return p.Lu(-b,b,-a,a,c,d)};p.Ow=function(a,b,c,d){var e=d-c;a=p.i.create([1/(.5*a*b),0,0,0,0,1/(.5*a),0,0,0,0,-2/e,-((d+c)/e),0,0,0,1]);p.i.te(a);return a};
p.Xc=function(a,b){var c=Math.cos(b),d=Math.sin(b);switch(a){case 0:c=[1,0,0,0,0,c,-d,0,0,d,c,0,0,0,0,1];break;case 1:c=[c,0,-d,0,0,1,0,0,d,0,c,0,0,0,0,1];break;default:c=[c,-d,0,0,d,c,0,0,0,0,1,0,0,0,0,1]}p.i.te(c);return c};p.If=function(a,b,c){a=[a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1];p.i.te(a);return a};p.Ws=function(a){return p.If(a,a,a)};p.Ic=function(a,b,c){a=[1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1];p.i.te(a);return a};p.Mz=function(a){return p.Ic(a[0],a[1],0)};p.Nz=function(a){return p.Ic(a[0],a[1],a[2])};
p.isEqual=function(a,b,c){return Math.abs(a-b)<c};p.dd=function(a,b,c){a<b?a=b:a>c&&(a=c);return a};p.Ga=function(a){return a*Math.PI/180};p.Pi=function(a){return a/Math.PI*180};p.cw=function(a,b,c){return a+(b-a)*c};p.ea=function(a,b){return"boolean"===typeof a?a:b};p.oc=function(a,b,c,d){return"number"===typeof a?p.dd(a,b,c):d};p.Fm=function(a,b){return"string"===typeof a?a:b};
p.yz=function(a,b){if(0>a)return a=-a+"",b--,a.length>=b?"-"+a:"-"+(Array(b-a.length+1).join("0")+a);a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a};p.lu=function(a){var b=(a&31744)>>10;fraction=a&1023;return(a>>15?-1:1)*(b?31===b?fraction?NaN:Infinity:Math.pow(2,b-15)*(1+fraction/1024):fraction/1024*6.103515625E-5)};p.Tx=function(a){var b={copy:"&copy;",Y:(new Date).getFullYear()};return a&&""!=a?a.replace(/\{([_$a-zA-Z0-9][_$a-zA-Z0-9]*)\}/g,function(a,d){return d in b?b[d]:a}):""};
p.$s=function(a){return a&&""!=a?p.Tx(a).replace(/\[([^\]]*)\]/g,function(a,c){c=c.trim();urls_=c.split(" ");return-1!=urls_[0].indexOf("//")?1<urls_.length?"<a href="+urls_[0]+" target='_blank'>"+c.substring(urls_[0].length)+"</a>":"<a href="+urls_[0]+" target='_blank'>"+urls_[0]+"</a>":c}):""};p.Ux=function(a,b,c){return a&&""!=a?a.replace(/\{([_$a-zA-Z(-9][_$a-zA-Z(-9]*)\}/g,function(a,e){return e in b?b[e]:c(e)}):""};
p.az=function(a){return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?[parseInt(a[4],16),parseInt(a[3],16),parseInt(a[2],16),parseInt(a[1],16)]:[0,0,0,255]};p.dy=function(){return"("+p.Lt+").call(self);"};
p.Jd=function(a,b,c,d,e,f){var g=new XMLHttpRequest;g.onreadystatechange=function(){switch(g.readyState){case 4:if(400<=g.status||0==g.status)c&&c(g.status);else{var e=g.response,f=e;if(!d)try{f=JSON.parse(e)}catch(m){console.log("JSON Parse Error ("+a+"): "+(m.message?m.message:""));c&&c(g.status);break}b&&b(f)}}}.bind(this);g.open("GET",a,!0);g.withCredentials=e;f&&f.token&&g.setRequestHeader("Accept","token/"+f.token+", */*");g.send("")};
p.Id=function(a,b,c,d,e,f){var g=new XMLHttpRequest;g.onreadystatechange=function(){switch(g.readyState){case 0:case 1:case 2:case 3:break;case 4:if(400<=g.status||0==g.status){c&&c(g.status);break}var a=g.response;if(!a){c&&c();break}a=f&&"arraybuffer"!=f?a:new DataView(a);b&&b(a);break;default:c&&c()}}.bind(this);g.open("GET",a,!0);g.responseType=f?f:"arraybuffer";g.withCredentials=d;e&&e.token&&g.setRequestHeader("Accept","token/"+e.token+", */*");g.send("")};
window.performance=window.performance||{};performance.now=performance.now||performance.qz||performance.rz||performance.vz||performance.webkitNow||function(){return(new Date).getTime()};window.Rs=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)};"undefined"===typeof Array.isArray&&(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});
p.isEqual=p.isEqual;p.clamp=p.dd;p.mix=p.cw;p.radians=p.Ga;p.degrees=p.Pi;p.loadJSON=p.Jd;p.loadBinary=p.Id;
p.Oa={rf:!1,Eb:function(){var a=p.Oa;a.Um=a.Ys(a.ju)||"An unknown browser";a.version=a.Zs(navigator.userAgent.toLowerCase())||a.Zs(navigator.appVersion)||"an unknown version";a.Of=a.Ys(a.ku)||"an unknown os: ua: "+navigator.userAgent+" pl: "+navigator.platform;a.wf="iphone/ipod"==a.Of||"android"==a.Of||"ipad"==a.Of||"windows ce"==a.Of||"windows phone"==a.Of||"kindle"==a.Of;a.dw="android"==a.Of;a.rf=!0},Mu:function(){p.Oa.rf||p.Oa.Eb();return p.Oa.Um},Jn:function(){p.Oa.rf||p.Oa.Eb();return p.Oa.Um},
Wu:function(){p.Oa.rf||p.Oa.Eb();return p.Oa.Um},Lr:function(){p.Oa.rf||p.Oa.Eb();return p.Oa.wf},Bv:function(){p.Oa.rf||p.Oa.Eb();return p.Oa.dw},Ys:function(a){for(var b=p.Oa,c=0;c<a.length;c++){var d=a[c].Va,e=a[c].vx;b.Kt=a[c].$g||a[c].Ba;if(d){if(-1!=d.toLowerCase().indexOf(a[c].Wa))return null!=a[c].version&&(b.version=a[c].version),a[c].Ba}else if(e)return a[c].Ba}},Zs:function(a){var b=p.Oa;if(null!=b.version)return b.version;var c=a.indexOf(b.Kt);if(-1!=c)return parseFloat(a.substring(c+
b.Kt.length+1))},ju:[{Va:navigator.userAgent,Wa:"chrome",Ba:"chrome"},{Va:navigator.userAgent,Wa:"firefox",Ba:"firefox"},{Va:navigator.vendor,Wa:"apple",Ba:"safari",$g:"version"},{vx:window.opera,Ba:"opera",$g:"version"},{Va:navigator.vendor,Wa:"icab",Ba:"icab"},{Va:navigator.vendor,Wa:"kde",Ba:"konqueror"},{Va:navigator.vendor,Wa:"camino",Ba:"camino"},{Va:navigator.userAgent,Wa:"netscape",Ba:"netscape"},{Va:navigator.userAgent,Wa:"msie",Ba:"explorer",$g:"msie"},{Va:navigator.userAgent,Wa:"trident/",
Ba:"explorer",version:"11"},{Va:navigator.userAgent,Wa:"edge/",Ba:"explorer",version:"12"},{Va:navigator.userAgent,Wa:"omniweb",$g:"omniweb/",Ba:"omniweb"},{Va:navigator.userAgent,Wa:"silk",$g:"silk/",Ba:"silk"},{Va:navigator.userAgent,Wa:"gecko",Ba:"mozilla",$g:"rv"},{Va:navigator.userAgent,Wa:"mozilla",Ba:"netscape",$g:"mozilla"}],ku:[{Va:navigator.userAgent,Wa:"windows ce",Ba:"windows ce"},{Va:navigator.userAgent,Wa:"windows phone",Ba:"windows phone"},{Va:navigator.platform,Wa:"win",Ba:"windows"},
{Va:navigator.platform,Wa:"mac",Ba:"mac"},{Va:navigator.userAgent,Wa:"iphone",Ba:"iphone/ipod"},{Va:navigator.userAgent,Wa:"ipod",Ba:"iphone/ipod"},{Va:navigator.userAgent,Wa:"ipad",Ba:"ipad"},{Va:navigator.userAgent,Wa:"android",Ba:"android"},{Va:navigator.userAgent,Wa:"silk",Ba:"kindle"},{Va:navigator.userAgent,Wa:"blackberry",Ba:"blackberry"},{Va:navigator.platform,Wa:"linux",Ba:"linux"}]};p.getBrowser=p.Oa.Mu;p.getBrowserVersion=p.Oa.Jn;p.getOS=p.Oa.Wu;p.isPlatformMobileDevice=p.Oa.Lr;
p.isPlatformAndroid=p.Oa.Bv;p.Ha={};p.Ha.hz=function(a){if("string"!==typeof a)return!1;var b=document.location.hostname;return p.Ha.parse(a).hostname===b};p.Ha.parse=function(a){if("string"!==typeof a)return null;var b=document.createElement("a");b.href=a;return b};
p.Ha.vr=function(a){var b={};a=p.Ha.parse(a).search.substring(1).split("&");if(1!=a.length||""!=a[0])for(var c=0;c<a.length;c++){var d=a[c].split("=");"undefined"===typeof b[d[0]]?b[d[0]]=d[1]:"string"===typeof b[d[0]]?b[d[0]]=[b[d[0]],d[1]]:b[d[0]].push(d[1])}return b};p.Ha.Tu=function(a){var b=document.createElement("a");b.href=a;return b.hostname};
p.Ha.hl=function(a){if(-1!=a.indexOf("http://"))return"http:";if(-1!=a.indexOf("https://"))return"https:";var b=document.createElement("a");b.href=a;return b.protocol};p.Ha.el=function(a){var b=document.createElement("a");b.href=a;return b.origin};p.Ha.Xk=function(a){return a.split("?")[0].split("/").slice(0,-1).join("/")+"/"};
p.Ha.wr=function(a,b){if(!a||!b)return a;a=a.trim();b=b.trim();var c=p.Ha.Xk(b),d=p.Ha.hl(b),e=p.Ha.el(b);return-1!=a.indexOf("://")?a:0==a.indexOf("//")?d+a:0==a.indexOf("/")?e+a:c+a};p.Url=p.Ha;p.Ha.getParamsFromUrl=p.Ha.vr;p.wb={};p.wb.Sv=function(a,b,c,d){!a instanceof Image||"string"!==typeof b||(d||(a.crossOrigin=c?"use-credentials":"anonymous"),a.src=b)};p.wb.sl=function(a,b,c,d,e){var f=new Image;f.onerror=c;f.onload=b;p.wb.Sv(f,a,d,e);return f};p.wb.Jd=function(a,b,c){p.Id(a,b,c)};
p.wb.Id=function(a,b,c){p.Id(a,b,c)};p.wb.Dr=function(a,b,c,d,e){var f=new XMLHttpRequest;f.onreadystatechange=function(){switch(f.readyState){case 0:case 1:case 2:case 3:break;case 4:null!=b&&b(f.getAllResponseHeaders(),f.status);break;default:null!=c&&c()}}.bind(this);f.onerror=function(){null!=c&&c()}.bind(this);f.open("HEAD",a,!0);f.withCredentials=d;e&&e.token&&f.setRequestHeader("Accept","token/"+e.token+", */*");f.send("")};p.Http=p.wb;p.wb.imageFactory=p.wb.sl;p.wb.loadJSON=p.wb.Jd;
p.wb.loadBinary=p.wb.Id;p.wb.headRequest=p.wb.Dr;
function ia(a){this.l=a;na("#melown-stats-panel {font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;display: none;padding:15px;width: 305px;font-size: 14px;position: absolute;right: 10px;top: 10px;cursor: default;background-color: rgba(255,255,255,0.95);border-radius: 5px;border: solid 1px #ccc;text-align: left;z-index: 7;padding: 10px;}#melown-stats-panel-info {margin-top: 5px;margin-bottom: 3px;}#melown-stats-panel-info table {color:#000000;text-align: left;font-size: 12px;}#melown-stats-panel-info table td {vertical-align: top;}#melown-stats-panel-pos {width: 100%;}");this.Xe=
document.createElement("div");this.Xe.id="melown-stats-panel";this.Xe.innerHTML='<span id="melown-stats-panel-title">Render statistics</h3><p id="melown-stats-panel-info"></p><input id="melown-stats-panel-pos" type="text">';this.l.ba.appendChild(this.Xe);this.by=document.getElementById("melown-stats-panel-info");this.lt=document.getElementById("melown-stats-panel-pos");this.Xe.addEventListener("mouseup",this.qb.bind(this),!0);this.Xe.addEventListener("mousedown",this.qb.bind(this),!0);this.Xe.addEventListener("mousewheel",
this.qb.bind(this),!1);this.Xe.addEventListener("dblclick",this.qb.bind(this),!1);this.Tp=!1;na("#melown-graphs-panel {position:absolute;left:10px;top:10px;z-index: 7;background-color: #FFFFFF;padding: 5px;border-radius: 4px;font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;color:#000000;text-align: left;font-size: 12px;display:none;}.melown-graphs-canvas {border: solid 1px #bbb;image-rendering : pixelated;}.melown-graphs-info {padding: 5px 2px;font-size: 10px;}.melown-graphs-button {padding: 2px 5px;display:inline-block;margin-right: 4px;border-radius: 4px;cursor:pointer;}.melown-graphs-button:hover {box-shadow: 0 0 1px #0066ff;}");
this.Ie=document.createElement("div");this.Ie.id="melown-graphs-panel";this.Ie.innerHTML='<canvas id="melown-graphs-render" class="melown-graphs-canvas" width="900" height="100" ></canvas><div id="melown-graphs-info" class="melown-graphs-info" >&FilledSmallSquare; Frame: 1234 &nbsp <span style="color:#ff0000">&FilledSmallSquare;</span> Render: 1234 &nbsp <span style="color:#0000ff">&FilledSmallSquare;</span> Textures: 1234 &nbsp <span style="color:#005500">&FilledSmallSquare;</span> Mesh: 1234 &nbsp <span style="color:#00bb00">&FilledSmallSquare;</span> GpuMesh: 1234</div><canvas id="melown-graphs-cache" class="melown-graphs-canvas" width="900" height="100" ></canvas><div id="melown-graphs-info2" class="melown-graphs-info" >&FilledSmallSquare; Cache: 1234 &nbsp <span style="color:#ff0000">&FilledSmallSquare;</span> Used: 123 &nbsp <span style="color:#0000ff">&FilledSmallSquare;</span> Textures: 1234 &nbsp <span style="color:#00bb00">&FilledSmallSquare;</span> Mesh: &nbsp 1234</div><div id="melown-graphs-rec" class="melown-graphs-button" >Recording On</div><div id="melown-graphs-ref" class="melown-graphs-button" >Refresh On</div><div id="melown-graphs-res" class="melown-graphs-button" >Reset</div><div id="melown-graphs-zoom" class="melown-graphs-button" >Scale: Max value</div><div id="melown-graphs-magnify" class="melown-graphs-button" >Magnify Off</div><div id="melown-graphs-graph" class="melown-graphs-button" >Graph: Cache</div>';
this.l.ba.appendChild(this.Ie);this.qf=document.getElementById("melown-graphs-render");this.hg=document.getElementById("melown-graphs-cache");this.dv=this.qf.getContext("2d");this.cv=this.hg.getContext("2d");document.getElementById("melown-graphs-rec").onclick=this.lo.bind(this);document.getElementById("melown-graphs-rec").onclick=this.lo.bind(this);document.getElementById("melown-graphs-ref").onclick=this.gv.bind(this);document.getElementById("melown-graphs-res").onclick=this.hv.bind(this);document.getElementById("melown-graphs-zoom").onclick=
this.iv.bind(this);document.getElementById("melown-graphs-magnify").onclick=this.fv.bind(this);document.getElementById("melown-graphs-graph").onclick=this.ev.bind(this);document.getElementById("melown-graphs-render").onmousemove=this.vs.bind(this);document.getElementById("melown-graphs-render").onmouseout=this.ws.bind(this);document.getElementById("melown-graphs-cache").onmousemove=this.vs.bind(this);document.getElementById("melown-graphs-cache").onmouseout=this.ws.bind(this);this.Ie.addEventListener("mouseup",
this.qb.bind(this),!0);this.Ie.addEventListener("mousedown",this.qb.bind(this),!0);this.Ie.addEventListener("mousewheel",this.qb.bind(this),!1);this.Ie.addEventListener("dblclick",this.qb.bind(this),!1);this.kg="max";this.Hd="Cache";this.kl=!0;this.jl=!1;na("#melown-layers-panel {font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;display: none;padding:15px;font-size: 14px;position: absolute;right: 10px;bottom: 10px;cursor: default;background-color: rgba(255,255,255,0.95);border-radius: 5px;border: solid 1px #ccc;text-align: left;z-index: 7;padding: 10px;}#melown-layers-panel button {max-width: 23px;max-height: 21px;}#melown-layers-panel-title {margin-bottom: 3px;}#melown-layers-views-panel {margin-top: 5px;float: left;}#melown-layers-views-items {width: 191px;overflow-y: scroll;overflow-x: hidden;height: 200px;border: 1px solid #ddd;}#melown-layers-surfaces-panel {margin-top: 5px;float: left;}#melown-layers-surfaces-items {width: 150px;overflow-y: scroll;overflow-x: hidden;height: 200px;border-top: 1px solid #ddd;border-bottom: 1px solid #ddd;}#melown-layers-boundlayers-panel {margin-top: 5px;float: left;}#melown-layers-boundlayers-items {width: 250px;overflow-y: scroll;overflow-x: hidden;height: 200px;border: 1px solid #ddd;border-right: none;}#melown-layers-freelayers-panel {margin-top: 5px;float: left;}#melown-layers-freelayers-items {width: 150px;overflow-y: scroll;overflow-x: hidden;height: 200px;border: 1px solid #ddd;}#melown-layers-fl-properties-panel {margin-top: 5px;float: left;}#melown-layers-fl-properties-items {width: 250px;overflow-y: scroll;overflow-x: hidden;height: 200px;border: 1px solid #ddd;border-right: none;}#melown-layers-json-panel {margin-top: 5px;float: right;}#melown-layers-json-text {width: 200px;resize: none;height: 180px;border: 1px solid #ddd;white-space: nowrap;padding: 0px;}#melown-layers-json-text2 {width: 200px;height: 21px;border: 1px solid #ddd;}.melown-layers-panel-title {margin: 0px;margin-bottom: 5px;}.melown-layers-item {width: 100%;}.melown-layers-item input[type=number]{width: 43px;}.melown-layers-name {width: 120px;display: inline-block;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}.melown-layers-name2 {width: 126px;display: inline-block;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}#melown-layers-fl-properties-style {width: 175px;height: 21px;}.melown-surface-item {width: 100%;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}");
this.Ne=document.createElement("div");this.Ne.id="melown-layers-panel";this.Ne.innerHTML='<div id="melown-layers-views-panel"><p class="melown-layers-panel-title">Named Views:</p><div id="melown-layers-views-items"></div></div><div id="melown-layers-surfaces-panel"><p class="melown-layers-panel-title">Surfaces:</p><div id="melown-layers-surfaces-items"></div></div><div id="melown-layers-boundlayers-panel"><p class="melown-layers-panel-title">Surface Bound Layers:</p><div id="melown-layers-boundlayers-items"></div></div><div id="melown-layers-freelayers-panel"><p class="melown-layers-panel-title">Free Layers:</p><div id="melown-layers-freelayers-items"></div></div><div id="melown-layers-fl-properties-panel"><p class="melown-layers-panel-title">Free Layer Properties:</p><div id="melown-layers-fl-properties-items"></div></div><div id="melown-layers-json-panel"><p class="melown-layers-panel-title">Definition:</p><textarea id="melown-layers-json-text" cols="48"></textarea><br/><input id="melown-layers-json-text2" type="text"></div>';
this.l.ba.appendChild(this.Ne);this.Jv=document.getElementById("melown-layers-views-items");this.Iv=document.getElementById("melown-layers-surfaces-items");this.Ev=document.getElementById("melown-layers-boundlayers-items");this.Fv=document.getElementById("melown-layers-freelayers-items");this.Yr=document.getElementById("melown-layers-fl-properties-items");this.Hv=document.getElementById("melown-layers-json-text");this.Gv=document.getElementById("melown-layers-json-text2");this.Ne.addEventListener("mouseup",
this.qb.bind(this),!0);this.Ne.addEventListener("mousedown",this.qb.bind(this),!0);this.Ne.addEventListener("mousewheel",this.qb.bind(this),!1);this.Ne.addEventListener("dblclick",this.qb.bind(this),!1);this.Nb=[];this.Zr=this.Fo=!1;this.tf=this.Me=this.Mb="";na("#melown-replay-panel {font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;display: none;padding:15px;width: 600px;font-size: 14px;position: absolute;right: 10px;top: 10px;cursor: default;background-color: rgba(255,255,255,0.95);border-radius: 5px;border: solid 1px #ccc;text-align: left;z-index: 7;padding: 10px;}#melown-replay-panel-left {width: 253px;height: 100%;float: left;}#melown-replay-panel-right {width: 340px;height: 100%;float: right;}#melown-replay-items {width: 240px;overflow-x: hidden;border: 1px solid #ddd;padding-right: 5px;}.melown-replay-item {width: 100%;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}#melown-replay-lod-slider {width: 240px;}#melown-replay-lod-text {width: 60px;margin-left: 10px;margin-right: 10px;}#melown-replay-lod-single {margin-left: 10px;}#melown-replay-time-slider {width: 330px;}#melown-replay-time-text {width: 60px;margin-left: 10px;margin-right: 10px;}#melown-replay-time-single {margin-left: 10px;}#melown-replay-panel-gtime canvas{border: 1px solid #555;}#melown-replay-panel-gtime span{font-size: 10px;}#melown-replay-info {width: 240px;height: 140px;overflow-x: hidden;border: 1px solid #ddd;padding-right: 5px;margin-top: 10px;font-size: 12px;word-wrap: break-word;}");
this.Se=document.createElement("div");this.Se.id="melown-replay-panel";this.Se.innerHTML='<div id="melown-replay-panel-left"><div id="melown-replay-items"></div><div id="melown-replay-panel-lod"><input id="melown-replay-lod-slider" type="range" min="0" max="30" step="1" value="30" /><br/><span>LOD:</span><input id="melown-replay-lod-text" type="text" value="30"/><input id="melown-replay-lod-up" type="button" value="<"/><input id="melown-replay-lod-down" type="button" value=">"/><input id="melown-replay-lod-single" type="checkbox"/><span>Single</span></div><div id="melown-replay-info"></div></div><div id="melown-replay-panel-right"><div id="melown-replay-panel-gtime"><span id="melown-replay-info-meshes">Meshes Count: 0 Min/Max: 0/0 Avg. 0</span><br/><canvas id="melown-replay-canvas-meshes" width=340 height=30></canvas><br/><span id="melown-replay-info-textures">Internal Textures Count: 0 Min/Max: 0/0 Avg. 0</span><br/><canvas id="melown-replay-canvas-textures" width=340 height=30></canvas><br/><span id="melown-replay-info-textures2">External Textures Count: 0 Min/Max: 0/0 Avg. 0</span><br/><canvas id="melown-replay-canvas-textures2" width=340 height=30></canvas><br/><span id="melown-replay-info-geodata">Geodata Count: 0 Min/Max: 0/0 Avg. 0</span><br/><canvas id="melown-replay-canvas-geodata" width=340 height=30></canvas><br/><span id="melown-replay-info-metatiles">Metatiles Count: 0 Min/Max: 0/0 Avg. 0</span><br/><canvas id="melown-replay-canvas-metatiles" width=340 height=30></canvas><br/><span id="melown-replay-info-intervals">Interval Count: 0 Min/Max: 0/0 Avg. 0</span><br/><canvas id="melown-replay-canvas-intervals" width=340 height=30></canvas><br/><span id="melown-replay-info-threads">Threads Min/Max: 0/0 Avg. 0 </span><br/><canvas id="melown-replay-canvas-threads" width=340 height=30></canvas><br/></div><div id="melown-replay-panel-time"><input id="melown-replay-time-slider" type="range" min="0" max="2000" value="0" /><br/><span>File:</span><input id="melown-replay-time-text" type="text" value="0"/><input id="melown-replay-time-up" type="button" value="<"/><input id="melown-replay-time-down" type="button" value=">"/><input id="melown-replay-time-single" type="checkbox"/><span>Single</span></div></div>';
this.l.ba.appendChild(this.Se);this.Mx=document.getElementById("melown-replay-items");this.Hf=document.getElementById("melown-replay-lod-slider");this.Hf.onchange=this.oe.bind(this,"lod");this.Hf.oninput=this.oe.bind(this,"lod");this.Hg=document.getElementById("melown-replay-lod-text");this.Hg.onchange=this.zs.bind(this,"lod");document.getElementById("melown-replay-lod-up").onclick=this.oe.bind(this,"lod","down");document.getElementById("melown-replay-lod-down").onclick=this.oe.bind(this,"lod","up");
document.getElementById("melown-replay-lod-single").onclick=this.oe.bind(this,"lod","single");this.Te=document.getElementById("melown-replay-time-slider");this.Te.onchange=this.oe.bind(this,"time");this.Te.oninput=this.oe.bind(this,"time");this.Ig=document.getElementById("melown-replay-time-text");this.Ig.onchange=this.zs.bind(this,"time");this.Nx=document.getElementById("melown-replay-info");document.getElementById("melown-replay-time-up").onclick=this.oe.bind(this,"time","down");document.getElementById("melown-replay-time-down").onclick=
this.oe.bind(this,"time","up");document.getElementById("melown-replay-time-single").onclick=this.oe.bind(this,"time","single");this.Se.addEventListener("mouseup",this.qb.bind(this),!0);this.Se.addEventListener("mousedown",this.qb.bind(this),!0);this.Se.addEventListener("mousewheel",this.qb.bind(this),!1);this.Se.addEventListener("dblclick",this.qb.bind(this),!1);this.Hx=document.getElementById("melown-replay-info-meshes");this.hi=document.getElementById("melown-replay-canvas-meshes").getContext("2d");
this.Kx=document.getElementById("melown-replay-info-textures");this.ki=document.getElementById("melown-replay-canvas-textures").getContext("2d");this.Jx=document.getElementById("melown-replay-info-textures2");this.ji=document.getElementById("melown-replay-canvas-textures2").getContext("2d");this.Fx=document.getElementById("melown-replay-info-geodata");this.gi=document.getElementById("melown-replay-canvas-geodata").getContext("2d");this.Ix=document.getElementById("melown-replay-info-metatiles");this.ii=
document.getElementById("melown-replay-canvas-metatiles").getContext("2d");this.Gx=document.getElementById("melown-replay-info-intervals");this.Fg=document.getElementById("melown-replay-canvas-intervals").getContext("2d");this.Lx=document.getElementById("melown-replay-info-threads");this.Gg=document.getElementById("melown-replay-canvas-threads").getContext("2d");this.km=[];this.Ff=[];this.Gf=[];this.Jp=this.Ps=!1;na("#melown-stylesheets-panel {font-family: Arial, 'Helvetica Neue', Helvetica, sans-serif;display: none;padding:15px;width: 1200px;height: 350px;font-size: 14px;position: absolute;right: 10px;bottom: 10px;cursor: default;background-color: rgba(255,255,255,0.95);border-radius: 5px;border: solid 1px #ccc;text-align: left;z-index: 7;padding: 10px;}#melown-stylesheets-panel-header {width: 100%;height: 30px;}#melown-stylesheets-panel-combo {width: 1130px;height: 21px;}#melown-stylesheets-panel-button {float: right;}#melown-stylesheets-panel-text {width: 100%;height: 320px;resize: none;white-space: nowrap;}");
this.Ze=document.createElement("div");this.Ze.id="melown-stylesheets-panel";this.Ze.innerHTML='<div id="melown-stylesheets-panel-header"><select id="melown-stylesheets-panel-combo"></select><button id="melown-stylesheets-panel-button" type="button" title="Update">Update</button></div><textarea id="melown-stylesheets-panel-text" cols="50"></textarea>';this.l.ba.appendChild(this.Ze);this.wm=document.getElementById("melown-stylesheets-panel-combo");this.wm.onchange=this.Dw.bind(this);this.Xp=document.getElementById("melown-stylesheets-panel-text");
document.getElementById("melown-stylesheets-panel-button").onclick=this.Ew.bind(this);this.Ze.addEventListener("mouseup",this.qb.bind(this),!0);this.Ze.addEventListener("mousedown",this.qb.bind(this),!0);this.Ze.addEventListener("mousewheel",this.qb.bind(this),!1);this.Ze.addEventListener("dblclick",this.qb.bind(this),!1);this.Wp=!1;document.addEventListener("keyup",this.Af.bind(this),!1);document.addEventListener("keypress",this.dm.bind(this),!1);document.addEventListener("keydown",this.hp.bind(this),
!1);this.l.K("map-update",this.ip.bind(this));this.Mk=this.er=this.Rp=!1;this.qe=null}function na(a){var b=document.createElement("style");b.type="text/css";b.innerHTML=a;document.getElementsByTagName("head")[0].appendChild(b)}l=ia.prototype;l.qb=function(a){a.stopPropagation();return!1};
l.ip=function(){var a=this.l.xj;if(a){this.Rp&&a.Oj();if(this.fr){var b=this.l.Dd(),c=b,d=a.mh([0,0,0]),b=b.zp,e=this.Qs,f=6371E3,g=c.j.u;g.disable(g.CULL_FACE);var k=p.i.create();p.i.multiply(p.If(2,2,2),p.Ic(-.5,-.5,-.5),k);var h=[d[0],d[1],d[2]],f=null!=f?f:1.5,d=p.i.create();p.i.multiply(p.Ic(h[0],h[1],h[2]),p.If(f,f,6371E3),d);f=p.i.create();p.i.multiply(oa(c.P),d,f);p.i.multiply(f,k,f);c.j.useProgram(b,["aPosition","aTexCoord"]);c.j.bindTexture(e||c.di);pa(b,"uSampler",0);ra(b,"uMVP",f);c.Wj.jb(b,
"aPosition","aTexCoord");g.enable(g.CULL_FACE)}if(this.er){b=this.l.nf();g=[];c=0;for(k=this.km.length;c<k;c++)g.push(a.Qf(this.km[c]));b.fd({points:g,size:2,color:[0,.5,1,255],"depth-test":!1,blend:!1});c=0;for(k=this.Gf.length;c<k;c++){g=[];e=0;for(f=this.Gf[c].length;e<f;e++)g.push(a.Qf(this.Gf[c][e]));b.fd({points:g,size:2,color:[0,1,.5,255],"depth-test":!1,blend:!1})}c=0;for(k=this.Ff.length;c<k;c++){g=[];e=0;for(f=this.Ff[c].length;e<f;e++)g.push(a.Qf(this.Ff[c][e]));b.fd({points:g,size:2,color:[0,
1,1,255],"depth-test":!1,blend:!1})}e=a.ie();g=a.mh(this.km[0]);c=p.i.create(this.Cx);c[12]=g[0];c[13]=g[1];c[14]=g[2];p.Math.oz(e["view-matrix"],c,c);e=[0,0,0,0,0,0,0,0,0];p.i.cq(c,e);b.Gc(this.Ex);b.dr({mesh:this.Dx,texture:null,shader:"shaded","shader-variables":{uMV:["mat4",c],uNorm:["mat3",e],uMaterial:["mat4",[255,128,128,0,0,0,0,0,0,0,0,0,0,.5,0,0]]}})}if(this.Mk&&this.Lq){b=this.l.nf();k=a.sa();f=a.Cd(k)/64;g=Array(256);for(e=0;16>e;e++)for(c=0;16>c;c++)d=c*f-8*f,h=e*f-8*f,d=a.xf(k,p.Pi(Math.atan2(h,
d)),Math.sqrt(d*d+h*h)),d=a.Ee(d),d=a.Li([d[0],d[1],0],"float",this.qe),g[16*e+c]=d;a=Array(16);for(e=0;16>e;e++){for(c=0;16>c;c++)a[c]=g[16*e+c];b.fd({points:a,size:2,color:[0,1,1,255],"depth-test":!1,blend:!1})}for(c=0;16>c;c++){for(e=0;16>e;e++)a[e]=g[16*e+c];b.fd({points:a,size:2,color:[0,1,1,255],"depth-test":!1,blend:!1})}c=0;for(k=g.length;c<k;c++)a=g[c],b.drawImage({rect:[a[0]-10,a[1]-10,20,20],texture:this.Lq,color:[255,0,255,255],depth:a[2],"depth-test":!1,blend:!0})}}};
l.hp=function(a){"undefined"==typeof a&&(a=window.event);this.cn=a.ctrlKey;this.Uj=a.shiftKey;this.Af(a,!0)};l.dm=function(a){this.Af(a,!0)};l.preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};
l.Af=function(a,b){"undefined"==typeof a&&(a=window.event);var c=this.l.J();if(null!=c){this.cn=a.ctrlKey;this.Uj=a.shiftKey;var d=!1;if(a){var e;e=window.event?window.event.keyCode:a.which?a.which:a.charCode;if(1==this.Uj&&1==this.cn)switch(e){case 68:case 100:this.preventDefault(a)}if(1==this.Uj&&1!=b){if(1==this.cn)switch(e){case 68:case 100:this.Kq||(this.Kq=p.wb.sl("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QAAAAAAAD5Q7t/AAAACW9GRnMAAAAgAAAA4ACD+EAUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVRYw+2VPwqDMBTG3dz1Am56EnH2XLroETxGuwc3Z7cOdhY8QJpfSUBspUvStJAPPggvD973/uQligICAgL+DKViqygUV02hbaXLwJlio7gpyhNu2idzEXwwgfI8H+u6vnZdN/V9P3EuimLcCRlsiyArGcfxjWDLsmzyAGzc4aNFNDZ7/iw7AeQH4LNrh5WZYLgkJTaZCyHuVVVdkiSZ0zSdOWMzlaBFWkRrQ4A4Zk/A4wBie1MFYUMAz0wybCYAmR8FUAlzj6+2r18TgM2VAO8tOB1Cyk7mrofQ+zP0voheVjHtIBjDxjrmvCu7k1Xs/TP6ie84ICDAGR5uCYdPo0MWiAAAAABJRU5ErkJggg==",
function(){this.Lq=this.l.nf().createTexture({source:this.Kq})}.bind(this))),d=this.fn=!0}if(1==this.fn){var f=!0;switch(e){case 68:case 100:break;case 49:break;case 50:break;case 51:break;case 48:break;case 72:case 104:c.oo=!c.oo;break;case 80:case 112:var g=c.sa();console.log("pos-before: "+JSON.stringify(g.s));va(g,"obj"==g.s[0]?"subj":"obj");console.log("new mode: "+g.s[0]);console.log("pos-after: "+JSON.stringify(g.s));c.setPosition(g);break;case 83:case 115:c.m.mm("frame001.png","png");this.Tp?
(this.Xe.style.display="none",this.Tp=!1):(this.Xe.style.display="block",this.Tp=!0);break;case 86:case 118:this.Fo?(this.Ne.style.display="none",this.Fo=!1):(this.Ne.style.display="block",this.Fo=!0,this.Ft());break;case 69:case 101:this.Wp?(this.Ze.style.display="none",this.Wp=!1):(Aa(this),this.Ze.style.display="block",this.Wp=!0);break;case 84:case 116:this.Jp?(this.Se.style.display="none",this.Jp=!1):Ca(this);break;case 66:case 98:c.sc=!c.sc;break;case 87:case 119:g=c.th+1;c.th=2<g?0:g;break;
case 70:case 102:c.th=3!=c.th?3:0;break;case 77:case 109:c.Nh=!c.Nh;console.log("loader state "+c.Nh);break;case 74:case 106:c.Jk=!c.Jk;d=!0;break;case 88:case 120:c.f.Oh=!c.f.Oh;d=!0;break;case 82:case 114:1==this.jl?(this.Ie.style.display="none",this.jl=!1):(this.Ie.style.display="block",this.jl=!0);this.lo(!0);break;case 79:case 111:Da(c.P,!c.P.np);break;case 76:case 108:this.Mk=!this.Mk;break;case 90:case 122:c.Ir=!c.Ir;break;case 78:case 110:this.Rp=!this.Rp;break;default:f=!1}f&&(d=!0)}}if(this.fn&&
this.Mk&&!this.Uj&&!b){f=!0;switch(e){case 43:case 107:null==this.qe&&(this.qe=8);this.qe++;break;case 45:case 109:null==this.qe&&(this.qe=8);this.qe=Math.max(0,this.qe-1);break;case 42:case 106:this.qe=null;break;default:f=!1}f&&(d=!0)}if(this.fn&&c.sc&&!this.Uj&&!b){f=!0;switch(e){case 76:case 108:c.qn=!c.qn;break;case 80:case 112:c.un=!c.un;break;case 84:case 116:c.wn=!c.wn;break;case 70:case 102:c.nn=!c.nn;break;case 68:case 100:c.mn=!c.mn;break;case 78:case 110:c.rn=!c.rn;break;case 77:case 109:c.Vi=
!c.Vi;break;case 73:case 105:c.cr=!c.cr;break;case 66:case 98:c.kn=!c.kn;break;case 83:case 115:c.vn=!c.vn;break;case 67:case 99:c.Ik=!c.Ik;break;case 79:case 111:c.tn=!c.tn;break;case 69:case 101:c.en=2==c.en?3:2;break;case 88:case 120:c.f.Aj=!c.f.Aj;break;case 90:case 122:c.f.Bj=!c.f.Bj;break;default:f=!1}f&&(d=!0)}}d&&(z(c),this.preventDefault(a))}};function Fa(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c].g==b)return c;return-1}
function Ha(a){if(a.l.J()){var b=a.Nb,c="",d;for(d in b)c+='<div class="melown-views-item" id="melown-views-item-'+d+'"><div class="melown-layers-name2">'+d+'</div><button id="melown-views-cbutton-'+d+'" type="button" title="Clone">C</button><button id="melown-views-xbutton-'+d+'" type="button" title="Remove">X</button></div>';a.Jv.innerHTML=c;for(d in b)b="melown-views-cbutton-"+d,document.getElementById(b).onclick=a.ot.bind(a,d,b,"clone"),b="melown-views-xbutton-"+d,document.getElementById(b).onclick=
a.ot.bind(a,d,b,"remove"),b="melown-views-item-"+d,document.getElementById(b).onclick=a.om.bind(a,d)}}
l.om=function(a){if(this.Nb[a]){if(this.Mb){var b=document.getElementById("melown-views-item-"+this.Mb);b&&(b.style.backgroundColor="initial")}b=document.getElementById("melown-views-item-"+a);b.style.backgroundColor="#ddd";this.Mb=a;a=this.Nb[this.Mb].Ka;var b="",c=null,d;for(d in a)b+='<div id="melown-surface-item-'+d+'" class="melown-surface-item"><input id="melown-surface-checkbox-'+d+'" type="checkbox"/><span title='+d+">"+d+"</span></div>",null===c&&(c=d);this.Iv.innerHTML=b;this.Me=c;for(d in a)a[d].Ta&&
(b="melown-surface-checkbox-"+d,document.getElementById(b).checked=!0);for(d in a)b="melown-surface-checkbox-"+d,document.getElementById(b).onchange=this.hy.bind(this,d,b),b="melown-surface-item-"+d,document.getElementById(b).onclick=this.nm.bind(this,d);this.nm(this.Me);d=this.Nb[this.Mb].fa;a="";for(var e in d)a+='<div class="melown-surface-item" id="melown-freelayer-item-'+e+'"><input id="melown-freelayer-checkbox-'+e+'" type="checkbox" '+(d[e].Ta?"checked":"")+"/><span title="+e+">"+e+"</span></div>";
this.Fv.innerHTML=a;for(e in d)d="melown-freelayer-checkbox-"+e,document.getElementById(d).onchange=this.fy.bind(this,e,d),d="melown-freelayer-item-"+e,document.getElementById(d).onclick=this.Op.bind(this,e);Ja(this)}};l.ot=function(a,b,c){b=this.Nb;for(var d in this.Nb)if(d==a){switch(c){case "clone":for(d=2;;){if(!b[a+" #"+d]){b[a+" #"+d]=JSON.parse(JSON.stringify(b[a]));break}d++}Ha(this);break;case "remove":c=0;for(d in b)c++;if(1<c)if(delete b[a],Ha(this),this.Mb==a)for(d in b){this.om(d);break}else this.om(this.Mb)}break}};
l.hy=function(a,b){this.Nb[this.Mb].Ka[a].Ta=document.getElementById(b).checked;Ja(this)};
l.nm=function(a){if(this.Me){var b=document.getElementById("melown-surface-item-"+this.Me);b.style.backgroundColor="initial"}b=document.getElementById("melown-surface-item-"+a);b.style.backgroundColor="#ddd";this.Me=a;a=this.Nb[this.Mb].Ka[this.Me].ta;for(var c="",b=0,d=a.length;b<d;b++)var e=a[b],c=c+('<div class="melown-layers-item"><input id="melown-boundlayer-checkbox-'+e.g+'" type="checkbox" '+(e.Ta?"checked":"")+'/><div class="melown-layers-name">'+e.g+'</div><input id="melown-boundlayer-spinner-'+
e.g+'" type="number" title="Alpha" min="0" max="100" step="10" value="'+e.nb+'"><button id="melown-boundlayer-ubutton-'+e.g+'" type="button" title="Move Above">&uarr;</button><button id="melown-boundlayer-dbutton-'+e.g+'" type="button" title="Move Bellow">&darr;</button></div>');this.Ev.innerHTML=c;b=0;for(d=a.length;b<d;b++)c="melown-boundlayer-checkbox-"+a[b].g,document.getElementById(c).onchange=this.ym.bind(this,a[b].g,c,"enable"),c="melown-boundlayer-spinner-"+a[b].g,document.getElementById(c).onchange=
this.ym.bind(this,a[b].g,c,"alpha"),c="melown-boundlayer-ubutton-"+a[b].g,document.getElementById(c).onclick=this.ym.bind(this,a[b].g,c,"up"),c="melown-boundlayer-dbutton-"+a[b].g,document.getElementById(c).onclick=this.ym.bind(this,a[b].g,c,"down")};
l.ym=function(a,b,c){b=document.getElementById(b);for(var d=this.Nb[this.Mb].Ka[this.Me].ta,e=0,f=d.length;e<f;e++)if(d[e].g==a){switch(c){case "enable":d[e].Ta=b.checked;break;case "alpha":d[e].nb=parseInt(b.value,10);break;case "up":d.splice(Math.max(0,e-1),0,d.splice(e,1)[0]);this.nm(this.Me);break;case "down":d.splice(Math.max(0,e+1),0,d.splice(e,1)[0]),this.nm(this.Me)}break}Ja(this)};l.fy=function(a,b){this.Nb[this.Mb].fa[a].Ta=document.getElementById(b).checked;Ja(this)};
l.Op=function(a){if(this.tf){var b=document.getElementById("melown-freelayer-item-"+this.tf);b.style.backgroundColor="initial"}b=document.getElementById("melown-freelayer-item-"+a);b.style.backgroundColor="#ddd";var c=this.tf=a,d=this.l.J(),e=this.Nb[this.Mb],b=e.fa[c].ta;a="";if(d&&d.fa[c])switch(d.fa[c].gb().type){case "mesh":case "mesh-tiles":a+='<div class="melown-layers-item"><div class="melown-layers-name" style="width:185px">DepthShift:</div><input id="melown-fl-properties-depth-shift" type="number" min="-100" max="100" step="1" value="'+
e.fa[c].Sf+'"></div>';a+='<div class="melown-layers-item"><div class="melown-layers-name">BoundLayers:</div></div>';c=0;for(e=b.length;c<e;c++)d=b[c],a+='<div class="melown-layers-item"><input id="melown-fl-properties-checkbox-'+d.g+'" type="checkbox" '+(d.Ta?"checked":"")+'/><div class="melown-layers-name">'+d.g+'</div><input id="melown-fl-properties-spinner-'+d.g+'" type="number" title="Alpha" min="0" max="100" step="10" value="'+d.nb+'"><button id="melown-fl-properties-ubutton-'+d.g+'" type="button" title="Move Above">&uarr;</button><button id="melown-fl-properties-dbutton-'+
d.g+'" type="button" title="Move Bellow">&darr;</button></div>';this.Yr.innerHTML=a;a="melown-fl-properties-depth-shift";document.getElementById(a).onchange=this.nt.bind(this,a,"depthShift");c=0;for(e=b.length;c<e;c++)a="melown-fl-properties-checkbox-"+b[c].g,document.getElementById(a).onchange=this.zm.bind(this,b[c].g,a,"enable"),a="melown-fl-properties-spinner-"+b[c].g,document.getElementById(a).onchange=this.zm.bind(this,b[c].g,a,"alpha"),a="melown-fl-properties-ubutton-"+b[c].g,document.getElementById(a).onclick=
this.zm.bind(this,b[c].g,a,"up"),a="melown-fl-properties-dbutton-"+b[c].g,document.getElementById(a).onclick=this.zm.bind(this,b[c].g,a,"down");break;case "geodata":case "geodata-tiles":a+='<div class="melown-layers-item"><div class="melown-layers-name" style="width:50px">Style:</div><select id="melown-layers-fl-properties-style">';b=La(d);d=b.indexOf(e.fa[c].Ye||e.fa[c].Yh);c=0;for(e=b.length;c<e;c++)a+='<option value="'+b[c]+'" '+(c==d?"selected":"")+">"+b[c]+"</option>";this.Yr.innerHTML=a+"</select></div>";
a="melown-layers-fl-properties-style";document.getElementById(a).onchange=this.nt.bind(this,a,"style")}};l.zm=function(a,b,c){b=document.getElementById(b);for(var d=this.Nb[this.Mb].fa[this.tf].ta,e=0,f=d.length;e<f;e++)if(d[e].g==a){switch(c){case "enable":d[e].Ta=b.checked;break;case "alpha":d[e].nb=parseInt(b.value,10);break;case "up":d.splice(Math.max(0,e-1),0,d.splice(e,1)[0]);this.Op(this.tf);break;case "down":d.splice(Math.max(0,e+1),0,d.splice(e,1)[0]),this.Op(this.tf)}break}Ja(this)};
l.nt=function(a,b){var c=document.getElementById(a),d=this.Nb[this.Mb].fa[this.tf];switch(b){case "depthShift":d.Sf=parseInt(c.value,10);break;case "style":d.Ye=c.value}Ja(this)};
function Ja(a){var b={surfaces:{},freeLayers:{}},c=a.Nb[a.Mb],d=c.Ka,e;for(e in d)if(d[e].Ta){for(var f=[],g=d[e].ta,k=0,h=g.length;k<h;k++)g[k].Ta&&(100>g[k].nb?f.push({id:g[k].g,alpha:(.01*g[k].nb).toFixed(2)}):f.push(g[k].g));b.surfaces[e]=f}c=c.fa;for(e in c)if(c[e].Ta){d=[];g=c[e].ta;k=0;for(h=g.length;k<h;k++)g[k].Ta&&(100>g[k].nb?d.push({id:g[k].g,alpha:parseFloat((.01*g[k].nb).toFixed(2))}):d.push(g[k].g));b.freeLayers[e]={};0<d.length&&(b.freeLayers[e].boundLayers=d);c[e].Ye&&c[e].Ye!=c[e].Yh&&
(b.freeLayers[e].style=c[e].Ye);0!=c[e].Sf&&(b.freeLayers[e].depthShift=parseFloat((.01*c[e].Sf).toFixed(2)))}a.Hv.value=JSON.stringify(b,null,"  ");a.Gv.value=encodeURIComponent(JSON.stringify(b));(a=a.l.J())&&a.Rd(b)}l.Ft=function(){};
l.Ft=function(){if(!this.Zr){this.Zr=!1;var a=this.l.J();if(a){var b=Ma(a.wg),c="--initial--";this.Nb[c]={Ka:{},fa:{},mp:JSON.parse(JSON.stringify(a.pf()))};for(var d=0,e=b.length;d<e;d++){var f=b[d];this.Nb[f]={Ka:{},fa:{},mp:JSON.parse(JSON.stringify(a.wg[f].gb()))}}this.Mb=c;var b=this.Nb,g;for(g in b){for(var f=b[g],k=a.eg(),d=0,e=k.length;d<e;d++){for(var c=k[d],h=a.He(c),m=a.kf(),n=[],q=0,y=m.length;q<y;q++)n.push({g:m[q],nb:100,Ta:!1});f.Ka[c]={Ta:!1,ta:n}}k=a.bg();d=0;for(e=k.length;d<e;d++){c=
k[d];m=a.kf();n=[];q=0;for(y=m.length;q<y;q++)n.push({g:m[q],nb:100,Ta:!1});q=a.fa[c];m=q.gb();f.fa[c]={Ta:!1,Ye:null,Yh:m.style,Sf:0,ta:n}}var n=f.mp.surfaces,w;for(w in n)if(m=n[w],f.Ka[w])for(h=f.Ka[w],h.Ta=!0,d=0,e=m.length;d<e;d++)"string"===typeof m[d]?(c=Fa(h.ta,m[d]),-1!=c&&h.ta[c]&&(h.ta[c].Ta=!0,h.ta.splice(d,0,h.ta.splice(c,1)[0]))):(c=m[d].id,c=Fa(h.ta,c),-1!=c&&h.ta[c]&&(h.ta[c].Ta=!0,h.ta[c].nb=m[d].alpha?100*parseFloat(m[d].alpha):100,h.ta.splice(d,0,h.ta.splice(c,1)[0])));n=f.mp.freeLayers;
for(w in n)if(d=n[w],f.fa[w])for(q=f.fa[w],q.Ta=!0,q.Sf=d.depthShift||0,q.Sf*=100,q.Ye=d.style,m=[],q.ta=m,d=0,e=m.length;d<e;d++)"string"===typeof m[d]?(c=Fa(q.ta,m[d]),-1!=c&&q.ta[c]&&(q.ta[c].Ta=!0,q.ta.splice(d,0,q.ta.splice(c,1)[0]))):(c=m[d].id,c=Fa(q.ta,c),-1!=c&&h.ta[c]&&(q.ta[c].Ta=!0,q.ta[c].nb=m[d].alpha?100*parseFloat(m[d].alpha):100,q.ta.splice(d,0,h.ta.splice(c,1)[0])))}}Ha(this);this.om(this.Mb)}};l.Dw=function(){var a=this.l.J();a&&(this.Xp.value=Na(a.Lf[this.wm.value]))};
l.Ew=function(){var a=this.l.J();if(a){var b=JSON.parse(this.Xp.value),c=a.Lf[this.wm.value];c&&(c.Ia=b);if(c){c.setData(b);for(var d in a.fa)(b=a.fa[d])&&b.fb&&b.re==c&&(b.gd&&Oa(b.gd,"setStylesheet",{data:b.re.Ia,geocent:!Pa(Qa(a))}),b.De++)}z(a)}};
function Na(a){if(!a)return"";a=a.Ia;var b;b="{\n";var c=[];a.constants&&c.push("constants");a.bitmaps&&c.push("bitmaps");a.layers&&c.push("layers");for(var d=0,e=c.length;d<e;d++){var f=c[d];b+='  "'+f+'": {\n';var g=a[f],k=[],h;for(h in g)k.push(h);for(var m=0,n=k.length;m<n;m++)if("layers"==f){var q=g[k[m]],y=[],w;for(w in q)y.push(w);b+='    "'+k[m]+'": {\n';for(var t=0,v=y.length;t<v;t++)b+='      "'+y[t]+'": '+JSON.stringify(q[y[t]])+(t==v-1?"":",")+"\n";b+="    }"+(m==n-1?"":",\n")}else b+=
'    "'+k[m]+'": '+JSON.stringify(g[k[m]])+(m==n-1?"":",")+"\n";b+="\n  }"+(d==e-1?"":",\n")}return b+"\n}"}function Aa(a){var b=a.l.J();if(b){for(var c="",d=La(b),e=0,f=d.length;e<f;e++)c+='<option value="'+d[e]+'">'+d[e]+"</option>";a.wm.innerHTML=c;a.Xp.value=Na(b.Lf[d[0]])}}l.lo=function(a){var b=this.l.J();null!=b&&(b.o.Nj=null==a?a:!b.o.Nj,Ra(this),Sa(this,null,!0))};l.gv=function(){this.kl=!this.kl;Ra(this);Sa(this)};l.hv=function(){var a=this.l.J();null!=a&&(Ua(a.o),Sa(this,null,!0))};
l.iv=function(){switch(this.kg){case "max":this.kg="120avrg";break;case "120avrg":this.kg="180avrg";break;case "180avrg":this.kg="max"}Ra(this);Sa(this)};l.ev=function(){switch(this.Hd){case "Cache":this.Hd="Polygons";break;case "Polygons":this.Hd="Processing";break;case "Processing":this.Hd="LODs";break;case "LODs":this.Hd="Flux";break;case "Flux":this.Hd="Cache"}Ra(this);Sa(this)};
l.fv=function(){this.jo=!this.jo;1==this.jo?(this.qf.style.width="1400px",this.qf.style.height="200px",this.hg.style.width="1400px",this.hg.style.height="200px",document.getElementById("melown-graphs-magnify").innerHTML="Magnify On"):(this.qf.style.width="900px",this.qf.style.height="100px",this.hg.style.width="900px",this.hg.style.height="100px",document.getElementById("melown-graphs-magnify").innerHTML="Magnify Off");Ra(this);Sa(this)};
function Ra(a){var b=a.l.J();if(null!=b){document.getElementById("melown-graphs-rec").innerHTML=1==b.o.Nj?"Recording On":"Recording Off";document.getElementById("melown-graphs-ref").innerHTML=1==a.kl?"Refresh On":"Refresh Off";switch(a.kg){case "max":document.getElementById("melown-graphs-zoom").innerHTML="Scale: Max value";break;case "120avrg":document.getElementById("melown-graphs-zoom").innerHTML="Scale: 100% Avrg";break;case "180avrg":document.getElementById("melown-graphs-zoom").innerHTML="Scale: 50% Avrg"}document.getElementById("melown-graphs-graph").innerHTML=
"Graph: "+a.Hd}}l.vs=function(a){a=a.clientX-this.qf.getBoundingClientRect().left;this.jg=!0;1==this.jo&&(a=Math.floor(900*a/1400));this.ig=a;a=this.l.J();null!=a&&1!=a.o.Nj&&Sa(this,null)};l.ws=function(){this.jg=!1;Sa(this,null)};
function Sa(a,b,c){var d=a.l.J();if(null!=d&&(0!=a.kl||c)&&0!=a.jl){b=b||d.o;var e=a.qf.width;c=a.qf.height;var f=a.dv,g=b.tb,k=b.gj,h=e/g;f.clearRect(0,0,e,c);for(var m=0,n=e=0,q=0,y=0,w=0,t=0,v=b.bo,D=b.mo,B=b.Yn,x=b.Xn,H=b.Wn,u=0;u<g;u++){var e=e+v[u],n=n+D[u],q=q+B[u],y=y+x[u],w=w+H[u],L=v[u];L>m&&(m=L);0<L&&t++}"120avrg"==a.kg&&(m=e/t*1);"180avrg"==a.kg&&(m=e/t*.5);m=c/m;for(u=0;u<g;u++){var r=k+u,r=r%g;f.fillStyle="#000000";f.fillRect(u*h,c,1,-v[r]*m);f.fillStyle="#ff0000";f.fillRect(u*h,c,
1,-D[r]*m);f.fillStyle="#0000ff";f.fillRect(u*h,c,1,-B[r]*m);t=c-B[r]*m;f.fillStyle="#007700";f.fillRect(u*h,t,1,-x[r]*m);t-=x[r]*m;f.fillStyle="#00ff00";f.fillRect(u*h,t,1,-H[r]*m)}1==a.jg?(f.fillStyle="#aa00aa",r=a.ig%g,f.fillRect(Math.floor(r*h)-1,0,1,c),f.fillRect(Math.floor(r*h)+1,0,1,c),r=(a.ig+k)%g,u="&FilledSmallSquare; Frame: "+v[r].toFixed(2)+' &nbsp <span style="color:#ff0000">&FilledSmallSquare;</span> Render: '+D[r].toFixed(2)+' &nbsp <span style="color:#0000ff">&FilledSmallSquare;</span> Textures: '+
B[r].toFixed(2)+' &nbsp <span style="color:#005500">&FilledSmallSquare;</span> Meshes: '+x[r].toFixed(2)+' &nbsp <span style="color:#00bb00">&FilledSmallSquare;</span> GpuMeshes: '+H[r].toFixed(2)+"</div>"):u="&FilledSmallSquare; Frame: "+Math.round(e)+' &nbsp <span style="color:#ff0000">&FilledSmallSquare;</span> Render: '+Math.round(n)+' &nbsp <span style="color:#0000ff">&FilledSmallSquare;</span> Textures: '+Math.round(q)+' &nbsp <span style="color:#005500">&FilledSmallSquare;</span> Meshes: '+
Math.round(y)+' &nbsp <span style="color:#00bb00">&FilledSmallSquare;</span> GpuMeshes: '+Math.round(w)+"</div>";document.getElementById("melown-graphs-info").innerHTML=u;e=a.hg.width;c=a.hg.height;f=a.cv;h=e/g;f.clearRect(0,0,e,c);switch(a.Hd){case "Cache":m=c/(d.gc.vf+d.Ec.vf+d.Rc.vf);w=y=q=n=d=e=0;v=b.Un;D=b.Vn;B=b.ho;x=b.eo;t=b.co;H=b.fo;for(u=0;u<g;u++)e=v[u]>e?v[u]:e,d=D[u]>d?D[u]:d,n=B[u]>n?B[u]:n,q=x[u]>q?x[u]:q,y=t[u]>y?t[u]:y,w=H[u]>w?H[u]:w;for(u=0;u<g;u++)r=k+u,r%=g,b=v[r]+x[r]+B[r]+t[r]+
D[r],f.fillStyle="#000000",f.fillRect(u*h,c,1,-b*m),b-=D[r],f.fillStyle="#0000ff",f.fillRect(u*h,c,1,-b*m),b-=B[r],f.fillStyle="#009999",f.fillRect(u*h,c,1,-b*m),b-=t[r],f.fillStyle="#007700",f.fillRect(u*h,c,1,-b*m),b-=x[r],f.fillStyle="#ff0000",f.fillRect(u*h,c,1,-b*m),b=H[r],f.fillStyle="#ffff00",f.fillRect(u*h,c-b*m,1,1);1==a.jg?(r=(a.ig+k)%g,u='<span style="color:#555">&FilledSmallSquare;</span> Total: '+Math.ceil((v[r]+D[r]+B[r]+x[r])/1048576)+'MB &nbsp <span style="color:#000000">&FilledSmallSquare;</span> CPU: '+
Math.ceil(D[r]/1048576)+'MB &nbsp <span style="color:#000000">&FilledSmallSquare;</span> GPU: '+Math.ceil((B[r]+x[r])/1048576)+'MB &nbsp <span style="color:#0000ff">&FilledSmallSquare;</span> Te: '+Math.ceil(B[r]/1048576)+'MB &nbsp <span style="color:#005500">&FilledSmallSquare;</span> Me: '+Math.ceil(x[r]/1048576)+'MB &nbsp <span style="color:#009999">&FilledSmallSquare;</span> Ge: '+Math.ceil(t[r]/1048576)+'MB &nbsp <span style="color:#ff0000">&FilledSmallSquare;</span> Met: '+Math.ceil(v[r]/1048576)+
'MB &nbsp <span style="color:#ffff00">&FilledSmallSquare;</span> Render: '+Math.ceil(H[r]/1048576)+"MB</div>"):u='<span style="color:#555">&FilledSmallSquare;</span> Total: '+Math.round((e+d+n+q)/1048576)+'MB &nbsp <span style="color:#000000">&FilledSmallSquare;</span> CPU: '+Math.ceil(d/1048576)+'MB &nbsp <span style="color:#000000">&FilledSmallSquare;</span> GPU: '+Math.ceil((n+q)/1048576)+'MB &nbsp <span style="color:#0000ff">&FilledSmallSquare;</span> Te '+Math.ceil(n/1048576)+'MB &nbsp <span style="color:#005500">&FilledSmallSquare;</span> Me: '+
Math.ceil(q/1048576)+'MB &nbsp <span style="color:#009999">&FilledSmallSquare;</span> Ge: '+Math.ceil(y/1048576)+'MB &nbsp <span style="color:#ff0000">&FilledSmallSquare;</span> Met: '+Math.ceil(e/1048576)+'MB &nbsp <span style="color:#ffff00">&FilledSmallSquare;</span> Render: '+Math.ceil(w/1048576)+"MB</div>";break;case "Polygons":case "Processing":x=0;e=99999999999;t=d=0;B="Polygons"==a.Hd?b.ko:b.Tn;for(u=0;u<g;u++)x=B[u]>x?B[u]:x,0<B[u]&&(e=B[u]<e?B[u]:e,d+=B[u],t++);m=c/x;for(u=0;u<g;u++)r=k+
u,r%=g,f.fillStyle="#007700",f.fillRect(u*h,c,1,-B[r]*m);1==a.jg?(r=(a.ig+k)%g,u='<span style="color:#007700">&FilledSmallSquare;</span> '+a.Hd+" Max: "+Math.round(B[r])+"</div>"):(u='<span style="color:#007700">&FilledSmallSquare;</span> '+a.Hd+" Max: "+x+"</div>",u=u+(" &nbsp Min: "+e)+(" &nbsp Avrg: "+Math.round(d/t)+"</div>"));break;case "LODs":x=0;B=b.io;for(u=0;u<g;u++)x=B[u][0]>x?B[u][0]:x;m=c/x;f.fillStyle="#000000";f.fillRect(0,0,e,c);for(u=0;u<g;u++)for(r=k+u,r%=g,t=c,x=B[r][1],e=0,d=x.length;e<
d;e++)x[e]&&(f.fillStyle="hsl("+23*e%360+",100%,50%)",b=Math.round(x[e]*m),f.fillRect(u*h,t,1,-b),t-=b);if(1==a.jg)for(r=(a.ig+k)%g,u="LODs:"+B[r][0],x=B[r][1],e=0,d=x.length;e<d;e++)x[e]&&(u+='<span style="color:hsl('+23*e%360+',100%,50%)">&FilledSmallSquare;</span>'+e+":"+x[e]);else u="LODs:"+B[r][0];u+="</div>";break;case "Flux":for(var A=L=r=m=0,O=0,fa=0,H=D=v=w=y=q=n=d=0,B=b.ao,x=b.$n,t=b.Zn,u=0;u<g;u++)b=B[u][0][0]+x[u][0][0],m=b>m?b:m,b=B[u][1][0]+x[u][1][0],m=b>m?b:m,b=B[u][0][1]+x[u][0][1],
r=b>r?b:r,b=B[u][1][1]+x[u][1][1],r=b>r?b:r,L=B[u][0][0]>L?B[u][0][0]:L,A=B[u][0][1]>A?B[u][0][1]:A,O=B[u][1][0]>O?B[u][1][0]:O,fa=B[u][1][1]?B[u][1][1]:fa,d=x[u][0][0]>d?x[u][0][0]:d,n=x[u][0][1]>n?x[u][0][1]:n,q=x[u][1][0]>q?x[u][1][0]:q,y=x[u][1][1]>y?x[u][1][1]:y,w=t[u][0][0]>w?t[u][0][0]:w,v=t[u][0][1]>v?t[u][0][1]:v,D=t[u][1][0]>D?t[u][1][0]:D,H=t[u][1][1]>H?t[u][1][1]:H;m=(.25*c-2)/m;b=(.25*c-2)/r;for(var C=Math.floor(.25*c),da=Math.floor(.75*c),u=0;u<g;u++){var r=k+u,r=r%g,ca=C,V=C+1,Y=da,
ka=da+1;f.fillStyle="#0000aa";f.fillRect(u*h,ca,1,-B[r][0][0]*m);f.fillRect(u*h,V,1,B[r][1][0]*m);f.fillRect(u*h,Y,1,-B[r][0][1]*b);f.fillRect(u*h,ka,1,B[r][1][1]*b);ca-=B[r][0][0]*m;V+=B[r][1][0]*m;Y-=B[r][0][1]*b;ka+=B[r][1][1]*b;f.fillStyle="#007700";f.fillRect(u*h,ca,1,-x[r][0][0]*m);f.fillRect(u*h,V,1,x[r][1][0]*m);f.fillRect(u*h,Y,1,-x[r][0][1]*b);f.fillRect(u*h,ka,1,x[r][1][1]*b);ca-=x[r][0][0]*m;V+=x[r][1][0]*m;Y-=x[r][0][1]*b;ka+=x[r][1][1]*b;f.fillStyle="#009999";f.fillRect(u*h,ca,1,-t[r][0][0]*
m);f.fillRect(u*h,V,1,t[r][1][0]*m);f.fillRect(u*h,Y,1,-t[r][0][1]*b);f.fillRect(u*h,ka,1,t[r][1][1]*b);f.fillStyle="#aaaaaa";f.fillRect(0,Math.floor(.5*c),e,1);f.fillStyle="#dddddd";f.fillRect(0,C,e,1);f.fillRect(0,da,e,1)}1==a.jg?(r=(a.ig+k)%g,u='<span style="color:#007700">&FilledSmallSquare;</span> Textures Count +/-: '+B[r][0][0]+"/"+B[r][1][0],u+=" &nbsp Size +/-: "+(B[r][0][1]/1024/1024).toFixed(2)+"/"+(B[r][1][1]/1024/1024).toFixed(2),u+=' &nbsp <span style="color:#0000aa">&FilledSmallSquare;</span> Meshes Count +/-: '+
x[r][0][0]+"/"+x[r][1][0],u+=" &nbsp Size +/-: "+(x[r][0][1]/1024/1024).toFixed(2)+"/"+(x[r][1][1]/1024/1024).toFixed(2),u+=' &nbsp <span style="color:#009999">&FilledSmallSquare;</span> Geodata Count +/-: '+t[r][0][0]+"/"+t[r][1][0],u+=" &nbsp Size +/-: "+(t[r][0][1]/1024/1024).toFixed(2)+"/"+(t[r][1][1]/1024/1024).toFixed(2)):(u='<span style="color:#007700">&FilledSmallSquare;</span> Textures Count +/-: '+L+"/"+O+(" &nbsp Size +/-: "+(A/1024/1024).toFixed(2)+"/"+(fa/1024/1024).toFixed(2)),u=u+(' &nbsp <span style="color:#0000aa">&FilledSmallSquare;</span> Meshes Count +/-: '+
d+"/"+q)+(" &nbsp Size +/-: "+(n/1024/1024).toFixed(2)+"/"+(y/1024/1024).toFixed(2)),u+=' &nbsp <span style="color:#009999">&FilledSmallSquare;</span> Geodata Count +/-: '+w+"/"+D,u+=" &nbsp Size +/-: "+(v/1024/1024).toFixed(2)+"/"+(H/1024/1024).toFixed(2));u+="</div>"}1==a.jg&&(f.fillStyle="#aa00aa",r=a.ig%g,f.fillRect(Math.floor(r*h)-1,0,1,c),f.fillRect(Math.floor(r*h)+1,0,1,c));document.getElementById("melown-graphs-info2").innerHTML=u}}
function Ca(a){if(a.l.J()){for(var b=[["Drawn Tiles",1],["Drawn Tiles - Free Layers",1],["Traced Nodes",1],["Traced Nodes - Free Layers",1],["Load Sequence",2],["Camera",1],["Globe",0]],c="DrawnTiles DrawnTilesFreeLayers TracedNodes TracedNodesFreeLayers LoadSequence Camera Globe".split(" "),d="",e=0,f=b.length;e<f;e++)d+='<div id="melown-replay-item-'+c[e]+'" class="melown-replay-item"><input id="melown-replay-checkbox-'+c[e]+'" type="checkbox"/><span title='+b[e][0]+">"+b[e][0]+"&nbsp;&nbsp;</span>",
0<b[e][1]&&(d+='<input id="melown-replay-sbutton-'+c[e]+'" type="button" value="S"/>'),1<b[e][1]&&(d+='<input id="melown-replay-fbutton-'+c[e]+'" type="button" value="F"/>'),d+="</div>";a.Mx.innerHTML=d;e=0;for(f=b.length;e<f;e++)d="melown-replay-checkbox-"+c[e],document.getElementById(d).onchange=a.gy.bind(a,c[e],d),0<b[e][1]&&(d="melown-replay-sbutton-"+c[e],document.getElementById(d).onclick=a.Ip.bind(a,c[e],"S")),1<b[e][1]&&(d="melown-replay-fbutton-"+c[e],document.getElementById(d).onclick=a.Ip.bind(a,
c[e],"F"))}a.Se.style.display="block";a.Jp=!0;if(b=a.l.J())Va(a,b.w.Kd),Ya(a)}
l.oe=function(a,b){if("lod"==a)switch(b){case "up":this.Hf.stepUp();this.Hg.value=this.Hf.value;break;case "down":this.Hf.stepDown();this.Hg.value=this.Hf.value;break;default:this.Hg.value=this.Hf.value}else switch(b){case "up":this.Te.stepUp();this.Ig.value=this.Te.value;break;case "down":this.Te.stepDown();this.Ig.value=this.Te.value;break;default:this.Ig.value=this.Te.value}var c=this.l.J();c&&("lod"==a?(c.w.ua=parseFloat(this.Hg.value),c.w.at=document.getElementById("melown-replay-lod-single").checked):
(c.w.Kd=parseFloat(this.Ig.value),c.w.bt=document.getElementById("melown-replay-time-single").checked,Va(this,c.w.Kd),Ya(this)),z(c))};l.zs=function(a){"lod"==a?this.Hf.value=this.Hg.value:this.Te.value=this.Ig.value;var b=this.l.J();b&&("lod"==a?b.w.ua=parseFloat(this.Hg.value):(b.w.Kd=parseFloat(this.Ig.value),Va(this,b.w.Kd),Ya(this)),z(b))};
l.Ip=function(a,b){var c=this.l.J();if(c){switch(a){case "DrawnTiles":c.w.wi=!0;break;case "DrawnTilesFreeLayers":c.w.vi=!0;break;case "TracedNodes":c.w.Tg=!0;break;case "TracedNodesFreeLayers":c.w.Sg=!0;break;case "LoadSequence":c.w.vm="S"==b;"S"==b?(c.w.Kd=0,c.w.zc=[]):(Va(this,c.w.Kd),Ya(this));break;case "Camera":var d=c.w.P={Vb:c.Vb,ka:c.ka.slice(),$d:c.$d.slice(),rk:c.rk.slice(),wd:c.wd},e=this.l.nf();this.l.xj.sa();var f=d.ka;this.km=[f,d.rk];this.Ff=[[f],[f],[f],[f]];var g=16,k=this.l.J(),
h,m=k.P;m.Ea&&m.update();h=m.Kg;m=p.i.create();p.i.inverse(h,m);this.Cx=m;h=Math.tan(p.Ga(k.P.je()));var n=h*k.P.ve;h=Math.atan(Math.sqrt(h*h+n*n)/1);for(var n=d.Vb/g,q=.5*n*Math.tan(h),y=q*k.P.ve,w=0;w<g;w++){var t=[-y,-q,-n],v=[y,-q,-n],D=[y,q,-n],B=[-y,q,-n];p.D.scale(t,w+1);p.D.scale(v,w+1);p.D.scale(D,w+1);p.D.scale(B,w+1);p.i.Ma(m,t);p.i.Ma(m,v);p.i.Ma(m,D);p.i.Ma(m,B);p.D.add(t,f);p.D.add(v,f);p.D.add(D,f);p.D.add(B,f);this.Ff[0].push(t);this.Ff[1].push(v);this.Ff[2].push(D);this.Ff[3].push(B)}this.Gf=
[[f],[f],[f],[f]];g=256;n=(d.Vb+12742E3*1.1)/g;q=.5*n*Math.tan(h);y=q*k.P.ve;for(w=0;w<g;w++)t=[-y,-q,-n],v=[y,-q,-n],D=[y,q,-n],B=[-y,q,-n],p.D.scale(t,w+1),p.D.scale(v,w+1),p.D.scale(D,w+1),p.D.scale(B,w+1),p.i.Ma(m,t),p.i.Ma(m,v),p.i.Ma(m,D),p.i.Ma(m,B),p.D.add(t,f),p.D.add(v,f),p.D.add(D,f),p.D.add(B,f),this.Gf[0].push(t),this.Gf[1].push(v),this.Gf[2].push(D),this.Gf[3].push(B);t=[-y,-q,-n];v=[y,-q,-n];D=[y,q,-n];B=[-y,q,-n];p.D.scale(t,g);p.D.scale(v,g);p.D.scale(D,g);p.D.scale(B,g);f=[0,0,0];
d=[f[0],f[1],f[2],t[0],t[1],t[2],v[0],v[1],v[2],f[0],f[1],f[2],v[0],v[1],v[2],D[0],D[1],D[2],f[0],f[1],f[2],D[0],D[1],D[2],B[0],B[1],B[2],f[0],f[1],f[2],B[0],B[1],B[2],t[0],t[1],t[2]];this.Ex=e.Lc({blend:!0,zwrite:!1,ztest:!0,culling:!1});this.Dx=e.Rq({vertices:d,uvs:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],normals:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]});this.Ps=!0}z(c)}};
l.gy=function(a,b){var c=document.getElementById(b),d=this.l.J();if(d){switch(a){case "DrawnTiles":d.w.zn=c.checked;break;case "DrawnTilesFreeLayers":d.w.Kk=c.checked;break;case "TracedNodes":d.w.sn=c.checked;break;case "TracedNodesFreeLayers":d.w.pn=c.checked;break;case "LoadSequence":d.w.Lk=c.checked;break;case "Camera":this.Ps||this.Ip("Camera");this.er=c.checked;break;case "Globe":var e=this.l.Dd();this.Qs||(this.Qs=new Za(e.j,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAEACAMAAADyTj5VAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0Mzk4RkVFMzlGNjUxMUU2OTBDM0I0OEM1NjU0RURBMyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0Mzk4RkVFNDlGNjUxMUU2OTBDM0I0OEM1NjU0RURBMyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQzOThGRUUxOUY2NTExRTY5MEMzQjQ4QzU2NTRFREEzIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjQzOThGRUUyOUY2NTExRTY5MEMzQjQ4QzU2NTRFREEzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+5rvbhAAAAAZQTFRFwcHBLS0tMDfv/wAAAiZJREFUeNrs2LENAEEIA0HTf9ME5DTgIZn8ta+TnLjymzuW6kMIwIcQgA8hAAqAAmBdAM4O4E/wBPgQAqAAKAAKgAKgHcDZAegJoAAoAAqAAqAAaAdwdgB6AigACoACoAAoANoBnB2AngAKgAKgACgACoB2AGcHoCeAAqAAKAAKgAKgHcDZAegJoAAoAAqAAqAAaAdwdgB6AigACoACoAAoANoBnB2AngAKgAKgACgACoB2AGcHoCeAAqAAKAAKgAKgHcDZAegJoAAoAAqAAqAAaAdwdgB6AigACoACEIAPIQAfwg7g7AD0BFAAFAAFQAFQALQDODsAPQEUAAVAAVAAFADtAM4OQE8ABUABUAAUAAVAO4CzA9ATQAFQABQABUAB0A7g7AD0BFAAFAAFQAFQALQDODsAPQEUAAVAAVAAFADtAM4OQE8ABUABUAAUAAVAO4CzA9ATQAFQABQABUAB0A7g7AD0BFAAFAAFQAFQALQDODsAPQEUAAVAAVAAFADtAM4OQE8ABSAAH0IAPoQAfAgB0A7g7AD0BFAAFAAFQAFQALQDODsAPQEUAAVAAVAAFADtAM4OQE8ABUABUAAUAAVAO4CzA9ATQAFQABQABUAB0A7g7AD0BFAAFAAFQAFQALQDODsAPQEUAAVAAVAAFADtAM4OQE8ABUABUAAUAAVAO4CzA9ATQAFQABQABUAB0A7g7AD0BFAAFAAFQAFQAPxcAQYAZt2IEFFJhxsAAAAASUVORK5CYII=",
this.l,null,!0));this.fr=c.checked;d.w.br=this.fr}z(d)}};
function Ya(a){var b,c=a.l.J();if(c){var d=c.w.zc;b=c.w.Kd;a.Te.max=d.length;var e;a.hi.fillStyle="#000000";a.hi.fillRect(0,0,340,30);a.ki.fillStyle="#000000";a.ki.fillRect(0,0,340,30);a.ji.fillStyle="#000000";a.ji.fillRect(0,0,340,30);a.gi.fillStyle="#000000";a.gi.fillRect(0,0,340,30);a.ii.fillStyle="#000000";a.ii.fillRect(0,0,340,30);a.Fg.fillStyle="#000000";a.Fg.fillRect(0,0,340,30);a.Gg.fillStyle="#000000";a.Gg.fillRect(0,0,340,30);for(var f=340*Math.floor(c.w.Kd/340),g=f,k=339,f=0;f<k;f++){var h=
d[f+g];if(h){switch(h.og){case "mesh":e=a.hi;break;case "texture-in":e=a.ki;break;case "texture-ex":e=a.ji;break;case "geodata":e=a.gi;break;case "metatile":e=a.ii;break;default:continue}var m=Math.round(Math.min(255,60+20*Math.max(1,h.O/300)));e.fillStyle="rgb("+m+","+m+","+m+")";m=h.O/300*30;e.fillRect(f,30,1,-m);m=Math.round(Math.min(255,60+20*Math.max(1,h.ul/300)));a.Fg.fillStyle="rgb("+m+","+m+","+m+")";m=h.ul/300*30;a.Fg.fillRect(f,30,1,-m);a.Gg.fillStyle="rgb(80,80,80)";m=h.Yc/c.f.wj*30;a.Gg.fillRect(f,
30,1,-m)}}for(var c=Number.MAX_VALUE,n=m=e=0,q=Number.MAX_VALUE,y=0,w=0,t=0,v=Number.MAX_VALUE,D=0,B=0,x=0,H=Number.MAX_VALUE,u=0,L=0,r=0,A=Number.MAX_VALUE,O=0,fa=0,C=0,da=Number.MAX_VALUE,ca=0,V=0,Y=0,ka=Number.MAX_VALUE,Ba=0,Ia=0,Ea=0,k=d.length,f=0;f<k;f++)if(h=d[f]){switch(h.og){case "mesh":h.O<c&&(c=h.O);h.O>e&&(e=h.O);m+=h.O;n++;break;case "texture-in":h.O<q&&(q=h.O);h.O>y&&(y=h.O);w+=h.O;t++;break;case "texture-ex":h.O<v&&(v=h.O);h.O>D&&(D=h.O);B+=h.O;x++;break;case "geodata":h.O<H&&(H=h.O);
h.O>u&&(u=h.O);L+=h.O;r++;break;case "metatile":h.O<A&&(A=h.O);h.O>O&&(O=h.O);fa+=h.O;C++;break;default:continue}h.Yc<da&&(da=h.Yc);h.Yc>ca&&(ca=h.Yc);V+=h.Yc;Y++;h.Yc<ka&&(ka=h.Yc);h.Yc>Ba&&(Ba=h.Yc);Ia+=h.Yc;Ea++}b-=g;a.hi.fillStyle="#ff0000";a.hi.fillRect(b-1,0,1,30);a.hi.fillRect(b+1,0,1,30);a.ki.fillStyle="#ff0000";a.ki.fillRect(b-1,0,1,30);a.ki.fillRect(b+1,0,1,30);a.ji.fillStyle="#ff0000";a.ji.fillRect(b-1,0,1,30);a.ji.fillRect(b+1,0,1,30);a.gi.fillStyle="#ff0000";a.gi.fillRect(b-1,0,1,30);
a.gi.fillRect(b+1,0,1,30);a.ii.fillStyle="#ff0000";a.ii.fillRect(b-1,0,1,30);a.ii.fillRect(b+1,0,1,30);a.Fg.fillStyle="#ff0000";a.Fg.fillRect(b-1,0,1,30);a.Fg.fillRect(b+1,0,1,30);a.Gg.fillStyle="#ff0000";a.Gg.fillRect(b-1,0,1,30);a.Gg.fillRect(b+1,0,1,30);n||(e=c=0);t||(y=q=0);x||(D=v=0);r||(u=H=0);C||(O=A=0);Y||(ca=da=0);Ea||(Ba=ka=0);a.Hx.innerHTML="Meshes Min/Max/Avg/Count: "+c.toFixed(0)+"/"+e.toFixed(0)+"/"+(n?m/n:0).toFixed(1)+"/"+n;a.Kx.innerHTML="Internal Textures Min/Max/Avg/Count: "+q.toFixed(0)+
"/"+y.toFixed(0)+"/"+(t?w/t:0).toFixed(1)+"/"+t;a.Jx.innerHTML="External Textures Min/Max/Avg/Count: "+v.toFixed(0)+"/"+D.toFixed(0)+"/"+(x?B/x:0).toFixed(1)+"/"+x;a.Fx.innerHTML="Geodata Min/Max/Avg/Count: "+H.toFixed(0)+"/"+u.toFixed(0)+"/"+(r?L/r:0).toFixed(1)+"/"+r;a.Ix.innerHTML="Metatiles Min/Max/Avg/Count: "+A.toFixed(0)+"/"+O.toFixed(0)+"/"+(C?fa/C:0).toFixed(1)+"/"+C;a.Gx.innerHTML="Intervals Min/Max/Avg: "+ka.toFixed(0)+"/"+Ba.toFixed(0)+"/"+(Ea?Ia/Ea:0).toFixed(1);a.Lx.innerHTML="Threads Min/Max/Avg: "+
da+"/"+ca+"/"+(Y?V/Y:0).toFixed(1)}}function Va(a,b){var c=a.l.J();c&&(c=c.w.zc[b],a.Nx.innerHTML=c?"Resource Kind: "+c.og+"<br/>Time: "+c.Am.toFixed(2)+"<br/>Duration: "+c.O.toFixed(2)+"<br/>Interval: "+c.ul.toFixed(2)+"<br/>Priority: "+c.Vc.toFixed(2)+"<br/>Threads: "+c.Yc+"<br/>"+c.Td:"")}
function $a(a){a=this.u=a.u;if(null!=a){this.Z=null;this.Z=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.Z);var b=[0,0,0,1,0,0,1,0,0,1,1,0,1,1,0,0,1,0,0,1,0,0,0,0,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,0,1,1,0,1,1,0,0,1,0,0,0,0,0,1,1,0,0,1,0,1,1,1,0,1,1,1,0,1,0,0,1,1];a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);this.Z.za=3;this.Z.oa=b.length/3;this.v=36;this.Ho=this.Z.oa/3}}$a.prototype.I=function(){this.u.deleteBuffer(this.Z)};
$a.prototype.jb=function(a,b){var c=this.u;if(null!=c){var d=a.getAttribute(b);c.bindBuffer(c.ARRAY_BUFFER,this.Z);c.vertexAttribPointer(d,this.Z.za,c.FLOAT,!1,0,0);c.drawArrays(c.LINES,0,this.Z.oa)}};function ab(a,b,c,d){this.ee=a;this.eb=null;this.wa=b;this.Sq=null;this.js=8;this.fw=new Uint8Array(this.js);this.Du=new Uint8Array(this.js);this.Tq=this.mu=this.Lc({});this.Mr=null==c?!1:c;this.Rt=d?!0:!1}l=ab.prototype;
l.Eb=function(){this.eb=document.createElement("canvas");if(null!=this.eb&&(this.eb.width=this.wa[0],this.eb.height=this.wa[1],this.eb.style.display="block",null!=this.eb.getContext)){try{this.u=this.eb.getContext("webgl",{preserveDrawingBuffer:this.Mr,antialias:this.Rt,stencil:!0})||this.eb.getContext("experimental-webgl",{preserveDrawingBuffer:this.Mr})}catch(a){}this.u&&(this.u.getExtension("OES_standard_derivatives"),this.ee.appendChild(this.eb),this.u.tq=this.eb.width,this.u.sq=this.eb.height,
this.u.clearColor(0,0,0,1),this.u.enable(this.u.DEPTH_TEST),this.u.viewport(0,0,this.u.tq,this.u.sq),this.u.clear(this.u.COLOR_BUFFER_BIT|this.u.DEPTH_BUFFER_BIT))}};l.I=function(){this.ee.removeChild(this.eb);delete this.eb;this.eb=null};l.resize=function(a,b){this.wa=a;null!=this.eb&&1!=b&&(this.eb.width=this.wa[0],this.eb.height=this.wa[1]);null!=this.u&&(this.u.tq=this.eb.width,this.u.sq=this.eb.height)};function bb(a){a.u.viewport(0,0,a.u.tq,a.u.sq)}
l.clear=function(a,b,c){null!=c&&this.u.clearColor(c[0]/255,c[1]/255,c[2]/255,c[3]/255);this.u.clear((b?this.u.COLOR_BUFFER_BIT:0)|(a?this.u.DEPTH_BUFFER_BIT:0))};
l.useProgram=function(a,b,c){if(this.Sq!=a){this.u.useProgram(a.ib);this.Sq=a;pa(a,"uSampler",0);c&&pa(a,"uSampler2",1);c=this.fw;for(var d=this.Du,e=0,f=c.length;e<f;e++)c[e]=0;e=0;for(f=b.length;e<f;e++){var g=a.getAttribute(b[e]);-1!=g&&(c[g]=1)}e=0;for(f=c.length;e<f;e++)d[e]!=c[e]&&(c[e]?(this.u.enableVertexAttribArray(e),d[e]=1):(this.u.disableVertexAttribArray(e),d[e]=0))}};
l.bindTexture=function(a,b){0!=a.zc&&(this.u.activeTexture(b?this.u.TEXTURE1:this.u.TEXTURE0),this.u.bindTexture(this.u.TEXTURE_2D,a.U))};p.Ly=function(){return!0};function cb(a,b){null!=b?a.u.bindFramebuffer(a.u.FRAMEBUFFER,b.lr):(a.u.bindTexture(a.u.TEXTURE_2D,null),a.u.bindRenderbuffer(a.u.RENDERBUFFER,null),a.u.bindFramebuffer(a.u.FRAMEBUFFER,null))}
ab.prototype.Lc=function(a){null==a.ud&&(a.ud=!1);null==a.ti&&(a.ti=!1);null==a.cf&&(a.cf=!0);null==a.Nf&&(a.Nf=!0);null==a.Bi&&(a.Bi=!1);null==a.ce&&(a.ce=!0);return a};
ab.prototype.Gc=function(a){var b=this.u,c=this.Tq;c.ud!=a.ud&&(1==a.ud?(b.blendEquationSeparate(b.FUNC_ADD,b.FUNC_ADD),b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA),b.enable(b.BLEND)):b.disable(b.BLEND));c.ti!=a.ti&&(1==a.ti?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST));c.cf!=a.cf&&(1==a.cf?b.depthMask(!0):b.depthMask(!1));c.Nf!=a.Nf&&(0!=a.Nf?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST));c.Bi!=a.Bi&&(0!=a.Bi?b.depthFunc(b.LEQUAL):b.depthFunc(b.LESS));
c.ce!=a.ce&&(1==a.ce?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE));this.Tq=a};function eb(a,b,c,d){this.A=null;this.j=a;this.u=a.u;this.l=b;this.xe=[];this.Jf=0;this.he=c;this.v=d;this.U=this.Ra=null;this.En(c,d)}eb.prototype.I=function(){};
eb.prototype.En=function(a,b){null==a&&(a="Arial, 'Helvetica Neue', Helvetica, sans-serif");null==b&&(b=10);var c=1/512,d=1/512,e=document.createElement("canvas");e.width=512;e.height=512;e=e.getContext("2d");e.beginPath();e.font=b+"pt "+a;e.textAlign="left";e.textBaseline="top";e.fillStyle="#ffffff";e.strokeStyle="#000000";e.lineWidth=5;e.lineCap="round";e.lineJoin="round";var f=Math.round(.5*e.lineWidth),g=e.lineWidth+2,k=g,h=g,m=Math.floor(2.5*e.measureText("e").width);this.xe=[];this.Jf=m;this.v=
b;this.he=a;for(var n=[],q=33;191>q;q++)n.push(q);for(q=192;688>q;q++)n.push(q);for(var n=n.concat(32,8230,8216,8217,8218,8219,8220,8221,8222,8242,8243,8252),q=0,y=n.length;q<y;q++){var w=String.fromCharCode(n[q]),t=Math.round(e.measureText(w).width),v=t+e.lineWidth;512<=k+t+g&&(k=g,h+=m+g);e.strokeText(w,k+f,h);e.fillText(w,k+f,h);this.xe[n[q]]={jq:k*c,nq:h*d,kq:(k+v)*c,oq:(h+m)*d,Oo:v,Uv:m,Rg:v-2};k+=v+g}this.Ra=e.getImageData(0,0,512,512);this.U=new Za(this.j,null);fb(this.U,this.Ra,"linear");
this.U.bf=512;this.U.Kh=512;this.U.v=1048576};eb.prototype.size=function(){return this.v};function gb(a,b,c,d,e){this.g=a;this.A=null;this.zg=c||[0,0,0];this.j=d;this.u=d.u;this.m=e;this.Ke=[];this.Ef=0;null!=b&&null!=b[0]&&null!=b[1]&&(this.A=new ib(b[0][0],b[0][1],b[0][2],b[1][0],b[1][1],b[1][2]));this.ic=this.v=0}
gb.prototype.I=function(){for(var a=0,b=this.Ke.length;a<b;a++){var c=this.Ke[a];switch(c.R){case "flat-line":c.Z&&this.u.deleteBuffer(c.Z);break;case "flat-tline":case "pixel-line":case "pixel-tline":c.Z&&this.u.deleteBuffer(c.Z);c.ah&&this.u.deleteBuffer(c.ah);break;case "line-label":c.Z&&this.u.deleteBuffer(c.Z);c.bc&&this.u.deleteBuffer(c.bc);break;case "icon":case "label":c.Z&&this.u.deleteBuffer(c.Z),c.bc&&this.u.deleteBuffer(c.bc),c.Mf&&this.u.deleteBuffer(c.Mf)}}};gb.prototype.size=function(){return this.v};
function jb(a,b){var c=a.u,d=b.vertexBuffer,e=b.normalBuffer,f=b.color,g=1/255,k={};k.R=b.type;k.ib=b.program;k.ae=[f[0]*g,f[1]*g,f[2]*g,f[3]*g];k.Ai=b["z-index"]+256;k.Gi=b["click-event"];k.nj=b["hover-event"];k.lj=b.hitable;k.Wi=b.eventInfo;k.Pk=b["enter-event"];k.Fl=b["leave-event"];k.We=b.state;k.Kc=b.center;k.ua=b.lod;k.$r=b["line-width"];k.fh=b["zbuffer-offset"];k.Ef=!1;k.va=!0;if(null!=b.texture){var f=b.texture,h=f[0];k.U=[kb(a.m,h.url,h.filter||"linear",h.tiled||!1),f[1],f[2],f[3],f[4]];
h=b.background;0!=h[3]&&(k.mk=[h[0]*g,h[1]*g,h[2]*g,h[3]*g])}switch(k.R){case "flat-tline":k.ib=0!=h[3]?a.m.nx:a.m.ox;break;case "pixel-line":k.ib=a.m.ix;break;case "pixel-tline":k.ib=0!=h[3]?a.m.px:a.m.qx}k.Z=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,k.Z);c.bufferData(c.ARRAY_BUFFER,d,c.STATIC_DRAW);k.Z.za=4;k.Z.oa=d.length/4;k.ah=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,k.ah);c.bufferData(c.ARRAY_BUFFER,e,c.STATIC_DRAW);k.ah.za=4;k.ah.oa=e.length/4;a.Ke.push(k);a.v+=4*d.length+4*e.length;
a.ic+=d.length/4}
function lb(a,b,c){var d=a.u,e=b.vertexBuffer,f=b.texcoordsBuffer,g=b.originBuffer,k=b.color,h=b.stick,m=1/255,n={};n.R=c?"label":"icon";n.ib=b.program;n.ae=[k[0]*m,k[1]*m,k[2]*m,k[3]*m];n.Ai=b["z-index"]+256;n.zi=b.visibility;n.ce=b.culling;n.Gi=b["click-event"];n.nj=b["hover-event"];n.Pk=b["enter-event"];n.Fl=b["leave-event"];n.lj=b.hitable;n.Wi=b.eventInfo;n.We=b.state;n.Kc=b.center;n.ui=[h[0],h[1],h[2],h[3]*m,h[4]*m,h[5]*m,h[6]*m];n.ua=b.lod;n.fh=b["zbuffer-offset"];n.Ef=!1;n.va=!0;1!=c?(b=b.icon,
n.U=kb(a.m,b.url,b.filter||"linear",b.tiled||!1)):n.U=a.m.he.U;n.Z=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,n.Z);d.bufferData(d.ARRAY_BUFFER,e,d.STATIC_DRAW);n.Z.za=4;n.Z.oa=e.length/4;n.bc=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,n.bc);d.bufferData(d.ARRAY_BUFFER,f,d.STATIC_DRAW);n.bc.za=4;n.bc.oa=f.length/4;n.Mf=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,n.Mf);d.bufferData(d.ARRAY_BUFFER,g,d.STATIC_DRAW);n.Mf.za=3;n.Mf.oa=g.length/3;a.Ke.push(n);a.v+=4*n.Z.oa+4*n.Mf.oa+4*n.bc.oa;a.ic+=
n.Z.oa/4}
gb.prototype.jb=function(a,b,c){if(null==this.g||!1!==this.m.Dv[this.g]){if(1==c){c=p.i.create();var d=p.i.create(),e=this.m.pa,f=this.m.jz[this.g];if(null!=f){var g=f[1],g=[g[0]-e[0],g[1]-e[1],g[2]];p.i.multiply(p.Ic(g[0],g[1],g[2]),f[0],d);p.i.multiply(a,d,d)}else g=[this.zg[0]-e[0],this.zg[1]-e[1],this.zg[2]],p.i.multiply(a,p.Ic(g[0],g[1],g[2]),d);p.i.multiply(b,d,c);a=d;b=c}c=this.m.ka;for(var d=this.m.mg,e=this.m.rj,f=this.m.lp,g=0,k=this.Ke.length;g<k;g++){var h=this.Ke[g];if(("icon"==h.R||
"label"==h.R)&&0<h.zi){var m=h.Kc;if(p.D.length([m[0]-c[0],m[1]-c[1],m[2]-c[2]])>h.zi)continue}if(!f||h.lj)h.sz=a,h.Fj=b,m=h.Ai,d[m][e[m]]=h,e[m]++}}};
p.xu=function(a,b,c,d,e){var f=d.Fj;if(d.va){if(0!=d.We){var g=d.Wi.id;if(null!=g&&null!=c.qo)if(1==d.We){if(c.qo[0].id==g)return}else{if(c.qo[0].id!=g)return}else if(2==d.We)return}var k=d.lj&&c.lp,g=d.ae;if(k){var h=c.Gr,g=[(h&255)/255,(h>>8&255)/255,(h>>16&255)/255,1];c.sv[h]=[d.Wi,d.Kc,d.Gi,d.nj,d.Pk,d.Fl];c.Gr++}switch(d.R){case "flat-line":a.Gc(p.Im);h=c.jx;a.useProgram(h,["aPosition"]);mb(h,"uColor",g);ra(h,"uMVP",f,nb(c,d.fh));a=h.getAttribute("aPosition");b.bindBuffer(b.ARRAY_BUFFER,d.Z);
b.vertexAttribPointer(a,d.Z.za,b.FLOAT,!1,0,0);b.drawArrays(b.TRIANGLES,0,d.Z.oa);break;case "flat-tline":case "pixel-line":case "pixel-tline":a.Gc(p.Im);var h=d.ib,m=[0,0,0,0];if("pixel-line"!=d.R){if(k)k=c.dh;else{var n=d.U;if(null==n||null==n[0])break;k=n[0];m=[0,n[1]/n[0].Kh,(n[1]+n[2])/n[0].Kh,0];m[0]="flat-tline"==d.R?1/d.$r/(k.bf/n[2]):1/k.bf/1}if(0==k.zc)break;a.bindTexture(k)}a.useProgram(h,["aPosition","aNormal"]);mb(h,"uColor",g);ob(h,"uScale",e);ra(h,"uMVP",f,nb(c,d.fh));"pixel-line"!=
d.R&&(null!=d.mk&&mb(h,"uColor2",d.mk),mb(h,"uParams",m),pa(h,"uSampler",0));a=h.getAttribute("aPosition");c=h.getAttribute("aNormal");b.bindBuffer(b.ARRAY_BUFFER,d.Z);b.vertexAttribPointer(a,d.Z.za,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,d.ah);b.vertexAttribPointer(c,d.ah.za,b.FLOAT,!1,0,0);b.drawArrays(b.TRIANGLES,0,d.Z.oa);break;case "line-label":k=k?c.dh:c.he.U;a.Gc(p.wq);h=c.Js;a.bindTexture(k);a.useProgram(h,["aPosition","aTexCoord"]);pa(h,"uSampler",0);ra(h,"uMVP",f,nb(c,d.fh));mb(h,"uVec",
c.Bo);mb(h,"uColor",g);a=h.getAttribute("aPosition");c=h.getAttribute("aTexCoord");b.bindBuffer(b.ARRAY_BUFFER,d.Z);b.vertexAttribPointer(a,d.Z.za,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,d.bc);b.vertexAttribPointer(c,d.bc.za,b.FLOAT,!1,0,0);b.drawArrays(b.TRIANGLES,0,d.Z.oa);break;case "icon":case "label":if(k=k?c.dh:d.U,0!=k.zc){if(180!=d.ce){h=d.Kc;m=c.ka;h=[h[0]-m[0],h[1]-m[1],h[2]-m[2]];if(0!=d.zi){m=p.D.length(h);if(m>d.zi)break;m=1/m;h[0]*=m;h[1]*=m;h[2]*=m}else p.D.normalize(h);d.rs=[0,
0,0];p.D.normalize(d.Kc,d.rs);if(-p.D.Db(h,d.rs)<Math.cos(p.Ga(d.ce)))break}else if(0!=d.zi&&(h=d.Kc,m=c.ka,h=[h[0]-m[0],h[1]-m[1],h[2]-m[2]],m=p.D.length(h),m>d.zi))break;a.Gc(p.wq);m=0;0!=d.ui[0]&&(h=d.ui,m=c.Hq*h[0],m<h[1]?m=0:0!=h[2]&&(n=qb(c,d.Kc,f),n[0]=Math.round(n[0]),c.fd([[n[0],n[1],n[2]],[n[0],n[1]-m,n[2]]],h[2],[h[3],h[4],h[5],h[6]],null,null,null,!0)));h=c.hx;a.bindTexture(k);a.useProgram(h,["aPosition","aTexCoord","aOrigin"]);pa(h,"uSampler",0);ra(h,"uMVP",f,nb(c,d.fh));mb(h,"uScale",
[e[0],e[1],"label"==d.R?1:1/k.bf,2*m]);mb(h,"uColor",g);a=h.getAttribute("aPosition");c=h.getAttribute("aTexCoord");e=h.getAttribute("aOrigin");b.bindBuffer(b.ARRAY_BUFFER,d.Z);b.vertexAttribPointer(a,d.Z.za,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,d.bc);b.vertexAttribPointer(c,d.bc.za,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,d.Mf);b.vertexAttribPointer(e,d.Mf.za,b.FLOAT,!1,0,0);b.drawArrays(b.TRIANGLES,0,d.Z.oa)}}}};
function ub(a,b,c,d){this.u=a.u;this.A=b.A;this.Mc=c;this.l=d;this.Ud=this.Vd=this.ya=null;performance.now();a=b.ca;c=b.dk;d=b.Ht;var e=b.Jy||3,f=b.Fy||2;b=b.Ey||2;var g=this.u;a&&g&&(this.ya=g.createBuffer(),g.bindBuffer(g.ARRAY_BUFFER,this.ya),g.bufferData(g.ARRAY_BUFFER,new Float32Array(a),g.STATIC_DRAW),this.ya.za=e,this.ya.oa=a.length/e,null!=c&&(this.Vd=g.createBuffer(),g.bindBuffer(g.ARRAY_BUFFER,this.Vd),g.bufferData(g.ARRAY_BUFFER,new Float32Array(c),g.STATIC_DRAW),this.Vd.za=f,this.Vd.oa=
c.length/f),null!=d&&(this.Ud=g.createBuffer(),g.bindBuffer(g.ARRAY_BUFFER,this.Ud),g.bufferData(g.ARRAY_BUFFER,new Float32Array(d),g.STATIC_DRAW),this.Ud.za=b,this.Ud.oa=d.length/b),this.v=this.ya.oa*e*4,this.v+=null==c?0:this.Vd.oa*f*4,this.v+=null==d?0:this.Ud.oa*b*4,this.ic=this.ya.oa/3,this.af=!0)}ub.prototype.I=function(){this.u&&this.af&&(this.ya&&this.u.deleteBuffer(this.ya),this.Vd&&this.u.deleteBuffer(this.Vd),this.Ud&&this.u.deleteBuffer(this.Ud),this.Ud=this.Vd=this.ya=null)};
ub.prototype.jb=function(a,b,c,d,e){var f=this.u;null!=f&&this.af&&(b=a.getAttribute(b),f.bindBuffer(f.ARRAY_BUFFER,this.ya),f.vertexAttribPointer(b,this.ya.za,f.FLOAT,!1,0,0),this.Vd&&c&&(c=a.getAttribute(c),f.bindBuffer(f.ARRAY_BUFFER,this.Vd),f.vertexAttribPointer(c,this.Vd.za,f.FLOAT,!1,0,0)),this.Ud&&d&&(d=a.getAttribute(d),f.bindBuffer(f.ARRAY_BUFFER,this.Ud),f.vertexAttribPointer(d,this.Ud.za,f.FLOAT,!1,0,0)),e&&e&&(a=a.getAttribute(e),f.bindBuffer(f.ARRAY_BUFFER,p.gh),f.vertexAttribPointer(a,
p.gh.za,f.FLOAT,!1,0,0)),f.drawArrays(f.TRIANGLES,0,this.ya.oa))};ub.prototype.size=function(){return this.v};function vb(a,b,c,d,e,f){this.A=null;this.j=a;this.u=a.u;this.l=b;performance.now();null!=this.u&&(this.ca=[],this.ya=null,this.Ho=c,this.zl=e,this.yl=f,this.ap=d,this.Eb())}l=vb.prototype;l.I=function(){this.u.deleteBuffer(this.ya)};
l.Eb=function(){if(this.Ho){this.zl&&wb(this,0,this.yl);for(var a=0;a<this.ap;a++){var b=a,c=a+1,d=this.ca.length;this.ca[d]=b;this.ca[d+1]=c;this.ca[d+2]=1;this.ca[d+3]=b;this.ca[d+4]=c;this.ca[d+5]=-1;this.ca[d+6]=c;this.ca[d+7]=b;this.ca[d+8]=1;this.ca[d+9]=b;this.ca[d+10]=c;this.ca[d+11]=1;this.ca[d+12]=c;this.ca[d+13]=b;this.ca[d+14]=1;this.ca[d+15]=c;this.ca[d+16]=b;this.ca[d+17]=-1;this.ic+=2;this.zl&&wb(this,a+1,this.yl)}}else if(this.zl)for(a=0;a<=this.ap;a++)wb(this,a,this.yl);this.compile()};
function wb(a,b,c){var d=a.ca.length,e=2*Math.PI/c;for(i=0;i<c;i++)a.ca[d]=b,a.ca[d+1]=-1,a.ca[d+2]=0,a.ca[d+3]=b,a.ca[d+4]=-2,a.ca[d+5]=e*i,a.ca[d+6]=b,a.ca[d+7]=-2,a.ca[d+8]=e*(i+1),d+=9;a.ic+=c}l.compile=function(){var a=this.u;this.ya=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.ya);a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.ca),a.STATIC_DRAW);this.ya.za=3;this.ya.oa=this.ca.length/3;this.v=24*this.ya.oa;this.ic=this.ya.oa/3};
l.jb=function(a,b,c){var d=this.u;null==d||null==this.ya||c>this.ap||(a=a.getAttribute(b),d.bindBuffer(d.ARRAY_BUFFER,this.ya),d.vertexAttribPointer(a,this.ya.za,d.FLOAT,!1,0,0),a=0,this.Ho&&(a+=6*(c-1)),this.zl&&(a+=3*c*this.yl),d.drawArrays(d.TRIANGLES,0,a))};l.size=function(){return this.v};function xb(a,b,c){this.j=a;this.u=a.u;this.ib=null;this.lq=[];this.Rm=[];this.Xv=new Float32Array(16);this.createProgram(b,c)}
xb.prototype.createShader=function(a,b){var c=this.u;if(!a||!c)return null;var d;d=1!=b?c.createShader(c.FRAGMENT_SHADER):c.createShader(c.VERTEX_SHADER);c.shaderSource(d,a);c.compileShader(d);return c.getShaderParameter(d,c.COMPILE_STATUS)?d:(alert("An error occurred compiling the shaders: "+c.getShaderInfoLog(d)),null)};
xb.prototype.createProgram=function(a,b){var c=this.u;if(null!=c){var d=this.createShader(a,!0),e=this.createShader(b,!1),f=c.createProgram();c.attachShader(f,d);c.attachShader(f,e);c.linkProgram(f);c.getProgramParameter(f,c.LINK_STATUS)||alert("Unable to initialize the shader program.");c.useProgram(f);this.ib=f}};function pa(a,b,c){var d=a.u;null!=d&&null!=a.ib&&(a=a.getUniform(b),null!=a&&d.uniform1i(a,c))}
function ra(a,b,c,d){var e=a.u;null!=e&&null!=a.ib&&(b=a.getUniform(b),null!=b&&(d?(d=1+d,a=a.Xv,a[0]=c[0],a[1]=c[1],a[2]=c[2]*d,a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6]*d,a[7]=c[7],a[8]=c[8]*d,a[9]=c[9]*d,a[10]=c[10]*d,a[11]=c[11]*d,a[12]=c[12],a[13]=c[13],a[14]=c[14]*d,a[15]=c[15],e.uniformMatrix4fv(b,!1,a)):e.uniformMatrix4fv(b,!1,c)))}function yb(a,b,c){var d=a.u;null!=d&&null!=a.ib&&(a=a.getUniform(b),null!=a&&d.uniformMatrix3fv(a,!1,c))}
function ob(a,b,c){var d=a.u;null!=d&&null!=a.ib&&(a=a.getUniform(b),null!=a&&d.uniform2fv(a,c))}function zb(a,b,c){var d=a.u;null!=d&&null!=a.ib&&(a=a.getUniform(b),null!=a&&d.uniform3fv(a,c))}function mb(a,b,c){var d=a.u;null!=d&&null!=a.ib&&(a=a.getUniform(b),null!=a&&d.uniform4fv(a,c))}function Ab(a,b,c){var d=a.u;null!=d&&null!=a.ib&&(a=a.getUniform(b),null!=a&&d.uniform1f(a,c))}function Bb(a,b,c){var d=a.u;null!=d&&null!=a.ib&&(a=a.getUniform(b),null!=a&&d.uniform1fv(a,c))}
xb.prototype.getAttribute=function(a){var b=this.u;if(null!=b&&null!=this.ib)return null==this.Rm[a]?(b=b.getAttribLocation(this.ib,a),this.Rm[a]=b):this.Rm[a]};xb.prototype.getUniform=function(a){var b=this.u;if(null!=b&&null!=this.ib)return null==this.lq[a]?(b=b.getUniformLocation(this.ib,a),this.lq[a]=b):this.lq[a]};p.Xt="attribute vec3 aPosition;\nuniform mat4 uMVP;\nvoid main(){ \ngl_Position = uMVP * vec4(aPosition, 1.0);\n}";p.Wt="precision mediump float;\nvoid main() {\ngl_FragColor = vec4(0.0, 0.0, 1.0, 1.0);\n}";
p.Pv="attribute vec3 aPosition;\nuniform mat4 uMVP;\nvoid main(){ \ngl_Position = uMVP * vec4(aPosition, 1.0);\n}";p.Ov="precision mediump float;\nuniform vec4 uColor;\nvoid main() {\ngl_FragColor = uColor;\n}";p.Lv="attribute vec4 aPosition;\nattribute vec4 aNormal;\nuniform mat4 uMVP;\nuniform vec2 uScale;\nvoid main(){ \nvec4 pp0 = (uMVP * vec4(aPosition.xyz, 1.0));\nif (aNormal.w == 0.0) {\ngl_Position = pp0 + vec4((vec3(aNormal.x*uScale.x*pp0.w, aNormal.y*uScale.y*pp0.w, 0.0)), 0.0);\n} else {\nvec2 pp1 = pp0.xy / pp0.w;\nvec4 pp3 = (uMVP * vec4(aNormal.xyz, 1.0));\nvec2 pp2 = pp3.xy / pp3.w;\nvec2 n = normalize(pp2 - pp1);\ngl_Position = pp0 + vec4((vec3(-n.y*uScale.x*aNormal.w*pp0.w, n.x*uScale.y*aNormal.w*pp0.w, 0.0)), 0.0);\n}\n}";
p.Kv="precision mediump float;\nuniform vec4 uColor;\nvoid main() {\ngl_FragColor = uColor;\n}";p.Nv="attribute vec3 aPosition;\nuniform mat4 uMVP;\nuniform vec3 uScale;\nuniform vec3 uPoints[32];\nvoid main(){ \nvec4 pp0 = (uMVP * vec4(uPoints[int(aPosition.x)], 1.0));\nif (aPosition.y < 0.0) {\nif (aPosition.y == -1.0) {\ngl_Position = pp0;\n} else {\ngl_Position = pp0 + vec4((vec3(-sin(aPosition.z)*uScale.x*uScale.z, cos(aPosition.z)*uScale.y*uScale.z, 0.0)), 0.0);\n}\n} else {\nvec2 pp1 = pp0.xy / pp0.w;\nvec4 pp3 = (uMVP * vec4(uPoints[int(aPosition.y)], 1.0));\nvec2 pp2 = pp3.xy / pp3.w;\nvec2 n = normalize(pp2 - pp1);\ngl_Position = pp0 + vec4((vec3(-n.y*uScale.x*aPosition.z*uScale.z, n.x*uScale.y*aPosition.z*uScale.z, 0.0)), 0.0);\n}\n}";
p.Mv="precision mediump float;\nuniform vec4 uColor;\nvoid main() {\ngl_FragColor = uColor;\n}";p.yt="attribute vec4 aPosition;\nattribute vec4 aNormal;\nuniform mat4 uMVP;\nuniform vec2 uScale;\nuniform vec4 uParams;\nvarying vec2 vTexCoord;\nvoid main(){ \nvec4 p=vec4(aPosition.xyz, 1.0);\np.xy+=aNormal.xy;\nif (aNormal.w == 0.0){\nfloat tcy=(uParams[1]+uParams[2])*0.5;\nfloat tdy=uParams[1]-tcy;\nfloat ty=(aNormal.x == 0.0 && aNormal.y == 0.0)?tcy:tcy+tdy*cos(aNormal.z);\nvTexCoord=vec2(abs(aPosition.w)*uParams[0], ty);\n} else {\nvTexCoord=vec2(abs(aPosition.w)*uParams[0], aPosition.w < 0.0 ? uParams[1] : uParams[2]);\n}\ngl_Position = uMVP * p;\n}";
p.Dt="attribute vec4 aPosition;\nattribute vec4 aNormal;\nuniform mat4 uMVP;\nuniform vec2 uScale;\nuniform vec4 uParams;\nvarying vec2 vTexCoord;\nvoid main(){ \nvec4 pp0 = (uMVP * vec4(aPosition.xyz, 1.0));\nvTexCoord=vec2(abs(aPosition.w)*uParams[0], aPosition.w < 0.0 ? uParams[1] : uParams[2]);\nif (aNormal.w == 0.0) {\ngl_Position = pp0 + vec4((vec3(aNormal.x*uScale.x*pp0.w, aNormal.y*uScale.y*pp0.w, 0.0)), 0.0);\n} else {\nvec2 pp1 = pp0.xy / pp0.w;\nvec4 pp3 = (uMVP * vec4(aNormal.xyz, 1.0));\nvec2 pp2 = pp3.xy / pp3.w;\nvec2 n = normalize(pp2 - pp1);\ngl_Position = pp0 + vec4((vec3(-n.y*uScale.x*aNormal.w*pp0.w, n.x*uScale.y*aNormal.w*pp0.w, 0.0)), 0.0);\n}\n}";
p.xt="precision mediump float;\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform vec4 uColor2;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 c=texture2D(uSampler, vTexCoord)*uColor;\ngl_FragColor = c;\n}";p.pt="precision mediump float;\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform vec4 uColor2;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 c=texture2D(uSampler, vTexCoord)*uColor;\nvec4 c2=uColor2;\nc.xyz*=c.w; c2.xyz*=c2.w;\nc=mix(c,c2,1.0-c.w);\nc.xyz/=(c.w+0.00001);\ngl_FragColor = c;\n}";
p.cx="attribute vec3 aPosition;\nattribute vec3 aNormal;\nuniform mat4 uMVP;\nuniform mat4 uRot;\nuniform vec4 uColor;\nvarying vec4 vColor;\nvoid main(){ \nfloat l = dot((uRot*vec4(aNormal,1.0)).xyz, vec3(0.0,0.0,1.0)) * 0.5;\nvec3 c = uColor.xyz;\nc = (l > 0.0) ? mix(c,vec3(1.0,1.0,1.0),l) : mix(vec3(0.0,0.0,0.0),c,1.0+l);\nvColor = vec4(c, uColor.w);\ngl_Position = uMVP * vec4(aPosition, 1.0);\n}";p.bx="precision mediump float;\nvarying vec4 vColor;\nvoid main() {\ngl_FragColor = vColor;\n}";
p.jy="attribute vec4 aPosition;\nattribute vec4 aTexCoord;\nuniform mat4 uMVP;\nuniform vec4 uVec;\nvarying vec2 vTexCoord;\nvoid main(){ \nvTexCoord = aTexCoord.xy;\nif (dot(uVec.xyz, vec3(aTexCoord.z, aTexCoord.w, aPosition.w)) < 0.0) {\ngl_Position = uMVP * vec4(2.0, 0.0, 0.0, 1.0);\n}else{\ngl_Position = uMVP * vec4(aPosition.xyz, 1.0);\n}\n}";p.ky="attribute vec3 aPosition;\nattribute vec4 aTexCoord;\nuniform mat4 uMVP;\nuniform vec4 uPosition;\nuniform float uDepth;\nvarying vec2 vTexCoord;\nvoid main(){ \nvTexCoord = aTexCoord.xy;\ngl_Position = uMVP*vec4(aPosition[0]+uPosition[0],-aPosition[1]+uPosition[1],uPosition[2],1.0);\n}";
p.vv="attribute vec4 aPosition;\nattribute vec4 aTexCoord;\nattribute vec3 aOrigin;\nuniform mat4 uMVP;\nuniform vec4 uScale;\nvarying vec2 vTexCoord;\nvoid main(){ \nvTexCoord = aTexCoord.xy * uScale[2];\nvec4 pos = (uMVP * vec4(aOrigin, 1.0));\ngl_Position = pos + vec4(aPosition.x*uScale.x*pos.w, (aPosition.y+uScale.w)*uScale.y*pos.w, 0.0, 0.0);\n}";p.$p="precision mediump float;\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 c=texture2D(uSampler, vTexCoord);\nif(c.w < 0.01){ discard; }\ngl_FragColor = c*uColor;\n}";
p.dt="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMVP;\nvarying vec2 vTexCoord;\nvoid main(){ \ngl_Position = uMVP * vec4(aPosition, 1.0);\nvTexCoord = aTexCoord;\n}";p.Vx="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nconst vec4 gray = vec4(0.125, 0.125, 0.125, 1.0);\nvoid main() {\nfloat fade = smoothstep(0.51, 0.55, vTexCoord.t);\ngl_FragColor = mix(texture2D(uSampler, vTexCoord), gray, fade);\n}";p.ay="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uSampler, vTexCoord);\n}";
p.Ut="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform mat3 uNorm;\nvarying vec3 vNormal;\nvarying vec4 vPosition;\nvoid main(){ \nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nvec4 c = uMV * vec4(aPosition, 1.0);\nvNormal = (aPosition.xyz - vec3(0.5));\nvPosition = camSpacePos;\n}";p.St="precision mediump float;\nuniform sampler2D uSampler;\nuniform vec4 uParams;\nuniform vec4 uParams2;\nvarying vec4 vPosition;\nvarying vec3 vNormal;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nconst vec4 fogColor2 = vec4(72.0/255.0, 154.0/255.0, 255.0/255.0, 1.0);\nvoid main() {\nfloat l = dot(normalize(vNormal),-uParams2.xyz);\nl = (1.0-pow(abs(l),uParams.x));\nvec4 c = vec4(mix(fogColor2.xyz, fogColor.xyz, l), l);\ngl_FragColor = c;\n}";
p.Ry="precision mediump float;\nuniform sampler2D uSampler;\nuniform float uNFactor;\nuniform vec2 uRadius;\nuniform vec3 uPos;\nvarying vec4 vPosition;\nvarying vec3 vNormal;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec3 ldir = normalize(-vPosition.xyz);\nvec3 diff = uPos;\nfloat a = dot(ldir, ldir);\nfloat b = 2 * dot(ldir, diff);\nfloat c = dot(diff, diff) - (uRadius[0] * uRadius[0]);\nfloat i = 0;\nfloat discr = b * b - 4 * a * c;\nif (discr > 0.0) {}\n}\ngl_FragColor = fogColor;\n}";
p.Vt="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform vec4 uParams;\nuniform vec4 uParams2;\nvarying vec2 vTexcoords;\nvoid main(){ \ngl_Position = uProj * (uMV * vec4(aPosition, 1.0));\nvec3 position = (aPosition.xyz - vec3(0.5)) * vec3(uParams.w * 2.0);\nvec4 camPos = uParams2;\nfloat SurfaceRadius = uParams.x;\nfloat AtmosphereRadius = uParams.y;\nfloat StretchAmt = uParams.z;\nfloat camHeight = length(camPos.xyz);\nvec3 camToPos = position - camPos.xyz;\nfloat farDist = length(camToPos);\nfloat altitude = max(0.0,camHeight - SurfaceRadius);\nfloat horizonDist = sqrt((altitude*altitude) + (2.0 * SurfaceRadius * altitude));\nfloat maxDot = horizonDist / camHeight;\naltitude = max(0.0,camHeight - AtmosphereRadius);\nhorizonDist = sqrt((altitude*altitude) + (2.0 * AtmosphereRadius * altitude));\nfloat tweakAmount = 0.1;\nfloat minDot = max(tweakAmount,horizonDist / camHeight);\nfloat minDot2 = ((camHeight - SurfaceRadius) * (1.0 / (AtmosphereRadius  - SurfaceRadius))) - (1.0 - tweakAmount);\nminDot = min(minDot, minDot2);\nfloat posDot = dot(camToPos / farDist,-camPos.xyz / camHeight) - minDot;\nfloat height = posDot * (1.0 / (maxDot - minDot));\nvTexcoords.y = height;\nheight -= min(0.0,minDot2 + ((1.0 + StretchAmt) * minDot2));\nvTexcoords.x = height;\n}";
p.Tt="precision mediump float;\nvarying vec2 vTexcoords;\nuniform vec4 uParams3;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nconst vec4 fogColor2 = vec4(72.0/255.0, 154.0/255.0, 255.0/255.0, 1.0);\nconst vec4 fogColor3 = vec4(0.0/255.0, 0.0/255.0, 0.0/255.0, 1.0);\nvoid main() {\nfloat l = vTexcoords.y;\nif (l > uParams3.z){ discard; } else {\nfloat l2 = clamp((l*l)*0.9+0.1, 0.0, 1.5);\ngl_FragColor = vec4(mix(fogColor2.xyz, fogColor.xyz, l2), l);\nif (l > uParams3.x){ gl_FragColor.xyz = mix(gl_FragColor.xyz, fogColor3.xyz, (l-uParams3.x)*uParams3.y); }\n}}";
p.qv="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nuniform mat4 uGridMat;\nuniform float uGridStep1, uGridStep2;\nconst int HMSize = 5;\nconst float HMSize1 = float(HMSize-1);\nuniform float uHeight[HMSize*HMSize];\nvarying vec2 vTexCoord1;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nfloat round(float x) { return floor(x + 0.5); }\nvoid main() {\nvec3 pos = aPosition;\nfloat z = uHeight[int(round(pos.y*HMSize1)*float(HMSize) + round(pos.x*HMSize1))];\nvec4 camSpacePos = uMV * vec4(pos.xy, z, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvec4 gridCoord = uGridMat * vec4(pos, 1.0);\nvTexCoord1 = aTexCoord;\nvTexCoord1 = gridCoord.xy * vec2(uGridStep1);\nvTexCoord2 = gridCoord.xy * vec2(uGridStep2);\n}";
p.ov="precision mediump float;\nuniform sampler2D uSampler;\nuniform float uGridBlend;\nvarying vec2 vTexCoord1;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec4 gridColor = mix(texture2D(uSampler, vTexCoord1), texture2D(uSampler, vTexCoord2), uGridBlend);\ngl_FragColor = mix(fogColor, gridColor, vFogFactor);\n}";p.nv="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nuniform mat4 uGridMat;\nuniform float uGridStep1, uGridStep2;\nconst int HMSize = 5;\nconst float HMSize1 = float(HMSize-1);\nuniform float uHeight[HMSize*HMSize];\nvarying vec2 vTexCoord1;\nvarying vec2 vTexCoord2;\nvarying float vDepth;\nfloat round(float x) { return floor(x + 0.5); }\nvoid main() {\nvec3 pos = aPosition;\nfloat z = uHeight[int(round(pos.y*HMSize1)*float(HMSize) + round(pos.x*HMSize1))];\nvec4 camSpacePos = uMV * vec4(pos.xy, z, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvDepth = camDist;\nvec4 gridCoord = uGridMat * vec4(pos, 1.0);\nvTexCoord1 = aTexCoord;\nvTexCoord1 = gridCoord.xy * vec2(uGridStep1);\nvTexCoord2 = gridCoord.xy * vec2(uGridStep2);\n}";
p.mv="precision mediump float;\nuniform sampler2D uSampler;\nuniform float uGridBlend;\nvarying vec2 vTexCoord1;\nvarying vec2 vTexCoord2;\nvarying float vDepth;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\ngl_FragColor = fract(vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/16581375.0) * vDepth) + (-0.5/255.0);\n}";p.Xw="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform vec4 uParams;\nuniform vec4 uParams3;\nuniform float uPoints[9*3];\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nvec3 quadPoint(int i1, int i2, int i3, float t, float t2) {\nfloat p1x = uPoints[i1], p1y = uPoints[i1+1], p1z = uPoints[i1+2];\nfloat p3x = uPoints[i3], p3y = uPoints[i3+1], p3z = uPoints[i3+2];\nfloat p2x = 2.0*uPoints[i2]-p1x*0.5-p3x*0.5;\nfloat p2y = 2.0*uPoints[i2+1]-p1y*0.5-p3y*0.5;\nfloat p2z = 2.0*uPoints[i2+2]-p1z*0.5-p3z*0.5;\nreturn vec3(t2*t2*p1x+2.0*t2*t*p2x+t*t*p3x, t2*t2*p1y+2.0*t2*t*p2y+t*t*p3y, t2*t2*p1z+2.0*t2*t*p2z+t*t*p3z); }\nvoid main() {\nvec3 indices = aPosition;\nfloat t = aPosition.y * uParams[2];\nfloat t2 = (1.0-t);\nvec3 p1 = quadPoint(0, 3, 6, t, t2);\nvec3 p2 = quadPoint(9, 9+3, 9+6, t, t2);\nvec3 p3 = quadPoint(18, 18+3, 18+6, t, t2);\nt = aPosition.x * uParams[2];\nt2 = (1.0-t);\nfloat p2x = 2.0*p2.x-p1.x*0.5-p3.x*0.5;\nfloat p2y = 2.0*p2.y-p1.y*0.5-p3.y*0.5;\nfloat p2z = 2.0*p2.z-p1.z*0.5-p3.z*0.5;\nvec4 p = vec4(t2*t2*p1.x+2.0*t2*t*p2x+t*t*p3.x, t2*t2*p1.y+2.0*t2*t*p2y+t*t*p3.y, t2*t2*p1.z+2.0*t2*t*p2z+t*t*p3.z, 1);\nvec4 camSpacePos = uMV * p;\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uParams[1] * camDist);\nvec2 uv = aTexCoord;\nuv.x = uv.x * uParams3[2] + uParams3[0];\nuv.y = uv.y * uParams3[3] + uParams3[1];\nvTexCoord = uv;\n}";
p.Uw="precision mediump float;\nuniform sampler2D uSampler;\nuniform vec4 uParams2;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec4 c = mix(texture2D(uSampler, vTexCoord), texture2D(uSampler, vTexCoord*8.0), uParams2[2]);\ngl_FragColor = mix(fogColor, c, vFogFactor);\n}";p.Ww="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform vec4 uParams;\nuniform vec4 uParams3;\nuniform float uPoints[9*3];\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nvec3 quadPoint(int i1, int i2, int i3, float t, float t2) {\nfloat p1x = uPoints[i1], p1y = uPoints[i1+1], p1z = uPoints[i1+2];\nfloat p3x = uPoints[i3], p3y = uPoints[i3+1], p3z = uPoints[i3+2];\nfloat p2x = 2.0*uPoints[i2]-p1x*0.5-p3x*0.5;\nfloat p2y = 2.0*uPoints[i2+1]-p1y*0.5-p3y*0.5;\nfloat p2z = 2.0*uPoints[i2+2]-p1z*0.5-p3z*0.5;\nreturn vec3(t2*t2*p1x+2.0*t2*t*p2x+t*t*p3x, t2*t2*p1y+2.0*t2*t*p2y+t*t*p3y, t2*t2*p1z+2.0*t2*t*p2z+t*t*p3z); }\nvoid main() {\nvec3 indices = aPosition;\nfloat t = aPosition.y * uParams[2];\nfloat t2 = (1.0-t);\nvec3 p1 = quadPoint(0, 3, 6, t, t2);\nvec3 p2 = quadPoint(9, 9+3, 9+6, t, t2);\nvec3 p3 = quadPoint(18, 18+3, 18+6, t, t2);\nt = aPosition.x * uParams[2];\nt2 = (1.0-t);\nfloat p2x = 2.0*p2.x-p1.x*0.5-p3.x*0.5;\nfloat p2y = 2.0*p2.y-p1.y*0.5-p3.y*0.5;\nfloat p2z = 2.0*p2.z-p1.z*0.5-p3.z*0.5;\nvec4 p = vec4(t2*t2*p1.x+2.0*t2*t*p2x+t*t*p3.x, t2*t2*p1.y+2.0*t2*t*p2y+t*t*p3.y, t2*t2*p1.z+2.0*t2*t*p2z+t*t*p3.z, 1);\nvec4 camSpacePos = uMV * p;\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uParams[1] * camDist);\nvec2 uv = aTexCoord;\nuv.x = uv.x * uParams3[2] + uParams3[0];\nuv.y = uv.y * uParams3[3] + uParams3[1];\nvTexCoord = uv;\nvTexCoord2 = p.xy;\n}";
p.Tw="precision mediump float;\nuniform sampler2D uSampler;\nuniform vec4 uParams2;\nuniform vec4 uParams4;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nif (length(uParams4.xy - vTexCoord2.xy) > uParams4.z){ discard; }vec4 c = mix(texture2D(uSampler, vTexCoord), texture2D(uSampler, vTexCoord*8.0), uParams2[2]);\ngl_FragColor = mix(fogColor, c, vFogFactor);\n}";p.vy="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nuniform mat4 uMV, uProj;\nuniform vec4 uParams;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uParams[1] * camDist);\nvTexCoord = aTexCoord;\n}";
p.sy="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\ngl_FragColor = mix(fogColor, texture2D(uSampler, vTexCoord), vFogFactor);\n}";p.rt="attribute vec3 aPosition;\nattribute vec2 aTexCoord2;\nuniform mat4 uMV, uProj;\nuniform vec4 uParams;\nuniform vec4 uTransform;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uParams[1] * camDist);\nvTexCoord = vec2(uTransform[0] * aTexCoord2[0] + uTransform[2], uTransform[1] * aTexCoord2[1] + uTransform[3]);\n}";
p.my="precision mediump float;\nuniform sampler2D uSampler;\nuniform float uAlpha;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec4 c = texture2D(uSampler, vTexCoord);\ngl_FragColor = mix(fogColor, c, vFogFactor);\ngl_FragColor[3] = c.w * uAlpha;\n}";p.ny="precision mediump float;\nuniform sampler2D uSampler;\nuniform sampler2D uSampler2;\nuniform float uAlpha;\nvarying vec2 vTexCoord;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec4 c = texture2D(uSampler, vTexCoord);\nvec4 c2 = texture2D(uSampler2, vTexCoord);\ngl_FragColor = mix(fogColor, c, vFogFactor);\ngl_FragColor[3] = c.w * uAlpha * c2.x;\n}";
p.Ju="attribute vec3 aPosition;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\n}";p.Iu="precision mediump float;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\ngl_FragColor = vec4(fogColor.xyz, 1.0-vFogFactor);\n}";
p.tt="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nattribute vec3 aNormal;\nuniform mat4 uMV, uProj;\nuniform mat3 uNorm;\nuniform float uFogDensity;\nvarying vec2 vTexCoord;\nvarying vec4 vPosition;\nvarying vec3 vNormal;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvTexCoord = aTexCoord;\nvPosition = camSpacePos;\nvNormal = aNormal * uNorm;\n}";
p.uy="precision mediump float;\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying vec4 vPosition;\nvarying vec3 vNormal;\nuniform mat4 uMaterial;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec3 ldir = normalize(-vPosition.xyz);\nvec3 normal = normalize(vNormal);\nvec3 eyeDir = ldir;\nvec3 refDir = reflect(-ldir, normal);\nfloat specW = pow(max(dot(refDir, eyeDir), 0.0), uMaterial[3][0]);\nfloat diffW = max(dot(normal, ldir), 0.0);\nvec4 lcolor = uMaterial[0]+(uMaterial[1]*diffW)+(uMaterial[2]*specW);\nvec4 tcolor = texture2D(uSampler, vTexCoord);\ngl_FragColor = mix(fogColor, vec4(lcolor.xyz*(1.0/255.0), 1.0) * tcolor, vFogFactor);\n}";
p.ty="precision mediump float;\nvarying vec2 vTexCoord;\nvarying vec4 vPosition;\nvarying vec3 vNormal;\nuniform mat4 uMaterial;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nvoid main() {\nvec3 ldir = normalize(-vPosition.xyz);\nvec3 normal = normalize(vNormal);\nvec3 eyeDir = ldir;\nvec3 refDir = reflect(-ldir, normal);\nfloat specW = pow(max(dot(refDir, eyeDir), 0.0), uMaterial[3][0]);\nfloat diffW = max(dot(normal, ldir), 0.0);\nvec4 lcolor = uMaterial[0]+(uMaterial[1]*diffW)+(uMaterial[2]*specW);\ngl_FragColor = mix(fogColor, vec4(lcolor.xyz*(1.0/255.0), 1.0), vFogFactor); gl_FragColor.w=uMaterial[3][1];\n}";
p.ry="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nattribute vec3 aBarycentric;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nvarying vec2 vTexCoord;\nvarying vec3 vBarycentric;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvTexCoord = aTexCoord;\nvBarycentric = camSpacePos.xyz;\n}";p.qy="precision mediump float;\n#extension GL_OES_standard_derivatives : enable\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying vec3 vBarycentric;\nvarying float vFogFactor;\nvoid main() {\n#ifdef GL_OES_standard_derivatives\nvec3 nx = dFdx(vBarycentric);\nvec3 ny = dFdy(vBarycentric);\nvec3 normal=normalize(cross(nx,ny));\ngl_FragColor = vec4(vec3(max(0.0,normal.z*(204.0/255.0))+(32.0/255.0)),1.0);\n#else\ngl_FragColor = vec4(1.0,1.0,1.0,1.0);\n#endif\n}";
p.vt="attribute vec3 aPosition;\nattribute vec2 aTexCoord;\nattribute vec3 aBarycentric;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nvarying vec2 vTexCoord;\nvarying vec3 vBarycentric;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvTexCoord = aTexCoord;\nvBarycentric = aBarycentric;\n}";p.ut="precision mediump float;\n#extension GL_OES_standard_derivatives : enable\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying vec3 vBarycentric;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nfloat edgeFactor(){\n#ifdef GL_OES_standard_derivatives\nvec3 d = fwidth(vBarycentric);\nvec3 a3 = smoothstep(vec3(0.0), d*1.0, vBarycentric);\nreturn min(min(a3.x, a3.y), a3.z);\n#else\nfloat a = min(min(vBarycentric.x, vBarycentric.y), vBarycentric.z);\nreturn a > 0.1 ? 1.0 : smoothstep(0.0,1.0,a*10.0);\n#endif\n}\nvoid main() {\ngl_FragColor = mix(fogColor, vec4( mix(vec3(0.0), texture2D(uSampler, vTexCoord).rgb, edgeFactor()) , 1.0), vFogFactor);\n}";
p.wy="precision mediump float;\n#extension GL_OES_standard_derivatives : enable\nuniform sampler2D uSampler;\nvarying vec2 vTexCoord;\nvarying vec3 vBarycentric;\nvarying float vFogFactor;\nconst vec4 fogColor = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\nfloat edgeFactor(){\n#ifdef GL_OES_standard_derivatives\nvec3 d = fwidth(vBarycentric);\nvec3 a3 = smoothstep(vec3(0.0), d*1.0, vBarycentric);\nreturn min(min(a3.x, a3.y), a3.z);\n#else\nfloat a = min(min(vBarycentric.x, vBarycentric.y), vBarycentric.z);\nreturn a > 0.1 ? 1.0 : smoothstep(0.0,1.0,a*10.0);\n#endif\n}\nvoid main() {\nif (edgeFactor() < 0.5){ gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0); } else { discard; }}";
p.xy="attribute vec3 aPosition;\nattribute vec2 aTexCoord2;\nattribute vec3 aBarycentric;\nuniform mat4 uMV, uProj;\nuniform float uFogDensity;\nvarying vec2 vTexCoord;\nvarying vec3 vBarycentric;\nvarying float vFogFactor;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvFogFactor = exp(uFogDensity * camDist);\nvTexCoord = aTexCoord2;\nvBarycentric = aBarycentric;\n}";p.py="attribute vec3 aPosition;\nuniform mat4 uMV, uProj;\nvarying float vDepth;\nvoid main() {\nvec4 camSpacePos = uMV * vec4(aPosition, 1.0);\ngl_Position = uProj * camSpacePos;\nfloat camDist = length(camSpacePos.xyz);\nvDepth = camDist;\n}";
p.oy="precision mediump float;\nuniform sampler2D uSampler;\nvarying float vDepth;\nvoid main() {\ngl_FragColor = fract(vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/16581375.0) * vDepth) + (-0.5/255.0);\n}";p.zv="\nattribute vec4 aPosition;\nuniform mat4 uProjectionMatrix;\nuniform mat4 uData;\nuniform vec4 uColor;\nuniform float uDepth;\nvarying vec4 vColor;\nvarying vec2 vTexcoords;\nvoid main(void){\nint i=int(aPosition.x);\nif(i==0) gl_Position=uProjectionMatrix*vec4(floor(uData[0][0]+0.1),floor(uData[0][1]+0.1),uDepth,1.0), vTexcoords=vec2(uData[0][2], uData[0][3]);\nif(i==1) gl_Position=uProjectionMatrix*vec4(floor(uData[1][0]+0.1),floor(uData[1][1]+0.1),uDepth,1.0), vTexcoords=vec2(uData[1][2], uData[1][3]);\nif(i==2) gl_Position=uProjectionMatrix*vec4(floor(uData[2][0]+0.1),floor(uData[2][1]+0.1),uDepth,1.0), vTexcoords=vec2(uData[2][2], uData[2][3]);\nif(i==3) gl_Position=uProjectionMatrix*vec4(floor(uData[3][0]+0.1),floor(uData[3][1]+0.1),uDepth,1.0), vTexcoords=vec2(uData[3][2], uData[3][3]);\nvec4 c=uColor*(1.0/255.0);\nc.w*=1.0;\nvColor=c;\n}";
p.yv="precision mediump float;\nvarying vec4 vColor;\nvarying vec2 vTexcoords;\nuniform sampler2D uSampler;\nvoid main(void){\nvec4 c=texture2D(uSampler, vec2(vTexcoords.x, vTexcoords.y) );\nc*=vColor;\nif(c.w < 0.01){ discard; }\ngl_FragColor = c;\n}";function Za(a,b,c,d,e,f,g){this.j=a;this.u=a.u;this.lr=this.U=null;this.v=0;this.Mc=d;this.Kh=this.bf=0;this.Hp=f||!1;this.ir=g||"linear";this.Ra=null;this.zc=!1;this.l=c;null!=b&&this.load(b,null,null,e)}
Za.prototype.I=function(){this.u.deleteTexture(this.U);this.U=null};Za.prototype.size=function(){return this.v};
function Gb(a,b,c,d,e,f){var g=a.u;a.U=g.createTexture();g.bindTexture(g.TEXTURE_2D,a.U);1==f?(f=g.REPEAT,a.Hp=!0):f=g.CLAMP_TO_EDGE;g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,f);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,f);f=!1;switch(e){case "linear":g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR);g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);break;case "trilinear":g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR_MIPMAP_LINEAR);g.texParameteri(g.TEXTURE_2D,
g.TEXTURE_MAG_FILTER,g.LINEAR);f=!0;break;default:g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST)}g.pixelStorei(g.UNPACK_ALIGNMENT,1);g.texImage2D(g.TEXTURE_2D,0,g.RGBA,b,c,0,g.RGBA,g.UNSIGNED_BYTE,d);1==f&&g.generateMipmap(g.TEXTURE_2D);g.bindTexture(g.TEXTURE_2D,null);a.bf=b;a.Kh=c;a.v=b*c*4;a.zc=!0}
function fb(a,b,c,d){var e=a.u;performance.now();a.U=e.createTexture();e.bindTexture(e.TEXTURE_2D,a.U);1==d?(d=e.REPEAT,a.Hp=!0):d=e.CLAMP_TO_EDGE;e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,d);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,d);d=!1;a.ir=c;switch(c){case "linear":e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);break;case "trilinear":e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR);e.texParameteri(e.TEXTURE_2D,
e.TEXTURE_MAG_FILTER,e.LINEAR);d=!0;break;default:e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)}1!=p.gw&&(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,b),1==d&&e.generateMipmap(e.TEXTURE_2D));e.bindTexture(e.TEXTURE_2D,null);a.bf=b.naturalWidth;a.Kh=b.naturalHeight;a.v=b.naturalWidth*b.naturalHeight*4;a.zc=!0}
Za.prototype.load=function(a,b,c,d){this.Ra=p.wb.sl(a,function(){if(null==this.l||1!=this.l.N)fb(this,this.Ra,this.ir,this.Hp),this.Ra=null,b&&b()}.bind(this),function(){(null==this.l||1!=this.l.N)&&c&&c()}.bind(this),null,d)};
Za.prototype.createFramebuffer=function(a,b){if(null!=this.U){var c=this.u,d=c.createFramebuffer();c.bindFramebuffer(c.FRAMEBUFFER,d);d.width=a;d.height=b;c.bindTexture(c.TEXTURE_2D,this.U);var e=c.createRenderbuffer();c.bindRenderbuffer(c.RENDERBUFFER,e);c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,a,b);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,this.U,0);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,e);c.bindTexture(c.TEXTURE_2D,
null);c.bindRenderbuffer(c.RENDERBUFFER,null);c.bindFramebuffer(c.FRAMEBUFFER,null);this.lr=d}};p.zz=1.1;p.Kz=1;p.gw=!1;p.Im=null;
function Hb(a,b,c,d,e){this.f=e||{};this.l=a;this.Js=this.Ks=this.Ls=this.Ap=null;this.ee=b;this.lp=this.Kw=this.kp=this.N=!1;this.qo=null;this.Gr=0;this.sv=[];this.vk=[];this.As=d;this.nj=this.Gi=null;a=this.ee.getBoundingClientRect();this.wa=[a.width,a.height];this.cm=[a.width,a.height];this.Ea=!0;this.$d=[0,1,0];this.j=new ab(b,this.wa,this.f.Fp,this.f.Gp);this.P=new Ib(this,45,2,12E5);p.i.create();p.i.create();p.i.create();p.i.create();this.Zi=this.lg=this.ct=this.Wj=this.kj=this.no=null;this.mj=
1024;this.he=this.Lh=this.Cg=this.Dg=this.di=null;this.Zf=0;this.mg=Array(512);this.rj=Array(512);b=0;for(a=this.mg.length;b<a;b++)this.mg[b]=[],this.rj[b]=0;this.Dv=[];this.Aq={};this.ka=[0,0,0];this.sk=[0,0,0];this.wt=this.Zq=this.Hq=1;this.$d=[0,0,0];this.Bo=[0,0,0];p.i.create();this.Dl=[0,0,100];window.addEventListener("resize",this.em.bind(this),!1);this.j.Eb();this.Ap=new xb(this.j,p.vy,p.sy);this.sx=new xb(this.j,p.rt,p.my);this.tx=new xb(this.j,p.rt,p.ny);this.mx=new xb(this.j,p.tt,p.ty);
this.rx=new xb(this.j,p.tt,p.uy);this.gx=new xb(this.j,p.Ju,p.Iu);this.Ls=new xb(this.j,p.vt,p.ut);this.Ks=new xb(this.j,p.vt,p.wy);this.ux=new xb(this.j,p.xy,p.ut);this.Is=new xb(this.j,p.ry,p.qy);new xb(this.j,p.qv,p.ov);this.lx=new xb(this.j,p.Xw,p.Uw);this.kx=new xb(this.j,p.Ww,p.Tw);new xb(this.j,p.dt,p.Vx);this.zp=new xb(this.j,p.dt,p.ay);this.ex=new xb(this.j,p.Ut,p.St);this.fx=new xb(this.j,p.Vt,p.Tt);this.Hs=new xb(this.j,p.py,p.oy);new xb(this.j,p.nv,p.mv);this.bi=new xb(this.j,p.Xt,p.Wt);
this.jx=new xb(this.j,p.Pv,p.Ov);this.ix=new xb(this.j,p.Lv,p.Kv);this.ci=new xb(this.j,p.Nv,p.Mv);this.ox=new xb(this.j,p.yt,p.xt);this.qx=new xb(this.j,p.Dt,p.xt);this.nx=new xb(this.j,p.yt,p.pt);this.px=new xb(this.j,p.Dt,p.pt);new xb(this.j,p.cx,p.bx);this.Js=new xb(this.j,p.jy,p.$p);new xb(this.j,p.ky,p.$p);this.lb=new xb(this.j,p.zv,p.yv);this.hx=new xb(this.j,p.vv,p.$p);b=p.dc.Yt();this.no=new ub(this.j,b,null,this.l);b=p.dc.Zt();this.Vw=new ub(this.j,b,null,this.l);b=new Uint8Array(16384);
for(a=0;64>a;a++)for(c=0;64>c;c++)d=4*(64*a+c),1>a||63<=a||1>c||63<=c?(b[d]=255,b[d+1]=255,b[d+2]=255):(b[d]=32,b[d+1]=32,b[d+2]=32),b[d+3]=255;this.kj=new Za(this.j);Gb(this.kj,64,64,b,"trilinear",!0);b=p.dc.Cq(32,64);this.Wj=new ub(this.j,b,null,this.l);b=p.dc.Cq(128,256);this.Qm=new ub(this.j,b,null,this.l);b=this.mj;a=new Uint8Array(b*b*4);this.lg=new Za(this.j);Gb(this.lg,b,b,a);this.lg.createFramebuffer(b,b);this.Zi=new Za(this.j);Gb(this.Zi,b,b,a);this.Zi.createFramebuffer(b,b);this.aq=new Za(this.j,
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAACACAMAAADTa0c4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRFAAAA////pdmf3QAABIFJREFUeNrsnNuyqzAIhsP7v/Se6Yxra0L4OUVNCzetVqP5DAQItrVOiLg95739NnfOaR99RDj6esBw+CKZXiMK4PiuBkAcANoHAP3J5fzzAV2jePQIt6f4Ndb/MIChlVcCEFpAACZPfN4KUAF0/ufboDW3AuBMFgBwHTCfg2ftYgDUKBuA1ABuHKvA2P+5XdONIEt7BO2o2MdlAJoTQOsV6GEAswt0Zq/bsBhdeQQkqEDMwmIAnJHzA8i3ASkWRFKBbADyLGB3mlYD6DyhA4DfBlgsBDtirUPcBgC5woStYMgVtgKATWcB6DskKUEkGFLYrGw3+l3ydR16wKbbPDlWp4Xfo9vZwR1jtOMA6GkABrdvNmt1Vluy6pyvxu4Xt62fquyTggCTsIkCoIuv8gAA08w+ATBXAdSRY56xPDFPx/VPWFZp5v65kFMPgFjP70YASMfRsDn01xLPcwkRq1HLMoK647hR8v+nId74MQBjvIbUQePra42ZVXVcBCR3mIY89mYAlNGLflqA0V1seosCQNMg80B0bsLGAIDNwvFyiqu66ngVGGMGVBwyWwIwpty2DqEr/qf0Bq+DbjYkkcr4VUoOxiRjrYn3YY5SC4BQB/cF0Lq4kD1RCJ+tN4g6Jps5zfWu+QmSz9sUABkA0BIAXocmBwCJ99MDIASATkmtLQAIft4IgE/ZDStZ59yQbOQQAGZWYMbZ3FFCAGRHnwHQznegGAE+zwxNi8kALCOgS9tzAC4jYG1Qo0myRm0Ae/z8eleqewBoZLwfUswCsbT1KgBZD6QAzAEoXUe3K+xxVf2uLf5U3nBeMPRyACW/LtrwVX989id3PRQOG5Io6vh9XwC6stHIdGdJozun03lxNlwvH4u6UgDM8/LmJyx7ak12feEebaXmUwCOYJWk1JcYKsl74HL74wAaH93NqkE1FSKXc4cv0AjaPEEPgE4ru/ieWdvzVq/4psG3AYDFHlEAioQCuEgMgPjK1VDrqlkbTABAiQBGK38B0BlBSf9xtiAJQDM4NtDqMlaeyduTtkDjHgAtEQBj5ZGK2QE0aCcMAIxLSw0WVYlGDgOQXWE+afouAM0S398O4Nej3wIQf4cIHSfz9pbWugyep4MFIAFARvspbm8BcE2DOdvWnCJQAWFhJ/hKzh4AaB2A7NxedKmLPc+6PN4cL2S8GYC1QMIEQJvmFsJfxdvkEQAoLV4AogBS8/kNvdXlWe5GKhABvQUAZASDALJffY1XfsrToFXFbvYD1gBo6wC8LR7/uvj9CwHcfWuoUJItsVl5nwWAnhxxqsXatUq0OYCcaS/fkbK61u5H8jwAuUIEZXHNL1Jmub5oSKZWiDR9FttM4HEAigqRpn8TeB2AuWNiByAXSHCGbB7/3qYCfgCgPgADEEskbjCCaJDB/+kR6wP4P1Obl8jsBwDUB4yAxqKkthaATjX0KmCtDyCxm+yIMLjCbwBgrg94FYC3h8vLPPmfAVBSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlLy9fJPgAEAvWMULbGsSjwAAAAASUVORK5CYII=",
this.l,null,!0);b=new Uint8Array(2048);for(a=0;8>a;a++)for(c=0;64>c;c++)d=4*(64*a+c),b[d]=0,b[d+1]=0,b[d+2]=0,b[d+3]=255;b=this.j.u;this.Dg=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,this.Dg);b.bufferData(b.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,2,0,0,1,3,0,0,1]),b.STATIC_DRAW);this.Dg.za=4;this.Dg.oa=4;this.Cg=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.Cg);b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,2,1,0,3,2]),b.STATIC_DRAW);this.Cg.za=1;this.Cg.oa=6;b=new Uint8Array(1024);
for(a=0;16>a;a++)for(c=0;16>c;c++)d=4*(16*a+c),b[d]=255,b[d+1]=0,b[d+2]=0,b[d+3]=255;this.di=new Za(this.j);Gb(this.di,16,16,b);b=new Uint8Array(1024);for(a=0;16>a;a++)for(c=0;16>c;c++)d=4*(16*a+c),b[d]=255,b[d+1]=255,b[d+2]=255,b[d+3]=255;this.dh=new Za(this.j);Gb(this.dh,16,16,b);b=new Uint8Array(1024);for(a=0;16>a;a++)for(c=0;16>c;c++)d=4*(16*a+c),b[d]=0,b[d+1]=0,b[d+2]=0,b[d+3]=255;this.qk=new Za(this.j);Gb(this.qk,16,16,b);e="............................................................ .....xxxxx.......................xxxxx...................... .....xxxxx.......................xxxxx...................... .....xxxxx.......................xxxxx...................... xxxxxxxxxxxxxxxx............xxxxxxxxxxxxxxxx................ xxxxxxxxxxxxxxxx............xxxxxxxxxxxxxxxx................ ............................................................".split(" ");
b=new Uint8Array(2048);for(a=0;8>a;a++)for(c=0;64>c;c++)d=4*(64*a+c),b[d]=0,b[d+1]=0,b[d+2]=0,b[d+3]=0;a=0;for(var f=e.length;a<f;a++){var g=e[a];c=0;for(var k=g.length;c<k;c++)d=4*(64*a+c),"."!=g.charAt(c)&&(b[d]=255,b[d+1]=255,b[d+2]=255,b[d+3]=255)}this.Go=new Za(this.j);Gb(this.Go,64,8,b,"linear",!0);this.nk=new $a(this.j);this.he=new eb(this.j,this.l);this.gm=new Float32Array(96);this.tp=new vb(this.j,this.l,!0,64,!0,8);this.Fs=new vb(this.j,this.l,!1,64,!0,8);b=Array(196605);for(a=0;196605>
a;a+=9)b[a]=1,b[a+1]=0,b[a+2]=0,b[a+3]=0,b[a+4]=1,b[a+5]=0,b[a+6]=0,b[a+7]=0,b[a+8]=1;a=this.j.u;p.gh=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,p.gh);a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);p.gh.za=3;p.gh.oa=b.length/3;1==window.MelownMobile_&&null!=this.j.eb&&(this.j.eb.style.width="100%",this.j.eb.style.height="100%");b=window.MelownScreenScaleFactor_;Jb(this,Math.floor(this.wa[0]*b),Math.floor(this.wa[1]*b))}
Hb.prototype.em=function(){if(1!=this.N){var a=this.ee.getBoundingClientRect();Jb(this,Math.floor(a.width),Math.floor(a.height));this.As&&this.As()}};
Hb.prototype.I=function(){1!=this.N&&(this.N=!0,null!=this.Yw&&this.Yw.I(),this.no&&this.no.I(),this.kj&&this.kj.I(),this.Wj&&this.Wj.I(),this.ct&&this.ct.I(),this.lg&&this.lg.I(),this.Zi&&this.Zi.I(),this.di&&this.di.I(),this.dh&&this.dh.I(),this.qk&&this.qk.I(),this.Go&&this.Go.I(),this.aq&&this.aq.I(),this.Qm&&this.Qm.I(),this.nk&&this.nk.I(),this.he&&this.he.I(),this.tp&&this.tp.I(),this.Fs&&this.Fs.I(),this.j.I())};
function Jb(a,b,c){var d=a.P;d.ve=b/c;d.Ea=!0;a.wa=[b,c];a.cm=[b,c];a.j.resize(a.wa,void 0);a.j.clear(!0,!1);1!=a.Kw&&1!=a.kp&&1!=a.lp&&Kb(a);d=[];d[0]=2/b;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=-2/c;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=.5*-b*d[0];d[13]=.5*-c*d[5];d[14]=0;d[15]=1;a.Lh=d}function qb(a,b,c){b=p.i.am(c,[b[0],b[1],b[2],1]);return 0!=b[3]?(c=[0,0,0],c[0]=.5*(b[0]/b[3]+1)*a.wa[0],c[1]=.5*(-(b[1]/b[3])+1)*a.wa[1],c[2]=b[2]/b[3],c):[0,0,0]}
Hb.prototype.Ch=function(a,b){if(null==this.P)return[0,0,1];var c=[2*a/this.wa[0]-1,1-2*b/this.wa[1],1],d=[c[0],c[1],-1,1],e;p.i.create();e=p.i.inverse(Lb(this.P));c=[0,0,0,0];p.i.am(e,d,c);c[2]=-1;c[3]=0;p.i.create();d=p.i.inverse(Mb(this.P));e=[0,0,0,0];p.i.am(d,c,e);return e=p.D.normalize([e[0],e[1],e[2]])};
function Nb(a,b){var c=a.j.u;switch(b){case "base":var d=a.cm[0],e=a.cm[1];c.clearColor(0,0,0,1);cb(a.j,null);c=a.P;c.ve=d/e;c.Ea=!0;a.wa=[d,e];a.j.resize(a.wa,!0);a.P.update();a.kp=!1;break;case "depth":cb(a.j,a.lg),a.cm=[a.wa[0],a.wa[1]],c.clearColor(1,1,1,1),c.enable(c.DEPTH_TEST),d=a.mj,c.viewport(0,0,d,d),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT),a.wa=[d,d],a.j.clear(),a.P.update(),a.kp=!0}}function nb(a,b){return 1E-4*(b[0]+b[1]*a.Zq+b[2]*a.wt)}
Hb.prototype.mm=function(a,b,c){var d=this.j.u,e=this.wa[0],f=this.wa[1],g=new Uint8Array(e*f*4);d.readPixels(0,0,e,f,d.RGBA,d.UNSIGNED_BYTE,g);for(var d=new Uint8Array(e*f*4),k=0,h=0;h<f;h++){index2_=(f-1-h)*e*4;for(var m=0;m<e;m++)d[k]=g[index2_],d[k+1]=g[index2_+1],d[k+2]=g[index2_+2],d[k+3]=g[index2_+3],k+=4,index2_+=4}g=document.createElement("canvas");g.width=e;g.height=f;k=g.getContext("2d");e=k.createImageData(e,f);e.data.set(d);k.putImageData(e,0,0);c=c||"jpg";if("file"==a){for(var n=document.createElement("a"),
f=g.toDataURL("image/"+c),f=atob(f.split(",")[1]),d=new ArrayBuffer(f.length),k=new Uint8Array(d),h=0;h<f.length;h++)k[h]=f.charCodeAt(h);var q=URL.createObjectURL(new Blob([d],{type:c}));n.href=q;n.download=b;document.body.appendChild(n);n.click();setTimeout(function(){document.body.removeChild(n);window.URL.revokeObjectURL(q)},0)}"tab"==a&&window.open(g.toDataURL("image/"+type_));return e};
function kb(a,b,c,d){var e=b+"*"+c+"*"+d,f=a.Aq[e];null==f&&(f=new Za(a.j,b,a.l,null,null,d,c),a.Aq[e]=f);return f}function E(a){this.m=a;this.j=a.j}l=E.prototype;l.clear=function(a){null!=a&&this.j.clear(a.clearDepth||!0,a.clearColor||!1,a.color||[255,255,255,255],null!=a.depth?a.depth:1);return this};
l.Lc=function(a){return null==a||"object"!==typeof a?this:this.j.Lc({ud:null!=a.blend?a.blend:!1,ti:null!=a.stencil?a.stencil:!1,Rz:null!=a.zoffset?a.zoffset:0,cf:null!=a.zwrite?a.zwrite:!0,Nf:null!=a.ztest?a.ztest:!0,Bi:null!=a.zequal?a.zequal:!0,ce:null!=a.culling?a.culling:!0})};l.Gc=function(a){null!=a&&this.j.Gc(a);return this};
l.createTexture=function(a){if(null==a||"object"!==typeof a)return null;var b=a.source;if(null==b)return null;var c=a.filter||"linear",d=a.repeat||!1;if(b instanceof Uint8Array){var e=a.width;a=a.height;if(e&&a){var f=new Za(this.j);Gb(f,e,a,b,filter,d);return f}}return b instanceof Image?(f=new Za(this.j),fb(f,b,c,d),f):null};l.Ax=function(a){a&&a.I();return this};
l.Rq=function(a){return null==a||"object"!==typeof a?null:new ub(this.j,{ca:a.vertices,dk:a.uvs,Ht:a.normals,Jy:a["vertex-size"],Fy:a["uv-size"],Ey:a["normal-size"]||3,Qz:a["vertex-attr"],Pz:a["uv-attr"],Oz:a["normal-attr"],A:a.bbox},0,this.m.l)};l.xx=function(a){a&&a.I();return this};l.createShader=function(a){if(null==a||"object"!==typeof a)return null;var b=a["vertex-shader"];a=a["fragment-shader"];if(null!=b&&a)return new xb(this.j,b,a)};l.zx=function(a){null!=a&&null!=a.I&&resource.I();return this};
l.Ot=function(){return this};l.cu=function(){return this};
l.dr=function(a){if(null==a||"object"!==typeof a||null==!a.mesh||!a["shader-variables"])return this;var b=a.vertex||"aPosition",c=a.uv||"aTexCoord",d=a.normal||"aNormal",e=a["shader-variables"],f=a.shader||"textured",g=this.m,k=a.mesh;a=a.texture;var h=Mb(g.P),m=Lb(g.P),n=g.Zf;if("string"===typeof f)switch(f){case "hit":e.uMV||(e.uMV=["mat4",h]);e.uProj||(e.uProj=["mat4",m]);a=d=c=null;f=g.Hs;break;case "shaded":c=null;case "textured":case "textured-and-shaded":e.uMV||(e.uMV=["mat4",h]),e.uProj||
(e.uProj=["mat4",m]),e.uFogDensity||(e.uFogDensity=["float",n]),d="textured"==f?null:"aNormal",f="textured"==f?g.Ap:"shaded"==f?g.mx:g.rx}h=[b];c&&h.push(c);d&&h.push(d);g.j.useProgram(f,h);for(var q in e)if(h=e[q],2==h.length)switch(h[0]){case "floatArray":Bb(f,q,h[1]);break;case "float":Ab(f,q,h[1]);break;case "mat3":yb(f,q,h[1]);break;case "mat4":ra(f,q,h[1]);break;case "vec2":ob(f,q,h[1]);break;case "vec3":zb(f,q,h[1]);break;case "vec4":mb(f,q,h[1]);break;case "sampler":pa(f,q,h[1])}a&&g.j.bindTexture(a);
k.jb(f,b,c,d,null);return this};l.drawImage=function(a){if(null==a||"object"!==typeof a||null==a.texture||null==a.rect)return this;var b=a.rect;this.m.drawImage(b[0],b[1],b[2],b[3],a.texture,a.color||[255,255,255,255],null!=a.depth?a.depth:0,null!=a["depth-test"]?a["depth-test"]:!1,null!=a.blend?a.blend:!1,null!=a["write-depth"]?a["write-depth"]:!1,null!=a["use-state"]?a["use-state"]:!1);return this};
l.jn=function(a){if(null==a||"object"!==typeof a||null==a.texture||null==a.mvp)return this;this.m.jn(a.mvp,a.texture,a.color||[255,255,255,255],null!=a["depth-test"]?a["depth-test"]:!1,null!=a.blend?a.blend:!1,null!=a["write-depth"]?a["write-depth"]:!1,null!=a["use-state"]?a["use-state"]:!1);return this};
l.fd=function(a){if(null==a||"object"!==typeof a||null==a.points)return this;this.m.fd(a.points,a.size||2,a.color||[255,255,255,255],null!=a["depth-test"]?a["depth-test"]:!1,null!=a.blend?a.blend:!1,null!=a["write-depth"]?a["write-depth"]:!1,null!=a["use-state"]?a["use-state"]:!1);return this};l.yu=function(){return this};l.sh=function(){return this};
l.wu=function(a){if(null==a||"object"!==typeof a)return this;var b=a.text,c=a.coords;if(!b||!c)return this;var d=a.size||16;Ob(this.m,c[0]-.5*Pb(d,b),c[1],d,b,a.color||[255,255,255,255],a.depth,a["use-state"]||!1);return this};l.mm=function(a,b,c){return this.m.mm(a,b,c)};l.ag=function(a,b){return qb(this.m,a,b)};l.Nu=function(){return this.m.wa.slice()};l.Fc=function(a){this.m.Fc(a);return this};l.mc=function(a,b){this.m.mc(a,b);return this};l.uc=function(a){return this.m.uc(a,value_)};
E.prototype.clear=E.prototype.clear;E.prototype.createState=E.prototype.Lc;E.prototype.setState=E.prototype.Gc;E.prototype.createTexture=E.prototype.createTexture;E.prototype.removeTexture=E.prototype.Ax;E.prototype.createMesh=E.prototype.Rq;E.prototype.removeMesh=E.prototype.xx;E.prototype.createshader=E.prototype.Wy;E.prototype.removeResource=E.prototype.zx;E.prototype.addJob=E.prototype.Ot;E.prototype.clearJobs=E.prototype.cu;E.prototype.drawMesh=E.prototype.dr;E.prototype.drawImage=E.prototype.drawImage;
E.prototype.drawBillboard=E.prototype.jn;E.prototype.drawLineString=E.prototype.fd;E.prototype.drawJobs=E.prototype.yu;E.prototype.drawBBox=E.prototype.sh;E.prototype.drawDebugText=E.prototype.wu;E.prototype.getCanvasCoords=E.prototype.ag;E.prototype.getCanvasSize=E.prototype.Nu;E.prototype.setConfigParams=E.prototype.Fc;E.prototype.setConfigParam=E.prototype.mc;E.prototype.getConfigParam=E.prototype.uc;E.prototype.saveScreenshot=E.prototype.mm;
function ib(a,b,c,d,e,f){this.W=[];this.xa=[];this.W[0]=null!=a?a:Number.POSITIVE_INFINITY;this.W[1]=null!=b?b:Number.POSITIVE_INFINITY;this.W[2]=null!=c?c:Number.POSITIVE_INFINITY;this.xa[0]=null!=d?d:Number.NEGATIVE_INFINITY;this.xa[1]=null!=e?e:Number.NEGATIVE_INFINITY;this.xa[2]=null!=f?f:Number.NEGATIVE_INFINITY;Qb(this)}ib.prototype.clone=function(){return new ib(this.W[0],this.W[1],this.W[2],this.xa[0],this.xa[1],this.xa[2])};function Rb(a,b){return a.xa[b]-a.W[b]}
function Qb(a){a.Dj=Math.abs(Math.max(a.xa[0]-a.W[0],a.xa[1]-a.W[1],a.xa[2]-a.W[2]))}ib.prototype.tk=function(a){return null!=a?(a[0]=.5*(this.W[0]+this.xa[0]),a[1]=.5*(this.W[1]+this.xa[1]),a):[.5*(this.W[0]+this.xa[0]),.5*(this.W[1]+this.xa[1]),.5*(this.W[2]+this.xa[2])]};
function Ib(a,b,c,d){this.Fa=a;this.pa=[0,0,0];this.Bf=[0,0,0];this.ve=1;this.Rk=b;this.Wh=c;this.Xf=d;this.Mp=!1;this.Th=p.i.create();this.Kg=p.i.create();this.Df=p.i.create();this.Ms=p.i.create();this.Fj=p.i.create();this.ps=p.i.create();this.Bd=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];this.yq=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.Vs=[0,0,0,0];this.Ea=!0}l=Ib.prototype;l.setPosition=function(a){this.pa=a;this.Ea=!0};
l.setOrientation=function(a){this.Mp=!1;this.Bf=a;this.Ea=!0};function Da(a,b){a.np=b;a.Ea=!0}l.Qp=function(a,b,c){this.Rk=a;this.Wh=b;this.Xf=c;this.Ea=!0};l.clone=function(a){a=new Ib(this.Fa,null!=a?a:this.je(),this.Wh,this.Xf);a.setPosition(this.sa());a.setOrientation(this.ec());a.ve=this.ve;a.Ea=!0;a.update();return a};l.sa=function(){return[this.pa[0],this.pa[1],this.pa[2]]};l.ec=function(){return[this.Bf[0],this.Bf[1],this.Bf[2]]};l.je=function(){return this.Rk};
function Mb(a){a.Ea&&a.update();return a.Th}function Lb(a){a.Ea&&a.update();return a.Df}function oa(a){a.Ea&&a.update();return a.Fj}function Sb(a,b){a.Ea&&a.update();p.i.Ma(a.Th,b,a.Vs);var c=p.D.length(a.Vs);return c<a.Wh?[Number.POSITIVE_INFINITY,c]:[a.Df[0]/c,c]}
l.Zd=function(a,b){this.Ea&&this.update();var c=a.W,d=a.xa,e=this.yq;if(b)var f=c[0]-b[0],g=c[1]-b[1],c=c[2]-b[2],k=d[0]-b[0],h=d[1]-b[1],m=d[2]-b[2];else f=c[0],g=c[1],c=c[2],k=d[0],h=d[1],m=d[2];d=e[0];d[0]=f;d[1]=g;d[2]=c;d=e[1];d[0]=f;d[1]=g;d[2]=m;d=e[2];d[0]=f;d[1]=h;d[2]=c;d=e[3];d[0]=f;d[1]=h;d[2]=m;d=e[4];d[0]=k;d[1]=g;d[2]=c;d=e[5];d[0]=k;d[1]=g;d[2]=m;d=e[6];d[0]=k;d[1]=h;d[2]=c;d=e[7];d[0]=k;d[1]=h;d[2]=m;f=p.xi.$q;g=this.Bd;for(c=0;6>c;c++){k=!0;for(h=0;8>h;h++)if(0<=f(g[c],e[h])){k=
!1;break}if(k)return!1}return!0};
l.update=function(a){this.Mp||(p.i.multiply(p.Xc(2,p.Ga(-this.Bf[2])),p.Xc(0,p.Ga(-this.Bf[1]-90)),this.Kg),p.i.multiply(this.Kg,p.Xc(2,p.Ga(-this.Bf[0])),this.Kg));p.i.multiply(this.Kg,p.Ic(-this.pa[0],-this.pa[1],-this.pa[2]),this.Th);this.Df=1==this.np?p.Ow(this.qq,this.ve,this.Wh,this.Xf):p.Qw(this.Rk,this.ve,this.Wh,this.Xf);p.i.set(this.Df,this.Ms);if(a){a=1+a;var b=this.Df;b[2]*=a;b[6]*=a;b[10]*=a;b[15]*=a}p.i.multiply(this.Df,this.Th,this.Fj);p.i.multiply(this.Ms,this.Th,this.ps);this.Bd[0]=
[0,0,1,1];this.Bd[1]=[0,0,-1,1];this.Bd[2]=[1,0,0,1];this.Bd[3]=[-1,0,0,1];this.Bd[4]=[0,1,0,1];this.Bd[5]=[0,-1,0,1];a=p.i.create();p.i.te(this.ps,a);for(b=0;6>b;b++)this.Bd[b]=p.i.am(a,this.Bd[b]);this.Ea=!1};
function Kb(a,b,c){if(b){var d=p.i.create();p.i.multiply(p.If(2,2,2),p.Ic(-.5,-.5,-.5),d);var e=p.i.create(),f=a.P.sa();p.i.multiply(p.Ic(f[0],f[1],f[2]-400),p.Ws(Math.min(.9*a.P.Xf,6E5)),e);f=p.i.create();p.i.multiply(oa(a.P),e,f);p.i.multiply(f,d,f);a.j.useProgram(c,["aPosition","aTexCoord"]);a.j.bindTexture(b);pa(c,"uSampler",0);ra(c,"uMVP",f);a.j.u.depthMask(!1);a.Wj.jb(c,"aPosition","aTexCoord");a.j.u.depthMask(!0);a.j.u.enable(a.j.u.CULL_FACE)}}
function Tb(a,b,c,d,e,f,g,k){var h=a.j.u,m=p.i.create();p.i.multiply(p.If(2,2,2),p.Ic(-.5,-.5,-.5),m);var n=[b[0],b[1],b[2]];b=p.i.create();p.i.multiply(p.Ic(n[0],n[1],n[2]),p.Ws(null!=c?c:1.5),b);c=p.i.create();p.i.multiply(Mb(a.P),b,c);p.i.multiply(c,m,c);m=Lb(a.P);b=[0,0,0,0,0,0,0,0,0];p.i.cq(c,b);p.Md.te(b);a.j.useProgram(d,["aPosition"]);a.j.bindTexture(a.di);pa(d,"uSampler",0);ra(d,"uProj",m);ra(d,"uMV",c);k&&(yb(d,"uNorm",b),h.cullFace(h.FRONT));e&&mb(d,"uParams",e);f&&mb(d,"uParams2",f);f&&
mb(d,"uParams3",g);a.Qm.jb(d,"aPosition",null);k&&h.cullFace(h.BACK)}
Hb.prototype.fd=function(a,b,c,d,e,f,g){var k=this.j.u,h=0,m=a.length;if(32<m)for(var n=0;n<m;n+=31)this.fd(a.slice(n,n+32),b,c,d,e,f,g);else{for(n=0;n<m;n++){var q=a[n];this.gm[h]=q[0];this.gm[h+1]=q[1];this.gm[h+2]=q[2]||0;h+=3}1!=g&&(1!=d&&k.disable(k.DEPTH_TEST),1==e&&(k.blendEquationSeparate(k.FUNC_ADD,k.FUNC_ADD),k.blendFuncSeparate(k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA,k.ONE,k.ONE_MINUS_SRC_ALPHA),k.enable(k.BLEND)),!1===f&&k.depthMask(!1),k.disable(k.CULL_FACE));this.j.useProgram(this.ci,["aPosition"]);
ra(this.ci,"uMVP",this.Lh);zb(this.ci,"uScale",[2/this.wa[0],2/this.wa[1],.5*b]);mb(this.ci,"uColor",null!=c?c:[255,255,255,255]);zb(this.ci,"uPoints",this.gm);this.tp.jb(this.ci,"aPosition",m);1!=g&&(1!=d&&k.enable(k.DEPTH_TEST),1==e&&k.disable(k.BLEND),!1===f&&k.depthMask(!1),k.enable(k.CULL_FACE))}};
Hb.prototype.drawImage=function(a,b,c,d,e,f,g,k,h,m,n){if(null!=e&&null!=this.Lh){var q=this.j.u;1!=n&&(1!=k&&q.disable(q.DEPTH_TEST),1==h&&(q.blendEquationSeparate(q.FUNC_ADD,q.FUNC_ADD),q.blendFuncSeparate(q.SRC_ALPHA,q.ONE_MINUS_SRC_ALPHA,q.ONE,q.ONE_MINUS_SRC_ALPHA),q.enable(q.BLEND)),!1===m&&q.depthMask(!1),q.disable(q.CULL_FACE));this.j.useProgram(this.lb,["aPosition"]);this.j.bindTexture(e);e=this.Dg;q.bindBuffer(q.ARRAY_BUFFER,e);q.vertexAttribPointer(this.lb.getAttribute("aPosition"),e.za,
q.FLOAT,!1,0,0);e=this.Cg;q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,e);ra(this.lb,"uProjectionMatrix",this.Lh);ra(this.lb,"uData",[a,b,0,0,a+c,b,1,0,a+c,b+d,1,1,a,b+d,0,1]);mb(this.lb,"uColor",null!=f?f:[255,255,255,255]);Ab(this.lb,"uDepth",null!=g?g:0);q.drawElements(q.TRIANGLES,e.oa,q.UNSIGNED_SHORT,0);1!=n&&(!1===m&&q.depthMask(!0),1!=k&&q.enable(q.DEPTH_TEST),1==h&&q.disable(q.BLEND),q.enable(q.CULL_FACE))}};
Hb.prototype.jn=function(a,b,c,d,e,f,g){var k=this.j.u;1!=g&&(1!=d&&k.disable(k.DEPTH_TEST),1==e&&(k.blendEquationSeparate(k.FUNC_ADD,k.FUNC_ADD),k.blendFuncSeparate(k.SRC_ALPHA,k.ONE_MINUS_SRC_ALPHA,k.ONE,k.ONE_MINUS_SRC_ALPHA),k.enable(k.BLEND)),!1===f&&k.depthMask(!1),k.disable(k.CULL_FACE));this.j.useProgram(this.lb,["aPosition","aTexCoord"]);this.j.bindTexture(b);pa(this.lb,"uSampler",0);b=this.Dg;k.bindBuffer(k.ARRAY_BUFFER,b);k.vertexAttribPointer(this.lb.getAttribute("aPosition"),b.za,k.FLOAT,
!1,0,0);b=this.Cg;k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,b);ra(this.lb,"uProjectionMatrix",a);ra(this.lb,"uData",[0,0,0,0,1,0,1,0,1,1,1,1,0,1,0,1]);mb(this.lb,"uColor",null!=c?c:[255,255,255,255]);Ab(this.lb,"uDepth",0);k.drawElements(k.TRIANGLES,b.oa,k.UNSIGNED_SHORT,0);1!=g&&(!1===f&&k.depthMask(!0),1!=d&&k.enable(k.DEPTH_TEST),1==e&&k.disable(k.BLEND),k.enable(k.CULL_FACE))};
function Ob(a,b,c,d,e,f,g,k){if(null!=a.Lh){var h=a.j.u;1!=k&&(h.disable(h.CULL_FACE),null==g?h.disable(h.DEPTH_TEST):(h.depthFunc(h.LEQUAL),h.enable(h.DEPTH_TEST)));a.j.useProgram(a.lb,["aPosition"]);a.j.bindTexture(a.aq);var m=a.Dg;h.bindBuffer(h.ARRAY_BUFFER,m);h.vertexAttribPointer(a.lb.getAttribute("aPosition"),m.za,h.FLOAT,!1,0,0);m=a.Cg;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,m);ra(a.lb,"uProjectionMatrix",a.Lh);mb(a.lb,"uColor",f);Ab(a.lb,"uDepth",null!=g?g:0);f=d-1;var n=Math.round(.5*d),q=1/
256,y=Pb(d,e)+2,w=0,t=(w&15)<<4,v=w>>4<<4;ra(a.lb,"uData",[b-2,c-2,t*q,.0078125*v,b-2+y,c-2,(t+15)*q,.0078125*v,b-2+y,c+d+1,(t+15)*q,.0078125*(v+15),b-2,c+d+1,t*q,.0078125*(v+15)]);h.drawElements(h.TRIANGLES,m.oa,h.UNSIGNED_SHORT,0);for(var y=0,D=e.length;y<D;y++){w=e.charCodeAt(y)-32;t=(w&15)<<4;v=w>>4<<4;switch(w){case 12:case 14:case 27:case 28:case 64:case 73:case 76:case 84:ra(a.lb,"uData",[b,c,t*q,.0078125*v,b+n,c,(t+8)*q,.0078125*v,b+n,c+d,(t+8)*q,.0078125*(v+16),b,c+d,t*q,.0078125*(v+16)]);
b+=n;break;default:ra(a.lb,"uData",[b,c,t*q,.0078125*v,b+f,c,(t+15)*q,.0078125*v,b+f,c+d,(t+15)*q,.0078125*(v+16),b,c+d,t*q,.0078125*(v+16)]),b+=f}h.drawElements(h.TRIANGLES,m.oa,h.UNSIGNED_SHORT,0)}1!=k&&(h.enable(h.CULL_FACE),null==g&&h.enable(h.DEPTH_TEST))}}function Pb(a,b){for(var c=a-1,d=Math.round(.5*a),e=0,f=0,g=b.length;f<g;f++)switch(b.charCodeAt(f)-32){case 12:case 14:case 27:case 28:case 64:case 73:case 76:case 84:e+=d;break;default:e+=c}return e}
function Ub(a){var b=a.j,c=b.u;c.stencilMask(255);c.clear(c.STENCIL_BUFFER_BIT);c.stencilFunc(c.EQUAL,0,255);c.stencilOp(c.KEEP,c.KEEP,c.INCR);p.Im=a.j.Lc({ud:!0,ti:!0,ce:!1});p.wq=a.j.Lc({ud:!0,ce:!1});var d=[1/a.wa[0],1/a.wa[1]],e=513,f=0;0<a.vk.length&&(e=a.vk[0],f++);for(var g=0,k=a.mg.length;g<k;g++){var h=a.rj[g],m=a.mg[g];0<h&&g>=e&&(c.clear(c.STENCIL_BUFFER_BIT),a.vk.length>f?(e=a.vk[f],f++):e=513);for(var n=0;n<h;n++)p.xu(b,c,a,m[n],d)}}
function Vb(a){for(var b=0,c=a.mg.length;b<c;b++){for(var d=a.rj[b],e=a.mg[b],f=0;f<d;f++)e[f]=null;a.rj[b]=0}}p.dc={};p.dc.ni=function(a,b,c,d,e){a[e]=b[0];a[e+1]=b[1];a[e+2]=b[2];a[e+3]=c[0];a[e+4]=c[1];a[e+5]=c[2];a[e+6]=d[0];a[e+7]=d[1];a[e+8]=d[2]};p.dc.mi=function(a,b,c,d,e){a[e]=b[0];a[e+1]=b[1];a[e+2]=c[0];a[e+3]=c[1];a[e+4]=d[0];a[e+5]=d[1]};
p.dc.Yt=function(){var a=5;a--;for(var b=p.dc,c=a*a*2,d=new Float32Array(9*c),c=new Float32Array(6*c),e=1*a,f=0,g=0,k=0;k<a;k++)for(var h=0;h<a;h++){var m=h*e,n=(h+1)*e,q=k*e,y=(k+1)*e;b.ni(d,[m,q,0],[n,q,0],[n,y,0],f);b.mi(c,[m,q],[n,q],[n,y],g);f+=9;g+=6;b.ni(d,[n,y,0],[m,y,0],[m,q,0],f);b.mi(c,[n,y],[m,y],[m,q],g);f+=9;g+=6}return{A:new ib(0,0,0,1,1,1),ca:d,dk:c}};
p.dc.Zt=function(){var a=16;a--;for(var b=p.dc,c=a*a*2,d=new Float32Array(9*c),c=new Float32Array(6*c),e=1/a,f=0,g=0,k=0;k<a;k++)for(var h=0;h<a;h++){var m=h,n=h+1,q=k,y=k+1,w=h*e,t=(h+1)*e,v=k*e,D=(k+1)*e;b.ni(d,[m,q,0],[m,y,0],[n,y,0],f);b.mi(c,[w,v],[w,D],[t,D],g);f+=9;g+=6;b.ni(d,[n,y,0],[n,q,0],[m,q,0],f);b.mi(c,[t,D],[t,v],[w,v],g);f+=9;g+=6}return{A:new ib(0,0,0,1,1,1),ca:d,dk:c}};
p.dc.sm=function(a,b){b*=Math.PI;a*=2*Math.PI;return[Math.cos(a)*Math.sin(b)*.5+.5,Math.sin(a)*Math.sin(b)*.5+.5,.5*Math.cos(b)+.5]};p.dc.Cq=function(a,b){for(var c=p.dc,d=a*b*2,e=new Float32Array(9*d),d=new Float32Array(6*d),f=0,g=0,k=0;k<a;k++)for(var h=0;h<b;h++)c.Yv(h/b,k/a,(h+1)/b,(k+1)/a,e,f,d,g),f+=18,g+=12;return{A:new ib(0,0,0,1,1,1),ca:e,dk:d}};
p.dc.Yv=function(a,b,c,d,e,f,g,k){var h=p.dc,m=[a,b],n=h.sm(a,d),q=[a,d],y=h.sm(c,b),w=[c,b],t=h.sm(c,d);c=[c,d];h.ni(e,n,h.sm(a,b),y,f);h.mi(g,q,m,w,k);h.ni(e,y,t,n,f+9);h.mi(g,w,c,q,k+6)};p.gh=null;
function Wb(a,b,c,d){this.f=d||{};this.Fc(d);this.l=a;this.lc=this.l.Ge();this.Ac=b;this.hu=a.hu;this.N=!1;this.Gt=0;this.f=d||{};this.Nh=!1;this.Sw=new Float32Array(27);c=c.trim();this.Ya=p.Ha.Xk(c);this.Jc=p.Ha.hl(c);this.bd=p.Ha.el(c);this.pa=new dc(this,["obj",0,0,"fix",0,0,0,0,0,0]);this.Eo=this.pa.clone();this.Qg={};this.Ib={};this.L={};this.an={};this.Ka=[];this.pc={};this.fj={};this.fa=[];this.ob=[];this.Lf=[];this.pe=[];this.nc=Array(500);this.Gn=[];this.Kr=null;this.Ni=new ec(0,{});this.Uq=
"";this.wg=[];this.ge=this.yi=this.tc=0;this.vu=["base","hit"];this.Yi=[];this.Tk=!1;this.Xd={oj:{},il:{},Sl:{}};this.wf=!1;this.gc=new fc(this,1048576*this.f.Ll);this.Ec=new fc(this,1048576*this.f.Kl);this.Rc=new fc(this,1048576*this.f.Pl);gc(this);hc(this);this.Pc=new ic(this,this.f.wj);this.m=this.l.m;this.P=this.m.P;this.Gq=this.Vb=10;this.ka=[0,0,0];this.$d=[0,0,1];this.rk=[0,0,0];this.Co=this.Fi=this.wd=0;this.o=new jc(this);this.lm=new kc(this);this.w={P:null,Ce:null,Nk:null,yf:null,iq:null,
hq:null,wi:!1,vi:!1,Tg:!1,Sg:!1,vm:this.f.Ql,br:!1,zn:!1,sn:!1,Kk:!1,pn:!1,Lk:!1,ua:30,at:!1,Kd:0,bt:0,Kd:0,zc:[],Hl:0,vj:0};var e;a=this.Ac.srses;this.Qg={};if(null==a)e=!1;else{for(e in a)b=new lc(this,e,a[e]),this.Qg[e]=b;e=!0}e&&(e=this.Ac.referenceFrame,null==e?e=!1:(this.Ib=new mc(this,e),e=0==this.Ib.af?!1:!0));if(e)if(e=this.Ac.credits,this.L={},null==e)e=!1;else{for(var f in e)nc(this,f,new oc(this,e[f]));e=!0}var g;if(f=e){f=this.Ac.stylesheets;this.Lf=[];if(null!=f)for(g in f)e=new pc(this,
g,f[g]),this.Lf[g]=e;f=!0}if(g=f)if(g=this.Ac.surfaces,this.Ka=[],null==g)g=!1;else{f=0;for(e=g.length;f<e;f++)a=new qc(this,g[f]),this.Ka.push(a),a.h=this.Ka.length-1;g=!0}if(g){g=this.Ac.glue;this.fj=[];if(null!=g)for(f=0,e=g.length;f<e;f++)a=new qc(this,g[f],"glue"),this.fj[a.g.join(";")]=a;g=!0}if(g){g=this.Ac.virtualSurfaces;this.pc=[];if(this.f.Rl&&null!=g)for(f=0,e=g.length;f<e;f++)a=new rc(this,g[f]),this.pc[a.mt]=a;g=!0}var k;if(g){g=this.Ac.boundLayers;this.ob=[];if(null!=g)for(var h in g)f=
new sc(this,g[h],h),this.ob[h]=f;g=!0}if(h=g){h=this.Ac.freeLayers;this.fa=[];if(null!=h)for(k in h)g=new qc(this,h[k],"free"),this.fa[k]=g;h=!0}if(k=h){k=this.Ac.namedViews;this.wg=[];if(null!=k)for(var m in k)h=new ec(0,k[m]),this.wg[m]=h;m=this.Ac.view;null!=m&&(this.Kr=JSON.parse(JSON.stringify(m)));k=!0}k&&(m=this.Ac.browserOptions,this.Vm={},null!=m&&(this.Vm=JSON.parse(JSON.stringify(m))));this.o.Lo=0;this.o.Ko=0;this.o.Hl=performance.now();this.o.vj=this.Hl;this.Wk=!Pa(Qa(this));this.yp=Array(6E4);
this.xp=Array(6E4);this.ln=Array(6E4);this.ac=new tc(this);null!=this.Ac.position&&this.setPosition(this.Ac.position,!1);this.Rd(this.Kr);this.Pe=.5*this.m.wa[0];this.un=this.qn=this.Vi=this.sc=this.oo=!1;this.th=0;this.tn=this.Ik=this.vn=this.kn=this.rn=this.wn=this.mn=this.nn=!1;this.Jk=!0;this.xn=0;this.Ir=!1;this.Ui=this.f.Oh;this.en=2;this.eh=this.Zf=0;this.zq=this.pk=1;this.as=Math.log(8);this.Tv=Math.log(2);this.yn=this.m.j.Lc({});this.Au=this.m.j.Lc({cf:!1,Nf:!1});this.uu=this.m.j.Lc({Bi:!0,
ud:!0});this.tu=this.m.j.Lc({cf:!1,ud:!0});this.su=this.m.j.Lc({cf:!1,Nf:!1,ud:!0});this.m.j.Lc({cf:!1,Nf:!0,ud:!1});uc(this);this.Rb=[];this.Pf("map",this.zu.bind(this),!0)}l=Wb.prototype;l.I=function(){this.N=!0;this.ac.I();for(var a in this.fa)this.fa[a].ac.I();this.gc.clear();this.Ec.clear();this.Rc.clear();null!=this.m&&(this.m.I(),this.m=null)};function gc(a){a.wf=a.f.Wo;!a.wf&&a.f.Vo&&(a.wf=p.Oa.Lr());hc(a)}
function hc(a){var b=1/(a.wf?Math.pow(2,Math.max(0,a.f.zj-1)):1),b=.5*(b+1/(a.wf?Math.pow(2,a.f.zj):1)),c=a.Ec;c.vf=1048576*a.f.Kl*b;vc(c);c=a.gc;c.vf=1048576*a.f.Ll*b;vc(c);c=a.Rc;c.vf=1048576*a.f.Pl*(.8>b?.5:1);vc(c)}function uc(a){var b=0;a.wf&&(b=a.f.zj);a.Yj=a.f.Yo*Math.pow(2,b)}l.nf=function(){return this.l.Av.nf()};l.Dh=function(){return Ma(this.Qg)};function nc(a,b,c){a.L[b]=c;a.an[c.g]=c;c.Nr=b}l.yh=function(){return Ma(this.L)};
l.He=function(a){a:{for(var b=this.Ka,c=0,d=b.length;c<d;c++)if(b[c].g==a){a=b[c];break a}a=null}return a};l.eg=function(){for(var a=[],b=0,c=this.Ka.length;b<c;b++)a.push(this.Ka[b].g);return a};function wc(a,b){var c=a.ob,d;for(d in c)if(c[d].hw==b)return c[d];return null}l.kf=function(){return Ma(this.ob)};l.bg=function(){var a=[],b;for(b in this.fa)a.push(b);return a};function Fc(a,b){return null==b?null:-1!=b.indexOf("+proj")?new lc(a,{srsDef:b}):a.Qg[b]}
l.Rd=function(a,b){if(null!=a){if("string"===typeof a)if(a=a.trim(),"{"==a.charAt(0))try{a=JSON.parse(a)}catch(f){return}else{a=this.wg[a];if(!a)return;a=a.gb()}var c=JSON.stringify(a);if(c!=this.Uq||b)this.Ni.parse(a),this.Uq=c,this.yi++;Gc(this);Hc(this);c=this.Ni.fa;this.Yi=[];for(var d in c){var e=this.fa[d];e&&(e.eh=c[d].depthShift||0,this.Yi.push(e),c[d].style?e.cb(c[d].style):e.cb(e.Yh))}z(this)}};function La(a){var b=[],c;for(c in a.Lf)b.push(c);return b}l.pf=function(){return this.Ni.gb()};
function Ic(a){a.yi++;Gc(a);Hc(a);z(a)}function Jc(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c].g==b)return c;return-1}function Ma(a){var b=[],c;for(c in a)b.push(c);return b}l.setPosition=function(a){this.pa=new dc(this,a);z(this)};l.Pa=function(a,b,c){return this.Ib.Pa(a,b,c)};function Qa(a){return a.Ib.Cc.bm}l.sa=function(){return this.pa.clone()};l.Fc=function(a){if("object"===typeof a&&null!==a)for(var b in a)this.mc(b,a[b])};
l.wh=function(a,b){if(!Pa(Qa(this))){var c=Kc(this).Ny(a[0],a[1],b[0],b[1]),c=c.Ty-c.Uy;isNaN(c)&&(c=0);return c}return 0};l.$b=function(a,b){if(!a)return b;a=a.trim();return-1!=a.indexOf("://")?a:0==a.indexOf("//")?this.Jc+a:0==a.indexOf("/")?this.bd+a:this.Ya+a};
l.mc=function(a,b){switch(a){case "map":this.f.c=p.Fm(b,null);break;case "mapCache":this.f.Kl=p.oc(b,10,Number.$c,900);hc(this);break;case "mapGPUCache":this.f.Ll=p.oc(b,10,Number.$c,360);hc(this);break;case "mapMetatileCache":this.f.Pl=p.oc(b,10,Number.$c,60);hc(this);break;case "mapTexelSizeFit":this.f.Yo=p.oc(b,1E-4,Number.$c,1.1);break;case "mapLowresBackground":this.f.Ol=p.oc(b,0,Number.$c,0);break;case "mapDownloadThreads":this.f.wj=p.oc(b,1,Number.$c,6);break;case "mapMaxProcessingTime":this.f.yj=
p.oc(b,1,Number.$c,50);break;case "mapMobileMode":this.f.Wo=p.ea(b,!1);gc(this);break;case "mapMobileModeAutodect":this.f.Vo=p.ea(b,!1);break;case "mapMobileDetailDegradation":this.f.zj=p.oc(b,1,Number.$c,2);break;case "mapNavSamplesPerViewExtent":this.f.Oe=p.oc(b,1E-11,Number.$c,4);break;case "mapFog":this.f.Oh=p.ea(b,!1);break;case "mapIgnoreNavtiles":this.f.Uo=p.ea(b,!1);break;case "mapAllowHires":this.f.bs=p.ea(b,!0);break;case "mapAllowLowres":this.f.cs=p.ea(b,!0);break;case "mapAllowSmartSwitching":this.f.ds=
p.ea(b,!0);break;case "mapDisableCulling":this.f.Ro=p.ea(b,!1);break;case "mapPreciseCulling":this.f.Xo=p.ea(b,!1);break;case "mapHeightLodBlend":this.f.Ph=p.ea(b,!0);break;case "mapHeightNodeBlend":this.f.To=p.ea(b,!0);break;case "mapBasicTileSequence":this.f.es=p.ea(b,!0);break;case "mapSmartNodeParsing":this.f.gs=p.ea(b,!0);break;case "mapStoreLoadStats":this.f.Ql=p.ea(b,!0);this.w.vm=this.f.Ql;break;case "mapXhrImageLoad":this.f.Cj=p.ea(b,!1);break;case "mapLoadMode":this.f.Nl=p.Fm(b,"topdown");
break;case "mapGeodataLoadMode":this.f.So=p.Fm(b,"fit");break;case "mapPreciseBBoxTest":this.f.Aj=p.ea(b,!0);break;case "mapPreciseDistanceTest":this.f.Bj=p.ea(b,!1);break;case "mapHeightfiledWhenUnloaded":this.f.Qh=p.ea(b,!1);break;case "mapVirtualSurfaces":this.f.Rl=p.ea(b,!0);break;case "mario":this.f.hs=p.ea(b,!0)}};
l.uc=function(a){switch(a){case "map":return this.f.c;case "mapCache":return this.f.Kl;case "mapGPUCache":return this.f.Ll;case "mapMetatileCache":return this.f.Pl;case "mapTexelSizeFit":return this.f.Yo;case "mapLowresBackground":return this.f.Ol;case "mapDownloadThreads":return this.f.wj;case "mapMaxProcessingTime":return this.f.yj;case "mapMobileMode":return this.f.Wo;case "mapMobileModeAutodect":return this.f.Vo;case "mapMobileDetailDegradation":return this.f.zj;case "mapNavSamplesPerViewExtent":return this.f.Oe;
case "mapFog":return this.f.Oh;case "mapIgnoreNavtiles":return this.f.Uo;case "mapAllowHires":return this.f.bs;case "mapAllowLowres":return this.f.cs;case "mapAllowSmartSwitching":return this.f.ds;case "mapDisableCulling":return this.f.Ro;case "mapPreciseCulling":return this.f.Xo;case "mapHeightLodBlend":return this.f.Ph;case "mapHeightNodeBlend":return this.f.To;case "mapBasicTileSequence":return this.f.es;case "mapSmartNodeParsing":return this.f.gs;case "mapStoreLoadStats":return this.f.Ql;case "mapXhrImageLoad":return this.f.Cj;
case "mapLoadMode":return this.f.Nl;case "mapGeodataLoadMode":return this.f.So;case "mapPreciseBBoxTest":return this.f.Aj;case "mapPreciseDistanceTest":return this.f.Bj;case "mapHeightfiledWhenUnloaded":return this.f.Qh;case "mapVirtualSurfaces":return this.f.Rl;case "mario":return this.f.hs}};function z(a){a.Ea=!0;a.rv=!0}l.Ch=function(a,b){return this.m.Ch(a,b)};
l.cg=function(a,b,c,d){this.rv&&(this.ge=1,Nb(this.m,"depth"),Lc(this),Nb(this.m,"base"),this.ge=0);var e;e=this.m;var f=e.j.u,g=e.Ch(a,b),k=e.P.sa();if(f.checkFramebufferStatus(f.FRAMEBUFFER)!=f.FRAMEBUFFER_COMPLETE)e=[0,0,0,null,g,Number.MAX_VALUE,k];else{a=Math.floor(e.mj/e.wa[0]*a);f=e.lg;b=e.mj-Math.floor(e.mj/e.wa[1]*b)-1;if(null!=f.U){f.j.bindTexture(f);cb(f.j,f);var h=f.u,m=new Uint8Array(4);h.readPixels(a,b,1,1,h.RGBA,h.UNSIGNED_BYTE,m);cb(f.j,null);f=m}else f=void 0;a=1/255*f[0]+f[1]+255*
f[2]+65025*f[3];f=!(255==f[0]&&255==f[1]&&255==f[2]&&255==f[3]);e.Dl=[k[0]+g[0]*a,k[1]+g[1]*a,k[2]+g[2]*a];e=[e.Dl[0],e.Dl[1],e.Dl[2],f,g,a,k]}var g=!1,k=this.ka,n;a=e[4];if(Pa(Qa(this)))f=[0,0,Math.min(-1E3,this.Ib.Ae.pl[0])],b=[0,0,1],h=p.Math.vec3Dot(b,a),f=[f[0]-k[0],f[1]-k[1],f[2]-k[2]],f=p.Math.vec3Dot(f,b)/h,0<=f&&(!e[3]||f<e[5])&&(n=[a[0]*f+k[0],a[1]*f+k[1],a[2]*f+k[2]],g=!0);else if(h=Qa(this).fc().b+this.Ib.Ae.pl[0],m=[k[0],k[1],k[2]],f=p.Math.vec3Dot(a,a),b=2*p.Math.vec3Dot(a,m),h=p.Math.vec3Dot(m,
m)-h*h,h=b*b-4*f*h,0<h&&(h=Math.sqrt(h),m=(-b-h)/(2*f),f=(-b+h)/(2*f),f=m<f?m:f,!e[3]||f<e[5]))n=[a[0]*f+k[0],a[1]*f+k[1],a[2]*f+k[2]],g=!0;if(!e[3]&&!g)return null;g||(n=[e[0]+k[0],e[1]+k[1],e[2]+k[2]]);n=this.Pa(n,"physical","navigation");"float"==c&&(d=null!=d?d:Mc(this,n,100,this.f.Oe),c=this.vc(n,d),n[2]-=c[0]);return n};
l.zu=function(){1!=this.ge&&bb(this.m.j);this.Xd={oj:{},il:{},Sl:{}};var a=Pa(Qa(this));if(!a)var b=this.pa.ie(Pa(Qa(this)),!0);p.i.create();this.pa.check();var c=this.pa.s[4],d=Mc(this,Nc(this.pa),this.pa.s[8],this.f.Oe),e=this.vc(Nc(this.pa),d,!0);this.o.Fr=e[0];this.o.Er=c;"float"==this.pa.s[3]&&(c+=e[0]);d=this.pa.ie(Pa(Qa(this)));this.P.setPosition(d.Uc);var f=this.P,g=d.Kp;f.Mp=!0;f.Kg=g.slice();f.Ea=!0;this.$d=d.ek;this.ka=d.Uc;this.wd=d.Mw+c;this.Fi=this.wd-e[0];this.Gq=Oc(this.pa);this.Vb=
Math.max(this.Fi,this.Gq);this.Vb=p.dd(this.Vb,.1,this.P.Xf);this.m.Vb=this.Vb;e=this.P;e.qq=this.pa.s[8];e.Ea=!0;c=this.Pa([Nc(this.pa)[0],Nc(this.pa)[1],c],"navigation","physical");this.rk=[c[0],c[1],c[2]];c[0]+=d.Uc[0];c[1]+=d.Uc[1];c[2]+=d.Uc[2];this.P.setPosition([0,0,0]);this.ka=c;c=Math.max(this.wd,this.Vb)/6E5;d=Math.max(2,40*c);c=Math.max(1,c);this.P.Qp(.5*this.pa.je(),d,12E6*c);this.m.Ea=!0;this.m.Ui=this.Ui;this.m.ka=this.ka;this.m.sk=this.pa.ec();this.m.Hq=Math.cos(p.Ga(this.m.sk[1]));
this.m.$d=this.$d;a?(b=p.Ga(this.m.sk[0]),this.m.Bo=[-Math.sin(b),Math.cos(b),0,0,0]):(b=b.ek,this.m.Bo=[b[0],b[1],b[2],0],this.$t=p.D.length(this.ka),b=[0,0,0],p.D.normalize(this.ka,b),this.au=b);this.m.Zq=1/Math.max(1,Math.log(this.Vb)/Math.log(1.04));this.m.wt=Math.abs(this.m.sk[1]/-90);1!=this.ge?this.m.j.clear(!0,!1):this.m.j.clear(!0,!0,[255,255,255,255]);this.m.j.Gc(this.Au);1!=this.ge&&.8>this.f.Ol&&(2==this.th?Kb(this.m,this.m.dh,this.m.zp):Kb(this.m,this.m.qk,this.m.zp));this.m.j.Gc(this.yn);
uc(this);this.eh=this.Pc.uk=0;this.jb(null,a)};
l.update=function(){if(1!=this.N&&(this.l.Bm&&Date.now()>this.l.Bm-6E4&&this.l.Bt(),null==this.ee||"hidden"!=this.ee.style.visibility)){Pc(this.pa,this.Eo)&&this.l.pb("map-position-changed",{position:this.pa.s.slice(),"last-position":this.Eo.s.slice()});this.Co!=this.Fi&&this.l.pb("map-position-fixed-height-changed",{height:this.Fi,"last-height":this.Co});this.Eo=this.pa.clone();this.Co=this.Fi;this.Ui=this.f.Oh;var a=this.m.ee.getBoundingClientRect();if(this.m.wa[0]!=a.width||this.m.wa[1]!=a.height)this.m.em(),
this.Ea=!0;var a=this.Ea,b=this.o;if(a){b.Ce=0;b.Ok=0;b.Ti=0;b.Vf=0;b.Yb=0;b.ck=0;b.Lj=0;for(var c=b.Kj=0,d=b.Eg.length;c<d;c++)b.Eg[c]=0}b.xd++;b.kt++;b.Os=performance.now();for(this.Pc.update();0<this.pe.length;){if(this.o.mb>this.f.yj){z(this);break}this.pe[0]();this.pe.shift()}this.Ea&&(this.Ea=!1,this.zq=this.pk=0,Lc(this),this.Pc.update(),this.l.pb("map-update",{}));this.o.end(a)}};
p.Lt=function(){function a(a,b,c){if(ya>=pb){var d=Ta;pb+=65536;Ta=Array(pb);for(var e=0,f=ya;e<f;e++)Ta[e]=d[e]}Ta[ya]={ng:a,lk:b,Vj:c};ya++}function b(){for(var a=0,b=Ta,c=0,d=ya;c<d;c++){var e=b[c],f=e.ng,g=f.type,h=e.Vj;if(e.hitable||e.Ef||"icon"==g||"label"==g)e.Ef||(postMessage(e.ng,e.lk),a++);else{switch(g){case "flat-line":for(var k=f.vertexBuffer.length,m=c+1;m<d;m++){var n=b[m];n.Vj==h&&(n.Ef=!0,k+=n.ng.vertexBuffer.length)}for(var q=new Float32Array(k),k=0,m=c;m<d;m++){var n=b[m],r=n.ng;
if(n.Vj==h){n=r.vertexBuffer;r.vertexBuffer=null;for(var r=0,u=n.length;r<u;r++)q[k+r]=n[r];k+=u}}f.vertexBuffer=q;e.lk=[q.buffer];break;case "pixel-line":case "line-label":k=f.vertexBuffer.length;for(m=c+1;m<d;m++)n=b[m],n.Vj==h&&(n.Ef=!0,k+=n.ng.vertexBuffer.length);for(var q=new Float32Array(k),t=new Float32Array(k),k=0,m=c;m<d;m++)if(n=b[m],r=n.ng,n.Vj==h){n=r.vertexBuffer;r.vertexBuffer=null;if("line-label"==g){var w=r.texcoordsBuffer;r.texcoordsBuffer=null}else w=r.normalBuffer,r.normalBuffer=
null;r=0;for(u=n.length;r<u;r++)q[k+r]=n[r],t[k+r]=w[r];k+=u}f.vertexBuffer=q;"line-label"==g?f.texcoordsBuffer=t:f.normalBuffer=t;e.lk=[q.buffer,t.buffer]}a++;postMessage(e.ng,e.lk)}}ya=0}function c(a,b,c,e,f,g){for(var h in O){var k=O[h],m=x(k,"filter",b,c);b.Mj=b.properties||{};if(!m||r(m,b,f,g)){var m=a,n=b,q=c,U=e,P=x(k,"visible",n,q),J=x(k,"z-index",n,q);if(0!=P){var t=n.Mj,P=x(k,"hover-style",n,q),P=""!=P?u(P,m,U):null;null!=P?(Ea=1,d(m,n,q,k,J,t),Ea=2,d(m,n,q,P,J,t)):(Ea=0,d(m,n,q,k,J,t));
var w=x(k,"next-pass",n,q);if(null!=w)for(var v=0,xc=w.length;v<xc;v++)J=w[v][0],k=u(w[v][1],m,U),P=x(k,"visible",n,q),0!=P&&(P=x(k,"hover-style",n,q),P=""!=P?u(P,m,U):null,null!=P?(Ea=1,d(m,n,q,k,J,t),Ea=2,d(m,n,q,P,J,t)):(Ea=0,d(m,n,q,k,J,t)))}}}}function d(b,c,d,e,f,g){switch(b){case "line-string":(x(e,"point",c,d)||x(e,"label",c,d))&&q(c,d,e,f,g);y(c,d,e,f,g);break;case "point-array":q(c,d,e,f,g);break;case "polygon":var h=style_,k=c.vertices||[];if(0!=k.length&&((x(h,"point",c,d)||x(h,"label",
c,d))&&m(c,k,d,h,f,g,!1),(x(h,"line",c,d)||x(h,"line-label",c,d))&&m(c,k,d,h,f,g,!0),0!=x(h,"polygon",c,d))){var n=c.surface||[];if(0!=n.length){b=x(h,"hover-event",c,d);e=x(h,"click-event",c,d);var r=x(h,"draw-event",c,d),P=x(h,"enter-event",c,d),J=x(h,"leave-event",c,d),U=x(h,"zbuffer-offset",c,d);c=x(h,"polygon-color",c,d);d=[0,0,0];for(var t=n.length/3*3,h=Array(3*t),u=0,w=0,v,xc=0;xc<t;xc++)v=3*n[u++],v=[k[v++],k[v++],k[v]],null!=forceScale_&&(v=[v[0]*forceScale_[0],v[1]*forceScale_[1],v[2]*
forceScale_[2]]),d[0]+=v[0],d[1]+=v[1],d[2]+=v[2],h[w++]=v[0],h[w++]=v[1],h[w++]=v[2];0<t&&(k=1/t,d[0]*=k,d[1]*=k,d[2]*=k);d[0]+=Wa[0];d[1]+=Wa[1];d[2]+=Wa[2];a({command:"addRenderJob",type:"flat-line",vertexBuffer:h,color:c,"z-index":f,center:d,"hover-event":b,"click-event":e,"draw-event":r,hitable:b||e||P||J,state:Ea,eventInfo:g,"enter-event":P,"leave-event":J,"zbuffer-offset":U,lod:Ba})}}}}function e(a,b){if(!a||""==a)return!1;for(var c=b.xe,d=0,e=a.length;d<e;d++){var f=a.charCodeAt(d);if(10!=
f&&9!=f&&!c[f])return!1}return!0}function f(a,b){for(var c=0,d=[0,0,0],e=[1,0,0],f=0,g=a.length-1;f<g;f++){var d=a[f],e=a[f+1],e=[e[0]-d[0],e[1]-d[1],e[2]-d[2]],h=vec3Length(e);if(c+h>b){c=(b-c)/h;d=[d[0]+e[0]*c,d[1]+e[1]*c,d[2]+e[2]*c];vec3Normalize(e);break}c+=h}return[d,e]}function g(a,b,c){var d=0;c=c.xe;for(var e=0,f=a.length;e<f;e++){var g=a.charCodeAt(e);10!=g&&(9==g&&(g=32),g=c[g],null!=g&&(d+=g.Rg*b))}return d}function k(a,b,c,d,e,k,m,n){var q=c/d.v,r=g(b,q,d),P,J=0;P=0;for(var U=a.length-
1;P<U;P++)var t=a[P],u=a[P+1],J=J+vec3Length([u[0]-t[0],u[1]-t[1],u[2]-t[2]]);P=J;J=.5*(P-r);0>J&&(J=0);if(!(r>P)){a:{P=J;for(var U=0,v,r=[0,0,0],q=P+g(b,q,d),t=0,u=a.length-1;t<u;t++){v=a[t];var w=a[t+1];v=[w[0]-v[0],w[1]-v[1],w[2]-v[2]];U+=vec3Length(v);U>P&&(vec3Normalize(v),r[0]+=v[0],r[1]+=v[1],r[2]+=v[2]);if(U>q){vec3Normalize(r);if(ka){q=[0,0,0];vec3Normalize(da,q);L(q,r,q);break a}q=[-r[1],r[0],0];break a}}q=r}null==q&&(q=[0,1,0]);U=a[0];r=d.xe;c/=d.v;P=d.Jf*c;U=[U[0],U[1],U[2]];t=0;for(u=
b.length;t<u;t++)if(v=b.charCodeAt(t),10==v)U[0]+=-y[1]*P,U[1]+=y[0]*P;else{9==v&&(v=32);y=r[v];w=1;null!=y&&(w=y.Rg*c);var x=f(a,J),y=f(a,J+w),y=[.5*(y[1][0]+x[1][0]),.5*(y[1][1]+x[1][1]),.5*(y[1][2]+x[1][2])];vec3Normalize(y);n=h(x[0],y,-c*d.v*.7+e,v,c,n,n,q,d,k,m)[1];J+=w}return n}}function h(a,b,c,d,e,f,g,h,k,m,n,q){if(ka&&!q){q=[0,0,0];var r=[0,0,0];vec3Normalize(da,r);L(r,b,q)}else q=[-b[1],b[0],0];a=[a[0],a[1],a[2]];var r=[a[0],a[1],a[2]],P=k.xe;k=P[d];var t=0,U=h[0],u=h[1];h=h[2];9==d||32==
d?(k=P[32],null!=k&&(a[0]+=b[0]*k.Rg*e,a[1]+=b[1]*k.Rg*e,t=k.Oo*e)):null!=k&&(d=k.Oo*e,P=k.Uv*e,c=[q[0]*c,q[1]*c,q[2]*c],q=[c[0]+q[0]*P,c[1]+q[1]*P,c[2]+q[2]*P],r[0]=a[0]+b[0]*d,r[1]=a[1]+b[1]*d,r[2]=a[2]+b[2]*d,m[f]=a[0]-c[0],m[f+1]=a[1]-c[1],m[f+2]=a[2]-c[2],m[f+3]=h,n[g]=k.jq,n[g+1]=k.nq,n[g+2]=U,n[g+3]=u,m[f+4]=a[0]-q[0],m[f+5]=a[1]-q[1],m[f+6]=a[2]-q[2],m[f+7]=h,n[g+4]=k.jq,n[g+5]=k.oq,n[g+6]=U,n[g+7]=u,m[f+8]=r[0]-c[0],m[f+9]=r[1]-c[1],m[f+10]=r[2]-c[2],m[f+11]=h,n[g+8]=k.kq,n[g+9]=k.nq,n[g+
10]=U,n[g+11]=u,m[f+12]=a[0]-q[0],m[f+13]=a[1]-q[1],m[f+14]=a[2]-q[2],m[f+15]=h,n[g+12]=k.jq,n[g+13]=k.oq,n[g+14]=U,n[g+15]=u,m[f+16]=r[0]-q[0],m[f+17]=r[1]-q[1],m[f+18]=r[2]-q[2],m[f+19]=h,n[g+16]=k.kq,n[g+17]=k.oq,n[g+18]=U,n[g+19]=u,m[f+20]=r[0]-c[0],m[f+21]=r[1]-c[1],m[f+22]=r[2]-c[2],m[f+23]=h,n[g+20]=k.kq,n[g+21]=k.nq,n[g+22]=U,n[g+23]=u,f+=24,g+=24,a[0]+=b[0]*k.Rg*e,a[1]+=b[1]*k.Rg*e,t=k.Oo*e);return[a,f,g,t]}function m(a,b,c,d,e,f,g){var k=a.borders||[];if(0!=k.length){var h={},m;for(m in a)"surface"!=
m&&"vertices"!=m&&"borders"!=m&&(h[m]=a[m]);a=k.length;for(m=0;m<a;m++){var n=k[m],r=n.length;if(0<r){var P;P=g?Array(r+1):Array(r);for(var t=0;t<r;t++){var U=3*n[t];P[t]=[b[U++],b[U++],b[U]];g&&0==t&&(P[r]=P[0])}h.points=P;g?y(h,c,d,e,f):q(h,c,d,e,f)}}}}function n(a,b,c){switch(a){case "top-left":return[0,0];case "top-right":return[-b,0];case "top-center":return[.5*-b,0];case "center-left":return[0,.5*-c];case "center-right":return[-b,.5*-c];case "center-center":return[.5*-b,.5*-c];case "bottom-left":return[0,
-c];case "bottom-right":return[-b,-c];case "bottom-center":return[.5*-b,-c]}}function q(b,c,d,f,k){var m=[];b.lines?m=b.lines||[]:b.points&&(m=[b.points]);if(0!=m.length){var q=x(d,"visibility",b,c),r=x(d,"culling",b,c),t=x(d,"hover-event",b,c),P=x(d,"click-event",b,c),u=x(d,"draw-event",b,c),v=x(d,"enter-event",b,c),w=x(d,"leave-event",b,c),U=x(d,"zbuffer-offset",b,c),J=x(d,"point",b,c),y=x(d,"point-flat",b,c),A=x(d,"point-color",b,c),B=.5*x(d,"point-radius",b,c),D=x(d,"icon",b,c);if(1==D){var Cb=
x(d,"icon-source",b,c);if(Cb)var C=24*m.length,hb=18*m.length,G={ae:x(d,"icon-color",b,c),Xs:x(d,"icon-scale",b,c),Ij:x(d,"icon-offset",b,c),ui:x(d,"icon-stick",b,c),zg:x(d,"icon-origin",b,c),gt:x(d,"icon-source",b,c),ya:new Float32Array(C),yg:new Float32Array(hb),Yg:new Float32Array(C),h:0,pj:0};else D=!1}var yc=x(d,"label",b,c);if(1==yc){var Cb=x(d,"label-source",b,c),L=H(d,Cb,b),O=x(d,"label-size",b,c);if("$name"==Cb&&!e(L,Ia["default"])){var Y=H(d,"$name:en",b);e(Y,Ia["default"])&&(L=Y)}if(L&&
""!=L&&1E-4<Math.abs(O))var C=24*L.length*m.length,hb=18*L.length*m.length,ca={ae:x(d,"label-color",b,c),v:O,Ij:x(d,"label-offset",b,c),ui:x(d,"label-stick",b,c),zg:x(d,"label-origin",b,c),Qt:x(d,"label-align",b,c),ly:L,bf:x(d,"label-width",b,c),ya:new Float32Array(C),yg:new Float32Array(hb),Yg:new Float32Array(C),h:0,pj:0};else yc=!1}var T=0,V=0,aa=[],ka,Ka=4*B;8>Ka&&(Ka=8);32<Ka&&(Ka=32);ka=Ka;for(var Wa=0,F=2*Math.PI/ka,K=0;K<ka;K++)aa[K]=[-Math.sin(Wa),Math.cos(Wa)],Wa+=F;aa[ka]=[0,1];for(var Xa=
0,la=[0,0,0],ya=0,Ta=m.length;ya<Ta;ya++){var ja=m[ya];if(Array.isArray(ja)&&0<ja.length){var I=ja[0],W=[I[0],I[1],I[2]],Xa=Xa+ja.length;if(0==y)var xa=12*ka,X=Array(ja.length*xa),ta=Array(12*ja.length*ka);else xa=9*ka,X=Array(ja.length*xa);for(var K=0,qa=ja.length;K<qa;K++){null!=forceScale_&&(W=[W[0]*forceScale_[0],W[1]*forceScale_[1],W[2]*forceScale_[2]]);la[0]+=W[0];la[1]+=W[1];la[2]+=W[2];if(1==D){var sa=W,ua=G,R=ua.gt,N=ua.h,Xb=ua.pj,pb=N,zc=Math.abs(R[3]*ua.Xs),Ac=Math.abs(R[4]*ua.Xs),ma=ua.ya,
wa=ua.Yg,ld=ua.yg;ma[N]=0;ma[N+1]=0;ma[N+2]=0;ma[N+3]=0;ma[N+4]=zc;ma[N+5]=0;ma[N+6]=0;ma[N+7]=0;ma[N+8]=zc;ma[N+9]=-Ac;ma[N+10]=0;ma[N+11]=0;wa[N]=R[1];wa[N+1]=R[2];wa[N+2]=0;wa[N+3]=0;wa[N+4]=R[1]+R[3];wa[N+5]=R[2];wa[N+6]=0;wa[N+7]=0;wa[N+8]=R[1]+R[3];wa[N+9]=R[2]+R[4];wa[N+10]=0;wa[N+11]=0;N+=12;ma[N]=0;ma[N+1]=0;ma[N+2]=0;ma[N+3]=0;ma[N+4]=0;ma[N+5]=-Ac;ma[N+6]=0;ma[N+7]=0;ma[N+8]=zc;ma[N+9]=-Ac;ma[N+10]=0;ma[N+11]=0;wa[N]=R[1];wa[N+1]=R[2];wa[N+2]=0;wa[N+3]=0;wa[N+4]=R[1];wa[N+5]=R[2]+R[4];
wa[N+6]=0;wa[N+7]=0;wa[N+8]=R[1]+R[3];wa[N+9]=R[2]+R[4];wa[N+10]=0;wa[N+11]=0;for(var N=N+12,oe=n(ua.zg,zc,Ac),Df=oe[0]+ua.Ij[0],Ef=oe[1]+ua.Ij[1],Ff=sa[0],Gf=sa[1],Hf=sa[2],Db=pb;Db<N;Db+=4)ma[Db]+=Df,ma[Db+1]-=Ef,ld[Xb]=Ff,ld[Xb+1]=Gf,ld[Xb+2]=Hf,Xb+=3;ua.h=N;ua.pj=Xb}if(1==yc){for(var md=W,Ga=ca,Yb=Ga.ya,If=Ga.Yg,nd=Ga.yg,Zb=Ga.h,$b=Ga.pj,Jf=Zb,pe=(""+Ga.ly).match(/[^\r\n]+/g),Eb=[],za=0,ac=pe.length;za<ac;za++){var rb=pe[za];do{var bc;a:{for(var qe=0,Kf=Ia["default"].xe,Bc=0,re=rb.length;Bc<re;Bc++){var sb=
rb.charCodeAt(Bc);if(qe>Ga.bf&&(10==sb||9==sb||32==sb)){bc=Bc;break a}if(10!=sb){9==sb&&(sb=32);var se=Kf[sb];null!=se&&(qe+=Ga.v/Ia["default"].v*se.Rg)}}bc=re}if(rb.length==bc){Eb.push(rb);break}Eb.push(rb.substring(0,bc));rb=rb.substring(bc+1)}while(1)}var Cc=0,od=0,te,ue=Ia["default"];te=Ga.v/ue.v*ue.Jf;for(var cc=0,pd=[],za=0,ac=Eb.length;za<ac;za++)pd[za]=g(Eb[za],Ga.v/Ia["default"].v,Ia["default"]),cc=Math.max(pd[za],cc);za=0;for(ac=Eb.length;za<ac;za++){var ve=pd[za];switch(Ga.Qt){case "left":Cc=
0;break;case "right":Cc=cc-ve;break;case "center":Cc=.5*(cc-ve)}for(var Fb=[Cc,od,0],we=Eb[za],qd=Ia["default"],Lf=Yb,Mf=If,Dc=Zb,rd=[1,0,0],Nf=[0,1,0],xe=Ga.v/qd.v,ye=qd.Jf*xe,tb=[Fb[0],Fb[1],Fb[2]],sd=[Fb[0],Fb[1],Fb[2]],td=0,Of=we.length;td<Of;td++){var ze=we.charCodeAt(td);if(10==ze)tb[0]+=-rd[1]*ye,tb[1]+=rd[0]*ye,sd=[tb[0],tb[1],tb[2]];else var Ae=h(sd,rd,0,ze,xe,Dc,Dc,Nf,qd,Lf,Mf,!0),sd=Ae[0],Dc=Ae[1]}Zb=Dc;od-=te}var Be=n(Ga.zg,cc,-od);offsetX_=Be[0]+Ga.Ij[0];offsetY_=Be[1]+Ga.Ij[1];for(var Pf=
md[0],Qf=md[1],Rf=md[2],za=Jf;za<Zb;za+=4)Yb[za]+=offsetX_,Yb[za+1]-=offsetY_,nd[$b]=Pf,nd[$b+1]=Qf,nd[$b+2]=Rf,$b+=3;Ga.h=Zb;Ga.pj=$b}for(var db=0;db<ka;db++)1==J&&(1==y?(X[T]=W[0],X[T+1]=W[1],X[T+2]=W[2],X[T+3]=W[0]+aa[db][0]*B,X[T+4]=W[1]+aa[db][1]*B,X[T+5]=W[2],X[T+6]=W[0]+aa[db+1][0]*B,X[T+7]=W[1]+aa[db+1][1]*B,X[T+8]=W[2],T+=9):(X[T]=W[0],X[T+1]=W[1],X[T+2]=W[2],X[T+3]=0,ta[V]=0,ta[V+1]=0,ta[V+2]=0,ta[V+3]=0,X[T+4]=W[0],X[T+5]=W[1],X[T+6]=W[2],X[T+7]=0,ta[V+4]=aa[db][0]*B,ta[V+5]=aa[db][1]*
B,ta[V+6]=0,ta[V+7]=0,X[T+8]=W[0],X[T+9]=W[1],X[T+10]=W[2],X[T+11]=0,ta[V+8]=aa[db+1][0]*B,ta[V+9]=aa[db+1][1]*B,ta[V+10]=0,ta[V+11]=0,T+=12,V+=12));W=ja[K+1]}}}0<Xa&&(la[0]/=Xa,la[1]/=Xa,la[2]/=Xa);la[0]+=da[0];la[1]+=da[1];la[2]+=da[2];var Ec=t||P||v||w;1==J&&(1==y?a({command:"addRenderJob",type:"flat-line",vertexBuffer:X,color:A,"z-index":f,visibility:q,center:la,"hover-event":t,"click-event":P,"draw-event":u,"enter-event":v,"leave-event":w,"zbuffer-offset":U,hitable:Ec,state:Ea,eventInfo:k,lod:Ba},
[X.buffer]):a({command:"addRenderJob",type:"pixel-line",vertexBuffer:X,normalBuffer:ta,color:A,"z-index":f,visibility:q,center:la,"hover-event":t,"click-event":P,"draw-event":u,"enter-event":v,"leave-event":w,"zbuffer-offset":U,hitable:Ec,state:Ea,eventInfo:k,lod:Ba},[X.buffer,ta.buffer]));1==D&&0<G.ya.length&&a({command:"addRenderJob",type:"icon",vertexBuffer:G.ya,originBuffer:G.yg,texcoordsBuffer:G.Yg,icon:fa[G.gt[0]],color:G.ae,"z-index":f,visibility:q,culling:r,center:la,stick:G.ui,"hover-event":t,
"click-event":P,"draw-event":u,"enter-event":v,"leave-event":w,"zbuffer-offset":U,hitable:Ec,state:Ea,eventInfo:k,lod:Ba},[G.ya.buffer,G.yg.buffer,G.Yg.buffer]);1==yc&&0<ca.ya.length&&a({command:"addRenderJob",type:"label",vertexBuffer:ca.ya,originBuffer:ca.yg,texcoordsBuffer:ca.Yg,color:ca.ae,"z-index":f,visibility:q,culling:r,center:la,stick:ca.ui,"hover-event":t,"click-event":P,"draw-event":u,"enter-event":v,"leave-event":w,"zbuffer-offset":U,hitable:Ec,state:Ea,eventInfo:k,lod:Ba},[ca.ya.buffer,
ca.yg.buffer,ca.Yg.buffer])}}function y(b,c,d,f,g){var h,m=b.lines||[];if(0!=m.length){var n=x(d,"line",b,c),q=x(d,"line-label",b,c);if(n||q){var r=x(d,"hover-event",b,c),t=x(d,"click-event",b,c),u=x(d,"draw-event",b,c),v=x(d,"enter-event",b,c),P=x(d,"leave-event",b,c),w=x(d,"zbuffer-offset",b,c),U=x(d,"line-flat",b,c),y=x(d,"line-color",b,c),J=.5*x(d,"line-width",b,c),A=x(d,"line-style",b,c),B=x(d,"line-style-texture",b,c),D=x(d,"line-style-background",b,c),q=x(d,"line-label",b,c),Cb=x(d,"line-label-size",
b,c),G=0,C=0,hb=!U&&2.1>J;if(!hb){for(var O=[],Y=[],V=8,T=0,ca=2*Math.PI/V,aa=0;aa<V;aa++)O[aa]=[-Math.sin(T),Math.cos(T)],Y[aa]=T,T+=ca;O[V]=[0,1];Y[V]=0}for(var ya=0,Ka=0;Ka<m.length;Ka++)Array.isArray(m[Ka])&&(ya+=m[Ka].length);var Ta=6*(W||!U?4:3),F=new Float32Array(ya*Ta+ya*(hb?0:V*(W||!U?4:3)*3));if(!U||W)var K=new Float32Array(24*ya+ya*(hb?0:12*V));if(W&&!hb)var Xa=Float32Array(ya);T=[0,0,0];ca=[];for(Ka=0;Ka<m.length;Ka++)if(Array.isArray(m[Ka])&&m[Ka].length){var la=m[Ka];if(q){var pb=Array(la.length),
ne=Array(la.length);ca.push({$w:pb,Zw:ne})}for(var ja=la[0],I,W="solid"!=A,xa=.001,X=.001,aa=0,ta=la.length-1;aa<ta;aa++){I=la[aa];h=la[aa+1];null!=forceScale_&&(I=[I[0]*forceScale_[0],I[1]*forceScale_[1],I[2]*forceScale_[2]],h=[h[0]*forceScale_[0],h[1]*forceScale_[1],h[2]*forceScale_[2]]);if(U&&!W){if(ka){var qa=[h[0]-I[0],h[1]-I[1],h[2]-I[2]],sa=Math.sqrt(qa[0]*qa[0]+qa[1]*qa[1]+qa[2]*qa[2]),X=X+sa,sa=0!=sa?1/sa:0,ua=[qa[0]*sa,qa[1]*sa,qa[2]*sa],R=[0,0,0],N=[0,0,0];vec3Normalize(da,N);L(N,ua,R);
R=[R[0]*J,R[1]*J,R[2]*J]}else qa=[h[0]-I[0],h[1]-I[1],0],sa=Math.sqrt(qa[0]*qa[0]+qa[1]*qa[1]),X+=sa,sa=0!=sa?J/sa:0,R=[-qa[1]*sa,qa[0]*sa,0];F[G]=I[0]+R[0];F[G+1]=I[1]+R[1];F[G+2]=I[2]+R[2];F[G+3]=I[0]-R[0];F[G+4]=I[1]-R[1];F[G+5]=I[2]-R[2];F[G+6]=h[0]+R[0];F[G+7]=h[1]+R[1];F[G+8]=h[2]+R[2];F[G+9]=I[0]-R[0];F[G+10]=I[1]-R[1];F[G+11]=I[2]-R[2];F[G+12]=h[0]-R[0];F[G+13]=h[1]-R[1];F[G+14]=h[2]-R[2];F[G+15]=h[0]+R[0];F[G+16]=h[1]+R[1];F[G+17]=h[2]+R[2];G+=18}else qa=[h[0]-I[0],h[1]-I[1],0],sa=Math.sqrt(qa[0]*
qa[0]+qa[1]*qa[1]),X+=sa,U?(sa=0!=sa?J/sa:0,R=[-qa[1]*sa,qa[0]*sa,0],null!=Xa&&(Xa[aa]=0!=sa?Math.atan2(qa[0],qa[1])+.5*Math.PI:0),F[G]=I[0],F[G+1]=I[1],F[G+2]=I[2],F[G+3]=xa,K[C]=R[0],K[C+1]=R[1],K[C+2]=0,K[C+3]=J,F[G+4]=I[0],F[G+5]=I[1],F[G+6]=I[2],F[G+7]=-xa,K[C+4]=-R[0],K[C+5]=-R[1],K[C+6]=0,K[C+7]=-J,F[G+8]=h[0],F[G+9]=h[1],F[G+10]=h[2],F[G+11]=X,K[C+8]=R[0],K[C+9]=R[1],K[C+10]=0,K[C+11]=J,F[G+12]=I[0],F[G+13]=I[1],F[G+14]=I[2],F[G+15]=-xa,K[C+12]=-R[0],K[C+13]=-R[1],K[C+14]=0,K[C+15]=-J,F[G+
16]=h[0],F[G+17]=h[1],F[G+18]=h[2],F[G+19]=-X,K[C+16]=-R[0],K[C+17]=-R[1],K[C+18]=0,K[C+19]=-J,F[G+20]=h[0],F[G+21]=h[1],F[G+22]=h[2],F[G+23]=X,K[C+20]=R[0],K[C+21]=R[1],K[C+22]=0,K[C+23]=J):(F[G]=I[0],F[G+1]=I[1],F[G+2]=I[2],F[G+3]=xa,K[C]=h[0],K[C+1]=h[1],K[C+2]=h[2],K[C+3]=J,F[G+4]=I[0],F[G+5]=I[1],F[G+6]=I[2],F[G+7]=-xa,K[C+4]=h[0],K[C+5]=h[1],K[C+6]=h[2],K[C+7]=-J,F[G+8]=h[0],F[G+9]=h[1],F[G+10]=h[2],F[G+11]=-X,K[C+8]=I[0],K[C+9]=I[1],K[C+10]=I[2],K[C+11]=J,F[G+12]=I[0],F[G+13]=I[1],F[G+14]=
I[2],F[G+15]=xa,K[C+12]=h[0],K[C+13]=h[1],K[C+14]=h[2],K[C+15]=J,F[G+16]=h[0],F[G+17]=h[1],F[G+18]=h[2],F[G+19]=-X,K[C+16]=I[0],K[C+17]=I[1],K[C+18]=I[2],K[C+19]=J,F[G+20]=h[0],F[G+21]=h[1],F[G+22]=h[2],F[G+23]=X,K[C+20]=I[0],K[C+21]=I[1],K[C+22]=I[2],K[C+23]=-J),G+=24,C+=24;xa=X}I=[ja[0],ja[1],ja[2]];aa=0;for(ta=la.length;aa<ta;aa++){null!=forceScale_&&(I=[I[0]*forceScale_[0],I[1]*forceScale_[1],I[2]*forceScale_[2]]);T[0]+=I[0];T[1]+=I[1];T[2]+=I[2];if(!hb)for(h=null!=Xa?Xa[aa]:0,ka&&(ua=[0,0,0],
N=[0,0,0],vec3Normalize(da,N),vec3AnyPerpendicular(N,ua),vec3Normalize(ua),L(N,ua,N)),ja=0;ja<V;ja++)U&&!W?(F[G]=I[0],F[G+1]=I[1],F[G+2]=I[2],ka?(xa=O[ja][0],X=O[ja][1],F[G+3]=I[0]+(N[0]*xa+ua[0]*X)*J,F[G+4]=I[1]+(N[1]*xa+ua[1]*X)*J,F[G+5]=I[2]+(N[2]*xa+ua[2]*X)*J,xa=O[ja+1][0],X=O[ja+1][1],F[G+6]=I[0]+(N[0]*xa+ua[0]*X)*J,F[G+7]=I[1]+(N[1]*xa+ua[1]*X)*J,F[G+8]=I[2]+(N[2]*xa+ua[2]*X)*J):(F[G+3]=I[0]+O[ja][0]*J,F[G+4]=I[1]+O[ja][1]*J,F[G+5]=I[2],F[G+6]=I[0]+O[ja+1][0]*J,F[G+7]=I[1]+O[ja+1][1]*J,F[G+
8]=I[2]),G+=9):(xa=aa!=ta-1?F[aa*Ta+3]:F[(aa-1)*Ta+11],F[G]=I[0],F[G+1]=I[1],F[G+2]=I[2],F[G+3]=xa,K[C]=0,K[C+1]=0,K[C+2]=0,K[C+3]=0,F[G+4]=I[0],F[G+5]=I[1],F[G+6]=I[2],F[G+7]=xa,K[C+4]=O[ja][0]*J,K[C+5]=O[ja][1]*J,K[C+6]=Y[ja]+h,K[C+7]=0,F[G+8]=I[0],F[G+9]=I[1],F[G+10]=I[2],F[G+11]=xa,K[C+8]=O[ja+1][0]*J,K[C+9]=O[ja+1][1]*J,K[C+10]=Y[ja+1]+h,K[C+11]=0,G+=12,C+=12);q&&(ja=[I[0],I[1],I[2]+.1*Cb],pb[aa]=ja,ne[ta-aa-1]=ja);I=la[aa+1]}}0<ya&&(T[0]/=ya,T[1]/=ya,T[2]/=ya);T[0]+=Wa[0];T[1]+=Wa[1];T[2]+=
Wa[2];aa=r||t||v||P;n&&(aa={command:"addRenderJob",vertexBuffer:F,color:y,"z-index":f,center:T,normalBuffer:K,"hover-event":r,"click-event":t,"draw-event":u,hitable:aa,state:Ea,eventInfo:g,"enter-event":v,"leave-event":P,"zbuffer-offset":w,"line-width":2*J,lod:Ba},aa.type=U?1==W?"flat-tline":"flat-line":1==W?"pixel-tline":"pixel-line",W&&null!=B&&(aa.texture=[fa[B[0]],B[1],B[2]],aa.background=D),ta=JSON.stringify({R:aa.type,ae:y,Ai:f,Ky:w}),K?a(aa,[F.buffer,K.buffer],ta):a(aa,[F.buffer],ta));if(q)for(aa=
0,ta=ca.length;aa<ta;aa++)n=ca[aa].$w,y=ca[aa].Zw,J=b,q=T,F=c,m=d,K=f,w=g,U=x(m,"line-label-color",J,F),r=x(m,"line-label-source",J,F),B=x(m,"line-label-size",J,F),D=x(m,"line-label-offset",J,F),1E-4>Math.abs(B)||(W=H(m,r,J),"$name"!=r||e(W,Ia["default"])||(r=H(m,"$name:en",J),e(r,Ia["default"])&&(W=r)),W&&""!=W&&(r=x(m,"hover-event",J,F),t=x(m,"click-event",J,F),u=x(m,"draw-event",J,F),v=x(m,"enter-event",J,F),P=x(m,"leave-event",J,F),J=x(m,"zbuffer-offset",J,F),m=48*W.length,F=new Float32Array(m),
m=new Float32Array(m),A=r||t||v||P,n=k(n,W,B,Ia["default"],D,F,m,0),k(y,W,B,Ia["default"],D,F,m,n),y=JSON.stringify({R:"line-label",ae:U,Ai:K,Ky:J}),a({command:"addRenderJob",type:"line-label",vertexBuffer:F,texcoordsBuffer:m,color:U,"z-index":K,center:q,"hover-event":r,"click-event":t,"draw-event":u,"enter-event":v,"leave-event":P,"zbuffer-offset":J,hitable:A,state:Ea,eventInfo:w,lod:Ba},[F.buffer,m.buffer],y)))}}}function w(a){switch(a){case "filter":return null;case "inherit":return"";case "line":return!1;
case "line-flat":return!1;case "line-width":return 1;case "line-color":return[255,255,255,255];case "line-style":return"solid";case "line-style-texture":return null;case "line-style-background":return[0,0,0,0];case "line-label":return!1;case "line-label-color":return[255,255,255,255];case "line-label-source":return"$name";case "line-label-size":return 1;case "line-label-offset":return 0;case "point":return!1;case "point-flat":return!1;case "point-radius":return 1;case "point-Layer":return"solid";
case "point-color":return[255,255,255,255];case "icon":return!1;case "icon-source":return null;case "icon-scale":return 1;case "icon-offset":return[0,0];case "icon-origin":return"bottom-center";case "icon-stick":return[0,0,0,255,255,255,255];case "icon-color":return[255,255,255,255];case "label":return!1;case "label-color":return[255,255,255,255];case "label-source":return"$name";case "label-size":return 10;case "label-offset":return[0,0];case "label-origin":return"bottom-center";case "label-align":return"center";
case "label-stick":return[0,0,0,255,255,255,255];case "label-width":return 200;case "polygon":return!1;case "polygon-color":return[255,255,255,255];case "z-index":return 0;case "zbuffer-offset":return[0,0,0];case "hover-event":return!1;case "hover-style":return"";case "enter-event":return!1;case "leave-event":return!1;case "click-event":return!1;case "draw-event":return!1;case "visible":return!0;case "visibility":return 0;case "culling":return 180;case "next-pass":return null}}function t(a,b,c){switch(b){case "inherit":return v(a,
b,c,"string");case "line":return v(a,b,c,"boolean");case "line-flat":return v(a,b,c,"boolean");case "line-width":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "line-color":return v(a,b,c,"object",4,0,255);case "line-style":return v(a,b,c,"string");case "line-style-texture":return v(a,b,c,"object",3,-Number.MAX_VALUE,Number.MAX_VALUE);case "line-style-background":return v(a,b,c,"object",4,0,255);case "line-label":return v(a,b,c,"boolean");case "line-label-source":return v(a,b,c,"string");
case "line-label-color":return v(a,b,c,"object",4,0,255);case "line-label-size":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "line-label-offset":return v(a,b,c,"number",null,-Number.MAX_VALUE,Number.MAX_VALUE);case "point":return v(a,b,c,"boolean");case "point-flat":return v(a,b,c,"boolean");case "point-radius":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "point-Layer":return v(a,b,c,"string");case "point-color":return v(a,b,c,"object",4,0,255);case "icon":return v(a,b,c,"boolean");
case "icon-source":return v(a,b,c,"object",5,-Number.MAX_VALUE,Number.MAX_VALUE);case "icon-scale":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "icon-offset":return v(a,b,c,"object",2,-Number.MAX_VALUE,Number.MAX_VALUE);case "icon-origin":return v(a,b,c,"string");case "icon-stick":return v(a,b,c,"object",7,-Number.MAX_VALUE,Number.MAX_VALUE);case "icon-color":return v(a,b,c,"object",4,0,255);case "label":return v(a,b,c,"boolean");case "label-color":return v(a,b,c,"object",4,0,255);case "label-source":return v(a,
b,c,"string");case "label-size":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "label-offset":return v(a,b,c,"object",2,-Number.MAX_VALUE,Number.MAX_VALUE);case "label-origin":return v(a,b,c,"string");case "label-align":return v(a,b,c,"string");case "label-stick":return v(a,b,c,"object",7,-Number.MAX_VALUE,Number.MAX_VALUE);case "label-width":return v(a,b,c,"number",null,1E-4,Number.MAX_VALUE);case "polygon":return v(styleId_,b,c,"boolean");case "polygon-color":return v(styleId_,b,c,"object",
4,0,255);case "z-index":return v(a,b,c,"number",null,-Number.MAX_VALUE,Number.MAX_VALUE);case "zbuffer-offset":return v(a,b,c,"object",3,0,Number.MAX_VALUE);case "hover-event":return v(a,b,c,"boolean");case "hover-style":return v(a,b,c,"string");case "enter-event":return v(a,b,c,"boolean");case "leave-event":return v(a,b,c,"boolean");case "click-event":return v(a,b,c,"boolean");case "draw-event":return v(a,b,c,"boolean");case "visible":return v(a,b,c,"boolean");case "visibility":return v(a,b,c,"number",
null,1E-4,Number.MAX_VALUE);case "culling":return v(a,b,c,"number",180,1E-4,180);case "next-pass":return v(a,b,c,"object")}return c}function v(a,b,c,d,e,f,g){if(null!=c&&"object"==typeof c&&(null!=c.discrete||null!=c.linear||null!=c["lod-scaled"])){var h=!1;if(null!=c["lod-scaled"]){var k=c["lod-scaled"];if(!("object"==typeof k&&Array.isArray(k)&&2<=k.length))return D("wrong-property-value",a,b,c,null,"[]"),w(b);null==k[2]&&(k[2]=1);if("number"!=typeof k[0]||"number"!=typeof k[2])return D("wrong-property-value",
a,b,c,null,"[]"),w(b);if("number"==typeof k[1])return c;e=k[1];h=!0}else e=c.discrete||c.linear;if(null==e||!("object"==typeof e&&Array.isArray(e)&&0<e.length))return D("wrong-property-value",a,b,c,null,"[]"),w(b);if(null!=e){var m=null;d=0;for(k=e.length;d<k;d++){var n=e[d];if(null==n||"object"!=typeof n||!Array.isArray(n)||2==n.length)if(null==m&&(m=typeof n[1],1==h&&"number"!=m)||"number"!=typeof n[0]||typeof n[1]!=m||"number"==m&&(n[1]>g||n[1]<f))return D("wrong-property-value[]",a,b,c,d,"[]"),
w(b)}}return c}if(typeof c!=d&&(null!==c||"icon-source"!=b&&"visibility"!=b))return D("wrong-property-value",a,b,c),w(b);switch(typeof c){case "object":if(null===c&&("line-style-texture"==b||"icon-source"==b||"visibility"==b||"next-pass"==b))return c;if("next-pass"==b)if(1==Array.isArray(c)&&0<c.length)for(d=0;d<k;d++){if(f=c[d],"object"!=typeof f||1!=Array.isArray(f)||2!=f.length||"number"!=typeof f[0]||"string"!=typeof f[1])return D("wrong-property-value[]",a,b,c,d),w(b)}else return D("wrong-property-value",
a,b,c),w(b);if(null!=e)if(1==Array.isArray(c)&&c.length==e){d=0;if("icon-source"==b||"line-style-texture"==b){if("string"!=typeof c[0])return D("wrong-property-value[]",a,b,c,0),w(b);if(null==fa[c[0]])return D("wrong-object",a,b,c,null,"bitmap"),w(b);d=1}for(k=c.length;d<k;d++)if("number"!=typeof c[d])return D("wrong-property-value[]",a,b,c,d),w(b)}else return D("wrong-property-value",a,b,c),w(b);return c;case "string":if("line-style"==b)switch(c){case "solid":case "texture":return c;default:return D("wrong-property-value",
a,b,c),w(b)}if("label-origin"==b||"icon-origin"==b)switch(c){case "top-left":case "top-right":case "top-center":case "center-left":case "center-right":case "center-center":case "bottom-left":case "bottom-right":case "bottom-center":return c;default:return D("wrong-property-value",a,b,c),w(b)}if("label-align"==b)switch(c){case "left":case "right":case "center":break;default:return D("wrong-property-value",a,b,c),w(b)}return c;case "number":return c>g||c<f?(D("wrong-property-value",a,b,c),w(b)):c;case "boolean":return c}}
function D(a,b,c,d,e,f){"object"==typeof d&&(d=JSON.stringify(d));var g=null;switch(a){case "wrong-property-value":g="Error: wrong layer property "+(f?"'"+f+"'":"")+": "+b+"."+c+" = "+d;break;case "wrong-property-value[]":g="Error: wrong layer property "+(f?"'"+f+"'":"")+"["+e+"]: "+b+"."+c+" = "+d;break;case "wrong-object":g="Error: reffered "+f+" does not exist: "+b+"."+c+" = "+d;break;case "wrong-object[]":g="Error: reffered "+f+" does not exist: "+b+"."+c+"["+e+"] = "+d;break;case "wrong-Layer":g=
"Error: reffered "+f+" Layer does not exist: "+f+"["+e+"].Layer = "+b;break;case "wrong-bitmap":g="Error: wrong definition of bitmap: "+b;break;case "custom":g="Error: "+b}g&&console.log(g)}function B(a,b,c,d,e){if(100<e)D("custom","infinite inherit loop in Layer: "+a);else if(null!=c.inherit){var f=d.Layers[c.inherit];if(null!=f){null!=f.inherit&&B(c.inherit,b,f,d,e++);for(var g in f)b[g]=f[g]}else D("wrong-object",a,"inherit",f,"Layer")}}function x(a,b,c,d){var e=a[b];switch(typeof e){case "string":if(0<
e.length&&"$"==e.charAt(0)){d=c.Mj[e.substr(1)];if(null!=d)return d;D("wrong-object",a["$$layer-id"],b,e,null,"feature-property")}return e;case "object":if(null==e)break;if(1==Array.isArray(e)){if("icon-source"==b&&null==fa[e[0]]){D("wrong-object",a["$$layer-id"],b,e,null,"bitmap");break}return e}var f;a=null;if(null!=e["lod-scaled"]){a=e["lod-scaled"];if("number"==typeof a[1])return a[1]*Math.pow(2*a[2],a[0]-d);f=a[1]}else f=e.discrete||e.linear;b=f[0][0];c=f[0][1];for(var g=typeof c,h=c,k=0,m=f.length;k<=
m;k++){if(k==m){h=c;break}if(f[k][0]>d){if(null!=e.discrete||null!=a)h=c;else{currentLod_=f[k][0];currentValue_=f[k][1];if(currentLod_==b)break;switch(g){case "boolean":currentValue_=(c=c?1:0)?1:0;h=c+(d-b)/(currentLod_-b)*(currentValue_-c);h=.5<h?!0:!1;break;case "number":h=c+(d-b)/(currentLod_-b)*(currentValue_-c);break;case "object":for(h=[],e=0,f=c.length;e<f;e++)h[e]=c[e]+(d-b)/(currentLod_-b)*(currentValue_[e]-c[e])}}break}b=f[k][0];c=f[k][1]}null!=a&&(h*=Math.pow(2*a[2],a[0]-d));return h;case "number":case "boolean":return e}return w(b)}
function H(a,b,c){switch(typeof b){case "string":if(0<b.length)switch(b.charAt(0)){case "$":return c=c.Mj[b.substr(1)],"undefined"==typeof c&&D("wrong-expresion",a["$$layer-id"],b,b,null,"feature-property"),c}}return b}function u(a,b,c){var d=A.ta[a];return null==d?(D("wrong-Layer",a,null,null,c,b),{}):d}function L(a,b,c){c||(c=a);var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1];b=b[2];c[0]=e*b-a*g;c[1]=a*f-d*b;c[2]=d*g-e*f}function r(a,b,c,d){if(!a||!Array.isArray(a))return!1;switch(a[0]){case "all":for(var e=
!0,f=1,g=a.length;f<g;f++)e=e&&r(a[f],b,c,d);return e;case "any":e=!1;f=1;for(g=a.length;f<g;f++)e=e||r(a[f],b,c,d);return e;case "none":e=!0;f=1;for(g=a.length;f<g;f++)e=e&&r(a[f],b,c,d);return!e;case "skip":return!1}switch(a[1]){case "#type":e=c;break;case "#group":e=d;break;default:if((c=a[1])&&0<c.length)switch(c.charAt(0)){case "$":e=b.Mj[c.substr(1)];break;case "@":e=C[c];break;default:e=b.Mj[c]}}switch(a[0]){case "==":return e==a[2];case "!=":return e!=a[2];case ">=":return e>=a[2];case "<=":return e<=
a[2];case ">":return e>a[2];case "<":return e<a[2];case "has":return"undefined"!=typeof e;case "!has":return"undefined"==typeof e;case "in":f=2;for(g=a.length;f<g;f++)if(a[f]==e)return!0;break;case "!in":f=2;for(g=a.length;f<g;f++)if(a[f]==e)return!1;return!0}return!1}var A={},O={},fa={},C={},da=[0,0,0],ca=[1,1,1],V=[1,1,1],Y=4096,ka=!1,Ba=0,Ia={},Ea=0,Wa=[0,0,0],Ta=Array(65536),ya=0,pb=Ta.length;vec3Normalize=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],f=Math.sqrt(c*c+d*d+e*e);if(f){if(1==f)return b[0]=
c,b[1]=d,b[2]=e,b}else return b[0]=0,b[1]=0,b[2]=0,b;f=1/f;b[0]=c*f;b[1]=d*f;b[2]=e*f;return b};vec3Length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};vec3AnyPerpendicular=function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2];b[0]=1;b[1]=1;b[2]=e?-(c+d)/e:0;return b};self.onmessage=function(a){a=a.data;var d=a.data;switch(a.command){case "setStylesheet":if(d){ka=d.geocent||!1;var e=d.data;fa={};C=e.constants||{};a=e.bitmaps||{};for(var f in a)d=a[f],"string"==typeof d?d={url:d}:
"object"==typeof d?null==d.url&&D("wrong-bitmap",f):D("wrong-bitmap",f),fa[f]=d;postMessage({command:"loadBitmaps",bitmaps:fa});A={ta:{}};a=e.layers||{};O=A.ta;for(f in a){var d=A.ta,g=f,h=f,k={},m=h,n=k,q=a[f];null!=q.inherit&&B(m,n,q,e,0);var r=void 0;for(r in q)n[r]=q[r];n["$$layer-id"]=m;m=void 0;for(m in k)n=k[m],"string"==typeof n&&0<n.length&&"@"==n.charAt(0)&&(null!=C[n]?k[m]=C[n]:(D("wrong-object",h,m,n,null,"constant"),k[m]=w(m))),k[m]=t(h,m,k[m]);d[g]=k}}postMessage({command:"ready"});
break;case "setFont":Ia["default"]={xe:d.chars,Jf:d.space,v:d.size};postMessage({command:"ready"});break;case "processGeodata":Ba=a.lod||0;a=d=JSON.parse(d);f=Ba;if("string"==typeof a)try{e=JSON.parse(a)}catch(eg){e=null}else e=a;if(e)for(e=e.groups||[],a=0,d=e.length;a<d;a++)if(k=e[a],g=f,h=k.id||"",m=k.bbox){da=m[0];ca=m[1];V=[m[1][0]-m[0][0],m[1][1]-m[0][1],m[1][2]-m[0][2]];Y=k.resolution||4096;Wa=[0,0,0];forceScale_=[V[0]/Y,V[1]/Y,V[2]/Y];postMessage({command:"beginGroup",id:k.id,bbox:[da,ca],
origin:da});q=k.points||[];m=0;for(n=q.length;m<n;m++)c("point-array",q[m],g,m,"point",h);q=k.lines||[];m=0;for(n=q.length;m<n;m++)c("line-string",q[m],g,m,"line",h);k=k.polygons||[];m=0;for(n=k.length;m<n;m++)c("polygon",k[m],g,m,"polygon",h);b();postMessage({command:"endGroup"})}b();postMessage({command:"allProcessed"});postMessage({command:"ready"})}}};
p.ik=function(a,b){this.$a=a;this.c=a.c;this.N=!1;this.uj=b;this.va=!0;var c=window.URL||window.webkitURL,d,e=p.dy();try{d=new Blob([e],{type:"application/javascript"})}catch(f){window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.Py,d=new BlobBuilder,d.append(e),d=blob.getBlob()}this.jm=new Worker(c.createObjectURL(d));this.jm.onmessage=this.onMessage.bind(this)};p.ik.prototype.I=function(){1!=this.N&&(this.N=!0,null!=this.jm&&this.jm.terminate())};
p.ik.prototype.ha=function(){return this.va||this.N};p.ik.prototype.onMessage=function(a){if(1!=this.N){a=a.data;var b=a.command;"ready"==b&&(this.va=!0);null!=this.uj&&this.uj(b,a)}};function Oa(a,b,c,d){1!=a.N&&(a.va=!1,b={command:b,data:c},d&&d.g&&(b.lod=d.g[0]),a.jm.postMessage(b))}
function sc(a,b,c){this.c=a;this.g=c;this.st=[256,256];this.Ca=[0,100];this.L=[];this.ia=[[0,0],[0,0]];this.Oc=null;this.Ya=this.c.Ya;this.Jc=this.c.Jc;this.bd=this.c.bd;this.va=!1;"esri-world-imagery"==c&&(b.availability={type:"negative-size",size:2521});"string"===typeof b?(this.Oc=this.c.$b(b),this.Ya=p.Ha.Xk(this.Oc),this.Jc=p.Ha.hl(this.Oc),this.bd=p.Ha.el(this.Oc),p.Jd(this.Oc,function(a){this.Ag(a);this.va=!0;Ic(this.c)}.bind(this),function(){}.bind(this),null,p.useCredentials?-1!=this.Oc.indexOf(this.c.Ya):
!1,this.c.l.cc)):(this.Ag(b),this.va=!0)}
sc.prototype.Ag=function(a){this.hw=a.id||null;this.R=a.type||"raster";this.Td=this.$b(a.url,"");this.st=a.tileSize||[256,256];this.Ca=a.lodRange||[0,0];this.ia=a.tileRange||[[0,0],[0,0]];this.Qc=this.$b(a.metaUrl);this.$o=this.$b(a.maskUrl);this.xl=a.isTransparent||!1;this.L=a.credits||[];this.Kf=Math.pow(2,this.Ca[0])/((this.ia[1][0]-this.ia[1][0]+1)*(this.ia[1][1]-this.ia[1][1]+1));if(this.td=a.availability?{}:null)a=a.availability,this.td.R=a.type,this.td.aw=a.mime,this.td.du=a.codes,this.td.v=
a.size;this.Qc&&this.$o&&(this.td={R:"metatile"});switch(typeof this.L){case "string":this.L=[];break;case "object":if(!Array.isArray(this.L)){a=this.L;this.L=[];for(var b in a)nc(this.c,b,new oc(this.c,a[b])),this.L.push(b)}b=0;for(a=this.L.length;b<a;b++);}};sc.prototype.gb=function(){return{type:this.R,url:this.Td,tileSize:this.st,credits:this.L,lodRange:this.Ca,tileRange:this.ia,mataUrl:this.Qc,maskUrl:this.$o,isTransparent:this.xl}};
sc.prototype.$b=function(a,b){if(!a)return b;a=a.trim();return-1!=a.indexOf("://")?a:0==a.indexOf("//")?this.Jc+a:0==a.indexOf("/")?this.bd+a:this.Ya+a};function Qc(a,b){var c=b[0]-a.Ca[0];if(0>c)return!1;var d=b[1]>>c,c=b[2]>>c;return d<a.ia[0][0]||d>a.ia[1][0]||c<a.ia[0][1]||c>a.ia[1][1]?0:b[0]>a.Ca[1]?1:2}function Rc(a,b){return Sc(a.c,a.Td,{ua:b[0],Fb:b[1],Gb:b[2]},null,void 0)}function kc(a){this.c=a;this.ac=new Tc(a,null,[0,0,0])}kc.prototype.I=function(){this.ac.I()};
function Uc(a,b,c,d){a=a.ac;var e=b[1]>>c<<c;c=b[2]>>c<<c;for(b=b[0];0<b;b--){var f=1<<b-1,g=0;0!=(e&f)&&(g+=1);0!=(c&f)&&(g+=2);if(!a.la[g])if(d)a.jk(g);else return null;a=a.la[g]}return a}function Tc(a,b,c){this.c=a;this.g=c;this.Fa=b;this.Rh={};this.ls={};this.qt={};this.fb={};this.L={};this.la=[null,null,null,null]}Tc.prototype.I=function(){for(var a=0;4>a;a++)null!=this.la[a]&&this.la[a].I();this.la=[null,null,null,null];a=this.Fa;this.Fa=null;null!=a&&a.removeChild(this)};
Tc.prototype.jk=function(a){if(!this.la[a]){var b=this.g,b=[b[0]+1,b[1]<<1,b[2]<<1];switch(a){case 1:b[1]++;break;case 2:b[2]++;break;case 3:b[1]++,b[2]++}this.la[a]=new Tc(this.c,this,b)}};Tc.prototype.Ns=function(a){null!=this.la[a]&&(this.la[a].I(),this.la[a]=null)};Tc.prototype.removeChild=function(a){for(var b=0;4>b;b++)this.la[b]==a&&(this.la[b].I(),this.la[b]=null)};function Vc(a,b,c,d,e,f,g){var k=a.qt[b];k||(k=new Wc(a.c,b,c,d,e,f,g),a.qt[b]=k);return k}
function Xc(a,b){for(var c in a.Rh)a.Rh[c]==b&&delete a.Rh[c]}function Yc(a,b,c,d){var e=a.Rh,f;for(f in e)if(e[f].H==b)return e[f];f=b.cl(a.g);return e[f]?(b=e[f].clone(b),a.Rh[f]=b):c?(b=new Zc(a,b,d),a.Rh[f]=b):null}function fc(a,b){this.c=a;this.vf=null!=b?b:Number.MAX_VALUE;this.Wb=this.yc=null;this.Zc=0}function $c(a,b){if(null!=b&&a.Wb!=b){null!=b.kc&&(b.kc.Tc=b.Tc);null!=b.Tc&&(b.Tc.kc=b.kc);a.yc==b&&(a.yc=b.kc);var c=a.Wb;a.Wb=b;a.Wb.Tc=c;a.Wb.kc=null;c.kc=a.Wb}}l=fc.prototype;
l.clear=function(){for(var a=this.Wb;null!=a;)null!=a.Ek&&a.Ek(),a=a.Tc;this.Wb=this.yc=null;this.Zc=0};function ad(a,b,c){b={Ek:b,Qq:c,kc:null,Tc:a.Wb};null!=a.Wb&&(a.Wb.kc=b);a.Wb=b;null==a.yc&&(a.yc=b);a.Zc+=c;vc(a);return b}l.remove=function(a){var b=!1;a==this.Wb&&(this.Wb=a.Tc,b=!0,null!=this.Wb&&(this.Wb.kc=null));a==this.yc&&(this.yc=a.kc,b=!0,null!=this.yc&&(this.yc.Tc=null));if(!b){if(a.kc)a.kc.Tc=a.Tc;else debugger;if(a.Tc)a.Tc.kc=a.kc;else debugger}this.Zc-=a.Qq;a.Ek();vc(this)};
function vc(a){for(;a.Zc>a.vf;){var b=a.yc;if(null!=b)a.yc=a.yc.kc,null!=a.yc&&(a.yc.Tc=null),a.Zc-=b.Qq,b.Ek();else break}}l.Nt=function(a,b){return ad(this,b,a)};l.removeItem=function(a){return this.remove(a)};l.Cv=function(a){return $c(this,a)};fc.prototype.addItem=fc.prototype.Nt;fc.prototype.removeItem=fc.prototype.removeItem;fc.prototype.itemUsed=fc.prototype.Cv;function dc(a,b){this.c=a;b instanceof dc?this.s=b.s.slice():(this.s=null!=b&&b instanceof Array?b.slice():[],this.It())}l=dc.prototype;
l.clone=function(){return new dc(this.c,this.s)};function Nc(a){return[a.s[1],a.s[2],a.s[4]]}function bd(a,b){a.s[1]=b[0];a.s[2]=b[1];a.s[4]=b[2];return a}function cd(a,b){a.s[1]=b[0];a.s[2]=b[1]}function dd(a,b){a.s[4]=b;return a}l.ec=function(){return[this.s[5],this.s[6],this.s[7]]};l.setOrientation=function(a){this.s[5]=a[0];this.s[6]=a[1];this.s[7]=a[2];return this};l.je=function(){return this.s[9]};function ed(a,b){a.s[9]=b;return a}function fd(a,b){a.s[8]=b;return a}
function Oc(a){return.5*a.s[8]/Math.tan(p.Ga(.5*a.je()))}l.check=function(){this.s[6]=p.dd(this.s[6],-90,90);this.s[5]%=360;this.s[7]%=360};function gd(a,b,c,d){var e=Nc(a),f;Qa(a.c).fc();d=null==d?1:d;Pa(Qa(a.c))?(d=p.Ga(b),d=[-Math.sin(d),Math.cos(d)],cd(a,[e[0]+d[0]*c,e[1]+d[1]*c])):(f=Qa(a.c).fc(),c=(new GeographicLib.Geodesic.Geodesic(f.a,f.a/f.b-1)).Direct(e[1],e[0],b,c),cd(a,[c.lon2,c.lat2]),e=a.ec(),e[0]+=(c.azi1-c.azi2)*d,a.setOrientation(e));return a}
function va(a,b){if(b==a.s[0])return a;if("obj"==b){if("float"==a.s[3]){var c=!0;hd(a,"fix")}var d=Oc(a),e=a.ec(),f=p.Ga(-e[1]),g=d*Math.sin(f),d=d*Math.cos(f);Pa(Qa(a.c))?(e=p.Ga(e[0]),e=[-Math.sin(e),Math.cos(e)],f=Nc(a),f[0]+=e[0]*d,f[1]+=e[1]*d):(gd(a,-e[0],d),f=Nc(a));f[2]-=g;bd(a,f);c&&hd(a,"float")}else"subj"==b&&(f=id(a,a.s[3]),bd(a,f));a.s[0]=b;return a}
function hd(a,b){if(a.s[3]==b)return a;var c=Mc(a.c,Nc(a),a.s[8],a.c.f.Oe),c=a.c.vc(Nc(a),c);"float"==b?(a.s[3]=b,a.s[4]-=c[0]):"fix"==b&&(a.s[3]=b,a.s[4]+=c[0]);return a}function Pc(a,b){b=b.s;return!(a.s[0]==b[0]&&p.isEqual(a.s[1],b[1],1E-7)&&p.isEqual(a.s[2],b[2],1E-7)&&a.s[3]==b[3]&&p.isEqual(a.s[4],b[4],.001)&&p.isEqual(a.s[5],b[5],.001)&&p.isEqual(a.s[6],b[6],.001)&&p.isEqual(a.s[7],b[7],.001)&&p.isEqual(a.s[8],b[8],.001)&&p.isEqual(a.s[9],b[9],.001))}
l.It=function(){var a=this.s;"fixed"==a[0]&&(a[0]="obj",a[9]=a[8],a[8]=a[7],a[7]=a[6],a[6]=a[5],a[5]=a[4],a[4]=a[3],a[3]="fix");a[0]="obj"==a[0]||"subj"==a[0]?a[0]:"obj";a[1]=null!=a[1]?a[1]:0;a[2]=null!=a[2]?a[2]:0;a[3]="fix"==a[3]||"fixed"==a[3]||"float"==a[3]?a[3]:"float";a[4]=null!=a[4]?a[4]:0;a[5]=null!=a[5]?a[5]:0;a[6]=null!=a[6]?a[6]:-90;a[7]=null!=a[7]?a[7]:0;a[8]=null!=a[8]?a[8]:900;a[9]=null!=a[9]?a[9]:55;a[3]="fixed"==a[3]?"fix":a[3]};
function id(a,b){var c=a.ec(),d=p.i.create();p.i.multiply(p.Xc(2,p.Ga(c[0])),p.Xc(0,p.Ga(c[1])),d);if("obj"==a.s[0]){var c=Nc(a),e=0;"float"==a.s[3]&&(d=Mc(a.c,Nc(a),a.s[8],a.c.f.Oe),d=a.c.vc(Nc(a),d),e=d[0]);d=a.ie(Pa(Qa(a.c)));Pa(Qa(a.c))?(c[0]+=d.Uc[0],c[1]+=d.Uc[1],c[2]+=d.Uc[2]+e):(c=a.c.Pa([c[0],c[1],c[2]+e],"navigation","physical"),c[0]+=d.Uc[0],c[1]+=d.Uc[1],c[2]+=d.Uc[2],c=a.c.Pa(c,"physical","navigation"));"fix"!=b&&(d=Mc(a.c,c,a.s[8],a.c.f.Oe),d=a.c.vc(c,d),c[2]-=d[0]);return c}if(a.s[3]==
b)return Nc(a);d=Mc(a.c,Nc(a),a.s[8],a.c.f.Oe);d=a.c.vc(Nc(a),d);c=Nc(a);c[2]="fix"==b?c[2]+d[0]:c[2]-d[0];return c}function jd(a,b){var c=Nc(a);if("float"==a.s[3]){b=null!=b?b:Mc(a.c,Nc(a),a.s[8],a.c.f.Oe);var d=a.c.vc(Nc(a),b);c[2]+=d[0]}c=a.c.Pa(c,"navigation","physical");d=a.c.ka;c[0]-=d[0];c[1]-=d[1];c[2]-=d[2];return c}l.ag=function(a,b){if(b)var c=this.c.ka,d=Nc(this),c=[d[0]-c[0],d[1]-c[1],d[2]-c[2]];else c=jd(this,a);return qb(this.c.m,c,oa(this.c.P))};
function kd(a){var b=a.clone();hd(b,"fix");var c=Nc(b),b=a.c.Pa(c,"navigation","physical");a.c.Pa([0,0],"navigation","physical");a.c.Pa([-180,0],"navigation","physical");a.c.Pa([90,0],"navigation","physical");a.c.Pa([0,90],"navigation","physical");a.c.Pa([-90,0],"navigation","physical");a.c.Pa([0,-90],"navigation","physical");a.c.Pa([0,-100],"navigation","physical");if(Pa(Qa(a.c)))var d=a.c.Pa([c[0],c[1]+100,c[2]],"navigation","physical"),e=a.c.Pa([c[0]+100,c[1],c[2]],"navigation","physical");else{var f=
Kc(a.c),e=f.Direct(c[1],c[0],0,-100),d=a.clone();cd(d,[e.lon2,e.lat2]);d=a.c.Pa(Nc(d),"navigation","physical");e=f.Direct(c[1],c[0],90,100);c=a.clone();cd(c,[e.lon2,e.lat2]);e=a.c.Pa(Nc(c),"navigation","physical")}a=[d[0]-b[0],d[1]-b[1],d[2]-b[2]];b=[e[0]-b[0],e[1]-b[1],e[2]-b[2]];d=[0,0,0];p.D.normalize(a);p.D.normalize(b);p.D.bn(a,b,d);p.D.normalize(d);return{gr:b,Xq:a,ss:d}}
l.ie=function(a,b){var c=this.ec(),d=Oc(this);b&&(c[1]=p.dd(c[1],-89,90));var e=p.i.create();p.i.multiply(p.Xc(2,p.Ga(c[0])),p.Xc(0,p.Ga(c[1])),e);if("obj"==this.s[0]){var f=[0,-d,0];p.i.Ma(e,f)}else f=[0,0,0];d={Uc:null,Qa:d,Kp:null,ek:null,Mw:f[2]};if(a){e=p.i.create();p.i.multiply(p.Xc(0,p.Ga(-c[1]-90)),p.Xc(2,p.Ga(-c[0])),e);var g=kd(this);north_=g.ss;east_=g.gr;direction_=g.Xq;var c=[1,0,0],g=[0,1,0],k=[0,0,1],h=[1,0,0],m=[0,0,-1],n=[0,0,0];p.D.bn(h,m,n);p.i.Ma(e,k);p.i.Ma(e,c);p.i.Ma(e,g);p.i.Ma(e,
h);p.i.Ma(e,m);p.i.Ma(e,n);e=h[0];h[0]=h[1];h[1]=e;e=m[0];m[0]=m[1];m[1]=e;e=n[0];n[0]=n[1];n[1]=e;h[2]=-h[2];m[2]=-m[2];n[2]=-n[2];g=[c[0],c[1],c[2],0,g[0],g[1],g[2],0,k[0],k[1],k[2],0,0,0,0,1];d.ek=p.D.normalize([-f[0],-f[1],-f[2]]);d.Iy=d.ek;d.Uc=f;d.Kp=g}else g=kd(this),north_=g.ss,east_=g.gr,direction_=g.Xq,e=p.i.create(),p.i.multiply(p.Xc(0,p.Ga(-c[1]-90)),p.Xc(2,p.Ga(-c[0])),e),c=[1,0,0],g=[0,1,0],k=[0,0,1],h=Nc(this),m=p.i.create(),p.i.multiply(p.Xc(0,p.Ga(h[1]-90)),p.Xc(2,p.Ga(-h[0]-90)),
m),p.i.Ma(m,k),p.i.Ma(m,c),p.i.Ma(m,g),c=[c[0],c[1],c[2],0,g[0],g[1],g[2],0,k[0],k[1],k[2],0,0,0,0,1],n=[1,0,0],h=[0,1,0],m=[0,0,1],p.i.Ma(c,h),p.i.Ma(c,m),p.i.Ma(c,n),p.i.Ma(e,n),p.i.Ma(e,h),p.i.Ma(e,m),g=[n[0],n[1],n[2],0,h[0],h[1],h[2],0,m[0],m[1],m[2],0,0,0,0,1],c=p.i.inverse(c),p.i.Ma(c,f),d.Iy=[-c[8],-c[9],-c[10]],p.i.inverse(g,c),d.ek=[-c[8],-c[9],-c[10]];d.Uc=f;d.Kp=g;return d};
l.toString=function(){var a=this.s;return a[0]+", "+a[1].toFixed(0)+", "+a[2].toFixed(0)+", "+a[3]+", "+a[4].toFixed(0)+", "+a[5].toFixed(0)+", "+a[6].toFixed(0)+", "+a[7].toFixed(0)+", , "+a[8].toFixed(0)+", "+a[9].toFixed(0)};function oc(a,b){this.c=a;this.g=b.id||null;this.fp=b.notice||null;this.Td=b.url||null;this.Hr=p.$s(this.fp);this.Rw=p.$s(this.fp)}oc.prototype.gb=function(){return{id:this.g,notice:this.fp,html:this.Hr,plain:this.Rw}};
Wb.prototype.jb=function(a,b){this.Pe=.5*this.m.wa[0];var c=this.sa().ec(),c=Math.log(.05)/(Math.max(5,-c[1])/90*Math.max(1,1E-4*this.wd)*this.P.Xf),c=5/(Math.min(5E4,Math.max(this.Vb,1E3))/5E3)*c;this.Ui||(c=0);this.Zf=c;this.m.Zf=c;for(var c=this.Ib.Ae.Na,d=0,e=c.length;d<e;d++){var f=c[d],g=2*(f.da.na[0]-f.da.ja[0]),k=Math.log(Math.min(g,Math.max(10,this.Vb+20)))/this.as,k=Math.log(g)/this.as-k;f.jv=k-Math.floor(k);k=Math.floor(Math.floor(k))+1;f.Br=Math.pow(8,k);f.kv=8*f.Br}this.tg=.9*this.gc.vf;
this.xn=this.o.mb=0;c=this.ka;if(this.Jk){if(this.w.Tg||this.w.Sg)this.w.yf=[];if(this.w.br||this.w.zn||this.w.Kk||this.w.sn||this.w.pn||this.w.Lk){g=this.w.ua;k=this.w.at;if(this.w.zn&&this.w.Ce)for(var h=this.w.Ce,d=0,e=h.length;d<e;d++)f=h[d],(k&&f.g[0]==g||!k&&f.g[0]<=g)&&ud(this,f,f.F,c,f.Vc,!1,!1);if(this.w.Kk&&this.w.Nk)for(h=this.w.Nk,d=0,e=h.length;d<e;d++)f=h[d],(k&&f.g[0]==g||!k&&f.g[0]<=g)&&ud(this,f,f.F,c,f.Vc,!1,!1);if(this.w.sn&&this.w.iq){var h=this.w.iq,m=this.sc;this.sc=!0;d=0;for(e=
h.length;d<e;d++)f=h[d],(k&&f.g[0]==g||!k&&f.g[0]<=g)&&vd(this,f,f.F,c,f.Xa);this.sc=m}if(this.w.pn&&this.w.hq){h=this.w.hq;m=this.sc;this.sc=!0;d=0;for(e=h.length;d<e;d++)f=h[d],(k&&f.g[0]==g||!k&&f.g[0]<=g)&&vd(this,f,f.F,c,f.Xa);this.sc=m}var h=this.w.Kd,n=this.w.bt;if(this.w.Lk&&this.w.zc){var q=this.w.zc;this.sc=!0;d=0;for(e=q.length;d<e;d++)(f=q[d])&&f.S&&f.S.g&&(f=f.S,(n&&d==h||!n&&d<=h)&&(k&&f.g[0]==g||!k&&f.g[0]<=g)&&f.F&&(0!=(f.F.X&1)?ud(this,f,f.F,c,f.Vc,!1,!1):vd(this,f,f.F,c,f.Xa)));
this.sc=m}(this.w.Kk&&this.w.Nk||this.w.Lk&&this.w.zc)&&this.Tk&&(Ub(this.m),Vb(this.m));return}d=0;for(e=this.nc.length;d<e;d++)this.nc[d]=null;0<this.ac.Vg.length&&this.ac.jb();if(this.w.wi){m=[];d=0;for(e=this.nc.length;d<e;d++)if(h=this.nc[d])for(g=0,k=h.length;g<k;g++)m.push(h[g]);this.w.Ei=c;this.w.Ce=m;this.w.wi=!1}if(this.w.Tg){m=[];d=0;for(e=this.w.yf.length;d<e;d++)f=this.w.yf[d],m.push(f);this.w.Ei=c;this.w.iq=m;this.w.Tg=!1}d=0;for(e=this.Yi.length;d<e;d++)m=this.Yi[d],m.va&&m.ac&&(!m.fb||
m.re&&m.re.ha())&&("geodata"==m.R?m&&this.P.Zd(m.da,this.ka)&&(null==m.$l&&(f=Sc(m.c,m.$i,{},null,void 0),m.$l=new wd(this,f,{S:null,H:m})),m.os!=m.De&&(m.Ej=null,m.os=m.De),m.$l.ha()&&(m.Ej||(m.Ej=new xd(this,m.$l,{S:null,H:m})),m.Ej.ha()&&m.Ej.jb(this.ka))):m.ac.jb());if(this.w.vi){m=[];d=0;for(e=this.nc.length;d<e;d++)if(h=this.nc[d])for(g=0,k=h.length;g<k;g++)f=h[g],f.H&&f.H.Uk&&m.push(f);this.w.Ei=c;this.w.Nk=m;this.w.vi=!1}if(this.w.Sg){m=[];d=0;for(e=this.w.yf.length;d<e;d++)f=this.w.yf[d],
f.H&&f.H.Uk&&m.push(f);this.w.Ei=c;this.w.hq=m;this.w.Sg=!1}}!b&&this.Ui&&"melown2015"==this.Ib.g&&(this.pa.ie(!0),m=Qa(this).fc().a,d=[0,0,0,0],p.D.normalize(this.ka,d),p.D.length(this.ka),c=this.sa().ec(),c=1-Math.max(0,Math.min(1,this.wd/(5E4*(10+Math.max(5,-c[1])/90*20)))),c=[Math.max(2,c*c*128),0,0,0],this.wd>2*m&&(c[0]=2-Math.min(1,(this.wd-2*m)/(2*m))),this.m.j.Gc(this.su),Tb(this.m,[-this.ka[0],-this.ka[1],-this.ka[2]],m,this.m.ex,c,d,null,!0),c=[2,(m+5E4)/m*2,.25,(m+5E4)/m*2],d=1/m*2,d=[this.ka[0]*
d,this.ka[1]*d,this.ka[2]*d,1],e=1.1,f=1.5,6E4<this.wd?(f=1.8,e=[f,1,f,0]):(5E3>this.wd&&(e=1.05,f=1.12),e=[e,5.2/(f-e),f,0]),this.m.j.Gc(this.tu),Tb(this.m,[-this.ka[0],-this.ka[1],-this.ka[2]],m+5E4,this.m.fx,c,d,e),this.m.j.Gc(this.yn));this.Jk&&!a&&this.Tk&&(Ub(this.m),Vb(this.m))};
function yd(a,b,c,d){var e=!0;d=d?!1:!0;for(var f=0,g=a.length;f<g;f++){var k=a[f];switch(k.R){case "submesh":var h=k.Bc,k=k.U,h=h&&h.ha(c,b,d),k=!k||k&&k.ha(c,b,d);h&&k||(e=!1);break;case "geodata":(h=k.nr)&&h.ha(c,b,d)||(e=!1)}}return e}function zd(a,b){for(var c in b.hc){var d=b.hc[c],e=a.Xd.oj[c];a.Xd.oj[c]=e?d>e?d:e:d}for(c in b.fg)d=b.fg[c],e=a.Xd.oj[c],a.Xd.il[c]=e?d>e?d:e:d;for(c in b.uf)d=b.uf[c],e=a.Xd.Sl[c],a.Xd.Sl[c]=e?d>e?d:e:d}
function Ad(a,b,c,d,e){0<c.length&&a.xn++;for(var f=0,g=c.length;f<g;f++){var k=c[f];switch(k.R){case "state":a.m.j.Gc(k.We);break;case "submesh":var h=k.Bc,m=k.U,n=h&&h.ha(e,d),q=!m||m&&m.ha(e,d);if(n&&q)if(a.sc&&a.Vi&&h.Jb[k.qd].sh(b),m)Bd(h,b,k.qd,m,k.Nd,k.nb);else{n=k.Nd;switch(n){case "external":case "internal":n="flat"}Bd(h,b,k.qd,m,n,k.nb)}break;case "geodata":(k=k.nr)&&k.ha(e,d,!0)&&k.jb(b)}}}p.Xy=[144,8880,5492];
function ud(a,b,c,d,e,f,g,k){if(a.o.Yb>=a.tg)return!1;b.Dp=!1;if(b.H){if(0!=(c.X&1)){a.sc&&!f&&vd(a,b,c,d,b.Xa);if(a.oo&&!f)return b.H.fb||Cd(b,d),!0;f||(a.o.Eg[b.g[0]]++,a.o.Ce++,b.H.fb&&a.o.Ok++);if(b.Jg){b.ra=[[],[],[]];b.bk=!0;if(b.vd)for(var h in b.vd)b.vd[h].ue=0;b.Jg=!1}if(b.H.fb)if(1>=b.g[0])b=!0;else{if(null==b.se){var m;if(b.H.mr){h=b.g;var n=a.ac.Wg;if(0==h[0])h=n.F&&0!=(n.F.X&2)?n:null;else{for(var q=null,y=h[0];0<y;y--){var w=1<<y-1,t=0;0!=(h[1]&w)&&(t+=1);0!=(h[2]&w)&&(t+=2);if(n=n.la[t])n.F&&
0!=(n.F.X&2)&&(q=n);else break}h=q}h&&h.H&&(m=Dd(h.H,h.g)+";"+h.g[0]+"-"+h.g[1]+"-"+h.g[2]+";"+h.F.ne+";"+h.F.kb,m=Ed(b.H,b.g,encodeURIComponent(m)))}m||(m=Ed(b.Ua,b.g,""));h=b.Wc;n={S:b,H:b.H};q=h.fb[m];q||(q=new wd(h.c,m,n),h.fb[m]=q);b.se=q}m=a.ge;b.De!=b.H.De&&(b.ra=[[],[],[]],null!=b.Hc&&b.Hc.I(),b.Hc=null,b.De=b.H.De);if(0<b.ra[m].length&&yd(b.ra[m],e,g,k))f||(Ad(a,d,b.ra[m],e),zd(a,b)),b.xc=null,b=!0;else if(b.Hc||!b.se.ha(g,e)||g||(b.Hc=new xd(a,b.se,{S:b,H:b.H})),b.Hc){b.uf={};a=b.H?b.H.Kf:
0;d=0;for(e=c.L.length;d<e;d++)b.uf[c.L[d]]=a;b.ra[m][0]={R:"geodata",nr:b.Hc};b=b.Hc.ha()}else b=!1}else a:{if(!b.Xa){if(b.Ua.Wd){b=!0;break a}m=b.Ua;h=b.g;t=Sc(m.c,m.Xl,{ua:h[0],Fb:h[1],Gb:h[2]},null,void 0);m=b.Wc;h=t;n=m.ls[h];n||(n=new Fd(m.c,h,b),m.ls[h]=n);b.Xa=n}m=a.ge;h=!1;if(0<b.ra[m].length&&yd(b.ra[m],e,g,k))f||(Ad(a,d,b.ra[m],e),zd(a,b)),b.xc=null,b=!0;else{if(b.xc)if(1==b.Xa.ha(!0,e)){if(0<b.ra[m].length){f||(Ad(a,d,b.xc.ra[m],e,!0),zd(a,b));b=!0;break a}}else f||(Ad(a,d,b.xc.ra[m],
e,!0),zd(a,b)),h=!0;0<b.ra[m].length&&a.f.Qh&&!f&&(Cd(b,d),h=!0);if(b.Xa.ha(g,e)&&!g){n=b.Xa.Jb;b.ra=[[],[],[]];b.hc={};b.qc={};var v=0;if(b.H.gg){t=b.H.g;q=0;for(y=t.length;q<y;q++)(w=a.He(t[q]))&&(v=Math.max(v,w.Kf));for(var t=0,D=c.L.length;t<D;t++)b.fg[c.L[t]]=v}else for(v=b.H.Kf,t=0,D=c.L.length;t<D;t++)b.hc[c.L[t]]=v;q=0;for(y=n.length;q<y;q++){c=n[q];a.sc&&a.Vi&&!f&&c.sh(d);if(c.zd){if(b.bk){b.bk=!1;for(var t=a,w=b,D=n,v=0,B=D.length;v<B;v++){var x=D[v];if(x.zd){var H=w.Ua;w.Ua.gg&&(H=w.Ua.Ug[x.Ug-
1]);if(H){var u=w.vd[H.g];u||(u={Qd:[],nb:[],Cm:!1,ue:0},w.vd[H.g]=u);if(u.ue!=w.ue){var L=t,r=w,A=x,x=H,H=u,u=u.ue!=w.ue;if(0<x.cd.length){if(u){H.Qd=[];for(var L=[],O=A=0,fa=x.cd.length;O<fa;O++){var C=x.cd[O][0];if(C&&C.va&&Qc(C,r.g)&&0<x.cd[O][1]){var da=null;r.g[0]>C.Ca[1]&&(da={Pg:Gd(r,C.Ca[1]),ft:null,$a:C,S:r});u=r.xb[C.g];u||(u=Rc(C,r.g),u=Vc(r.Wc,u,null,da,{S:r,$a:C},r,!1),u.ha(!0),r.xb[C.g]=u);!u.Gj&&(Hd(u)&&(H.Cm=!0),(u=!(1>x.cd[O][1]||u.V||Hd(u)||C.xl))&&A++,L.push(u),H.Qd.push(C.g),
H.nb[C.g]=x.cd[O],r.ob[C.g]=C,1>H.nb[C.g][1]||C.xl)&&(H.Cm=!0)}}if(0<A){x=[];for(A=H.Qd.length-1;0<=A;A--)if(O=H.Qd[A],L[A]){x.unshift(O);break}else u=r.xb[O],(1>H.nb[O][1]||r.ob[O].xl||Hd(u)&&!u.V)&&x.unshift(O);H.Qd=x}}}else null!=x.$e?u&&(C=L.ob[x.$e])&&Qc(C,r.g)&&(da=null,r.g[0]>C.Ca[1]&&(da={Pg:Gd(r,C.Ca[1]),ft:null,$a:C,S:r}),H.Qd.push(C.g),r.ob[C.g]=C,r.xb[C.g]||(u=Rc(C,r.g),r.xb[C.g]=Vc(r.Wc,u,null,da,{S:r,$a:C},r,!1))):0!=A.$e&&(C=wc(L,A.$e))&&Qc(C,r.g)&&(da=null,r.g[0]>C.Ca[1]&&(da={Pg:Gd(r,
C.Ca[1]),ft:null,$a:C,S:r}),r.ob[C.g]=C,r.xb[C.g]||(u=Rc(C,r.g),r.xb[C.g]=Vc(r.Wc,u,null,da,{S:r,$a:C},r,!1)))}}}}t=void 0;for(t in w.vd)w.vd[t].ue=w.ue}w=b.Ua;b.Ua.gg&&(w=b.Ua.Ug[c.Ug-1]);if(null!=w&&(v=b.vd[w.g]))if(c.zd)if(0<v.Qd.length)if(v.Cm){c.Nc&&(null==b.Cb[q]&&(t=Id(b.Ua,b.g,q),b.Cb[q]=Vc(b.Wc,t,null,null,null,b,!0)),b.ra[0].push({R:"submesh",Bc:b.Xa,qd:q,U:b.Cb[q],Nd:"internal-nofog"}));b.ra[0].push({R:"state",We:a.uu});B=v.Qd;r=0;for(H=B.length;r<H;r++)if(c=b.xb[B[r]]){b.qc[w.g]||(b.qc[w.g]=
[]);b.qc[w.g].push(B[r]);x=b.ob[B[r]];L=x.L;t=0;for(D=L.length;t<D;t++)b.hc[L[t]]=x.Kf;b.ra[0].push({R:"submesh",Bc:b.Xa,qd:q,U:c,Nd:"external-nofog",nb:v.nb[B[r]][1]})}b.ra[0].push({R:"submesh",Bc:b.Xa,qd:q,U:null,Nd:"fog"});b.ra[0].push({R:"state",We:a.yn})}else{if(t=v.Qd[v.Qd.length-1],c=b.xb[t]){b.qc[w.g]||(b.qc[w.g]=[]);b.qc[w.g].push(t);x=b.ob[t];L=x.L;t=0;for(D=L.length;t<D;t++)b.hc[L[t]]=x.Kf;b.ra[0].push({R:"submesh",Bc:b.Xa,qd:q,U:c,Nd:"external"})}}else if(c.$e){if(x=wc(a,c.$e))if(c=b.xb[x.g]){b.qc[w.g]||
(b.qc[w.g]=[]);b.qc[w.g].push(x.g);x=b.ob[x.g];L=x.L;t=0;for(D=L.length;t<D;t++)b.hc[L[t]]=x.Kf;b.ra[0].push({R:"submesh",Bc:b.Xa,qd:q,U:c,Nd:"external"})}}else c.Nc?(null==b.Cb[q]&&(t=Id(b.Ua,b.g,q),b.Cb[q]=Vc(b.Wc,t,null,null,null,b,!0)),b.ra[0].push({R:"submesh",Bc:b.Xa,qd:q,U:b.Cb[q],Nd:"internal"})):b.ra[0].push({R:"submesh",Bc:b.Xa,qd:q,U:null,Nd:"flat"});else c.Nc&&(null==b.Cb[q]&&(t=Id(b.Ua,b.g,q),b.Cb[q]=Vc(b.Wc,t,null,null,null,b,!0)),b.ra[0].push({R:"submesh",Bc:b.Xa,qd:q,U:b.Cb[q],Nd:"internal"}))}else c.Nc&&
(null==b.Cb[q]&&(t=Id(b.Ua,b.g,q),b.Cb[q]=Vc(b.Wc,t,null,null,null,b,!0)),b.ra[0].push({R:"submesh",Bc:b.Xa,qd:q,U:b.Cb[q],Nd:"internal"}));b.ra[1].push({R:"submesh",Bc:b.Xa,qd:q,Nd:"depth"})}yd(b.ra[m],e,g,k)?(f||(Ad(a,d,b.ra[m],e),zd(a,b)),b.xc=null,h=!0):b.xc?(f||(Ad(a,d,b.xc.ra[m],e,!0),zd(a,b)),h=!0):a.f.Qh&&!f&&(Cd(b,d),h=!0)}else a.f.Qh&&!f&&(Cd(b,d),h=!0);b=h}}return b}return!0}if(!f&&b.xc)return Ad(a,d,b.xc.ra[a.ge],e,!0),zd(a,b),!0}function Gd(a,b){for(;a&&a.g[0]>b;)a=a.Fa;return a}
function vd(a,b,c,d,e){if(!a.Vi)if(a.Ik){for(var f=[],g=0,k=c.Di.length;g<k;g++){var h=c.Di[g],h=["obj",h[0],h[1],"fix",h[2],0,0,0,10,90];f.push((new dc(c.c,h)).ag(null,!0))}g=c.c.m;g.fd([f[0],f[1],f[2],f[3],f[0]],2,[0,1,.5,255],!1,!1,!0);g.fd([f[4],f[5],f[6],f[7],f[4]],2,[0,1,.5,255],!1,!1,!0)}else c.sh(d);k=c.A.W;f=c.A.xa;d=a.l.nf().ag([k[0]+.5*(f[0]-k[0])-d[0],k[1]+.5*(f[1]-k[1])-d[1],f[2]-d[2]],oa(a.P));d[2]*=.9992;f=a.en;a.qn&&(g=""+b.g[0],Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]-
4*f),4*f,g,[255,0,0,255],d[2]));a.cr&&(g=""+b.g[1]+" "+b.g[2],Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]-11*f),4*f,g,[0,255,255,255],d[2]));a.un&&(g=""+k[0].toFixed(1)+" "+k[1].toFixed(1)+" "+k[2].toFixed(1),Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]+3*f),4*f,g,[0,255,255,255],d[2]));a.nn&&e&&(g=""+e.hf+" - "+e.Jb.length+(b.H&&b.H.gg?" - 1":" - 0"),Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]+10*f),4*f,g,[0,255,0,255],d[2]));a.tn&&(g=""+a.xn,Ob(a.m,Math.round(d[0]-.5*Pb(4*
f,g)),Math.round(d[1]+10*f),4*f,g,[0,255,0,255],d[2]));a.vn&&(g=JSON.stringify(b.H.g),c.Ci&&(g="[A]"+g),Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]+10*f),4*f,g,[255,255,255,255],d[2]));if(a.kn&&b.qc){var m=b.H;if(m.gg)for(k=0,h=m.g.length;k<h;k++)b.qc[m.g[k]]&&(g="< "+m.g[k]+" >",Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]+(10+14*k)*f),4*f,g,[255,255,255,255],d[2]),g=JSON.stringify(b.qc[m.g[k]]),Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]+(17+14*k)*f),4*f,g,[255,255,255,
255],d[2]));else b.qc[m.g]&&(g="< "+m.g+" >",Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]+10*f),4*f,g,[255,255,255,255],d[2]),g=JSON.stringify(b.qc[m.g]),Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]+17*f),4*f,g,[255,255,255,255],d[2]))}if(a.Ik){var g="{ ",n;for(n in b.hc)b.hc[n]&&(g+=n+":"+b.hc[n]+", ");for(n in b.fg)b.hc[n]||(g+=n+":"+b.fg[n]+", ");g+="}";Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]+10*f),4*f,g,[255,255,255,255],d[2])}a.mn&&(g=""+b.Qa.toFixed(2)+"  "+b.Tb.toFixed(3)+
"  "+c.ai.toFixed(3),g+="--"+b.iy.toFixed(3),Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]+17*f),4*f,g,[255,0,255,255],d[2]));a.rn&&(n=(c.X&240)>>4,g=""+c.X.toString(2)+"-"+(n&1?"1":"0")+(n&2?"1":"0")+(n&4?"1":"0")+(n&8?"1":"0"),g+="-"+c.ne+"/"+c.kb,Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]-18*f),4*f,g,[255,0,255,255],d[2]));if(a.wn&&e)for(c=e.Jb,k=0,h=c.length;k<h;k++)c[k].Nc&&(e=b.Cb[k])&&e.sb&&(g="["+k+"]: "+e.sb.bf+" x "+e.sb.Kh,Ob(a.m,Math.round(d[0]-.5*Pb(4*f,g)),Math.round(d[1]+
(17+14*k)*f),4*f,g,[255,255,255,255],d[2]))}function S(a){this.c=a;this.f=a.f}l=S.prototype;l.setPosition=function(a){this.c.setPosition(a);return this};l.sa=function(){return this.c.sa().s};l.Rd=function(a){this.c.Rd(a);return this};l.pf=function(){return this.c.pf()};l.yh=function(){return this.c.yh()};
l.bj=function(){var a=this.c,b=a.Xd.oj,c=a.Xd.il,d=[],e=[],f;for(f in c)b[f]||(b[f]=c[f]);a.Xd.il={};for(f in b)d.push(f),e.push(b[f]);do for(var g=!0,b=0,c=e.length-1;b<c;b++)e[b]<e[b+1]&&(g=e[b],e[b]=e[b+1],e[b+1]=g,g=d[b],d[b]=d[b+1],d[b+1]=g,g=!1);while(!g);b=a.Xd.Sl;a=[];e=[];for(f in b)a.push(f),e.push(b[f]);do for(g=!0,b=0,c=e.length-1;b<c;b++)e[b]<e[b+1]&&(g=e[b],e[b]=e[b+1],e[b+1]=g,g=a[b],a[b]=a[b+1],a[b+1]=g,g=!1);while(!g);return{"3D":[],imagery:d,mapdata:a}};
l.Kn=function(a){return(a=this.c.L[a])?a.gb():{}};l.Rn=function(){return Ma(this.c.wg)};l.Qn=function(a){return(a=this.c.wg[a])?a.gb():{}};l.kf=function(){return this.c.kf()};l.Yk=function(a){return this.c.Yk(a)};l.bg=function(){return this.c.bg()};l.Mn=function(a){return(a=this.c.fa[a])?a.gb():{}};l.eg=function(){return this.c.eg()};l.On=function(a){return(a=this.c.fa[a])?a.gb():{}};l.Dh=function(){return this.c.Dh(surfaceId_)};l.fc=function(a){return(a=this.c.Qg[a])?a.gb():{}};l.mf=function(){return this.c.Ib.gb()};
l.Bk=function(a,b){var c=va(new dc(this.c,a),b);return null!=c?c.s:c};l.Rf=function(a,b){var c=hd(new dc(this.c,a),b);return null!=c?c.s:c};l.Pa=function(a,b,c){a=this.c.Qg[a];b=this.c.Qg[b];return a&&b?Jd(b,c,a):null};l.Li=function(a,b,c){return(new dc(this.c,["obj",a[0],a[1],b,a[2],0,0,0,10,90])).ag(c)};l.Qf=function(a){return(new dc(this.c,["obj",a[0],a[1],"fix",a[2],0,0,0,10,90])).ag(null,!0)};l.Ak=function(a,b,c){return jd(new dc(this.c,["obj",a[0],a[1],b,a[2],0,0,0,10,90]),c)};
l.mh=function(a){var b=this.c.ka;return[a[0]-b[0],a[1]-b[1],a[2]-b[2]]};l.wk=function(a){return(new dc(this.c,a)).s};l.Pm=function(a,b){p1_=new dc(this.c,a);p2_=new dc(this.c,b);return!Pc(p1_,p2_)};l.Ng=function(a,b){return bd(new dc(this.c,a),b).s};l.Ee=function(a){return Nc(new dc(this.c,a))};l.Tj=function(a,b){return dd(new dc(this.c,a),b).s};l.gl=function(a){return(new dc(this.c,a)).s[4]};l.pd=function(a,b){return(new dc(this.c,a)).setOrientation(b).s};l.Xb=function(a){return(new dc(this.c,a)).ec()};
l.Og=function(a,b){return fd(new dc(this.c,a),b).s};l.Cd=function(a){return(new dc(this.c,a)).s[8]};l.Sj=function(a,b){return ed(new dc(this.c,a),b)};l.ke=function(a){return(new dc(this.c,a)).je()};l.Fe=function(a){return(new dc(this.c,a)).s[0]};l.dj=function(a){return(new dc(this.c,a)).s[3]};l.fl=function(a,b){return(new dc(this.c,a)).ag(b)};l.Ah=function(a,b){return id(new dc(this.c,a),b)};l.xf=function(a,b,c,d){return gd(new dc(this.c,a),b,c,d).s};
l.vc=function(a,b){return this.c.vc(a,Kd(this.c,a,b))};l.zh=function(a,b,c){return this.c.dz(a,b,c)};l.wh=function(a,b){return this.c.wh(a,b)};l.ie=function(){var a=this.c.P;return{"projection-matrix":a.Df.slice(),"view-matrix":a.Th.slice(),"view-projection-matrix":a.Fj.slice(),"rotation-matrix":a.Kg.slice(),position:this.c.ka.slice(),vector:this.c.$d.slice(),distance:this.c.Vb}};
l.wl=function(a){var b;a:{b=this.c.P;var c=this.c.ka;b.Ea&&b.update();a=c?[a[0]-c[0],a[1]-c[1],a[2]-c[2],1]:[a[0],a[1],a[2],1];for(c=0;6>c;c++)if(0>p.xi.Db(b.Bd[c],a)){b=!1;break a}b=!0}return b};l.vl=function(a){return this.c.P.Zd({W:a[0],xa:a[1]},this.c.ka)};l.$f=function(a,b,c){a=new dc(this.c,a);b=new dc(this.c,b);return(new Ld(this.c,a,b,c)).En()};E.prototype.Fc=function(a){this.c.Fc(a);return this};l=S.prototype;l.mc=function(a,b){this.c.mc(a,b);return this};
l.uc=function(a){return this.c.uc(a,value_)};l.Oj=function(){z(this.c);return this};l.Pf=function(a,b,c){this.c.Pf(a,b,c);return this};l.Vh=function(a,b){this.c.Vh(a,b);return this};l.Uh=function(a,b){this.c.Uh(a,b);return this};l.ei=function(a){this.c.ei(a);return this};l.oi=function(a,b){this.c.oi(a,b);return this};l.Bh=function(a){return this.c.Bh(a)};l.qm=function(a){this.c.Nh=a;return this};l.bl=function(){return this.c.Nh};l.al=function(){return this.c.gc};
l.cg=function(a,b,c,d){return this.c.cg(a,b,c,d)};l.Ch=function(a,b){return this.c.Ch(a,b)};l.getStats=function(){for(var a=0,b=0,c=this.c.Gn;b<c;b++)this.c.Gn[b].Dq&&a++;return{bestMeshTexelSize:this.c.pk,bestGeodataTexelSize:this.c.zq,downloading:this.c.Pc.fe.length,lastDownload:this.c.Pc.sj,surfaces:this.c.ac.Vg.length,freeLayers:this.c.Yi.length,texelSizeFit:this.c.Yj,loadMode:this.c.f.Nl,processingTasks:this.c.pe.length,busyWorkers:a,dirty:this.c.Ea,drawnTiles:this.c.o.Ce,drawnGeodataTiles:this.c.o.Ok}};
p.Oy=dc;S.prototype.setPosition=S.prototype.setPosition;S.prototype.getPosition=S.prototype.sa;S.prototype.setView=S.prototype.Rd;S.prototype.getView=S.prototype.pf;S.prototype.getCredits=S.prototype.yh;S.prototype.getCurrentCredits=S.prototype.bj;S.prototype.getCreditInfo=S.prototype.Kn;S.prototype.getViews=S.prototype.Rn;S.prototype.getViewInfo=S.prototype.Qn;S.prototype.getBoundLayers=S.prototype.kf;S.prototype.getBoundLayerInfo=S.prototype.Yk;S.prototype.getFreeLayers=S.prototype.bg;
S.prototype.getFreeLayerInfo=S.prototype.Mn;S.prototype.getSurfaces=S.prototype.eg;S.prototype.getSurfaceInfo=S.prototype.On;S.prototype.getSrses=S.prototype.Dh;S.prototype.getSrsInfo=S.prototype.fc;S.prototype.getReferenceFrame=S.prototype.mf;S.prototype.convertPositionViewMode=S.prototype.Bk;S.prototype.convertPositionHeightMode=S.prototype.Rf;S.prototype.convertCoords=S.prototype.Pa;S.prototype.convertCoordsFromNavToCanvas=S.prototype.Li;S.prototype.convertCoordsFromPhysToCanvas=S.prototype.Qf;
S.prototype.convertCoordsFromNavToCameraSpace=S.prototype.Ak;S.prototype.convertCoordsFromPhysToCameraSpace=S.prototype.mh;S.prototype.clonePosition=S.prototype.wk;S.prototype.setPositionCoords=S.prototype.Ng;S.prototype.getPositionCoords=S.prototype.Ee;S.prototype.setPositionHeight=S.prototype.Tj;S.prototype.getPositionHeight=S.prototype.gl;S.prototype.setPositionOrientation=S.prototype.pd;S.prototype.getPositionOrientation=S.prototype.Xb;S.prototype.setPositionViewExtent=S.prototype.Og;
S.prototype.getPositionViewExtent=S.prototype.Cd;S.prototype.setPositionFov=S.prototype.Sj;S.prototype.getPositionFov=S.prototype.ke;S.prototype.getPositionViewMode=S.prototype.Fe;S.prototype.getPositionHeightMode=S.prototype.dj;S.prototype.getPositionCanvasCoords=S.prototype.fl;S.prototype.getPositionCameraCoords=S.prototype.Ah;S.prototype.movePositionCoordsTo=S.prototype.xf;S.prototype.getSurfaceHeight=S.prototype.vc;S.prototype.getDistance=S.prototype.zh;S.prototype.getAzimuthCorrection=S.prototype.wh;
S.prototype.getCameraInfo=S.prototype.ie;S.prototype.isPointInsideCameraFrustum=S.prototype.wl;S.prototype.isBBoxInsideCameraFrustum=S.prototype.vl;S.prototype.generateTrajectory=S.prototype.$f;S.prototype.setConfigParam=S.prototype.mc;S.prototype.getConfigParam=S.prototype.uc;S.prototype.redraw=S.prototype.Oj;S.prototype.addRenderSlot=S.prototype.Pf;S.prototype.moveRenderSlotBefore=S.prototype.Vh;S.prototype.moveRenderSlotAfter=S.prototype.Uh;S.prototype.removeRenderSlot=S.prototype.ei;
S.prototype.setRenderSlotEnabled=S.prototype.oi;S.prototype.getRenderSlotEnabled=S.prototype.Bh;S.prototype.setLoaderSuspended=S.prototype.qm;S.prototype.getLoaderSuspended=S.prototype.bl;S.prototype.getGpuCache=S.prototype.al;S.prototype.getHitCoords=S.prototype.cg;S.prototype.getScreenRay=S.prototype.Ch;S.prototype.getStats=S.prototype.getStats;function ic(a,b){this.c=a;this.Wl=b||1;this.Em=0;this.Vl=2*this.Wl;this.hr=.95;this.$h=[[],[]];this.uk=0;this.fe=[];this.qh=[];this.sj=0;Md(this)}
function Md(a){a.Wl=a.c.f.wj;a.Vl=Math.max(20,2*a.Wl);a.hr=(a.Vl-1)/a.Vl}l=ic.prototype;l.load=function(a,b,c,d,e){var f=this.fe.indexOf(a);if(-1==f){var g=this.$h[this.uk],f=Jc(g,a);-1!=f?g[f].Vc=c:g.unshift({g:a,Eq:b,Vc:c||0,S:d,og:e});do for(c=!0,a=0,b=g.length-1;a<b;a++)g[a].Vc>g[a+1].Vc&&(c=g[a],g[a]=g[a+1],g[a+1]=c,c=!1);while(!c);g.length>this.Vl&&g.pop()}};l.remove=function(a){a=Jc(this.$h[this.uk],a);-1!=a&&this.$h[this.uk].splice(a,1)};
l.Pb=function(a){var b=this.fe.indexOf(a.g),c=performance.now(),d=this.c.o;this.c.w.vm&&(this.c.w.zc.push({Td:a.g,og:a.og,S:a.S,Vc:a.Vc,Am:c,O:c-this.qh[b],ul:c-this.sj,Yc:this.fe.length}),Number.isNaN(c-this.qh[b]));this.fe.splice(b,1);this.qh.splice(b,1);this.sj=c;this.Em--;z(this.c);this.update();d.Lo++;d.vj=c};
l.Dc=function(a){var b=this.fe.indexOf(a.g),c=performance.now(),d=this.c.o;this.c.w.vm&&this.c.w.zc.push({Td:a.g,og:a.og,S:a.S,Vc:a.Vc,Am:c,O:c-this.qh[b],ul:c-this.sj,Yc:this.fe.length});this.fe.splice(b,1);this.qh.splice(b,1);this.sj=c;this.Em--;z(this.c);this.update();d.Ko++;d.vj=c};
l.update=function(){if(!this.c.Nh)for(var a=this.$h.length-1;0<=a;a--)if(0<this.$h[a].length){a=this.$h[a];Md(this);for(var b=0,c=a.length;b<c;b++)a[b].Vc*=this.hr;for(b=performance.now();0<a.length&&this.Em<this.Wl;)c=a.shift(),-1==this.fe.indexOf(c.g)&&null!=c.Eq&&(this.fe.push(c.g),this.qh.push(b),this.Em++,c.Eq(c.g,this.Pb.bind(this,c),this.Dc.bind(this,c)));break}};
Wb.prototype.vc=function(a,b,c,d,e,f){if(!d){var g=Nd(this,a);d=g[0];e=g[1]}this.f.Ph||(b=Math.floor(b));if(this.f.Uo)return Od(this,null,b+8,c,b,null,d,e,f);var k=this.ac;if(null!=d&&null!==b){g={Pq:e,Qi:Math.ceil(b),da:{ja:d.da.ja.slice(),na:d.da.na.slice()},F:null,ub:null,ij:null,Cy:!0};Pd(k,Qd(k,d.g),g,!1);k=g.F;if(null!=g.ub){c&&(this.o.hj=2,this.o.nl=b,this.o.ol=k.g[0]);a=k.g[0]>=Math.ceil(b);var h;if(this.f.Ph&&0<k.g[0]&&g.Fa&&g.Fa.ub&&b<=k.g[0]){if(c=Rd(e,g.Fa.F,g.Fa),e=Rd(e,k,g),b-=Math.floor(b),
d=c+(e-c)*b,f){h=Array(f.length);for(var m=0,n=f.length;m<n;m++)e=f[m],c=Rd(e,g.Fa.F,g.Fa),e=Rd(e,k,g),h[m]=[c+(e-c)*b,a,!0]}}else if(d=Rd(e,k,g),f)for(h=Array(f.length),m=0,n=f.length;m<n;m++)e=Rd(f[m],k,g),h[m]=[e,a,!0];return[d,a,!0,null,null,h]}if(null!=k)return a=Od(this,a,b+8,c,b,null,d,e,f),[a[0],a[1],!0,null,null,a[5]]}return[0,!1,!1,null,null,null]};
function Od(a,b,c,d,e,f,g,k,h){var m;if(f)g=f[0],k=f[1];else if(g||(k=Nd(a,b),g=k[0],k=k[1]),h){m=Array(h.length);b=0;for(var n=h.length;b<n;b++)m[b]=Od(a,null,c,d,e,f,g,h[b])}a.f.Ph||(c=Math.floor(c));if(!f&&a.f.To){f=Od(a,null,c,d,e,[g,[k[0],k[1],k[2]]]);if(f[2]){var q=f[3].na[0]-f[3].ja[0],y=f[3].na[1]-f[3].ja[1];h=(k[0]-f[3].ja[0])/q;b=(k[1]-f[3].ja[1])/y;var w=Od(a,null,c,d,e,[g,[k[0]+q,k[1],k[2]]]),n=Od(a,null,c,d,e,[g,[k[0],k[1]+y,k[2]]]);c=Od(a,null,c,d,e,[g,[k[0]+q,k[1]+y,k[2]]]);a=f[0]+
(w[0]-f[0])*h;c=a+(n[0]+(c[0]-n[0])*h-a)*b;return[c,f[1],f[2],f[3],null,m]}return[f[0],f[1],f[2],f[3],null,m]}f=a.ac;if(null!=g&&null!==c&&(k={Pq:k,Qi:Math.ceil(c),da:{ja:g.da.ja.slice(),na:g.da.na.slice()},F:null,ub:null,ij:null,Cy:!0},Pd(f,Qd(f,g.g),k,!0),g=k.F,null!=g))return f=g.A.tk(),f=a.Pa(f,"physical","navigation"),d&&(a.o.hj=1,a.o.nl=e,a.o.ol=g.g[0]),a.f.Ph&&0<g.g[0]&&k.Fa&&k.Fa.F?(a=a.Pa(k.Fa.F.A.tk(),"physical","navigation"),c=f[2]+(a[2]-f[2])*(c-Math.floor(c)),[c,!0,!0,k.da,g,m]):[f[2],
!0,!0,k.da,g,m];d&&(a.o.hj=0,a.o.nl=e,a.o.ol=0);return[0,!1,!1,null,null,m]}function Rd(a,b,c){var d=c.ub,e=d.me,f=d.rl;c=c.ij;d=a[0]-c.ja[0];a=c.na[1]-a[1];var g=f[0]-1,k=f[1]-1,d=d/(c.na[0]-c.ja[0])*g;a=a/(c.na[1]-c.ja[1])*k;0>d&&(d=0);0>a&&(a=0);d>g&&(d=g);a>k&&(a=k);var h=Math.floor(d);c=Math.floor(a);var d=d-h,m=c*f[0],f=c==k?m:m+f[0],g=h==g?h:h+1,k=e[4*(m+h)],h=e[4*(f+h)],m=k+(e[4*(m+g)]-k)*d,e=m+(h+(e[4*(f+g)]-h)*d-m)*(a-c);return e=b.ne+e/255*(b.kb-b.ne)}
function Nd(a,b){for(var c=a.Ib.Ae.Na,d=null,e=-1,f=[0,0],g=0,k=c.length;g<k;g++){var h=c[g],m=Jd(h.jt,b,Qa(h.c)),n=h.da;m[0]>=n.ja[0]&&m[0]<=n.na[0]&&m[1]>=n.ja[1]&&m[1]<=n.na[1]&&h.g[0]>e&&(d=h,e=h.g[0],f=m)}return[d,f]}
function Sd(a,b){for(var c=a.Ib.Ae.Na,d=null,e=[0,0],f=0,g=c.length;f<g;f++){var k=c[f],h=b[0]-k.g[0];if(0<=h){var m=b[2]>>h;k.g[1]==b[1]>>h&&k.g[2]==m&&(d=k,e=[k.g[1]<<h,k.g[2]<<h])}}h=b[0]-d.g[0];k=1/Math.pow(2,h);c=d.da.na;f=d.da.ja;g=(c[0]-f[0])*k;k*=f[1]-c[1];h=b[1]-e[0];e=b[2]-e[1];return[d,[[f[0]+g*h,c[1]+k*e],[f[0]+g*(h+1),c[1]+k*(e+1)]]]}function Kd(a,b,c){a=Nd(a,b)[0];return null!=a?(c=Math.log((a.da.na[1]-a.da.ja[1])/c)/Math.log(2),c=c-8+a.g[0],Math.max(0,c)):null}
function Mc(a,b,c,d){a=Nd(a,b)[0];return null!=a?(c=Math.log(d*(a.da.na[1]-a.da.ja[1])/c)/Math.log(2),c=c-8+a.g[0],Math.max(0,c)):null}
Wb.prototype.zh=function(a,b,c){var d=Jd(this.Ib.Cc.Bg,a,Qa(this)),e=Jd(this.Ib.Cc.Bg,b,Qa(this)),f=e[0]-d[0],g=e[1]-d[1],e=e[2]-d[2],d=c?Math.sqrt(f*f+g*g+e*e):Math.sqrt(f*f+g*g),k=Qa(this).fc();if(Pa(Qa(this)))return[d,p.Pi(Math.atan2(g,f))];a=Kc(this).Inverse(a[1],a[0],b[1],b[0]);return d>2*k.a*Math.PI/4007.5?c?[Math.sqrt(a.s12*a.s12+e*e),a.Sy]:[a.s12,a.azi1]:[d,a.azi1]};function Kc(a){a=Qa(a).fc();return new GeographicLib.Geodesic.Geodesic(a.a,a.a/a.b-1)}
function Ld(a,b,c,d){this.c=a;this.Pd=b.clone();this.Cf=c.clone();this.Lw=c.clone();a=this.Pd.s[3];b=this.Cf.s[3];"fix"==a&&"float"==b?hd(this.Pd,"float"):"float"==a&&"fix"==b&&hd(this.Pd,"fix");a=this.Pd.s[0];b=this.Cf.s[0];"subj"==a&&"obj"==b?va(this.Cf,"subj"):"obj"==a&&"subj"==b&&va(this.Pd,"subj");this.Pd.s[5]=0>this.Pd.s[5]?360+this.Pd.s[5]%360:this.Pd.s[5]%360;this.Cf.s[5]=0>this.Cf.s[5]?360+this.Cf.s[5]%360:this.Cf.s[5]%360;this.jc=this.Pd.clone();this.Sh=d.mode||"auto";this.ey="none";this.kb=
d.maxHeight||1E9;this.bw=d.minDuration||0;this.Tl=d.maxDuration||1E4;this.Us=d.samplePeriod||10;this.Eu=d.fade||"none";this.Bn=d.fadePower||1;this.wx=d.pv||.15;Pa(Qa(this.c))||(this.or=Kc(this.c));d.distanceAzimuth?(this.gn=!0,this.Qb=this.Pd.clone(),d.destHeight&&dd(this.Qb,d.destHeight),d.destOrientation&&dd(this.Qb,d.destOrientation),d.destFov&&dd(this.Qb,d.destFov),this.Vk=d.azimuth||0,this.Qa=this.Fn=d.distance||100,this.Lb=this.Vk%360,this.Lb=0>this.Lb?360+this.Lb:this.Lb):(this.gn=!1,this.Qb=
this.Cf.clone(),a=this.c.zh(Nc(this.jc),Nc(this.Qb)),this.Qa=a[0],this.Lb=(a[1]-90)%360,this.Lb=0>this.Lb?360+this.Lb:this.Lb,Pa(Qa(this.c))||(a=this.or.Inverse(this.jc.s[2],this.jc.s[1],this.Qb.s[2],this.Qb.s[1]),this.Vk=a.azi1,this.Fn=a.s12,this.Lb=this.Vk%360,this.Lb=0>this.Lb?360+this.Lb:this.Lb));"auto"==this.Sh&&(this.Sh=2E3<this.Qa?"ballistic":"direct");this.O=0;this.wc=1E3;500>this.Qa?this.O=1E3:2E3>this.Qa?this.O=2E3:(this.O=this.Qa/100,300>this.O?this.O=3E3:this.wc=1500,6E3>this.O&&(this.O=
6E3),1E4<this.O&&(this.O=1E4),"direct"!=this.Sh&&(this.O*=1.8,this.wc*=1.8));"direct"!=this.Sh&&(a=3*this.wc,this.O=Math.max(this.O,a),this.Tl<a&&(this.O=this.Tl,this.wc=this.Tl/3));this.O=Math.min(this.O,this.Tl);this.O=Math.max(this.O,this.bw);d=d.height;"ballistic"==this.Sh&&(this.Yf=Math.max(this.jc.s[4],this.Qb.s[4]),this.Yf+=d||.5*this.Qa,this.Yf=Math.min(this.Yf,this.kb),this.Yf-=Math.max(this.jc.s[4],this.Qb.s[4]))}
Ld.prototype.En=function(){for(var a=Array(Math.ceil(this.O/this.Us)+(this.gn?0:1)),b=0,c=0;c<=this.O;c+=this.Us){var d=c/this.O,e=this.jc.clone();if("direct"==this.Sh){var f=d;switch(this.Eu){case "in":switch(this.Bn){case 1:d=f*f;break;case 2:d=f*f*f;break;case 3:d=f*f*f*f;break;case 4:d=f*f*f*f*f;break;case 5:d=f*f*f*f*f*f;break;case 6:d=f*f*f*f*f*f*f}break;case "out":f=1-f;switch(this.Bn){case 1:d=1-f*f;break;case 2:d=1-f*f*f;break;case 3:d=1-f*f*f*f;break;case 4:d=1-f*f*f*f*f;break;case 5:d=
1-f*f*f*f*f*f;break;case 6:d=1-f*f*f*f*f*f*f}break;case "inout":switch(this.Bn){case 1:d=f*f*(3-2*f);break;case 2:d=f*f*f*(f*(6*f-15)+10);break;case 3:f=d=f*f*(3-2*f);d=f*f*(3-2*f);break;case 4:f=d=f*f*f*(f*(6*f-15)+10);d=f*f*f*(f*(6*f-15)+10);break;case 5:f=d=f*f*(3-2*f);f=d=f*f*(3-2*f);d=f*f*(3-2*f);break;case 6:f=d=f*f*f*(f*(6*f-15)+10),f=d=f*f*f*(f*(6*f-15)+10),d=f*f*f*(f*(6*f-15)+10)}}bd(e,Td(this,d));f=this.jc.s[4];dd(e,f+(this.Qb.s[4]-f)*d);e.setOrientation(Ud(this.jc.ec(),this.Qb.ec(),d));
ed(e,Vd(this,d));fd(e,Wd(this,d))}else{f=d;f=d=f*f*(3-2*f);d=f*f*(3-2*f);f=c<this.wc?0:c>this.O-this.wc?1:Math.min(1,(c-this.wc)/(this.O-2*this.wc));f=f*f*(3-2*f);factor2_=f*f*(3-2*f);if("piha"==this.ey){var f=Nc(this.jc)[2],g=this.Qa/(.001*this.O*this.wx*Math.tan(.5*p.Ga(this.jc.je())))*(1-Math.cos(2*Math.PI*c/this.O))+f+(Nc(this.Qb)[2]-f)*c/this.O,f=Td(this,this.Qa/this.O*(c-this.O/(2*Math.PI)*Math.sin(2*Math.PI/this.O*c))/this.Qa);bd(e,f);dd(e,g)}else f=Td(this,factor2_),bd(e,f),g=Nc(this.jc),
dd(e,g[2]+(Nc(this.Qb)[2]-g[2])*d+Math.sin(Math.PI*d)*this.Yf);null!=f[3]&&(this.Lb=f[3]);var f=c,g=[0,-90,0],k;g[0]=this.Lb%360;0>g[0]&&(g[0]=360-Math.abs(g[0]));f<=this.wc?(k=f/this.wc,f=this.jc.ec()):f>=this.O-this.wc?(k=(f-(this.O-this.wc))/this.wc,f=g,g=this.Qb.ec()):(k=0,f=g);e.setOrientation(Ud(f,g,k));ed(e,Vd(this,d));fd(e,Wd(this,d));a[b]=e.s}a[b]=e.s;b++}this.gn||(a[b]=this.Lw.clone().s);return a};
function Td(a,b){var c=Nc(a.jc),d=Nc(a.Qb);if(Pa(Qa(a.c)))return[c[0]+(d[0]-c[0])*b,c[1]+(d[1]-c[1])*b,c[2]+(d[2]-c[2])*b];var e=a.or.Direct(c[1],c[0],a.Vk,a.Fn*b),f=e.azi1-e.azi2,f=0>a.Lb?360+f:f;return[e.lon2,e.lat2,c[2]+(d[2]-c[2])*b,f]}function Ud(a,b,c){var d=b[0]-a[0],e=b[1]-a[1];b=b[2]-a[2];180<Math.abs(d)&&(d=0<d?-(360-d):360-Math.abs(d));return[a[0]+d*c,a[1]+e*c,a[2]+b*c]}function Vd(a,b){var c=a.jc.je();return c+(a.Qb.je()-c)*b}function Wd(a,b){var c=a.jc.s[8];return c+(a.Qb.s[8]-c)*b}
function pc(a,b,c){this.c=a;this.o=a.o;this.g=b;this.Ia=this.Td=null;this.Mc=this.v=this.T=0;"object"===typeof c?(this.Ia=c,this.T=2):(this.Td=this.c.$b(c),p.Jd(this.Td,this.Pb.bind(this),this.Dc.bind(this),null,p.useCredentials?-1!=this.Td.indexOf(this.c.Ya):!1,this.c.l.cc),this.T=1)}l=pc.prototype;l.I=function(){};l.setData=function(a){this.Ia=a;this.T=2};l.ha=function(a,b){if(2==this.T)return!0;0!=this.T||a||this.Sb(b);return!1};l.Sb=function(a){this.c.Pc.load(this.Td,this.Od.bind(this),a)};
l.Od=function(){this.T=1};l.Dc=function(){};l.Pb=function(a){1!=this.c.N&&(this.Ia=a,this.T=2)};l.size=function(){return this.v};l.fileSize=function(){return this.Mc};function wd(a,b,c){this.c=a;this.o=a.o;this.ab=b;this.rb=c;this.A=new ib;this.Mc=this.v=0;this.qa=this.fb=null;this.T=0;this.hb=null;this.La=0}l=wd.prototype;l.I=function(){this.A=null;this.Or()};l.Or=function(a){this.fb&&(this.fb=null);1!=a&&null!=this.qa&&this.c.Ec.remove(this.qa);this.Mc=this.v=this.T=0;this.qa=null};
l.ha=function(a,b){var c=this.c.o.Yb>=this.c.tg;a=a||c;if(2==this.T)return $c(this.c.Ec,this.qa),!0;0==this.T?a||this.Sb(b):3==this.T&&this.La<=this.c.f.ld&&performance.now()>this.hb+this.c.f.md&&this.Sb(b);return!1};l.Sb=function(a){this.c.Pc.load(this.ab,this.Od.bind(this),a,this.rb.S,"geodata")};l.Od=function(a,b,c){this.nd=b;this.Ld=c;this.T=1;p.Jd(a,this.Pb.bind(this),this.Dc.bind(this),!0,p.useCredentials?-1!=this.ab.indexOf(this.c.Ya):!1,this.c.l.cc)};
l.Dc=function(){this.c.N||(this.T=3,this.hb=performance.now(),this.La++,this.La<=this.c.f.ld&&setTimeout(function(){this.c.N||z(this.c)}.bind(this),this.c.f.md),this.Ld())};l.Pb=function(a){if(!this.c.N){var b=a.length;this.Mc=this.v=b;this.fb=a;this.qa=ad(this.c.Ec,this.Or.bind(this,!0),b);z(this.c);this.T=2;this.hb=null;this.La=0;this.nd()}};l.size=function(){return this.v};l.fileSize=function(){return this.Mc};
function xd(a,b,c){this.c=a;this.o=a.o;this.fb=b;this.j=this.c.m.j;this.m=this.c.m;this.Hh=[];this.nh=null;this.S=c.S;this.H=c.H;this.H.gd?this.H.Vp&&(Oa(this.H.gd,"setStylesheet",{data:this.H.re.Ia,geocent:!Pa(Qa(this.c))}),this.H.Vp=!1):(a=new p.ik(this,this.Jj.bind(this)),Oa(a,"setStylesheet",{data:this.H.re.Ia,geocent:!Pa(Qa(this.c))}),Oa(a,"setFont",{chars:this.m.he.xe,space:this.m.he.Jf,size:this.m.he.v}),this.H.gd=a,this.c.Gn.push(a));this.gd=this.H.gd;this.v=0;this.va=this.Ao=this.N=!1;this.ha()}
l=xd.prototype;l.I=function(){this.N=!0;this.fb=null;this.Pr(!1)};l.Pr=function(a){this.Ao=a;for(var b=0,c=this.Hh.length;b<c;b++)this.Hh[b].I();this.Hh=[];1!=a&&null!=this.Ab&&this.c.gc.remove(this.Ab);this.o.Gh-=this.v;this.o.Ed[1][0]++;this.o.Ed[1][1]+=this.v;this.va=!1;this.v=0;this.Ab=null};
l.Jj=function(a,b,c){if(!this.N&&!this.Ao)switch(a){case "beginGroup":c?(this.nh=new gb(b.id,b.bbox,b.origin,this.j,this.m),this.Hh.push(this.nh)):(z(this.c),this.c.pe.push(this.Jj.bind(this,a,b,!0)));break;case "addRenderJob":if(c){if(this.nh){a=performance.now();c=this.nh;switch(b.type){case "flat-line":var d=c.u,e=b.vertexBuffer,f=b.color,g=1/255,k={R:"flat-line"};k.ib=b.program;k.ae=[f[0]*g,f[1]*g,f[2]*g,f[3]*g];k.Ai=b["z-index"]+256;k.Gi=b["click-event"];k.nj=b["hover-event"];k.Pk=b["enter-event"];
k.Fl=b["leave-event"];k.lj=b.hitable;k.Wi=b.eventInfo;k.We=b.state;k.Kc=b.center;k.ua=b.lod;k.$r=b["line-width"];k.fh=b["zbuffer-offset"];k.Ef=!1;k.va=!0;k.Z=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,k.Z);d.bufferData(d.ARRAY_BUFFER,e,d.STATIC_DRAW);k.Z.za=3;k.Z.oa=e.length/3;c.Ke.push(k);c.v+=4*e.length;c.ic+=e.length/3;break;case "flat-tline":jb(c,b);break;case "pixel-line":jb(c,b);break;case "pixel-tline":jb(c,b);break;case "line-label":var d=c.u,e=b.vertexBuffer,f=b.texcoordsBuffer,g=b.color,
k=1/255,h={R:"line-label"};h.ib=b.program;h.ae=[g[0]*k,g[1]*k,g[2]*k,g[3]*k];h.Ai=b["z-index"]+256;h.Gi=b["click-event"];h.nj=b["hover-event"];h.Pk=b["enter-event"];h.Fl=b["leave-event"];h.lj=b.hitable;h.Wi=b.eventInfo;h.We=b.state;h.Kc=b.center;h.ua=b.lod;h.fh=b["zbuffer-offset"];h.Ef=!1;h.va=!0;h.Z=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,h.Z);d.bufferData(d.ARRAY_BUFFER,e,d.STATIC_DRAW);h.Z.za=4;h.Z.oa=e.length/4;h.bc=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,h.bc);d.bufferData(d.ARRAY_BUFFER,
f,d.STATIC_DRAW);h.bc.za=4;h.bc.oa=f.length/4;c.Ke.push(h);c.v+=4*e.length+4*f.length;c.ic+=e.length/4;break;case "icon":lb(c,b);break;case "label":lb(c,b,!0);break;case "optimize":c.wz(b)}this.o.mb+=performance.now()-a}}else z(this.c),this.c.pe.push(this.Jj.bind(this,a,b,!0));break;case "endGroup":c?this.nh&&(this.v+=this.nh.size()):(z(this.c),this.c.pe.push(this.Jj.bind(this,a,b,!0)));break;case "allProcessed":z(this.c);this.Ab=ad(this.c.gc,this.Pr.bind(this,!0),this.v);this.o.Gh+=this.v;this.o.Ed[0][0]++;
this.o.Ed[0][1]+=this.v;this.gd.Dq=!1;this.va=!0;break;case "ready":z(this.c)}};l.ha=function(a,b,c){if(this.N)return!1;var d=this.c.o.Yb>=this.c.tg;a=a||d;!this.va&&!a&&this.fb.ha(a,b,c)&&this.gd.ha()&&(this.Ao=!1,this.gd.uj=this.Jj.bind(this),Oa(this.gd,"processGeodata",this.fb.fb,this.S),this.gd.Dq=!0);!a&&this.Ab&&$c(this.c.gc,this.Ab);return this.va};l.Eh=function(a,b,c){null==c&&(c=p.i.create(),p.i.multiply(p.Ic(a.W[0]-b[0],a.W[1]-b[1],a.W[2]-b[2]),p.If(1,1,1),c));return c};
l.jb=function(a){if(this.va){for(var b=this.m,c=0,d=this.Hh.length;c<d;c++){var e=this.Hh[c],f=p.i.create(),g=p.i.create();p.i.multiply(Mb(b.P),this.Eh(e.A,a),g);var k=Lb(b.P);p.i.multiply(k,g,f);e.jb(g,f);this.o.Vf+=e.ic;this.o.Ti+=e.Ke.length}this.Xj!=this.o.xd&&(this.Xj=this.o.xd,this.o.Yb+=this.v)}return this.va};l.size=function(){return this.v};
function Fd(a,b,c){this.c=a;this.o=a.o;this.ab=b;this.S=c;this.A=new ib;this.hf=this.Mc=this.v=0;this.Ab=this.qa=null;this.T=0;this.hb=null;this.La=0;this.Wv=p.i.create();this.Vv=p.i.create();this.Jb=[];this.hd=[];this.Yp=!1}l=Fd.prototype;l.I=function(){this.A=null;this.zo();this.Qr()};l.zo=function(a){for(var b=0,c=this.Jb.length;b<c;b++)this.Jb[b].I();this.Yp=!0;1!=a&&this.qa&&this.c.Ec.remove(this.qa);0==this.hd.length&&(this.T=0);this.qa=null};
l.Qr=function(a){for(var b=0,c=0,d=this.hd.length;c<d;c++)this.hd[c].I(),b+=this.hd[c].v;0<d&&(this.o.Ih-=b,this.o.Fd[1][0]++,this.o.Fd[1][1]+=b);this.hd=[];1!=a&&this.Ab&&this.c.gc.remove(this.Ab);this.Yp&&(this.T=0);this.Ab=null};
l.ha=function(a,b,c){var d=this.c.o.Yb>=this.c.tg;a=a||d;"https://cdn.melown.com/mario/proxy/melown2015/surface/melown/cz10/12-1107-688.bin?0"==this.ab&&(this.ab=this.ab);if(2==this.T){this.qa&&$c(this.c.Ec,this.qa);if(c)return!0;if(0==this.hd.length){if(this.c.o.Yb>=this.c.tg)return!1;if(this.o.mb>this.c.f.yj)return z(this.c),!1;if(d)return!1;b=performance.now();c=0;this.hd=Array(this.Jb.length);for(var d=0,e=this.Jb.length;d<e;d++)this.hd[d]=Xd(this.Jb[d]),c+=this.hd[d].v;this.o.Ih+=c;this.o.Fd[0][0]++;
this.o.Fd[0][1]+=c;this.Ab=ad(this.c.gc,this.Qr.bind(this,!0),c);this.o.mb+=performance.now()-b}!a&&this.Ab&&$c(this.c.gc,this.Ab);return!0}0==this.T?a||this.Sb(b):3==this.T&&this.La<=this.c.f.ld&&performance.now()>this.hb+this.c.f.md&&this.Sb(b);return!1};l.Sb=function(a){this.ab||(this.ab=Sc(this.c,this.S.Ua.Xl,{ua:this.S.g[0],Fb:this.S.g[1],Gb:this.S.g[2]}));this.c.Pc.load(this.ab,this.Od.bind(this),a,this.S,"mesh")};
l.Od=function(a,b,c){this.nd=b;this.Ld=c;p.Id(a,this.Pb.bind(this),this.Dc.bind(this),p.useCredentials?-1!=this.ab.indexOf(this.c.Ya):!1,this.c.l.cc);this.T=1};l.Dc=function(){1!=this.c.N&&(this.T=3,this.hb=performance.now(),this.La++,this.La<=this.c.f.ld&&setTimeout(function(){this.c.N||z(this.c)}.bind(this),this.c.f.md),this.Ld())};
l.Pb=function(a,b){if(1!=this.c.N)if(b){this.Mc=a.byteLength;var c={Ia:a,h:0},d=performance.now();this.zo();var e=c.Ia,f;f=""+String.fromCharCode(e.getUint8(c.h,!0));c.h+=1;f+=String.fromCharCode(e.getUint8(c.h,!0));c.h+=1;if("ME"==f&&(this.Kb=e.getUint16(c.h,!0),c.h+=2,!(3<this.Kb))){e.getFloat64(c.h,!0);c.h+=8;this.ts=e.getUint16(c.h,!0);c.h+=2;this.Jb=[];e=0;for(f=this.ts;e<f;e++){var g=new Yd(this,c);g.af&&(this.Jb.push(g),this.v+=this.Jb[e].v,this.hf+=this.Jb[e].hf)}this.ts=this.Jb.length}this.c.o.mb+=
performance.now()-d;this.Yp=!1;this.qa=ad(this.c.Ec,this.zo.bind(this,!0),this.v);z(this.c);this.T=2;this.hb=null;this.La=0;this.nd()}else z(this.c),this.c.pe.push(this.Pb.bind(this,a,!0))};l.size=function(){return this.v};l.fileSize=function(){return this.Mc};
function Bd(a,b,c,d,e,f){null!=a.hd[c]||null==a.Jb[c]||a.Jb[c].N||(a.hd[c]=Xd(a.Jb[c]));var g=a.Jb[c];if(c=a.hd[c]){var k=a.c.m,h=null,m=null,n=null,q=null,y=a.c.th,w=0!=y?["aPosition","aBarycentric"]:["aPosition"];if("depth"==e)h=k.Hs;else if("flat"==e)h=k.Is;else if(0<y)switch(y){case 2:h=k.Ks;break;case 3:h=k.Is;break;case 1:switch(e){case "internal":case "internal-nofog":h=k.Ls;n="aTexCoord";w.push("aTexCoord");break;case "external":case "external-nofog":h=k.ux;q="aTexCoord2";w.push("aTexCoord2");
break;case "fog":return}}else switch(e){case "internal":case "internal-nofog":h=k.Ap;n="aTexCoord";w.push("aTexCoord");break;case "external":case "external-nofog":h=k.sx;d&&(m=d.V?d.V.U&&d.V.U.Hb?d.V.U.Hb.sb:null:d.Hb?d.Hb.sb:null)&&(h=k.tx);q="aTexCoord2";w.push("aTexCoord2");break;case "fog":h=k.gx}k.j.useProgram(h,w,m);if(d)if(w=d.V?d.V.U?d.V.U.sb:null:d.sb)d.Xj!=a.o.xd&&(d.Xj=a.o.xd,a.o.Yb+=w.v),k.j.bindTexture(w),m&&k.j.bindTexture(m,1);else return;else if("fog"!=e&&"depth"!=e&&"flat"!=e)return;
m=a.Wv;p.i.multiply(Mb(k.P),g.Eh(b,a.Vv),m);b=Lb(k.P);ra(h,"uMV",m);ra(h,"uProj",b);if(0==y)switch(e){case "internal":case "fog":mb(h,"uParams",[a.c.eh,a.c.Zf,0,0]);break;case "internal-nofog":mb(h,"uParams",[a.c.eh,0,0,0]);break;case "external":Ab(h,"uAlpha",1);mb(h,"uParams",[a.c.eh,a.c.Zf,0,0]);mb(h,"uTransform",d.V?d.V.U?d.V.Et:null:[1,1,0,0]);break;case "external-nofog":Ab(h,"uAlpha",f),mb(h,"uParams",[a.c.eh,0,0,0]),mb(h,"uTransform",d.V?d.V.U?d.V.Et:null:[1,1,0,0])}g.Xj!=a.o.xd&&(g.Xj=a.o.xd,
a.o.Yb+=c.v);c.jb(h,"aPosition",n,q,0!=y?"aBarycentric":null);a.o.Vf+=a.hf;a.o.Ti++}}MelownMetanodeFlags_GeometryPresent=1;MelownMetanodeFlags_NavtilePresent=3;MelownMetanodeFlags_InternalTexturePresent=7;MelownMetanodeFlags_CoarsenessControl=15;MelownMetanodeFlags_ChildShift=3;p.Mt=new Uint8Array(1024);
function Zd(a,b,c){this.Sc=a;this.c=a.c;this.g=b;this.L=[];this.jj=this.va=this.Ci=!1;if(c){a=c.Ia;this.X=a.getUint8(c.h,!0);c.h+=1;b=p.Mt;for(var d=0,e=6*(this.g[0]+2)+7>>3;d<e;d++)b[d]=a.getUint8(c.h,!0),c.h+=1;for(var e=this.g[0]+2,f=[0,0,0],g=[0,0,0],k=0,h=this.c.Xx,m=this.c.Wx,d=0;3>d;d++)f[d]=$d(b,e,k)*h[d]+m[d],k+=e,g[d]=$d(b,e,k)*h[d]+m[d],k+=e;d=k=0;for(e=b.length;d<e;d++)k+=b[d];0==k&&(f[0]=Number.POSITIVE_INFINITY,f[1]=Number.POSITIVE_INFINITY,f[2]=Number.POSITIVE_INFINITY,g[0]=Number.NEGATIVE_INFINITY,
g[1]=Number.NEGATIVE_INFINITY,g[2]=Number.NEGATIVE_INFINITY);this.A=new ib(f[0],f[1],f[2],g[0],g[1],g[2]);this.tl=a.getUint8(c.h,!0);c.h+=1;this.ai=p.lu(a.getUint16(c.h,!0));c.h+=2;a.getUint16(c.h,!0);c.h+=2;this.Tf=1024;0==(this.X&4)&&(this.ai=Number.POSITIVE_INFINITY);0==(this.X&8)&&(this.Tf=256);this.ne=a.getInt16(c.h,!0);c.h+=2;this.kb=a.getInt16(c.h,!0);c.h+=2;3<=this.Sc.Kb&&(this.Sc.X&128?(this.et=a.getUint16(c.h,!0),c.h+=2):this.Sc.X&64&&(this.et=a.getUint8(c.h,!0),c.h+=1));this.jj=0!=(this.X&
2);this.Ci=!1;ae(this)}}Zd.prototype.I=function(){};function $d(a,b,c){for(var d=0,e=0;e<b;e++)a[c>>3]&1<<7-(c&7)&&(d|=1<<b-e-1),c++;return d/((1<<b)-1)}
Zd.prototype.clone=function(){var a=new Zd(this.Sc,this.g);a.X=this.X;a.ne=this.ne;a.kb=this.kb;a.A=this.A.clone();a.tl=this.tl;a.ai=this.ai;a.Tf=this.Tf;a.va=this.va;a.cy=this.cy;a.jj=this.jj;a.L=Array(this.L.length);for(var b=0,c=this.L.length;b<c;b++)a.L[b]=this.L[b];a.de=this.de;a.Ri=this.Ri;a.Fk=this.Fk;a.ph=this.ph;a.Gk=this.Gk;a.Di=this.Di;this.Ds&&(a.Ds=this.Ds.slice());return a};
function ae(a,b){a.va=!0;if(a.c.Wk)if(a.c.f.Xo){if(!b){var c=Sd(a.c,a.g),d=c[0],e=c[1][0],f=c[1][1],g=a.ne,c=[0,0,0];a.de=be(d,[.5*(f[0]+e[0]),.5*(f[1]+e[1]),g]);a.Gk=p.D.length(a.de);p.D.normalize(a.de,c);a.Ri=c;var k=be(d,[f[0],f[1],g]),h=be(d,[f[0],e[1],g]),m=be(d,[e[0],e[1],g]),n=be(d,[e[0],f[1],g]),g=a.kb,q=be(d,[f[0],f[1],g]),y=be(d,[f[0],e[1],g]),w=be(d,[e[0],e[1],g]),d=be(d,[e[0],f[1],g]);a.Di=[[k[0],k[1],k[2]],[h[0],h[1],h[2]],[m[0],m[1],m[2]],[n[0],n[1],n[2]],q,y,w,d];p.D.normalize(k);p.D.normalize(h);
p.D.normalize(m);p.D.normalize(n);k=p.D.Db(c,k);h=p.D.Db(c,h);m=p.D.Db(c,m);n=p.D.Db(c,n);q=Math.min(k,h,m,n);a.Fk=Math.cos(Math.max(0,.5*Math.PI-Math.acos(q)));a.ph=q}}else d=a.A.W,e=a.A.xa,c=a.A.tk(),a.de=[c[0],c[1],c[2]],p.D.normalize(c),a.Ri=c,k=[d[0],d[1],d[2]],h=[e[0],d[1],d[2]],m=[e[0],e[1],d[2]],n=[d[0],e[1],d[2]],q=[d[0],d[1],e[2]],y=[e[0],d[1],e[2]],w=[e[0],e[1],e[2]],d=[d[0],e[1],e[2]],p.D.normalize(k),p.D.normalize(h),p.D.normalize(m),p.D.normalize(n),p.D.normalize(q),p.D.normalize(y),
p.D.normalize(w),p.D.normalize(d),k=p.D.Db(c,k),h=p.D.Db(c,h),m=p.D.Db(c,m),n=p.D.Db(c,n),q=Math.min(k,h,m,n,p.D.Db(c,q),p.D.Db(c,y),p.D.Db(c,w),p.D.Db(c,d)),a.Fk=Math.cos(Math.max(0,.5*Math.PI-Math.acos(q))),a.ph=q,Qb(a.A),q=.2*a.A.Dj,a.de=[a.de[0]-c[0]*q,a.de[1]-c[1]*q,a.de[2]-c[2]*q]}
Zd.prototype.Eh=function(a,b){var c=b;null!=c?(c[0]=Rb(this.A,0),c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=Rb(this.A,1),c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=Rb(this.A,2),c[11]=0,c[12]=this.A.W[0]-a[0],c[13]=this.A.W[1]-a[1],c[14]=this.A.W[2]-a[2],c[15]=1):(c=p.i.create(),p.i.multiply(p.Ic(this.A.W[0]-a[0],this.A.W[1]-a[1],this.A.W[2]-a[2]),p.If(Rb(this.A,0),Rb(this.A,1),Rb(this.A,2)),c));return c};
Zd.prototype.sh=function(a){var b=this.c.m;b.j.useProgram(b.bi,["aPosition"]);var c=p.i.create(),d=p.i.create();p.i.multiply(Mb(b.P),this.Eh(a),d);a=Lb(b.P);p.i.multiply(a,d,c);ra(b.bi,"uMVP",c);b.nk.jb(b.bi,"aPosition")};function Zc(a,b,c){this.Zb=a;this.c=a.c;this.H=b;this.g=a.g;this.S=c;this.Na=[];this.T=this.tc=0;this.hb=null;this.v=this.La=0;this.qa=null}l=Zc.prototype;
l.I=function(a){1!=a&&null!=this.qa&&this.c.Rc.remove(this.qa);this.Zb&&Xc(this.Zb,this);this.H=this.T=0;this.qa=null;this.Na=[]};l.clone=function(a){a=new Zc(this.Zb,a);a.Na=this.Na;a.T=this.T;a.Na=this.Na;a.v=this.v;a.ua=this.ua;a.ug=this.ug;a.vg=this.vg;a.Qe=this.Qe;a.Re=this.Re;a.Ja=this.Ja;a.Bb=this.Bb;a.Kb=this.Kb;a.L=this.L;2>this.Kb?a.Hj=this.Hj:(a.X=this.X,a.yd=this.yd,a.Ad=this.Ad);a.qa=ad(this.c.Rc,a.I.bind(a,!0),a.v);return a};
l.ha=function(a){if(2==this.T)return!0;0==this.T&&(3==this.T?this.La<=this.c.f.ld&&performance.now()>this.hb+this.c.f.md&&this.Sb(a):this.Sb(a));return!1};l.mq=function(){null!=this.qa&&$c(this.c.Rc,this.qa)};l.cj=function(a){var b=a[1]-this.g[1]-this.Qe;a=a[2]-this.g[2]-this.Re;if(0>b||0>a||b>=this.Ja||a>=this.Bb)return null;b=this.Na[this.Ja*a+b];b.va||(ae(b),b.va=!0);return b};l.Sb=function(){null==this.ab&&(this.ab=this.H.cl(this.g));this.c.Pc.load(this.ab,this.Od.bind(this),null,this.S,"metatile")};
l.Od=function(a,b,c){this.nd=b;this.Ld=c;p.Id(a,this.Pb.bind(this),this.Dc.bind(this),p.useCredentials?-1!=this.ab.indexOf(this.c.Ya):!1,this.c.l.cc);this.T=1};l.Dc=function(){1!=this.c.N&&(this.T=3,this.hb=performance.now(),this.La++,this.La<=this.c.f.ld&&setTimeout(function(){this.c.N||z(this.c)}.bind(this),this.c.f.md),this.Ld())};
l.Pb=function(a,b){if(1!=this.c.N)if(b){this.v+=4*a.byteLength;var c=performance.now();this.qp({Ia:a,h:0});this.c.o.mb+=performance.now()-c;this.qa=ad(this.c.Rc,this.I.bind(this,!0),this.v);z(this.c);this.T=2;this.hb=null;this.La=0;this.nd()}else z(this.c),this.c.pe.push(this.Pb.bind(this,a,!0))};
l.qp=function(a){var b=a.Ia,c;c=""+String.fromCharCode(b.getUint8(a.h,!0));a.h+=1;c+=String.fromCharCode(b.getUint8(a.h,!0));a.h+=1;"MT"==c&&(this.Kb=b.getUint16(a.h,!0),a.h+=2,3<this.Kb||(this.ua=b.getUint8(a.h,!0),a.h+=1,this.ug=b.getUint32(a.h,!0),a.h+=4,this.vg=b.getUint32(a.h,!0),a.h+=4,this.Qe=b.getUint16(a.h,!0),a.h+=2,this.Re=b.getUint16(a.h,!0),a.h+=2,this.Ja=b.getUint16(a.h,!0),a.h+=2,this.Bb=b.getUint16(a.h,!0),a.h+=2,this.Ad=Array(8),2>this.Kb?(this.Hj=b.getUint8(a.h,!0),a.h+=1):(this.X=
b.getUint8(a.h,!0),a.h+=1,this.yd=b.getUint8(a.h,!0),a.h+=1,this.pp(a)),this.rp(a),this.sp(a)))};l.pp=function(a){for(var b=a.Ia,c=this.Ja*this.Bb+7>>3,d=0;6>d;d++)if(0!=(this.X&1<<d)){for(var e=new Uint8Array(c),f=0;f<c;f++)e[f]=b.getUint8(a.h,!0),a.h+=1;this.Ad[d]=e}};
l.rp=function(a){var b=a.Ia;2>this.Kb&&(this.yd=b.getUint8(a.h,!0),a.h+=1,b.getUint16(a.h,!0),a.h+=2);if(0==this.yd)this.L=[];else{var c=this.Ja*this.Bb+7>>3;this.L=Array(this.yd);for(var d=0,e=this.L.length;d<e;d++){var f=b.getUint16(a.h,!0);a.h+=2;for(var g=new Uint8Array(c),k=0;k<c;k++)g[k]=b.getUint8(a.h,!0),a.h+=1;f=this.c.an[f];this.L[d]={Zm:f?f.Nr:null,$m:g}}}};
l.Nm=function(){for(var a=0;1>a;a++)if(this.Ad[a]){bitplane_=this.Ad[a];for(var b=0;b<this.Bb;b++)for(var c=0;c<this.Ja;c++){var d=this.Ja*b+c,e=1<<(d&7),d=d>>3;if(bitplane_[d]&e)switch(a){case 0:this.Na[b*this.Ja+c].Ci=!0}}}};l.Om=function(){for(var a=0;a<this.Bb;a++)for(var b=0;b<this.Ja;b++)for(var c=this.Ja*a+b,d=1<<(c&7),c=c>>3,e=0,f=this.L.length;e<f;e++)if(this.L[e].$m[c]&d){var g=this.L[e].Zm;g&&this.Na[a*this.Ja+b].L.push(g)}};
l.sp=function(a){this.Na=Array(this.Ja*this.Bb);for(var b=0,c=0;c<this.Bb;c++)for(var d=0;d<this.Ja;d++)this.Na[b]=new Zd(this,[this.ua,this.ug+this.Qe+d,this.vg+this.Re+c],a),b++;this.Om();this.Nm()};function ce(a,b,c,d,e){this.c=a;this.g=b;this.jt=Fc(this.c,c);this.da=d;this.pl=e;this.uo=1==b[0]&&(0==b[1]&&1==b[2]||1==b[1]&&0==b[2])}function be(a,b,c){return de(a.jt,b,a.c.Ib.Cc.Bg,c)}
function mc(a,b){this.c=a;this.lc=a.lc;this.af=!1;this.g=b.id||null;this.Wq=b.description||"";var c=b.model;if(null!=c&&(this.Cc={Bg:Fc(a,c.physicalSrs),bm:Fc(a,c.navigationSrs),Bp:Fc(a,c.publicSrs)},this.Zh={},null!=b.parameters&&(c=b.parameters,this.Zh.Yl=c.metaBinaryOrder||1,this.Zh.qs=c.navDelta||8),c=b.division,null!=c)){this.Ae={Az:c.rootLod||0,Qy:c.arity||null,pl:c.heightRange||[0,1]};var d;d=c.extents;d=null==d?{ja:[0,0,0],na:[1,1,1]}:{ja:d.ll||[0,0,0],na:d.ur||[1,1,1]};this.Ae.da=d;a.Xx=
[d.na[0]-d.ja[0],d.na[1]-d.ja[1],d.na[2]-d.ja[2]];a.Wx=d.ja;c=c.nodes;this.Ae.Na=[];if(null!=c){this.lv=4==c.length;d=0;for(var e=c.length;d<e;d++){var f;var g=c[d],k;f=g.srs;var h;h=g.extents;h=null==h?{ja:[0,0],na:[1,1]}:{ja:h.ll||[0,0],na:h.ur||[1,1]};k=g.id;null!=k?(g=k.lod||0,k=k.position||[0,0],f=new ce(this.c,[g,k[0],k[1]],f,h,this.pl)):f=void 0;this.Ae.Na.push(f)}this.af=!0}}}mc.prototype.gb=function(){return{id:this.g,physicalSrs:this.Cc.Bg.g,navigationSrs:this.Cc.bm.g,publicSrs:this.Cc.Bp.g}};
mc.prototype.Pa=function(a,b,c){var d,e;switch(b){case "public":d=this.Cc.Bp;break;case "physical":d=this.Cc.Bg;break;case "navigation":d=this.Cc.bm}switch(c){case "public":e=this.Cc.Bp;break;case "physical":e=this.Cc.Bg;break;case "navigation":e=this.Cc.bm}return de(d,a,e)};l=Wb.prototype;l.Pf=function(a,b,c){this.Rb.push({id:a,Fq:b,Ta:c})};l.Vh=function(a,b){var c=Jc(this.Rb,"after-map-render"==a?"map":a),d=Jc(this.Rb,b);-1!=c&&-1!=d&&this.Rb.splice(d,0,this.Rb.splice(c,1)[0])};
l.Uh=function(a,b){var c=Jc(this.Rb,"after-map-render"==a?"map":a),d=Jc(this.Rb,b);-1!=c&&-1!=d&&(d++,this.Rb.splice(d,0,this.Rb.splice(c,1)[0]))};l.ei=function(a){a=Jc(this.Rb,a);-1!=a&&this.Rb.splice(a,1)};l.oi=function(a,b){var c=Jc(this.Rb,a);-1!=c&&(this.Rb[c].Ta=b)};l.Bh=function(){var a=Jc(this.Rb,id2_);return-1!=a?this.Rb[a].Ta:!1};function Lc(a){1!=a.ge&&bb(a.m.j);for(var b=0,c=a.Rb.length;b<c;b++){var d=a.Rb[b];d.Ta&&d.Fq&&d.Fq(a.vu[a.ge])}}
Zc=function(a,b,c){this.Zb=a;this.c=a.c;this.H=b;this.g=a.g;this.S=c;this.Na=[];this.T=this.tc=0;this.hb=null;this.v=this.La=0;this.qa=null};l=Zc.prototype;l.I=function(a){1!=a&&null!=this.qa&&this.c.Rc.remove(this.qa);this.Zb&&Xc(this.Zb,this);this.H=this.T=0;this.qa=null;this.Na=[]};
l.clone=function(a){a=new Zc(this.Zb,a);a.Na=this.Na;a.T=this.T;a.Na=this.Na;a.v=this.v;a.ua=this.ua;a.ug=this.ug;a.vg=this.vg;a.Qe=this.Qe;a.Re=this.Re;a.Ja=this.Ja;a.Bb=this.Bb;a.Kb=this.Kb;a.L=this.L;2>this.Kb?a.Hj=this.Hj:(a.X=this.X,a.yd=this.yd,a.Ad=this.Ad);a.qa=ad(this.c.Rc,a.I.bind(a,!0),a.v);return a};l.ha=function(a){if(2==this.T)return!0;0==this.T&&(3==this.T?this.La<=this.c.f.ld&&performance.now()>this.hb+this.c.f.md&&this.Sb(a):this.Sb(a));return!1};
l.mq=function(){null!=this.qa&&$c(this.c.Rc,this.qa)};l.cj=function(a){var b=a[1]-this.g[1]-this.Qe;a=a[2]-this.g[2]-this.Re;if(0>b||0>a||b>=this.Ja||a>=this.Bb)return null;b=this.Na[this.Ja*a+b];b.va||(ae(b),b.va=!0);return b};l.Sb=function(){null==this.ab&&(this.ab=this.H.cl(this.g));this.c.Pc.load(this.ab,this.Od.bind(this),null,this.S,"metatile")};
l.Od=function(a,b,c){this.nd=b;this.Ld=c;p.Id(a,this.Pb.bind(this),this.Dc.bind(this),p.useCredentials?-1!=this.ab.indexOf(this.c.Ya):!1,this.c.l.cc);this.T=1};l.Dc=function(){1!=this.c.N&&(this.T=3,this.hb=performance.now(),this.La++,this.La<=this.c.f.ld&&setTimeout(function(){this.c.N||z(this.c)}.bind(this),this.c.f.md),this.Ld())};
l.Pb=function(a,b){if(1!=this.c.N)if(b){this.v+=4*a.byteLength;var c=performance.now();this.qp({Ia:a,h:0});this.c.o.mb+=performance.now()-c;this.qa=ad(this.c.Rc,this.I.bind(this,!0),this.v);z(this.c);this.T=2;this.hb=null;this.La=0;this.nd()}else z(this.c),this.c.pe.push(this.Pb.bind(this,a,!0))};
l.qp=function(a){var b=a.Ia,c;c=""+String.fromCharCode(b.getUint8(a.h,!0));a.h+=1;c+=String.fromCharCode(b.getUint8(a.h,!0));a.h+=1;"MT"==c&&(this.Kb=b.getUint16(a.h,!0),a.h+=2,3<this.Kb||(this.ua=b.getUint8(a.h,!0),a.h+=1,this.ug=b.getUint32(a.h,!0),a.h+=4,this.vg=b.getUint32(a.h,!0),a.h+=4,this.Qe=b.getUint16(a.h,!0),a.h+=2,this.Re=b.getUint16(a.h,!0),a.h+=2,this.Ja=b.getUint16(a.h,!0),a.h+=2,this.Bb=b.getUint16(a.h,!0),a.h+=2,this.Ad=Array(8),2>this.Kb?(this.Hj=b.getUint8(a.h,!0),a.h+=1):(this.X=
b.getUint8(a.h,!0),a.h+=1,this.yd=b.getUint8(a.h,!0),a.h+=1,this.pp(a)),this.rp(a),this.sp(a)))};l.pp=function(a){for(var b=a.Ia,c=this.Ja*this.Bb+7>>3,d=0;6>d;d++)if(0!=(this.X&1<<d)){for(var e=new Uint8Array(c),f=0;f<c;f++)e[f]=b.getUint8(a.h,!0),a.h+=1;this.Ad[d]=e}};
l.rp=function(a){var b=a.Ia;2>this.Kb&&(this.yd=b.getUint8(a.h,!0),a.h+=1,b.getUint16(a.h,!0),a.h+=2);if(0==this.yd)this.L=[];else{var c=this.Ja*this.Bb+7>>3;this.L=Array(this.yd);for(var d=0,e=this.L.length;d<e;d++){var f=b.getUint16(a.h,!0);a.h+=2;for(var g=new Uint8Array(c),k=0;k<c;k++)g[k]=b.getUint8(a.h,!0),a.h+=1;f=this.c.an[f];this.L[d]={Zm:f?f.Nr:null,$m:g}}}};
l.Nm=function(){for(var a=0;1>a;a++)if(this.Ad[a]){bitplane_=this.Ad[a];for(var b=0;b<this.Bb;b++)for(var c=0;c<this.Ja;c++){var d=this.Ja*b+c,e=1<<(d&7),d=d>>3;if(bitplane_[d]&e)switch(a){case 0:this.Na[b*this.Ja+c].Ci=!0}}}};l.Om=function(){for(var a=0;a<this.Bb;a++)for(var b=0;b<this.Ja;b++)for(var c=this.Ja*a+b,d=1<<(c&7),c=c>>3,e=0,f=this.L.length;e<f;e++)if(this.L[e].$m[c]&d){var g=this.L[e].Zm;g&&this.Na[a*this.Ja+b].L.push(g)}};
l.sp=function(a){this.Na=Array(this.Ja*this.Bb);for(var b=0,c=0;c<this.Bb;c++)for(var d=0;d<this.Ja;d++)this.Na[b]=new Zd(this,[this.ua,this.ug+this.Qe+d,this.vg+this.Re+c],a),b++;this.Om();this.Nm()};
function lc(a,b,c){this.c=a;this.g=b;this.lc=a.lc;this.eu=c.comment||null;this.si=c.srsDef||null;this.it=c.srsModifiers||[];this.R=c.type||"projected";this.Gy=c.vdatum||"orthometric";this.si=c.srsDefEllps||this.si;a=c.periodicity;this.Pw=null==a?null:{type:a.type||"",period:a.period||0};this.Sp=this.lc(this.si).info();this.jf=this.zb=null;this.Ve=this.lc(this.si,null,null,!0);this.El=null;c.geoidGrid&&(c=c.geoidGrid,this.zb={Vq:c.definition||null,ht:c.srsDefEllps||null,pq:c.valueRange||[0,1]},this.zb.da=
c.extents?{ja:c.extents.ll,na:c.extents.ur}:{ja:[0,0],na:[1,1]},this.zb.Vq&&(c=Sc(this.c,this.zb.Vq,{},null),this.jf=new Wc(this.c,c,!0)),this.zb.ht&&(this.zb.Ve=this.lc(this.zb.ht,null,null,!0)))}lc.prototype.gb=function(){return{comment:this.eu,srsDef:this.si,srsModifiers:this.it,type:this.R,vdatum:this.Gy,srsDefEllps:this.si,a:this.Sp.a,b:this.Sp.b}};lc.prototype.fc=function(){return this.Sp};lc.prototype.ha=function(){return null==this.zb||null!=this.jf&&this.jf.ha()};
function Pa(a){return"projected"==a.R}function ee(a,b){var c=b[2]||0,c=c/fe(a,b);return c-=ge(a,b)}function he(a,b){var c=b[2]||0,c=c+ge(a,b);return c*=fe(a,b)}
function ge(a,b){if(null!=a.jf&&(null==a.zb||null!=a.jf&&a.jf.ha())){mapCoords_=a.lc(a.Ve,a.zb.Ve,[b[0],b[1]]);var c=mapCoords_[0]-a.zb.da.ja[0],d=a.zb.da.na[1]-mapCoords_[1],e=a.jf.rl,c=e[0]/(a.zb.da.na[0]-a.zb.da.ja[0])*c,d=e[1]/(a.zb.da.na[1]-a.zb.da.ja[1])*d,c=p.dd(c,0,e[0]-2),d=p.dd(d,0,e[1]-2),f=Math.floor(c),g=Math.floor(d),c=c-f,k=a.jf.me,h=g*e[0],e=h+e[0],m=k[4*(h+f)],n=k[4*(e+f)],h=m+(k[4*(h+f+1)]-m)*c,d=h+(n+(k[4*(e+f+1)]-n)*c-h)*(d-g);return d=a.zb.pq[0]+(a.zb.pq[1]-a.zb.pq[0])/255*d}return 0}
function fe(a,b){if(-1!=a.it.indexOf("adjustVertical")){var c=a.fc(),d="+proj=longlat  +alpha=0 +gamma=0 +a="+c.a+" +b="+c.b+" +x_0=0 +y_0=0";a.El||(a.El=a.lc(d,null,null,!0));d=a.lc(a.Ve,a.El,[b[0],b[1]]);c=(new GeographicLib.Geodesic.Geodesic(c.a,c.a/c.b-1)).Direct(d[1],d[0],90,1E3);d=[c.mz,c.iz];d=a.lc(a.El,a.Ve,d);c=d[0]-b[0];d=d[1]-b[1];return Math.sqrt(c*c+d*d)/1E3}return 1}
function de(a,b,c,d){a.ha();if("string"!==typeof c){if(c.g==a.g)return b.slice();c.ha()}b=b.slice();b[2]=ee(a,b);a=a.lc(a.Ve,"string"===typeof c?c:c.Ve,b);d||"string"===typeof c||(a[2]=he(c,a));return a}function Jd(a,b,c){a.ha();if("string"!==typeof c){if(c.g==a.g)return b.slice();c.ha()}b=b.slice();"string"!==typeof c&&(b[2]=ee(c,b));b=a.lc("string"===typeof c?c:c.Ve,a.Ve,b);b[2]=he(a,b);return b}
function jc(a){this.c=a;this.l=a.l;this.qj=a.l.qj;this.Ur=this.mb=this.Os=this.fi=this.Ep=this.kr=this.jr=this.kt=this.xd=this.Kj=this.Lj=this.ck=this.Ti=this.Vf=this.Ok=this.Ce=0;this.Eg=Array(32);this.Nj=!1;this.gj=0;this.tb=900;this.mo=Array(this.tb);this.Xn=Array(this.tb);this.Wn=Array(this.tb);this.Yn=Array(this.tb);this.bo=Array(this.tb);this.Un=Array(this.tb);this.Vn=Array(this.tb);this.ho=Array(this.tb);this.eo=Array(this.tb);this.co=Array(this.tb);this.fo=Array(this.tb);this.ko=Array(this.tb);
this.io=Array(this.tb);this.Tn=Array(this.tb);this.ao=Array(this.tb);this.$n=Array(this.tb);this.Zn=Array(this.tb);this.Gd=[[0,0],[0,0]];this.Fd=[[0,0],[0,0]];this.Ed=[[0,0],[0,0]];Ua(this);this.Er=this.Fr=this.ol=this.nl=this.hj=this.vj=this.Hl=this.Ko=this.Lo=this.Yb=this.ns=this.Ss=this.Ar=this.Gh=this.Jh=this.Ih=0}
function Ua(a){for(var b=a.gj=0;b<a.tb;b++)a.mo[b]=0,a.Xn[b]=0,a.Wn[b]=0,a.Yn[b]=0,a.bo[b]=0,a.Vn[b]=0,a.Un[b]=0,a.ho[b]=0,a.eo[b]=0,a.co[b]=0,a.fo[b]=0,a.ko[b]=0,a.io[b]=[0,[]],a.Tn[b]=0,a.ao[b]=[[0,0],[0,0]],a.$n[b]=[[0,0],[0,0]],a.Zn[b]=[[0,0],[0,0]]}
jc.prototype.end=function(a){var b=performance.now(),c=b-this.Os,d=b-this.kr;this.kr=b;a?(this.fi+=c,this.Ur=c):this.fi+=this.Ur;this.Nj&&(a=this.gj,this.mo[a]=c,this.Xn[a]=0,this.Wn[a]=0,this.Yn[a]=0,this.bo[a]=d,this.Vn[a]=this.c.Ec.Zc,this.Un[a]=this.c.Rc.Zc,this.ho[a]=this.Jh,this.eo[a]=this.Ih,this.co[a]=this.Gh,this.fo[a]=this.Yb,this.ko[a]=this.Vf,this.ao[a]=[[this.Gd[0][0],this.Gd[0][1]],[this.Gd[1][0],this.Gd[1][1]]],this.$n[a]=[[this.Fd[0][0],this.Fd[0][1]],[this.Fd[1][0],this.Fd[1][1]]],
this.Zn[a]=[[this.Ed[0][0],this.Ed[0][1]],[this.Ed[1][0],this.Ed[1][1]]],this.io[a]=[this.Ce,this.Eg.slice()],this.Tn[a]=this.mb,this.gj=(this.gj+1)%this.tb,Sa(this.qj,this));if(0==this.kt%50&&(this.Ep=this.fi/100,this.jr=1E3/this.Ep,this.fi=0,null!=this.qj)){this.Ar=this.c.gc.Zc;this.Ss=this.c.Ec.Zc;this.ns=this.c.Rc.Zc;c=this.qj;d="FPS: "+Math.round(this.jr)+"<br/>Render time: "+Math.round(1E3*this.Ep)+"<br/> - resources: "+Math.round(this.Yb/1048576)+"MB<br/>GPU Cache: "+Math.round(this.Ar/1048576)+
"MB<br/> - textures: "+Math.round(this.Jh/1048576)+"MB<br/> - meshes: "+Math.round(this.Ih/1048576)+"MB<br/> - geodata: "+Math.round(this.Gh/1048576)+"MB<br/>CPU Cache: "+Math.round(this.Ss/1048576)+"MB<br/>Metaile Cache: "+Math.round(this.ns/1048576)+"MB<br/>Draw calls: "+this.Ti+"<br/>Polygons: "+this.Vf+"<br/><br/>Terrain Height: "+this.Fr.toFixed(2)+"<br/>- float: "+this.Er.toFixed(2)+"<br/>- desired lod: "+this.nl.toFixed(2)+"<br/>- used lod: "+this.ol.toFixed(2)+"<br/>- used source: "+(2==this.hj?
"navtile":1==this.hj?"node":"---")+"<br/>Terrain Radar Lod: "+c.qe+"<br/><br/>Loaded/Errors: "+this.Lo+" / "+this.Ko+"<br/>Load time: "+(.001*(this.vj-this.Hl)).toFixed(2)+"s <br/>";a="Metatiles: "+this.Kj+"<br/>Metanodes: "+this.Lj+" / "+this.ck+"<br/>GeodataTiles: "+this.Ok+"<br/><br/>Tiles: "+this.Ce+"<br/>";for(var b=0,e=this.Eg.length;b<e;b++)this.Eg[b]&&(a+="LOD "+b+": "+this.Eg[b]+"<br/>");c.by.innerHTML="<table style='width:305px'><tr><td>"+d+"</td><td>"+a+"</td></tr></table>";d=c.l.J();null!=
d&&(d=d.sa(),a=""+(d.s[0]+","),b=Nc(d),a+=b[0]+","+b[1]+","+d.s[3]+","+b[2].toFixed(2)+",",b=d.ec(),a+=b[0].toFixed(2)+","+b[1].toFixed(2)+","+b[2].toFixed(2)+",",a+=d.s[8].toFixed(2)+","+d.je().toFixed(2),c.lt.value!=a&&(c.lt.value=a))}this.Gd=[[0,0],[0,0]];this.Fd=[[0,0],[0,0]];this.Ed=[[0,0],[0,0]]};MelownSubmeshFlags_InternalTexcoords=1;MelownSubmeshFlags_ExternalTexcoords=2;MelownSubmeshFlags_PerVertexUndulation=4;MelownSubmeshFlags_TextureMode=8;
function Yd(a,b){this.c=a.c;this.zd=this.Nc=this.ca=null;this.Bc=a;this.af=!0;this.N=!1;this.A=new ib;this.hf=this.v=0;if(null!=b){var c=b.Ia;this.X=c.getUint8(b.h,!0);b.h+=1;1<this.Bc.Kb?(this.Ug=c.getUint8(b.h,!0),b.h+=1):this.Ug=0;this.$e=c.getUint16(b.h,!0);b.h+=2;var d=this.A.W,e=this.A.xa;d[0]=c.getFloat64(b.h,!0);b.h+=8;d[1]=c.getFloat64(b.h,!0);b.h+=8;d[2]=c.getFloat64(b.h,!0);b.h+=8;e[0]=c.getFloat64(b.h,!0);b.h+=8;e[1]=c.getFloat64(b.h,!0);b.h+=8;e[2]=c.getFloat64(b.h,!0);b.h+=8;Qb(this.A);
if(3<=this.Bc.Kb){var c=b.Ia,d=b.h,f=c.getUint16(d,!0),d=d+2,g=c.getUint16(d,!0),d=d+2;f||(this.af=!1);for(var e=this.A.tk(),k=this.A.Dj,h=1/g,g=null,m=new Float32Array(3*f),n=0,q=0,y=0,w=e[0],t=e[1],v=e[2],D=this.A.W[0],B=this.A.W[1],x=this.A.W[2],H=1/(this.A.xa[0]-this.A.W[0]),u=1/(this.A.xa[1]-this.A.W[1]),L=1/(this.A.xa[2]-this.A.W[2]),e=0;e<f;e++){var r=ie(c,d),n=n+r[0],d=r[1],r=ie(c,d),q=q+r[0],d=r[1],r=ie(c,d),y=y+r[0],d=r[1],A=3*e;m[A]=(n*h*k+w-D)*H;m[A+1]=(q*h*k+t-B)*u;m[A+2]=(y*h*k+v-x)*
L}if(this.X&MelownSubmeshFlags_ExternalTexcoords)for(g=c.getUint16(d,!0),d+=2,h=1/g,g=new Float32Array(2*f),e=q=n=0;e<f;e++)r=ie(c,d),n+=r[0],d=r[1],r=ie(c,d),q+=r[0],d=r[1],r=2*e,g[r]=n*h,g[r+1]=1-q*h;this.ak=m;this.Zj=g;if(this.X&MelownSubmeshFlags_InternalTexcoords){g=c.getUint16(d,!0);d+=2;m=c.getUint16(d,!0);d+=2;e=c.getUint16(d,!0);d+=2;m=1/m;A=1/e;q=n=0;f=new Float32Array(2*g);e=0;for(g*=2;e<g;e+=2)r=ie(c,d),n+=r[0],d=r[1],r=ie(c,d),q+=r[0],d=r[1],f[e]=n*m,f[e+1]=1-q*A;this.$j=f}n=c.getUint16(d,
!0);d+=2;g=f=null;m=new Float32Array(9*n);this.X&MelownSubmeshFlags_InternalTexcoords&&(f=new Float32Array(6*n));this.X&MelownSubmeshFlags_ExternalTexcoords&&(g=new Float32Array(6*n));q=this.ak;k=this.Zj;h=this.$j;for(e=y=0;e<n;e++)A=9*e,r=je(c,d),w=y-r[0],d=r[1],r[0]||y++,r=je(c,d),t=y-r[0],d=r[1],r[0]||y++,r=je(c,d),v=y-r[0],d=r[1],r[0]||y++,r=3*w,m[A]=q[r],m[A+1]=q[r+1],m[A+2]=q[r+2],r=3*t,m[A+3]=q[r],m[A+4]=q[r+1],m[A+5]=q[r+2],r=3*v,m[A+6]=q[r],m[A+7]=q[r+1],m[A+8]=q[r+2],null!=g&&(A=6*e,g[A]=
k[2*w],g[A+1]=k[2*w+1],g[A+2]=k[2*t],g[A+3]=k[2*t+1],g[A+4]=k[2*v],g[A+5]=k[2*v+1]);y=0;if(null!=f)for(e=0;e<n;e++)r=je(c,d),w=y-r[0],d=r[1],r[0]||y++,r=je(c,d),t=y-r[0],d=r[1],r[0]||y++,r=je(c,d),v=y-r[0],d=r[1],r[0]||y++,A=6*e,f[A]=h[2*w],f[A+1]=h[2*w+1],f[A+2]=h[2*t],f[A+3]=h[2*t+1],f[A+4]=h[2*v],f[A+5]=h[2*v+1];this.ca=m;this.Nc=f;this.zd=g}else{c=b.Ia;d=b.h;A=c.getUint16(b.h,!0);d+=2;A||(this.af=!1);m=null;g=new Float32Array(3*A);this.X&MelownSubmeshFlags_ExternalTexcoords&&(m=new Float32Array(2*
A));q=n=1/65535;for(e=0;e<A;e++)r=3*e,g[r]=c.getUint16(d,!0)*q,d+=2,g[r+1]=c.getUint16(d,!0)*q,d+=2,g[r+2]=c.getUint16(d,!0)*q,d+=2,null!=m&&(r=2*e,m[r]=c.getUint16(d,!0)*n,d+=2,m[r+1]=(65535-c.getUint16(d,!0))*n,d+=2);this.ak=g;this.Zj=m;if(this.X&MelownSubmeshFlags_InternalTexcoords){m=c.getUint16(d,!0);d+=2;A=new Float32Array(2*m);n=1/65535;e=0;for(m*=2;e<m;e+=2)A[e]=c.getUint16(d,!0)*n,d+=2,A[e+1]=(65535-c.getUint16(d,!0))*n,d+=2;this.$j=A}n=c.getUint16(d,!0);d+=2;m=A=null;g=new Float32Array(9*
n);this.X&MelownSubmeshFlags_InternalTexcoords&&(A=new Float32Array(6*n));this.X&MelownSubmeshFlags_ExternalTexcoords&&(m=new Float32Array(6*n));q=this.ak;f=this.Zj;k=this.$j;for(e=0;e<n;e++)r=9*e,h=c.getUint16(d,!0),d+=2,y=c.getUint16(d,!0),d+=2,w=c.getUint16(d,!0),d+=2,t=3*h,g[r]=q[t],g[r+1]=q[t+1],g[r+2]=q[t+2],t=3*y,g[r+3]=q[t],g[r+4]=q[t+1],g[r+5]=q[t+2],t=3*w,g[r+6]=q[t],g[r+7]=q[t+1],g[r+8]=q[t+2],null!=m&&(r=6*e,m[r]=f[2*h],m[r+1]=f[2*h+1],m[r+2]=f[2*y],m[r+3]=f[2*y+1],m[r+4]=f[2*w],m[r+5]=
f[2*w+1]),null!=A&&(h=c.getUint16(d,!0),d+=2,y=c.getUint16(d,!0),d+=2,w=c.getUint16(d,!0),d+=2,r=6*e,A[r]=k[2*h],A[r+1]=k[2*h+1],A[r+2]=k[2*y],A[r+3]=k[2*y+1],A[r+4]=k[2*w],A[r+5]=k[2*w+1]);this.ca=g;this.Nc=A;this.zd=m}this.Zj=this.$j=this.ak=null;b.h=d;this.v=this.ca.length;this.Nc&&(this.v+=this.Nc.length);this.zd&&(this.v+=this.zd.length);this.v*=4;this.hf=n}}l=Yd.prototype;l.I=function(){this.N=!0;this.zd=this.Nc=this.ca=null};
function je(a,b){var c=a.getUint8(b,!0);if(c&128){var d=a.getUint8(b+1,!0);return[c&127|d<<7,b+2]}return[c,b+1]}function ie(a,b){var c=a.getUint8(b,!0);return c&128?(c=c&127|a.getUint8(b+1,!0)<<7,c&1?[-((c>>1)+1),b+2]:[c>>1,b+2]):c&1?[-((c>>1)+1),b+1]:[c>>1,b+1]}l.size=function(){return this.v};l.fileSize=function(){return this.Mc};function Xd(a){return new ub(a.c.m.j,{A:a.A,ca:a.ca,dk:a.Nc,Ht:a.zd},1,a.c.l)}
l.Eh=function(a,b){var c=b;null!=c?(c[0]=Rb(this.A,0),c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=Rb(this.A,1),c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=Rb(this.A,2),c[11]=0,c[12]=this.A.W[0]-a[0],c[13]=this.A.W[1]-a[1],c[14]=this.A.W[2]-a[2],c[15]=1):(c=p.i.create(),p.i.multiply(p.Ic(this.A.W[0]-a[0],this.A.W[1]-a[1],this.A.W[2]-a[2]),p.If(Rb(this.A,0),Rb(this.A,1),Rb(this.A,2)),c));return c};
l.sh=function(a){var b=this.c.m;b.j.useProgram(b.bi,["aPosition"]);var c=p.i.create(),d=p.i.create();p.i.multiply(Mb(b.P),this.Eh(a),d);a=Lb(b.P);p.i.multiply(a,d,c);ra(b.bi,"uMVP",c);b.nk.jb(b.bi,"aPosition")};
function qc(a,b,c){this.c=a;this.g=null;this.R="basic";this.Yl=1;this.cp=this.Qc="";this.qs=1;this.bq=this.Xl="";this.Ya=this.c.Ya;this.Jc=this.c.Jc;this.bd=this.c.bd;this.Ca=[0,0];this.ia=[[0,0],[0,0]];this.$e=null;this.cd=[];this.gg="glue"==c;this.Uk="free"==c;this.Wd=!1;this.eh=0;this.va=!1;this.gd=null;this.De=0;this.mr=!1;this.Ej=this.$l=null;this.os=-1;this.iu=[];this.Yh=this.re=this.Ye=null;this.Vp=!0;this.ac=this.Uk?new tc(this.c,0,this):null;"string"===typeof b?(this.Oc=this.c.$b(b),this.Ya=
p.Ha.Xk(this.Oc),this.Jc=p.Ha.hl(this.Oc),this.bd=p.Ha.el(this.Oc),p.Jd(this.Oc,function(a){this.Ag(a);this.va=!0;Ic(this.c)}.bind(this),function(){}.bind(this),null,p.useCredentials?-1!=this.Oc.indexOf(this.c.Ya):!1,this.c.l.cc)):(this.Ag(b),this.va=!0)}l=qc.prototype;
l.Ag=function(a){this.g=a.id||null;this.R=a.type||"basic";this.Yl=a.metaBinaryOrder||1;this.Qc=this.$b(a.metaUrl,"");this.cp=this.$b(a.navUrl,"");this.qs=a.navDelta||1;this.Xl=this.$b(a.meshUrl,"");this.bq=this.$b(a.textureUrl,"");this.$i=this.$b(a.geodataUrl||a.geodata,"");this.Ca=a.lodRange||[0,0];this.ia=a.tileRange||[[0,0],[0,0]];this.$e=a.textureLayer||null;this.fb="geodata"==this.R||"geodata-tiles"==this.R;this.L=a.credits||[];this.Tf=a.displaySize||256;if(a.extents){var b=a.extents.ll,c=a.extents.ur;
this.da=new ib(b[0],b[1],b[2],c[0],c[1],c[2])}else this.da=new ib(0,0,0,1,1,1);this.Kf=Math.pow(2,this.Ca[0])/((this.ia[1][0]-this.ia[1][0]+1)*(this.ia[1][1]-this.ia[1][1]+1));switch(typeof this.L){case "string":this.L=[];break;case "object":if(!Array.isArray(this.L)){b=this.L;this.L=[];for(var d in b)nc(this.c,d,new oc(this.c,b[d])),this.L.push(d)}d=0;for(b=this.L.length;d<b;d++)c=this.c.L[this.L[d]],this.iu.push(c?c.g:null)}this.$i&&-1!=this.$i.indexOf("{geonavtile}")&&(this.mr=!1);this.fb&&(this.Yh=
a=a.style)&&this.cb(a);this.Ug=[];if(this.gg)for(d=0,b=this.g.length;d<b;d++)this.Ug.push(this.c.He(this.g[d]))};l.gb=function(){return this.fb?{type:this.R,metaUrl:this.Qc,geodataUrl:this.$i,lodRange:this.Ca,tileRange:this.ia,style:this.Yh}:{type:this.R,metaUrl:this.Qc,navUrl:this.cp,meshUrl:this.Xl,textureUrl:this.bq,lodRange:this.Ca,tileRange:this.ia,textureLayer:this.$e}};
l.$b=function(a,b){if(!a)return b;a=a.trim();return-1!=a.indexOf("://")?a:0==a.indexOf("//")?this.Jc+a:0==a.indexOf("/")?this.bd+a:this.Ya+a};l.Cr=function(a){var b=a[0]-this.Ca[0],c=0>b;if(a[0]<this.Ca[0]){var b=-b,d=this.ia[0][0]>>b,e=this.ia[0][1]>>b,f=this.ia[1][0]>>b,b=this.ia[1][1]>>b;if(a[0]>this.Ca[1]||a[1]<d||a[1]>f||a[2]<e||a[2]>b)return[!1,!1]}else if(d=a[1]>>b,b=a[2]>>b,a[0]>this.Ca[1]||d<this.ia[0][0]||d>this.ia[1][0]||b<this.ia[0][1]||b>this.ia[1][1])return[!1,!1];return[!0,c]};
l.cb=function(a){this.Ye!=a&&(this.re=this.c.Lf[a],this.re||(this.re=new pc(this.c,a,a),this.c.Lf[a]=this.re),this.Ye=a,this.Vp=!0,this.De++,z(this.c))};l.cl=function(a,b){return Sc(this.c,this.Qc,{ua:a[0],Fb:a[1],Gb:a[2]},null,b)};function Dd(a,b){return Sc(a.c,a.cp,{ua:b[0],Fb:b[1],Gb:b[2]},null,void 0)}function Id(a,b,c){return Sc(a.c,a.bq,{ua:b[0],Fb:b[1],Gb:b[2]},c,void 0)}function Ed(a,b,c){return Sc(a.c,a.$i,{ua:b[0],Fb:b[1],Gb:b[2]},c,void 0)}
function Gc(a){var b,c=a.Ni;if(b=a.ac){b.Vg=[];b.Jz=[];b.xm=[];var d={},e=0,f=[],g=[],k;for(k in c.Ka){var h=a.He(k);h&&(g.push(h.g),e++,d[k]=h.h+1,f.push([[h.h+1],h,!0,!1]))}1<=e&&(g.sort(),g=g.join(";"),h=a.pc[g])&&(f=[[[h.h+1],h,!0,!1]],e=1);if(1<e){var m=[];for(k in a.fj){var n=a.fj[k],q=n.g;if(q.length<=e){for(var y=!1,g=0,h=q.length;g<h;g++)if(!d[q[g]]){y=!0;break}if(!y){y=[];g=0;for(h=q.length;g<h;g++)y.unshift(d[q[g]]);m.push([y,n,!1,!1])}}}d=0;for(q=m.length;d<q;d++)g=m[d],n=g[1],n.Hu=!0,
n.Gu=!0,n.Hu&&f.push(g),n.Gu&&(y=g[0].slice(1),f.push([y,g[1],!1,!0]));do for(m=!0,d=0,q=f.length-1;d<q;d++){for(var n=f[d][0],y=f[d+1][0],w=!1,g=0,h=Math.min(n.length,y.length);g<h;g++)if(n[g]<y[g]||g==h-1&&n[g]==y[g]&&y.length>n.length){w=!0;break}w&&(g=f[d],f[d]=f[d+1],f[d+1]=g,m=!1)}while(!m);--e;d=0;for(q=f.length;d<q;d++)b.Vg.push([f[d][1],f[d][3]]),f[d][1].rq=e,f[d][2]&&(e--,b.xm.push(f[d][1]))}else 1==e&&(b.Vg.push([f[0][1],f[0][3]]),f[0][1].rq=e-1,b.xm=[f[0][1]]);a.Tk=!1;for(k in c.fa)if(b=
a.fa[k])b.Vg=[b],b.xm=[b],b.fb&&(a.Tk=!0);Vb(a.m)}}
function Hc(a){var b=a.Ni,c;for(c in b.Ka){var d=b.Ka[c],e=a.He(c);if(null!=e){e.cd=[];for(var f=0,g=d.length;f<g;f++){var k=d[f];if("string"===typeof k){var h=a.ob[k];h&&e.cd.push([h,1])}else if(h=a.ob[k.id]){var m=1;"undefined"!==typeof k.alpha&&(m=k.alpha);e.cd.push([h,m])}}}}for(c in b.fa)if(f=b.fa[c],d=a.fa[c],null!=d&&d.va&&(d.cd=[],(e=f.boundLayers)&&Array.isArray(e)))for(f=0,g=e.length;f<g;f++)if(k=e[f],"string"===typeof k)(h=a.ob[k])&&d.cd.push([h,1]);else if(h=a.ob[k.id])m=1,"undefined"!==
typeof k.alpha&&(m=k.alpha),d.cd.push([h,m])}function Wc(a,b,c,d,e,f,g){this.c=a;this.o=a.o;this.S=f;this.Mh=g;this.sb=this.rl=this.me=this.Ra=null;this.T=0;this.hb=null;this.La=0;this.Gj=!1;this.Hb=null;this.ab=b;this.ub=c||!1;this.V=d;this.rb=e;this.Sa=0;this.ze=this.ye=null;this.Cn=!1;this.Mc=0;if(e&&e.$a&&(a=e.$a,a.td))switch(this.ye=a.td.R,this.ye){case "negative-type":this.ze=a.td.aw;break;case "negative-code":this.ze=a.td.du;break;case "negative-size":this.ze=a.td.v}this.Ab=this.qa=null}
l=Wc.prototype;l.I=function(){this.U=null;this.Bl();this.Al();this.Hb&&(this.Hb.Bl(),this.Hb.Al())};l.Bl=function(a){this.me=this.Ra=null;1!=a&&this.qa&&this.c.Ec.remove(this.qa);this.Hb&&this.Hb.Bl();this.sb||(this.T=0);this.qa=null};l.Al=function(a){null!=this.sb&&(this.o.Jh-=this.sb.v,this.sb.I(),this.o.Gd[1][0]++,this.o.Gd[1][1]+=this.sb.v,this.Hb&&this.Hb.Al());this.sb=null;1!=a&&this.Ab&&this.c.gc.remove(this.Ab);this.Ra||this.me||(this.T=0);this.Ab=null};
function ke(a,b,c){if(b&&c){a.V.Pg=b;a.V.$a=c;if(!b.xb[c.g]){b.ob[c.g]=c;var d=Rc(c,b.g);b.xb[c.g]=Vc(b.Wc,d,null,null,{S:b,$a:c},a.S,a.Mh)}a.V.U=b.xb[c.g];c=a.V.S;var d=c.g[0]-b.g[0],e=1/Math.pow(2,d);a.V.Et=[e,e,(c.g[1]-(b.g[1]<<d))*e,(c.g[2]-(b.g[2]<<d))*e];z(a.c)}}
l.ha=function(a,b,c){var d=this.c.o.Yb>=this.c.tg;a=a||d;if(this.Gj)return!1;if(this.V){if(this.V.U){for(;-1==this.V.U.Sa;){var e=this.V.Pg.Fa;if(e.g[0]<this.V.$a.Ca[0])return this.Gj=!0,this.V.S.Jg=!0,z(this.c),!1;ke(this,e,this.V.$a)}(a=this.V.U.ha(a,b,c))&&this.Iq&&(this.V.S.Jg=null!=Hd(this.V.U),this.Iq=!1);return a}ke(this,this.V.Pg,this.V.$a);return!1}switch(this.ye){case "metatile":if(2!=this.Sa){if(0==this.Sa&&this.rb&&this.rb.S){d=this.rb.S.Bq;d||(d=Uc(this.c.lm,this.rb.S.g,8),this.rb.S.Bq=
d);var e=this.rb.$a,f=this.rb.ms;this.rb.ms||(f=d.g,f=Sc(e.c,e.Qc,{ua:f[0],Fb:f[1],Gb:f[2]},null,void 0),this.rb.ms=f);d=Vc(d,f,!0,null,null,this.S,this.Mh);this.Hb?this.Hb.ha(a,b,c)&&(this.Sa=2):d.ha(a,b,c)&&(a=this.rb.S,b=d.me?d.me[4*((a.g[2]&255)*d.rl[0]+(a.g[1]&255))]:0,this.Sa=b&128?2:-1,2!=this.Sa||b&64||(b=a.g,f=Sc(e.c,e.$o,{ua:b[0],Fb:b[1],Gb:b[2]},null,void 0),this.Hb=Vc(a.Wc,f,null,null,null,this.S,this.Mh),this.Sa=0,a.Jg=!0,z(this.c)))}if(-1==this.Sa){if(!this.V){e=this.rb.S.Fa;if(e.g[0]<
this.rb.$a.Ca[0])return this.Gj=!0,this.rb.S.Jg=!0,z(this.c),!1;this.V={S:this.rb.S,$a:this.rb.$a};ke(this,this.V.S.Fa,this.V.$a);this.Iq=!0}for(;-1==this.V.U.Sa;){e=this.V.Pg.Fa;if(e.g[0]<this.V.$a.Ca[0]){this.Gj=!0;this.V.S.Jg=!0;z(this.c);break}ke(this,e,this.V.$a)}}return!1}break;case "negative-type":case "negative-code":case "negative-size":if(2!=this.Sa){if(0==this.Sa)le(this,b,"negative-size"==this.ye);else if(3==this.Sa)this.La<=this.c.f.ld&&performance.now()>this.hb+this.c.f.md&&le(this,
b,"negative-size"==this.ye);else if(-1==this.Sa&&this.rb)for(this.V||(this.V={S:this.rb.S,$a:this.rb.$a},ke(this,this.V.S.Fa,this.V.$a));-1==this.V.U.Sa;)ke(this,this.V.Pg.Fa,this.V.$a);return!1}}e=!0;this.Hb&&(e=this.Hb.ha(a,b,c));if(2==this.T){!a&&this.qa&&$c(this.c.Ec,this.qa);if((this.ub&&!this.me||!this.ub&&!this.sb)&&this.o.mb>this.c.f.yj)return z(this.c),!1;if(c)return this.ub&&!this.me&&(b=performance.now(),me(this),this.o.mb+=performance.now()-b),e;if(this.ub)this.me||(b=performance.now(),
me(this),this.o.mb+=performance.now()-b);else{if(!this.sb){if(this.c.o.Yb>=this.c.tg||d)return!1;b=performance.now();this.sb=new Za(this.c.m.j,null,this.c.l);fb(this.sb,this.Ra,"linear",!1);this.o.Jh+=this.sb.v;this.o.Gd[0][0]++;this.o.Gd[0][1]+=this.sb.v;this.Ab=ad(this.c.gc,this.Al.bind(this,!0),this.sb.v);this.o.mb+=performance.now()-b}!a&&this.Ab&&$c(this.c.gc,this.Ab)}return e}0==this.T?a||this.Sb(b):3==this.T&&this.La<=this.c.f.ld&&performance.now()>this.hb+this.c.f.md&&this.Sb(b);return!1};
l.Sb=function(a,b){this.c.Pc.load(this.ab,this.Od.bind(this,b),a,this.S,this.Mh?"texture-in":"texture-ex")};l.Od=function(a,b,c,d){this.nd=c;this.Ld=d;c=this.Dc.bind(this);d=this.Pb.bind(this);a?this.Sa=1:this.T=1;this.c.f.Cj?p.Id(b,this.iw.bind(this),c,p.useCredentials?-1!=this.ab.indexOf(this.c.Ya):!1,this.c.l.cc,"blob"):this.Ra=p.wb.sl(b,d,c,this.c.l.eq?-1!=b.indexOf(this.c.l.eq):!1)};
l.Dc=function(a){1!=this.c.N&&(a&&window.URL.revokeObjectURL(this.Ra.src),this.T=3,this.hb=performance.now(),this.La++,this.La<=this.c.f.ld&&setTimeout(function(){this.c.N||z(this.c)}.bind(this),this.c.f.md),this.Ld())};l.iw=function(a){if(this.Cn&&this.ye&&"metatile"!=this.ye&&(this.xs(0,a,null),-1==this.Sa)){this.nd();return}var b=new Image;b.onerror=this.Dc.bind(this,!0);b.onload=this.Pb.bind(this,!0);this.Ra=b;b.src=window.URL.createObjectURL(a);this.Mc=a.size};
l.Pb=function(a){this.c.N||(a&&window.URL.revokeObjectURL(this.Ra.src),this.qa=ad(this.c.Ec,this.Bl.bind(this,!0),this.Ra.naturalWidth*this.Ra.naturalHeight*3),z(this.c),this.T=2,this.hb=null,this.La=0,this.nd())};function le(a,b,c){a.c.f.Cj&&a.Cn?a.Sb(b,!0):a.c.Pc.load(a.ab,a.sw.bind(a,c),b,a.S,a.Mh,a.Mh?"texture-in":"texture-ex")}
l.sw=function(a,b,c,d){this.nd=c;this.Ld=d;c=this.tw.bind(this,a);d=this.xs.bind(this,a);this.Sa=1;a?p.Id(b,d,c,p.useCredentials?-1!=this.ab.indexOf(this.c.Ya):!1,this.c.l.cc,"blob"):p.wb.Dr(b,d,c,p.useCredentials?-1!=this.ab.indexOf(this.c.Ya):!1,this.c.l.cc)};l.tw=function(){this.c.N||(this.Sa=3,this.hb=performance.now(),this.La++,this.La<=this.c.f.ld&&setTimeout(function(){this.c.N||z(this.c)}.bind(this),this.c.f.md),this.Ld())};
l.xs=function(a,b,c){if(!this.c.N)if(this.Sa=2,this.hb=null,this.La=0,this.c.f.Cj&&this.Cn)switch(this.ye){case "negative-size":b&&b.size==this.ze&&(this.Sa=-1);break;case "negative-type":b&&b.type==this.ze&&(this.Sa=-1);break;case "negative-code":c&&-1!=this.ze.indexOf(c)&&(this.Sa=-1)}else{switch(this.ye){case "negative-size":b&&b.byteLength==this.ze&&(this.Sa=-1);break;case "negative-type":b&&-1!=b.indexOf(this.ze)&&(this.Sa=-1);break;case "negative-code":c&&-1!=this.ze.indexOf(c)&&(this.Sa=-1)}this.nd()}};
function me(a){var b=document.createElement("canvas");b.width=a.Ra.naturalWidth;b.height=a.Ra.naturalHeight;b=b.getContext("2d");b.drawImage(a.Ra,0,0);a.me=b.getImageData(0,0,a.Ra.naturalWidth,a.Ra.naturalHeight).data;a.rl=[a.Ra.naturalWidth,a.Ra.naturalHeight];a.Ra=null}function Hd(a){return a.V&&a.V.U?a.V.U.Hb:a.Hb}
function rc(a,b){this.c=a;this.g=null;this.Zo=this.Qc="";this.Ya=this.c.Ya;this.Jc=this.c.Jc;this.bd=this.c.bd;this.Ca=[0,0];this.ia=[[0,0],[0,0]];this.Ka=[];this.Ag(b);this.Wd=!0;this.va=!1}l=rc.prototype;
l.Ag=function(a){this.g=a.id||null;this.Qc=this.$b(a.metaUrl,"");this.Zo=this.$b(a.mapping,"");this.Ca=a.lodRange||[0,0];this.ia=a.tileRange||[[0,0],[0,0]];this.mt=this.g?this.g.join(";"):null;if(this.g){var b=this.g.slice();b.sort();this.mt=b.join(";")}a.extents?(b=a.extents.ll,a=a.extents.ur,this.da=new ib(b[0],b[1],b[2],a[0],a[1],a[2])):this.da=new ib(0,0,0,1,1,1);this.Kf=Math.pow(2,this.Ca[0])/((this.ia[1][0]-this.ia[1][0]+1)*(this.ia[1][1]-this.ia[1][1]+1));p.Id(this.Zo,this.Cw.bind(this),this.Bw.bind(this),
p.useCredentials?-1!=this.Oc.indexOf(this.c.Ya):!1,this.c.l.cc)};l.Cw=function(a){var b=0,c;c=""+String.fromCharCode(a.getUint8(b,!0));b+=1;c+=String.fromCharCode(a.getUint8(b,!0));b+=1;if("TM"==c){c=a.getUint16(b,!0);for(var b=b+2,d=0;d<c;d++){for(var e=a.getUint8(b,!0),b=b+1,f=[],g=0;g<e;g++){var k=a.getUint16(b,!0),b=b+2;(k=this.g[k])&&f.push(k)}1==f.length?this.Ka.push(this.c.He(f[0])):this.Ka.push(this.c.fj[f.join(";")])}}this.va=!0;Ic(this.c)};l.Bw=function(){};
l.gb=function(){return{metaUrl:this.Qc,mapping:this.Zo,lodRange:this.Ca,tileRange:this.ia}};l.$b=function(a,b){if(!a)return b;a=a.trim();return-1!=a.indexOf("://")?a:0==a.indexOf("//")?this.Jc+a:0==a.indexOf("/")?this.bd+a:this.Ya+a};
l.Cr=function(a){var b=a[0]-this.Ca[0],c=0>b;if(a[0]<this.Ca[0]){var b=-b,d=this.ia[0][0]>>b,e=this.ia[0][1]>>b,f=this.ia[1][0]>>b,b=this.ia[1][1]>>b;if(a[0]>this.Ca[1]||a[1]<d||a[1]>f||a[2]<e||a[2]>b)return[!1,!1]}else if(d=a[1]>>b,b=a[2]>>b,a[0]>this.Ca[1]||d<this.ia[0][0]||d>this.ia[1][0]||b<this.ia[0][1]||b>this.ia[1][1])return[!1,!1];return[!0,c]};l.He=function(a){return this.Ka[a-1]};l.cl=function(a,b){return Sc(this.c,this.Qc,{ua:a[0],Fb:a[1],Gb:a[2]},null,b)};
function Ce(a,b,c){this.c=a;this.g=c;this.Fa=b;this.yi=a.yi;this.Dp=!1;this.De=0;this.Qa=this.iy=this.Tb=1;this.Hc=this.se=this.Xa=this.H=this.Bq=this.pg=this.F=null;this.Cb=[];this.Ua=null;this.Wd=!1;this.pc=[];this.Jg=!1;this.vd={};this.ob={};this.xb={};this.bk=!0;this.ub=null;this.ra=[[],[],[]];this.hc={};this.fg={};this.uf={};a=this.c.lm.ac;for(b=c[0];0<b;b--){var d=1<<b-1,e=0;0!=(c[1]&d)&&(e+=1);0!=(c[2]&d)&&(e+=2);a.la[e]||a.jk(e);a=a.la[e]}this.Wc=a;this.Zb=Uc(this.c.lm,c,5,!0);Uc(this.c.lm,
c,8,!0);this.la=[null,null,null,null]}l=Ce.prototype;l.I=function(){for(var a=0;4>a;a++)null!=this.la[a]&&this.la[a].I();this.Xa=this.H=this.F=this.Zb=this.Wc=null;this.Cb=[];this.Ua=this.Hc=this.se=null;this.vd={};this.ob={};this.xb={};this.bk=!0;this.Wd=!1;this.pc=[];this.Dp=!1;this.ub=this.xc=this.Le=this.sf=null;this.ra=[[],[],[]];this.hc={};this.fg={};this.uf={};this.la=[null,null,null,null];a=this.Fa;this.Fa=null;null!=a&&a.removeChild(this)};
l.It=function(){null!=this.Zb&&Yc(this.Zb,this.H,null,this)};function De(a){a.Le&&(a.Xa=a.Le.Xa,a.Cb=a.Le.Cb,a.xb=a.Le.xb,a.se=a.Le.se,a.Hc=a.Le.Hc,a.Ua=a.Le.Ua,a.sf=null,a.Le=null)}l.jk=function(a){if(!this.la[a]){var b=this.g,b=[b[0]+1,b[1]<<1,b[2]<<1];switch(a){case 1:b[1]++;break;case 2:b[2]++;break;case 3:b[1]++,b[2]++}this.la[a]=new Ce(this.c,this,b)}};l.Ns=function(a){null!=this.la[a]&&(this.la[a].I(),this.la[a]=null)};
l.removeChild=function(a){for(var b=0;4>b;b++)this.la[b]==a&&(this.la[b].I(),this.la[b]=null)};
function Ee(a,b,c,d){if(a.c.yi!=a.ue){a.sf=a.H;a.Le={Xa:a.Xa,Cb:a.Cb,xb:a.xb,se:a.se,Hc:a.Hc,Ua:a.Ua};a.xc=0<a.ra[0].length?{ra:a.ra,hc:a.hc,uf:a.uf}:null;a.Dp=!1;a.pg=a.F;for(var e in a.vd)a.vd[e]={Qd:[],nb:[],Cm:!1,ue:0};a.ob={};a.xb={};a.bk=!0;a.H=null;a.Xa=null;a.Cb=[];a.se=null;a.Hc=null;a.Ua=null;a.Wd=!1;a.pc=[];a.ra=[[],[],[]];a.hc={};a.fg={};a.uf={};a.ue=a.c.yi;z(a.c);a.xc&&(a.xc=a.xc)}if(!d){if(a.gk||null==a.H&&0==a.pc.length)a:if(a.H=null,a.Wd=!1,a.pc=[],a.gk=!1,b.Sk)a.H=b.Sk;else{b=b.Vg;
d=0;for(e=b.length;d<e;d++){var f=b[d][0],g=b[d][1];if(1==f.Cr(a.g)[0]){if(0<a.g[0]){var k=a.Fa;if(k){if(k.gk){a.gk=!0;a.pc=[];break a}var h=Yc(k.Zb,f,null,a);if(h){if(!h.ha(c)){a.gk=!0;continue}if(k=h.cj(k.g)){if(h=a.g,0==(k.X&1<<(h[2]-(k.g[2]<<1)<<1)+(h[1]-(k.g[1]<<1))+4))continue}else continue}else continue}}a.pc.push([f,g])}}1<a.pc.length?a.Wd=!0:a.H=a.pc[0]?a.pc[0][0]:null}if(null==a.F||a.pg){if(!(b=a.gk)){a:{if(a.Wd){b=a.pc;e=d=0;for(f=b.length;e<f;e++)1==Yc(a.Zb,b[e][0],!0,a).ha(c)&&d++;if(d==
f){b=a.pc;d=null;e=0;for(f=b.length;e<f;e++)if(g=b[e][0],h=b[e][1],k=Yc(a.Zb,g,null,a),1==k.ha(c)&&(k=k.cj(a.g),null!=k&&h==k.Ci)){if(!h&&g.gg&&0==(k.X&1)&&0<k.tl){for(var h=k.tl-1,h=a.c.He(g.g[h]).rq,m=!1,n=e;n<f;n++)if(b[n].rq<=h){m=n>e;e=n-1;break}if(m)continue}if(0!=(k.X&1)){d=k.clone();a.H=g;break}}e=0;for(f=b.length;e<f;e++)g=b[e][0],k=Yc(a.Zb,g,null,a),1==k.ha(c)&&(k=k.cj(a.g),null!=k&&(d?(d.X|=k.X&240,d.A.W[0]=Math.min(d.A.W[0],k.A.W[0]),d.A.W[1]=Math.min(d.A.W[1],k.A.W[1]),d.A.W[2]=Math.min(d.A.W[2],
k.A.W[2]),d.A.xa[0]=Math.max(d.A.xa[0],k.A.xa[0]),d.A.xa[1]=Math.max(d.A.xa[1],k.A.xa[1]),d.A.xa[2]=Math.max(d.A.xa[2],k.A.xa[2])):(d=k.clone(),a.H=g)));d&&ae(d,!0);a.F=d;a.pg=null;z(a.c)}else{c=!1;break a}}b=a.H;if(null==b)c=!1;else if(b=Yc(a.Zb,b,!0,a),1==b.ha(c)){a.Wd||(a.F=b.cj(a.g),a.pg=null,z(a.c));if(null!=a.F)for(a.F.S=a,a.pg=null,z(a.c),c=0;4>c;c++)0!=(a.F.X&1<<c+4)==1?a.jk(c):a.Ns(c);c=!0}else c=!1}b=c||null!=a.F&&a.pg}if(!b)return;a.pg&&(processFlag2_=!0)}}if(null==a.F)return!1;a.F.Sc.mq();
a.sf&&a.sf==a.H&&(a.sf=null,De(a));a.H&&(a.H.Wd?(a.Ua=a.H.He(a.F.et),a.Ua||(a.Ua=a.H)):a.Ua=a.H);return!0}
l.Zd=function(a,b,c,d){var e=this.c;if(!e.f.Ro&&e.Wk&&d){var f=d.de,g=e.ka,f=[f[0]-g[0],f[1]-g[1],f[2]-g[2]];p.D.normalize(f);if(p.D.Db(f,d.Ri)>d.Fk)return!1}if(!e.Wk||!e.f.Aj||4>a[0])d=e.P.Zd(b,c);else a:{a=e.P;d=d.Di;a.Ea&&a.update();b=a.yq;if(c){var e=c[0],f=c[1],k=c[2];c=d[0];g=b[0];g[0]=c[0]-e;g[1]=c[1]-f;g[2]=c[2]-k;c=d[1];g=b[1];g[0]=c[0]-e;g[1]=c[1]-f;g[2]=c[2]-k;c=d[2];g=b[2];g[0]=c[0]-e;g[1]=c[1]-f;g[2]=c[2]-k;c=d[3];g=b[3];g[0]=c[0]-e;g[1]=c[1]-f;g[2]=c[2]-k;c=d[4];g=b[4];g[0]=c[0]-e;g[1]=
c[1]-f;g[2]=c[2]-k;c=d[5];g=b[5];g[0]=c[0]-e;g[1]=c[1]-f;g[2]=c[2]-k;c=d[6];g=b[6];g[0]=c[0]-e;g[1]=c[1]-f;g[2]=c[2]-k;c=d[7];g=b[7];g[0]=c[0]-e;g[1]=c[1]-f;g[2]=c[2]-k;d=b}c=p.xi.$q;a=a.Bd;for(b=0;6>b;b++){e=!0;for(f=0;8>f;f++)if(0<=c(a[b],d[f])){e=!1;break}if(e){d=!1;break a}}d=!0}return d};
function Fe(a,b,c,d){var e=b.W,f=b.xa;b=[e[0]-d[0],e[1]-d[1]];var g=[f[0]-d[0],e[1]-d[1]],k=[f[0]-d[0],f[1]-d[1]],h=[e[0]-d[0],f[1]-d[1]],m=e[2]-d[2],n=f[2]-d[2];if(!a.c.f.Ol&&d[0]>e[0]&&d[0]<f[0]&&d[1]>e[1]&&d[1]<f[1]&&d[2]>e[2]&&d[2]<f[2])return[Number.POSITIVE_INFINITY,.1];a=a.c.P;a=0<b[1]?0<b[0]?0>n?Sb(a,[b[0],b[1],n]):0<m?Sb(a,[b[0],b[1],m]):Sb(a,[b[0],b[1],.5*(m+n)]):0>g[0]?0>n?Sb(a,[g[0],g[1],n]):0<m?Sb(a,[g[0],g[1],m]):Sb(a,[g[0],g[1],.5*(m+n)]):0>n?Sb(a,[.5*(b[0]+g[0]),g[1],n]):0<m?Sb(a,
[.5*(b[0]+g[0]),g[1],m]):Sb(a,[.5*(b[0]+g[0]),g[1],.5*(m+n)]):0>h[1]?0<h[0]?0>n?Sb(a,[h[0],h[1],n]):0<m?Sb(a,[h[0],h[1],m]):Sb(a,[h[0],h[1],.5*(m+n)]):0>k[0]?0>n?Sb(a,[k[0],k[1],n]):0<m?Sb(a,[k[0],k[1],m]):Sb(a,[k[0],k[1],.5*(m+n)]):0>n?Sb(a,[.5*(h[0]+k[0]),k[1],n]):0<m?Sb(a,[.5*(h[0]+k[0]),k[1],m]):Sb(a,[.5*(h[0]+k[0]),k[1],.5*(m+n)]):0<h[0]?0>n?Sb(a,[b[0],.5*(g[1]+k[1]),n]):0<m?Sb(a,[b[0],.5*(g[1]+k[1]),m]):Sb(a,[b[0],.5*(g[1]+k[1]),.5*(m+n)]):0>k[0]?0>n?Sb(a,[g[0],.5*(g[1]+k[1]),n]):0<m?Sb(a,[g[0],
.5*(g[1]+k[1]),m]):Sb(a,[g[0],.5*(g[1]+k[1]),.5*(m+n)]):0>n?Sb(a,[.5*(b[1]+g[1]),.5*(g[1]+k[1]),n]):0<m?Sb(a,[.5*(b[1]+g[1]),.5*(g[1]+k[1]),m]):Sb(a,[.5*(b[1]+g[1]),.5*(g[1]+k[1]),.5*(m+n)]);return[a[0]*c,a[1]]}function Ge(a,b,c){var d=1*a.c.$t-b.Gk;if(0>d)return[Number.POSITIVE_INFINITY,.1];var e=p.D.Db(a.c.au,b.Ri);e<b.ph&&(e=Math.acos(e),e-=Math.acos(b.ph),b=Math.tan(e)*b.Gk,d=Math.sqrt(b*b+d*d));a=a.c.P;b=d;a.Ea&&a.update();a=b<a.Wh?Number.POSITIVE_INFINITY:a.Df[0]/b;return[a*c,d]}
function He(a){var b,c=a.c,d=c.Yj,e=a.F,f=c.ka,g=c.Wk&&c.f.Bj;0!=(e.X&1)?(b=Number.POSITIVE_INFINITY,0!=(e.X&4)?b=c.Pe*e.ai:0!=(e.X&8)&&(b=e.A.Dj/e.Tf*c.Pe),1==c.P.np?(e=c.P.qq,b=[2*b/e,e]):0!=(e.X&8)?g?(b=e.A.Dj/256*c.Pe*(256/e.Tf),b=Ge(a,e,b)):(b=e.A.Dj/256*c.Pe,d=e.Tf/256*c.Vb,c=c.$d,f=[f[0]-c[0]*d,f[1]-c[1]*d,f[2]-c[2]*d],b=Fe(a,e.A,b,f)):!g&&1.1<d?(b=d/1.1*e.ai*c.Pe,d=d/1.1*c.Vb,c=c.$d,f=[f[0]-c[0]*d,f[1]-c[1]*d,f[2]-c[2]*d],b=Fe(a,e.A,b,f)):b=g?Ge(a,e,b):Fe(a,e.A,b,f)):(b=g?Ge(a,e,1):Fe(a,e.A,
1,f),b[0]=Number.POSITIVE_INFINITY);a.Tb=b[0];a.Qa=b[1]}
function Cd(a,b,c,d){if(!(a.Tb==Number.POSITIVE_INFINITY||4.4<a.Tb)||!a.F||0==(a.F.X&240)){var e=a.c.f.Zv,f=a.c;if(c){var g=c[0],k=c[1][0];c=c[1][1]}else{var h=Sd(f,a.g),g=h[0],k=h[1][0];c=h[1][1]}var m=[.5*(c[0]+k[0]),.5*(c[1]+k[1])],n=f.Ib.lv;d=d||a.F.ph;if(n&&!g.uo&&Math.acos(d)>.1*Math.PI)d=Math.cos(.5*Math.acos(d)),Cd(a,b,[g,[[k[0],k[1]],[m[0],m[1]]]],d),Cd(a,b,[g,[[m[0],k[1]],[c[0],m[1]]]],d),Cd(a,b,[g,[[k[0],m[1]],[m[0],c[1]]]],d),Cd(a,b,[g,[[m[0],m[1]],[c[0],c[1]]]],d);else{h=Math.log(5*(g.da.na[1]-
g.da.ja[1])/a.Qa)/f.Tv;h=Math.max(0,h-8+g.g[0]);d=[[c[0],c[1]],[c[0],k[1]],[k[0],k[1]],[k[0],c[1]],[m[0],c[1]],[m[0],k[1]],[k[0],m[1]],[c[0],m[1]]];if(e){if(!a.F)return;var e=a.F.ne,q=[[e],[e],[e],[e],[e],[e],[e],[e]];m[2]=e;m=be(g,m,!0)}else h=f.vc(null,h,null,g,m,d),m[2]=h[0],m=be(g,m,!0),(q=h[5])||(q=[[0],[0],[0],[0],[0],[0],[0],[0]]);var e=f.m,h=f.Sw,y=Mb(e.P),w=Lb(e.P),t=b[0],v=b[1];b=b[2];d[0][2]=q[0][0];var D=be(g,d[0],!0);d[1][2]=q[1][0];var B=be(g,d[1],!0);d[2][2]=q[2][0];var x=be(g,d[2],
!0);d[3][2]=q[3][0];var H=be(g,d[3],!0);d[4][2]=q[4][0];var u=be(g,d[4],!0);d[5][2]=q[5][0];var L=be(g,d[5],!0);d[6][2]=q[6][0];var r=be(g,d[6],!0);d[7][2]=q[7][0];d=be(g,d[7],!0);h[0]=H[0]-t;h[1]=H[1]-v;h[2]=H[2]-b;h[3]=u[0]-t;h[4]=u[1]-v;h[5]=u[2]-b;h[6]=D[0]-t;h[7]=D[1]-v;h[8]=D[2]-b;h[9]=r[0]-t;h[10]=r[1]-v;h[11]=r[2]-b;h[12]=m[0]-t;h[13]=m[1]-v;h[14]=m[2]-b;h[15]=d[0]-t;h[16]=d[1]-v;h[17]=d[2]-b;h[18]=x[0]-t;h[19]=x[1]-v;h[20]=x[2]-b;h[21]=L[0]-t;h[22]=L[1]-v;h[23]=L[2]-b;h[24]=B[0]-t;h[25]=
B[1]-v;h[26]=B[2]-b;!n||f.vp||1!=g.g[0]||g.uo||(m=be(g,[g.da.na[0],g.da.na[1],0]),f.vp=Math.sqrt(m[0]*m[0]+m[1]*m[1]),f.ax=8*Math.pow(2,552058/f.vp));m=1;n&&g.uo?(m=f.ax,n=e.kx,e.j.useProgram(n,["aPosition","aTexCoord"]),mb(n,"uParams4",[-t,-v,f.vp,0])):(n=e.lx,e.j.useProgram(n,["aPosition","aTexCoord"]));ra(n,"uMV",y);ra(n,"uProj",w);Bb(n,"uPoints",h);f=g.Br*m;w=1/(c[0]-k[0]);y=1/(k[1]-c[1]);d=f/((g.da.na[0]-g.da.ja[0])*w);h=f/((g.da.na[1]-g.da.ja[1])*y);k=(k[0]-g.da.ja[0])*w*d;c=(c[1]-g.da.ja[1])*
y*h;mb(n,"uParams",[f*m,a.c.Zf,1/15,g.kv*m]);mb(n,"uParams3",[c-Math.floor(c),k-Math.floor(k),h,d]);mb(n,"uParams2",[0,0,g.jv,0]);e.j.bindTexture(e.kj);e.Vw.jb(n,"aPosition","aTexCoord")}}}function tc(a,b,c){this.c=a;this.P=a.P;this.Ox=[0,0,0];this.Sk=c;this.Yl=this.c.Ib.Zh.Yl;this.rf=!1;this.Wg=new Ce(this.c,null,this.Ox);this.Vg=[];this.xm=[];this.f=this.c.f;this.Ei=[0,0,0];this.Pe=1;this.xd=0}l=tc.prototype;l.I=function(){this.Wg=null};
l.Eb=function(){var a=Sc(this.c,surface.Qc,{ua:result_[0],Fb:result_[1],Gb:result_[2]});map_.Pc.load(a,metatile_.lz.bind(metatile_,a));this.pz.load();this.Wg.Sc=1;this.rf=!0};function Qd(a,b){for(var c=a.Wg,d=b[0];0<d;d--){var e=1<<d-1,f=0;0!=(b[1]&e)&&(f+=1);0!=(b[2]&e)&&(f+=2);c=c.la[f];if(!c)return null}return c}
l.jb=function(){this.Ei=[0,0,0];this.Pe=this.c.Pe;var a=this.c.Ib.Cc.Bg.Pw;if(null!=a)Ie(this),"X"==a.R&&(Ie(this),Ie(this));else switch(this.Sk&&this.Sk.fb?this.c.f.So:this.c.f.Nl){case "topdown":Ie(this);break;case "fit":this.xd++;var b=this.Wg;if(Ee(b,this,0)){var a=this.c,c=b.F,d=a.ka;if(b.Zd(b.g,c.A,d,c)){He(b);var e=b.H.Uk,e=!b.H.fb&&!e&&a.f.Qh,f=a.ln,g=a.yp,k=a.xp,h=0,m;g[0]=[b,0];var b=1,n=a.Yj,q=a.w.Tg||a.w.Sg,y=a.w.yf;a.tc++;var w=1,t=1,v=1,D=a.tc,B=a.f.$v;do{var x=0;m=0;for(var H=b-1;0<=
H;H--)if(c=g[H],b=c[0],depth_=c[1],depth_>=B)e&&(f[h]=[b,!0],h++);else{if(c=b.F)t++,c.Sc.tc!=D&&(c.Sc.tc=D,v++);if(b.Zd(b.g,c.A,d,c)){w++;b.Tb!=Number.POSITIVE_INFINITY&&b.Tb>x&&(x=b.Tb);q&&y.push(b);var u=m,L=h;if(0!=(c.X&240)==0||b.Tb<=n){var r=2E3*(b.g[0]+4)*b.Qa;if(0==(c.X&240)||ud(a,b,b.F,d,r,!0,0<depth_,!0))f[h]=[b,!1],h++;else for(depth_++,c=0;4>c;c++){var A=b.la[c];A&&Ee(A,this,A.g[0],!0)&&(Je(A,A.F),He(A),r=2E3*(A.g[0]+4)*A.Qa,ud(a,A,A.F,d,r,!0,0<depth_,!0)?(f[h]=[A,!1],h++):(k[m]=[A,depth_],
m++))}}else if(0==depth_&&0!=(c.X&1)&&b.Tb<=2*n){for(var O=0,fa=0,C=[],c=0;4>c;c++)if(A=b.la[c])O++,Ee(A,this,A.g[0])&&(Je(A,A.F),He(A),r=2E3*(A.g[0]+4)*A.Qa,ud(a,A,A.F,d,r,!0,!0,!0)&&(fa++,C.push(A)));if(0<O&&O==fa){do for(A=!0,c=0,r=C.length-1;c<r;c++)C[c].Qa>C[c+1].Qa&&(A=C[c],C[c]=C[c+1],C[c+1]=A,A=!1);while(!A);c=0;for(r=C.length;c<r;c++)k[m]=[C[c],depth_],m++}else if(r=2E3*(b.g[0]+4)*b.Qa,ud(a,b,b.F,d,r,!0,!0,!0))for(f[h]=[b,!1],h++,c=0;4>c;c++)(A=b.la[c])&&Ee(A,this,A.g[0])&&(r=2E3*(A.g[0]+
4)*A.Qa,ud(a,A,A.F,d,r,!0,!1,!0));else for(c=0;4>c;c++)(A=b.la[c])&&Ee(A,this,A.g[0])&&(Je(A,A.F),He(A),k[m]=[A,depth_],m++)}else for(c=0;4>c;c++)(A=b.la[c])&&Ee(A,this,A.g[0])&&(Je(A,A.F),He(A),k[m]=[A,depth_],m++)}e&&u==m&&L==h&&(f[h]=[b,!0],h++)}b=g;g=k;k=b;b=m}while(0<b);a.o.ck=w;a.o.Lj=t;a.o.Kj=v;if(this.c.w.wi||this.c.w.vi)for(this.c.nc[0]||(this.c.nc[0]=[]),u=this.c.nc[0],H=h-1;0<=H;H--)u.push(f[H]);for(H=h-1;0<=H;H--)u=f[H],b=u[0],e&&u[1]?Cd(b,d):u[1]||ud(a,b,b.F,d,0,!1,!1,!0)}}break;case "fitonly":if(this.xd++,
B=this.Wg,Ee(B,this,0)&&(a=this.c,v=B.F,d=a.ka,B.Zd(B.g,v.A,d,v))){He(B);e=a.ln;u=a.yp;L=a.xp;f=0;u[0]=B;t=1;b=a.Yj;g=a.w.Tg||a.w.Sg;k=a.w.yf;a.tc++;q=n=m=1;y=a.tc;do{h=w=0;for(--t;0<=t;t--){B=u[t];if(v=B.F)n++,v.Sc.tc!=y&&(v.Sc.tc=y,q++);if(B.Zd(B.g,v.A,d,v))if(m++,g&&k.push(B),B.Tb!=Number.POSITIVE_INFINITY&&B.Tb>w&&(w=B.Tb),B.Tb<=b)e[f]=B,f++;else{H=0;v=[];for(D=0;4>D;D++)if(x=B.la[D])H++,Ee(x,this,x.g[0])&&(Je(x,x.F),He(x),v.push(x));if(0<H){do for(H=!0,D=0,B=v.length-1;D<B;D++)v[D].Qa>v[D+1].Qa&&
(H=v[D],v[D]=v[D+1],v[D+1]=H,H=!1);while(!H);D=0;for(B=v.length;D<B;D++)L[h]=v[D],h++}else e[f]=B,f++}}w=u;u=L;L=w;t=h}while(0<t);a.o.ck=m;a.o.Lj=n;a.o.Kj=q;if(this.c.w.wi||this.c.w.vi)for(this.c.nc[0]||(this.c.nc[0]=[]),u=this.c.nc[0],t=f-1;0<=t;t--)u.push(e[t]);for(t=f-1;0<=t;t--)B=e[t],ud(a,B,B.F,d,0,!1,!1)}}};function Je(a,b){if(!b.jj){for(var c=a.Fa;c;){var d=c.F;if(0!=(d.X&2)){b.ne=d.ne;b.kb=d.kb;ae(b);break}c=c.Fa}b.jj=!0}}
function Ie(a){a.xd++;var b=a.Wg;if(Ee(b,a,0)){var c=a.c,d=b.F,e=c.ka;if(b.Zd(b.g,d.A,e,d)){He(b);var f=c.ln,g=c.yp,k=c.xp,h=0,m,n;g[0]=b;m=1;var q=c.Yj,y=0,w=c.w.Tg||c.w.Sg,t=c.w.yf;c.tc++;var v=1,D=1,B=1,x=c.tc;do{var H=0;n=0;for(--m;0<=m;m--){b=g[m];if(d=b.F)v++,d.Sc.tc!=x&&(d.Sc.tc=x,D++);if(b.Zd(b.g,d.A,e,d))if(B++,b.Tb!=Number.POSITIVE_INFINITY&&b.Tb>H&&(H=b.Tb),w&&t.push(b),b.Tb<=q)f[h]=b,h++;else{for(var u=0,L=0,d=[],r=0;4>r;r++){var A=b.la[r];if(A&&(u++,Ee(A,a,A.g[0]))){Je(A,A.F);He(A);var O=
1*A.g[0]*A.Qa;b.H&&0!=(A.F.X&1)?ud(c,A,A.F,e,O,!0,!1)&&(L++,d.push(A)):(L++,d.push(A))}}if(0<u&&u==L&&0!=u){do for(u=!0,r=0,b=d.length-1;r<b;r++)d[r].Qa>d[r+1].Qa&&(u=d[r],d[r]=d[r+1],d[r+1]=u,u=!1);while(!u);r=0;for(b=d.length;r<b;r++)k[n]=d[r],n++}else f[h]=b,h++}}m=g;g=k;k=m;m=n;0!=H&&(y=H)}while(0<m);y>a.c.pk&&(a.c.pk=y);c.o.ck=B;c.o.Lj=v;c.o.Kj=D;if(a.c.w.wi||a.c.w.vi)for(a.c.nc[0]||(a.c.nc[0]=[]),a=a.c.nc[0],m=h-1;0<=m;m--)a.push(f[m]);for(m=h-1;0<=m;m--)b=f[m],ud(c,b,b.F,e,0,!1,!1)}}}
function Pd(a,b,c,d){if(b){a.Zh=c;c=d?a.By:a.Ay;if(1==b.g[0]&&(Ke(a,b.Fa,!0),!b.Fa.F))return;Ke(a,b,!1,c)}}function Ke(a,b,c,d){if(null!=b&&Ee(b,a,0)&&!c&&(b.F.Sc.mq(),b.sf&&b.sf==b.H&&(b.sf=null,De(b)),1==d(b,a.Zh,0))){var e=a.Zh;c=e.Pq;var e=e.da,f=[.5*(e.ja[0]+e.na[0]),.5*(e.ja[1]+e.na[1])],g=c[0]>=f[0];c=c[1]>=f[1];g?e.ja[0]=f[0]:e.na[0]=f[0];c?e.ja[1]=f[1]:e.na[1]=f[1];Ke(a,b.la[g?c?1:3:c?0:2],!1,d)}}
l.Ay=function(a,b){if(!a||a.g[0]>b.Qi&&b.ub)return!1;var c=a.F;if(!c)return!1;if(0!=(c.X&2))if(!a.ub){if(!a.H||a.H.Wd)return!1;c=Dd(a.Ua,a.g);a.ub=Vc(a.Wc,c,!0)}else{if(1==a.ub.ha())return b.Fa={F:b.F,ub:b.ub,ij:b.ij},b.F=c,b.ub=a.ub,b.ij={ja:b.da.ja.slice(),na:b.da.na.slice()},a.g[0]!=b.Qi}else return b.ub||(b.F=c),!0;return!1};l.By=function(a,b){if(!a||a.g[0]>b.Qi)return!1;var c=a.F;if(!c)return!1;b.Fa={F:b.F};b.F=c;return a.g[0]!=b.Qi};
Wb.prototype.quad=function(a,b,c){var d="";for(i=a;0<i;i--){a=0;var e=1<<i-1;0!=(b&e)&&(a+=1);0!=(c&e)&&(a+=2);d+=a}return d};Wb.prototype.msDigit=function(a,b){return((a&3)<<1)+(b&1)};function Le(a){for(a=a.toString(16);8>a.length;)a="0"+a;return a}Wb.prototype.ppx=function(a,b){return Le(b<<28-a)};Wb.prototype.ppy=function(a,b){return Le(268435456-(b+1<<28-a))};
Wb.prototype.dx=function(a,b,c){if("string"==typeof c)if(-1!=c.indexOf("quad")){b="(function(lod,x,y,loclod,locx,locy){"+c.replace("quad","return this.quad")+"})";try{var d=eval(b).bind(this);return d(a.ua,a.Fb,a.Gb,a.Jl,a.Mo,a.No)}catch(e){return c}}else if(-1!=c.indexOf("ms_digit")){b="(function(x,y,loclod,locx,locy){"+c.replace("ms_digit","return this.msDigit")+"})";try{return d=eval(b).bind(this),d(a.Fb,a.Gb,a.Jl,a.Mo,a.No)}catch(e){return c}}else{if(-1!=c.indexOf("alt"))return(a=/\(([^)]*)\)/.exec(c))&&
a[1]&&(a=a[1].match(/([^,]+)/g),0<a.length)?a[b%a.length]:c;if(-1!=c.indexOf("ppx")){b="(function(lod,x,loclod,locx){"+c.replace("ppx","return this.ppx")+"})";try{return d=eval(b).bind(this),d(a.ua,a.Fb,a.Jl,a.Mo)}catch(e){return c}}else if(-1!=c.indexOf("ppy")){b="(function(lod,y,loclod,locy){"+c.replace("ppy","return this.ppy")+"})";try{return d=eval(b).bind(this),d(a.ua,a.Gb,a.Jl,a.No)}catch(e){return c}}else return c}else return c};
function Sc(a,b,c,d,e){var f=e=0,g=0;if(c.ua){var k=[c.ua,c.Fb,c.Gb],h=a.Ib.Ae.Na;e=[];g=0;for(f=h.length;g<f;g++){var m=h[g],n=k[0]-m.g[0];ix_=k[1]>>n;iy_=k[2]>>n;ix_==m.g[1]&&iy_==m.g[2]&&e.push(m)}k=null;g=0;for(f=e.length;g<f;g++)-1<e[g].g[0]&&(k=e[g]);g=c.ua-(k?k.g.slice():[0,0,0])[0];f=(1<<g)-1;e=c.Fb&f;f&=c.Gb}k={ua:c.ua,Fb:c.Fb,Gb:c.Gb,Jl:g,Mo:e,No:f};b=b.replace(/ /g,"");b=p.Ux(b,{lod:c.ua,x:c.Fb,y:c.Gb,sub:d,locx:e,locy:f,loclod:g,geonavtile:d,here_app_id:"abcde",here_app_code:"12345"},
a.dx.bind(a,k,a.Gt));a.Gt++;return(e=-1!=b.indexOf("//"))?0==b.indexOf("//")?a.Jc+b:b:a.Ya+b}function ec(a,b){this.parse(b)}ec.prototype.parse=function(a){this.Wq=a.description||"";this.fa=a.freeLayers||{};this.Ka={};if(a.surfaces)if(a=a.surfaces,Array.isArray(a))for(var b=0,c=a.length;b<c;b++)this.Ka[a[b]]=[];else this.Ka=a;this.fa=!this.fa||Array.isArray(this.fa)?{}:JSON.parse(JSON.stringify(this.fa));this.Ka=JSON.parse(JSON.stringify(this.Ka))};
ec.prototype.gb=function(){return{description:JSON.parse(JSON.stringify(this.Wq)),surfaces:JSON.parse(JSON.stringify(this.Ka)),freeLayers:JSON.parse(JSON.stringify(this.fa))}};
function Me(a,b,c){this.N=!1;this.to();this.jh={};this.Fc(b);this.ba=a;this.Av=c;this.va=!1;this.rg=[];this.Jo=0;this.gq=this.eq=null;this.cc={};this.qj=null!=ia?new ia(this):null;this.xj=this.c=null;this.m=new Hb(this,this.ba,0,this.em.bind(this),this.f);this.Bx=new E(this.m);this.lc=window._mproj4_;p.Oa.Eb();this.sg(this.f.c);window.Rs(this.Cs.bind(this))}l=Me.prototype;l.em=function(){null!=this.c&&z(this.c)};
l.sg=function(a){null!=this.c&&this.df();if(null!=a){a=p.Ha.wr(a,window.location.href);this.fq=!0;this.Bt=this.Bm=this.Po=null;this.Ct=!1;this.At=!0;this.fs=!1;var b=function(){if((this.fq||this.At)&&this.Po&&!this.fs){this.fs=!0;var b=this.Po;this.pb("map-mapconfig-loaded",b);this.c=new Wb(this,b,a,this.f);this.xj=new S(this.c);this.Fc(this.c.Vm);this.Fc(this.jh);this.f.pa&&(this.c.setPosition(this.f.pa),this.f.pa=null);this.f.fk&&(this.c.Rd(this.f.fk),this.f.fk=null);this.pb("map-loaded",{browserOptions:this.c.Vm})}}.bind(this),
c=function(a){this.Po=a;b()}.bind(this),d=function(){}.bind(this),e=function(b){this.cc.token=b.token;this.cc.tokenHeader=b.header;this.Bm=1E3*b.expires;this.Bt=function(){this.Bm=null;this.Ct=!0;"string"===typeof this.f.Yd?p.Jd(this.f.Yd,e,f,null,p.useCredentials,this.cc):this.f.Yd(e)}.bind(this);this.Ct||k(a);"string"===typeof this.f.Yd?h(b.cookieInjector,this.f.Yd):h(b.cookieInjector,a)}.bind(this),f=function(){console.log("auth token not loaded");this.At&&k(a)}.bind(this),g=function(){document.body.removeChild(this.gq);
this.gq=null;this.fq=!0;b()}.bind(this),k=function(a){p.Jd(a,c,d,null,p.useCredentials,this.cc)}.bind(this),h=function(a,b){a=p.Ha.wr(a,b);this.eq=p.Ha.Tu(a);var c=document.createElement("iframe");this.gq=c;c.onload=g;c.src=a;c.style.display="none";document.body.appendChild(c)}.bind(this);this.f.Yd?(this.fq=!1,"string"===typeof this.f.Yd?p.Jd(this.f.Yd,e,f,null,p.useCredentials,this.cc):this.f.Yd(e)):k(a)}};l.oh=function(){this.N||(this.df(),this.m&&this.m.I(),this.ba=null,this.N=!0)};
l.df=function(){this.c&&(this.c.I(),this.xj=this.c=null,this.pb("map-unloaded",{}))};l.J=function(){return this.c};l.Dd=function(){return this.m};l.nf=function(){return this.Bx};l.Ge=function(){return this.lc};l.K=function(a,b){if(1!=this.N&&null!=b)return this.Jo++,this.rg.push({ew:a,uj:b,g:this.Jo}),function(a){this.removeListener(a)}.bind(this,this.Jo)};l.pb=function(a,b){for(var c=0;c<this.rg.length;c++)this.rg[c].ew==a&&this.rg[c].uj(b)};
l.removeListener=function(a){for(var b=0;b<this.rg.length;b++)if(this.rg[b].g==a){this.rg.splice(b,1);break}};p.qr=function(a){return(a?"Core: ":"")+"1.78"};p.Jq=function(){p.Oa.Eb();var a=document.createElement("canvas");if(null==a)return!1;a.width=1024;a.height=768;if(null==a.getContext)return!1;var b=null;try{b=a.getContext("webgl")||a.getContext("experimental-webgl")}catch(c){return!1}return b?!0:!1};
p.Hm=function(a,b){a="string"!==typeof a?a:document.getElementById(a);return p.Jq()?new Ne(a,b):null};function Ne(a,b){this.l=new Me(a,b,this);this.c=this.l.J()}l=Ne.prototype;l.oh=function(){this.l.oh();this.l=null};l.J=function(){return this.l?this.l.xj:null};l.sg=function(a){return this.l?this.l.sg(a):null};l.df=function(){return this.l?this.l.df():null};l.Dd=function(){return this.l?this.l.nf():null};l.Ge=function(){return this.l?this.l.Ge():null};
l.K=function(a,b){if(!this.l)return null;this.l.K(a,b)};l.pb=function(a,b){if(!this.l)return null;this.l.pb(a,b)};p.MapCore=p.Hm;p.mapCore=p.Hm;Ne.prototype.destroy=Ne.prototype.oh;Ne.prototype.loadMap=Ne.prototype.sg;Ne.prototype.destroyMap=Ne.prototype.df;Ne.prototype.getMap=Ne.prototype.J;Ne.prototype.getRenderer=Ne.prototype.Dd;Ne.prototype.on=Ne.prototype.K;Ne.prototype.callListener=Ne.prototype.pb;p.getCoreVersion=p.qr;p.checkSupport=p.Jq;l=Me.prototype;
l.to=function(){this.f={c:null,Kl:900,Ll:360,Pl:60,Yo:1.1,$v:2,Ol:0,wj:20,yj:2E4,Wo:!1,Vo:!0,zj:2,Oe:4,Uo:!1,Rl:!0,bs:!0,cs:!0,ds:!0,Ro:!1,Xo:!0,Ph:!0,To:!0,es:!1,Aj:!1,Bj:!1,Qh:!0,Zv:!0,gs:!0,md:3E3,ld:3,Nl:"fit",So:"fit",Cj:!1,Ql:!0,Oh:!0,Gp:!0,Fp:!1,Yd:null,hs:!1}};l.Fc=function(a){if("object"===typeof a&&null!==a)for(var b in a)this.mc(b,a[b])};
l.mc=function(a,b){if("pos"==a||"position"==a||"view"==a)this.J()?("view"==a?this.J().Rd(b):this.J().setPosition(new dc(this,b)),this.jh[a]&&delete this.jh[a]):this.jh[a]=b;else if("map"==a)this.f.c=p.Fm(b,null);else if("mapVirtualSurfaces"==a)this.f.Rl=p.ea(b,!0);else if("authorization"==a)this.f.Yd="string"===typeof b||"function"===typeof b?b:null;else{if(0==a.indexOf("map")||"mario"==a)this.jh[a]=b,null!=this.J()&&this.J().mc(a,b);if(0==a.indexOf("renderer"))switch(a){case "rendererAntialiasing":this.f.Gp=
p.ea(b,!0);break;case "rendererAllowScreenshots":this.f.Fp=p.ea(b,!1)}}};l.uc=function(a){if("map"==a)return this.f.c;if(0==a.indexOf("map")&&null!=this.J())return this.J().uc(a,value_);if(0==a.indexOf("renderer")){a:{switch(a){case "rendererAntialiasing":a=this.f.Gp;break a;case "rendererAllowScreenshots":a=this.f.Fp;break a}a=void 0}return a}};l.Cs=function(){this.N||(null!=this.c&&this.c.update(),this.pb("tick",{}),window.Rs(this.Cs.bind(this)))};p.C={};p.C.$x=0;p.C.tm=function(a){a.ks=a.ks||++p.C.$x;return a.ks};p.C.Zx=function(a){return a.trim().split(/\s+/)};p.C.ea=function(a,b){return"boolean"===typeof a?a:b};p.C.oc=function(a,b,c,d){return"number"===typeof a?p.dd(a,b,c):d};p.C.Jt=function(a,b,c){var d=[0,0,0];if(Array.isArray(a)&&3==a.length){for(c=0;3>c;c++)a[c]=p.dd(a[c],d[c],b[c]);return a}return c};
p.C.ml=function(a,b){if(void 0!==a.classList)return a.classList.contains(b);var c=p.C.aj(a);return 0<c.length&&(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(c)};p.C.Lm=function(a,b){if(void 0!==a.classList)for(var c=p.C.Zx(b),d=0,e=c.length;d<e;d++)a.classList.add(c[d]);else p.C.ml(a,b)||(c=p.C.aj(a),p.C.Rj(a,(c?c+" ":"")+b))};p.C.Cp=function(a,b){void 0!==a.classList?a.classList.remove(b):p.C.Rj(a,(" "+p.C.aj(a)+" ").replace(" "+b+" "," ").trim())};
p.C.Rj=function(a,b){void 0===a.className.Tm?a.className=b:a.className.Tm=b};p.C.aj=function(a){return void 0===a.className.Tm?a.className:a.className.Tm};p.C.preventDefault=function(a){a=a instanceof Oe?a.Aa:a;a.preventDefault?a.preventDefault():a.returnValue=!1};p.C.stopPropagation=function(a){a=a instanceof Oe?a.Aa:a;a.stopPropagation()};p.C.pu=function(){window.addEventListener("selectstart",p.C.preventDefault)};p.C.Cu=function(){window.removeEventListener("selectstart",p.C.preventDefault)};
p.C.ou=function(){window.addEventListener("dragstart",p.C.preventDefault)};p.C.Bu=function(){window.removeEventListener("dragstart",p.C.preventDefault)};p.C.nu=function(a){a.addEventListener("contextmenu",p.C.preventDefault)};p.C.$y=function(a){a.removeEventListener("contextmenu",p.C.preventDefault)};p.C.av=function(){for(var a=["transform","WebkitTransform","OTransform","MozTransform","msTransform"],b=document.documentElement.style,c=0,d=a.length;c<d;c++)if(a[c]in b)return a[c];return!1};
p.C.Jm=p.C.av();function Pe(a,b){this.Lg=this.Km=this.Za=null;this.kb=0;this.Zp=[];this.Fu=20;this.Xg=60;this.ad=0;this.Ul=1;this.Mm=600;this.Mi="right";this.B=a;this.g=[];this.Oi=null;this.vb="undefined"!==typeof b.presenter?JSON.parse(JSON.stringify(b.presenter)):{};this.wp=b.presenterAutoplay;"undefined"!==typeof this.vb&&this.Es()}l=Pe.prototype;l.Pt=function(a,b){0!==Object.keys(this.vb).length?this.vb[a]=b:"undefined"!==typeof a&&(this.vb={},this.vb[a]=b)};
l.yx=function(a){if("undefined"!==typeof a)return this.Zk()==a&&(this.um(),this.Oi=null),delete this.vb[a],"Removed presentation id: "+a;null!==this.Zk()&&this.um();this.vb={};this.wp="";this.Oi=null;return"All presentations removed."};l.Zk=function(){return this.Oi};l.Ru=function(){return this.Mi};
l.Es=function(a){this.um();if(void 0!==this.wp&&"undefined"===typeof a)a=this.wp;else if("undefined"===typeof a&&void 0!==this.vb&&0<Object.keys(this.vb).length)for(var b in this.vb){a=b;break}return"undefined"!==typeof a&&-1!=Object.keys(this.vb).indexOf(a)?(this.Oi=a,Qe(this,a),!0):!1};l.um=function(){var a=this.Zk();this.Mi="right";return null!==a?(this.Oi=null,this.B.G.Pj(a),this.Za.getElementsByTagName("article")[0].parentNode.parentNode.parentNode.remove(),!0):!1};
l.Rv=function(a){if(0===Object.keys(this.vb).length)return[];if("undefined"!==typeof a)return"undefined"!==this.vb[a]?this.vb[a]:null;a=[];for(var b in this.vb)a.push(b);return a};Pe.prototype.addPresentation=Pe.prototype.Pt;Pe.prototype.removePresentation=Pe.prototype.yx;Pe.prototype.getCurrentPresentation=Pe.prototype.Zk;Pe.prototype.getCurrentPresentationType=Pe.prototype.Ru;Pe.prototype.playPresentation=Pe.prototype.Es;Pe.prototype.stopPresentation=Pe.prototype.um;
Pe.prototype.listPresentations=Pe.prototype.Rv;
Pe.prototype.Eb=function(a,b){var c=this,d=this.B.G.Ub(a,"<div class='melown-presenter panelContainer'><div class='melown-presenter swipeControl top'></div><div class='melown-presenter toolboxContainer'>"+b+"</div><div class='melown-presenter swipeControl'></div></div>"+("<div class='melown-presenter subtitlesContainer'><button type='button'></button><button type='button'></button><div class='melown-presenter swipeSubtitles'><div><div></div></div></div><div class='melown-presenter swipeSubtitles'><div><div></div></div></div><div class='melown-presenter innerContainer'>"+b+
"</div></div>"));this.g.push(a);this.Za=d.ba;this.Km=this.Za.getElementsByTagName("a");for(d=0;d<this.Km.length;d++)this.Km[d].onclick=function(){Re(c,this)};setTimeout(function(){Se(this)}.bind(this),200)};
function Qe(a,b){var c={le:a.vb[b],id:b,bu:function(){var a=/(\.\.\/|\.\/)/g;if(/(<article)/g.test(this.le))return"string";if(/^(ftp|http|https):\/\/[^ "]+$/.test(this.le))return"url";if(/.*\/+.*/.test(this.le)){for(var b,c=0,d="",e=window.location.href.split("/"),n="";null!==(b=a.exec(this.le));){d+=b[0];if("./"===b[0])break;c++}c++;for(a=0;a<e.length-c;a++)n=n+e[a]+"/";n+=this.le.split(d)[1];console.log("Final path:");console.log(n);this.le=n;return"url"}return/^#.*$/.test(this.le)?"hash":"string"}},
d=c.bu();if("url"==d){var e=new XMLHttpRequest;e.open("GET",c.le,!1);e.onreadystatechange=function(){4===e.readyState&&(200===e.status||0==e.status?(this.tv=e.responseText,this.Eb(c.id,this.tv)):this.file="undefined")}.bind(a);e.send(null)}else"hash"==d?a.Eb(c.id,document.getElementById(c.le).innerHTML):"string"==d&&a.Eb(c.id,c.le)}
function Re(a,b){var c,d=null,e=null;if(null!==b.getAttribute("data-mln-navigate")&&(c=b.getAttribute("data-mln-navigate"),null!==c)){"prev"==c?Te(a,"-1"):"next"==c?Te(a,"+1"):"first"==c?Te(a,0):"last"==c?Te(a,a.Ul-1):Te(a,c);return}null!==b.getAttribute("data-mln-position")&&(c=Ue(b.getAttribute("data-mln-position").split(",")),null!==b.getAttribute("data-mln-autorotate")&&(d=Ue(b.getAttribute("data-mln-autorotate"))),null!==b.getAttribute("data-mln-transition")&&(e=b.getAttribute("data-mln-transition")),
null===e?a.B.Da.vh(c):"teleport"==e?a.B.l.J().setPosition(c):a.B.Da.vh(c),null!==d&&a.B.Da.Ue(d))}function Ue(a){for(var b=0;b<a.length;b++){if("string"==typeof a&&parseFloat(a)){a=parseFloat(a);break}parseFloat(a[b])&&(a[b]=parseFloat(a[b]))}return a}function Te(a,b,c,d){"+1"===b?b=1:"-1"===b?b=-1:(a.ad=b,b=0);a.ad+=b;0<=a.ad&&a.ad<a.Ul?(c||("right"==a.Mi?Ve(a,a.ad):"wide"==a.Mi&&We(a,a.ad)),"undefined"!==typeof d&&(a.Ul=d),Re(a,a.Za.getElementsByTagName("section")[a.ad])):a.ad-=b}
function Xe(a){var b=a.Za.getElementsByTagName("article")[0].getAttribute("data-mln-style");null===b&&(b="right");var c=a.Za.getElementsByClassName("melown-presenter panelContainer")[0],d=a.Za.getElementsByClassName("melown-presenter subtitlesContainer")[0],e=a.Za.getElementsByClassName("melown-presenter swipeControl");a.Mi=b;d.setAttribute("style","opacity: 0;");d.setAttribute("class","melown-presenter subtitlesContainer");if("right"==b){c.style.display="block";setTimeout(function(){c.style.opacity=
1},20);e[0].style.display="block";e[1].style.display="block";for(b=0;b<a.Lg.length;b++)a.Lg[b].style.height=a.kb+"px";Te(a,0)}else if("wide"==b){d.style.display="block";setTimeout(function(){d.style.opacity=1},20);c.style.display="none";c.style.opacity=0;e[0].style.display="none";e[1].style.display="none";for(b=0;b<a.Lg.length;b++)a.Lg[b].style.height="auto";We(a,0,!0)}}
function Se(a){a.Lg=a.Za.getElementsByClassName("melown-presenter toolboxContainer")[0].querySelectorAll("section");var b=a.Za.getElementsByClassName("melown-presenter swipeControl")[0],c=a.Za.getElementsByClassName("melown-presenter swipeControl")[1],d=document.createElement("button");d.innerHTML="<div><div></div></div>";d.setAttribute("type","button");d.setAttribute("class","melown-presenter-btnDw");d.onclick=function(){Te(this,"+1")}.bind(a);var e=document.createElement("button");e.innerHTML="<div><div></div></div>";
e.setAttribute("type","button");e.setAttribute("class","melown-presenter-btnUp");e.onclick=function(){Te(this,"-1")}.bind(a);b.appendChild(e);c.appendChild(d);Ye(a,a.Lg);d=a.kb+a.Xg;a.Za.getElementsByClassName("melown-presenter panelContainer")[0].style.height=d+a.Xg+"px";c.style.top=d+"px";b.style.opacity="1";c.style.opacity="1";setTimeout(function(){Xe(this)}.bind(a),a.Mm);Te(a,0,!1,a.Lg.length)}
function Ye(a,b){for(var c=0;c<b.length;c++)b[c].offsetHeight>a.kb&&(a.kb=b[c].offsetHeight);for(c=0;c<b.length;c++)b[c].style.height=a.kb+"px"}
function Ve(a,b){var c=a.Za.getElementsByClassName("melown-presenter toolboxContainer")[0],d=a.Za.getElementsByClassName("melown-presenter-btnUp")[0],e=a.Za.getElementsByClassName("melown-presenter-btnDw")[0],f=function(a){this.Za.getElementsByClassName("melown-presenter toolboxContainer")[0].querySelectorAll("article")[0].setAttribute("class",a)}.bind(a),g=a.kb*a.ad*-1;d.setAttribute("class","melown-presenter-btnUp");e.setAttribute("class","melown-presenter-btnDw");0===b?d.setAttribute("class","melown-presenter-btnUp melown-presenter hidden"):
b===a.Ul-1&&e.setAttribute("class","melown-presenter-btnDw melown-presenter hidden");a.Za.getElementsByTagName("article")[0].setAttribute("style","top: "+g+"px");0===a.ad?(c.style.height=a.kb+a.Xg+"px",c.style.top=0,f("melown-presenter"),a.Za.getElementsByClassName("melown-presenter swipeControl")[0].style.height=0,a.Za.getElementsByTagName("article")[0].style.top=0,a.Za.getElementsByTagName("section")[0].style.height=a.kb+(a.Xg-a.Fu)+"px"):(c.style.height=a.kb+"px",c.style.top=a.Xg+"px",f("melown-presenter nonFirst"),
a.Za.getElementsByClassName("melown-presenter swipeControl")[0].style.height=a.Xg+"px",a.Za.getElementsByTagName("section")[0].style.height=a.kb+a.Xg+"px")}
function We(a,b,c){"undefined"===typeof b&&(b=0);var d=a.Za.getElementsByClassName("melown-presenter subtitlesContainer")[0],e=d.childNodes[0],f=d.childNodes[1],g=d.childNodes[4].querySelectorAll("article")[0].querySelectorAll("section"),k=a.Za.getElementsByClassName("melown-presenter swipeSubtitles");Re(a,g[b]);g[b].removeAttribute("style");d.setAttribute("class","melown-presenter subtitlesContainer");d.removeAttribute("onclick");k[0].removeAttribute("onclick");k[1].removeAttribute("onclick");k[0].removeAttribute("style");
k[1].removeAttribute("style");e.removeAttribute("onclick");f.removeAttribute("onclick");e.setAttribute("class","melown-presenter hidden");f.setAttribute("class","melown-presenter hidden");for(var h=0;h<g.length;h++)g[h].style.opacity=0,void 0===a.Zp[h]&&(g[h].style.display="block",a.Zp[h]=g[h].offsetHeight,g[h].style.display="none"),h!==b&&Ze(a,g[h]);$e(a,g[b]);h=g[b].getAttribute("data-mln-style");void 0==h&&(h="full");"full"==h?(k[0].style.opacity=0,k[1].style.opacity=0,k[0].style.cursor="default",
k[1].style.cursor="default",0===b?(e.setAttribute("class","melown-presenter hidden"),f.setAttribute("class","melown-presenter"),f.onclick=function(){Te(this,1)}.bind(a),f.innerHTML="Continue"):b===g.length-2&&(e.setAttribute("class","melown-presenter"),e.onclick=function(){Te(this,"-1")}.bind(a),e.innerHTML="Back",f.setAttribute("class","melown-presenter"),f.onclick=function(){Te(this,"+1")}.bind(a),f.innerHTML="Explore"),"undefined"===typeof c&&d.setAttribute("style","display: block;"),d.setAttribute("class",
"melown-presenter subtitlesContainer full")):"title"==h?(k[0].style.opacity=1,k[1].style.opacity=1,k[0].onclick=function(){Te(this,"-1")}.bind(a),k[1].onclick=function(){Te(this,"+1")}.bind(a),e.setAttribute("class","melown-presenter hidden"),f.setAttribute("class","melown-presenter hidden"),d.style.height=a.Zp[b]+"px",d.setAttribute("class","melown-presenter subtitlesContainer title")):"mini"==h&&(d.setAttribute("style","display: block;"),d.setAttribute("class","melown-presenter subtitlesContainer mini"),
e.setAttribute("class","melown-presenter hidden"),f.setAttribute("class","melown-presenter hidden"))}function Ze(a,b){setTimeout(function(){b.style.display="none"},a.Mm)}function $e(a,b){setTimeout(function(){b.style.display="block";setTimeout(function(){b.style.opacity=1},50)},a.Mm)}function af(a){this.B=a;this.Sd=[];this.Xi=!0;this.Sm=this.we=this.sd=0;this.Kc=[0,0,0];this.Bf=[0,0,0];this.qq=0;this.Rk=90;this.Wr=0}l=af.prototype;
l.Ue=function(a){this.sd!=a&&this.B.pb("autorotate-changed",{autorotate:a});this.sd=a};l.In=function(){return this.sd};l.li=function(a,b){this.we=a;this.Sm=b};l.Hn=function(){return[this.we,this.Sm]};l.vh=function(a,b){var c=this.B.l.J();c&&(b=b||{},c=c.$f(c.sa(),a,b),bf(this,c,b.samplePeriod||10,b))};l.Dn=function(a,b){bf(this,a,b||10,{})};l.Wm=function(){cf(this.B.xh(),this.Rr);this.Xi=!0};
function bf(a,b,c,d){null!=b&&0!=b.length&&(a.Ue(0),a.li(0,0),a.Yx=d.speed||1,a.Xi&&(a.Rr=a.B.xh().dn),cf(a.B.xh(),"disabled"),a.Sd=b,a.Px=c,a.B.pb("fly-start",{startPosition:a.Sd[0],endPosition:a.Sd[a.Sd.length-1],options:d}),a.yy=performance.now(),a.Xi=!1)}
l.Zg=function(){var a=this.B.J();if(a){var b=performance.now(),c=(b-this.Wr)/1E3;this.Wr=b;if(0!=this.sd){var d=a.sa(),e=a.Xb(d);e[0]=(e[0]+this.sd*c)%360;d=a.pd(d,e);a.setPosition(d)}0!=this.we&&(d=a.sa(),d=a.xf(d,this.Sm,.01*a.Cd(d)*this.we*c,0),a.setPosition(d));!this.Xi&&this.Sd&&(b-=this.yy,b=Math.floor(b/this.Px*this.Yx),c=this.Sd.length-1,b<c?(a.setPosition(this.Sd[b]),this.B.pb("fly-progress",{position:this.Sd[b],progress:b/c*100})):a.setPosition(this.Sd[c]),b>=this.Sd.length&&(this.B.pb("fly-end",
{position:this.Sd[c]}),cf(this.B.xh(),this.Rr),this.Xi=!0))}};
function df(a,b){this.G=a;this.B=a.B;this.aa=this.G.Ub("compass",'<div id="melown-compass"><div id="melown-compass-frame"><img id="melown-compass-compass" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAABjCAYAAACPO76VAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODRDNjZFNDJCQjNCMTFFM0IyN0ZCQTZFQTAwNzEzNDUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ODRDNjZFNDNCQjNCMTFFM0IyN0ZCQTZFQTAwNzEzNDUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4NEM2NkU0MEJCM0IxMUUzQjI3RkJBNkVBMDA3MTM0NSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4NEM2NkU0MUJCM0IxMUUzQjI3RkJBNkVBMDA3MTM0NSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pgg3VBcAAAzUSURBVHja7F1bbBTXGf7tNdiAbTAXYxscMJe04GDLwVwKNDgNhaogRB+4qKgtzUMrISEhIXjiLsT9gQd4oQ8lPFRtEdACoWCCuASRBCelJBASEnM1xsbgGwYbg03PN/4PHI93vTO7s7tnxv6kX7Pe9Y7H/zf/5fxnzn/iXr16Rd3QA3HdZHST0Q2XktFTSLKQNCGpQlKEJLL4WFqFvGRp5uMTIfVCaoQ08PvdZNgEFJ8uZIiQQQ6fu0rIfSEPmaBuMvygv5CRQrJN78cLyeLPQc4AIX2ZsB5Cegn5qZBqIff47oc8F1In5DErH5+XswWpwHdK+fMuTQYUOUrIaJPy3xLyEyYnV0iGQ3+vQsg1Vv73Qu6ayPlByI9CGrsSGf34bs5SCMgRksfKL4jSdVxmcr4WckshBhb0nZBaL5ORysrO5J+ThExmmRBjD3FJyBdCPhfSxO89YLLqvUQGsp18IcP5Z2RD04X8jC1EJ8AiPhNyjrMx4LaQK0Ja3E7GGBaZon4gZCbHBZ2BeHJKyCdKSnydxXVk+Nj1ZHFMeEfIbCGFLhuHfSnkYyFXOaYgnpREykoiQQbSz2lMCFLS+WwNbkaxkAOcAoOIC5w2a03GOCVVRXa0UMO4EE48+QdnXzIV/kZXMibwoA0WMU/Ib8mb+JuQf7GF3GO3pQ0Z8ZwZDeZMaYmQIvI2zgrZxxlXJWdgrbEmA0T8nOMEyPijBmOGaAEW8VcmA/Hj03AJCYeMOA7UKOYNFfJ7IeOpa+ErIfuFlFFbERKB/VU4d3aomMhEoID3oVUijhw5QqWlpV4hYzz/77LCPDFcNxMK3uULQJ3pdzzCtoSmpiaqqanxknXksw7SWCfvRpOMd7i0gTL2n63EiKqqKrp+vW3w2qtXL3r27JnX3BV08CfWyXDWUcTJgCW8zenrEqtmWVlZSSUlbRlg7969qbGxkTyIiawTH+soLZJk4Hen8OtfC3nfikuSBMjXHrUMifdZN8Tpvq2bPcEm8yh7j7E6oNu8eTNt3LjRIEMS0LdvXzp27BhdvnyZfD6f8RkIeu+99ygvL88LhEA3mKS6zjr73GkyQICc/kStqaedq+vTp89ry8jNzTVIAl68eEFPnz41iEpOTvaKdfRkHe1WdHfdKTJ8fMJ4/iP5wVJX3OX9+vVrRwaC+KFDhwwrgMAiBg4cSCNGjGj3ux7KsKCrv7DubpCFSm+8xRMDKAIGrb6WlZXRkydt8zJwQy9fvqT4+HhasmQJZWVlUWJiIjU0NNCdO3fo1q1brtEuLLi52dbTPjMV3eU7YRmpnKolKoGpUyQlJb2OD7AAKD09Pd1wTyDFjbh48SJduHCBVq1aZfervxLyLesQcaQ+HDJy+TiDLE4Mwf3gLgLGjh1LR48epefPnxvpbGtrK8XFxdH69euNoxusYefOnXTu3Dk6cOBAKKcoZN19zLr8LFQy4Mjx8EAKn9AS1NR1zpw5rnX6sIZNmzbRw4cPacOGDTRgwIBQTwXdnVd0WhsKGXJSqIhszFmDjOPHj9OlS5deB2vI9OnTKSMjwzXWAIsGpk2bRrNnzw7nlG+xDo+yTgOmuoGqtkkcI3DcSG0PlFkGLEOmrPL1yJEjKS0tzTXWYATM1FTDPYVhFRKojK6ltseA/kMBHpQLZBly6nSyXSJk3IC4KVNSrUFixYoVThBBrEPo8iy1PUX5jZ3UdjR/Nok8DgTn+fPndyDCAfdkxiTW6Wg7MaM/H3MozPq8zsBYaNu2bXTixImO+bxwT2vWrHH6T05knZayjqutWIZ0S3letwZ/RADLly93yj2ZkWfScVDLyGaScruSNUhMnjyZ5s6dG6lLgE7/zTouCUaGrNZhxFjgNWvYsmULPXr0KODvoFi5du3aSF5GAev2Juu6oTMy0k3ZVJewBtU9oXQTYbzNZKQHI2NIZz7Ni9aguqd58+ZF47JGKLq+2RkZeMLB5/Z4YccaouSezHHDR37WK6pkyAkj1KMyuoI1RNk9SWSwjstY583+yEg2jTNchbq6OsMaiouLbX0viu7JPJYrY51X+xtnpJnihmtw+vRpY9xgl4gouycVQ00672AZqXwc4CZr2Lp1K506dSqk70fZPfmrcqQGIiOFj33dYg1wS9XVoS3hjpF7IpOOUwKRkWSKHdoCAfrgwYMhfz+G7skcn5PUN+P9ZFM9dLcISUSoU7cxdE8SiSaddyDDx8deumdMAOZLMAeBCqsdTJo0KZbuyWwZvmBkaLsGD8Faxohly5YZU7l79uyxTAgIXL16tQ7/yshgZMhVN9U6EgH3JLOmCRMmGKksMGbMGMuEgMDMzExtXbBKxks+3tPdPZmDrxVCVAI1gFwt1BKMDO2aZG3fvr2de/J3d3dGiD8CY4yGYGRIEl7odNWoNZ08edLS3R2IEA3d03N/N75KhiRBm5UsqL5iTGHn7gYhixYt0tU9mS2jKdCgD8+BDtIpgCNOyOqrlbvbXB7R0D1JyFYXdYHIkKseH+ninuR8hJW721weARF4wkPT7OmRSecdyJD9lcrd5J78FQtBHr6jcRpbbtJ5BzKkH6t1i3vyZw34fQ1jhBm1Jp13IEMGcLRfQHPFjFi7p8LCQr+Kdak1SFSwjjtkruY58CoO4tdiQYbqnvDkur/ShYutQeIajy+qzB+YybjPZGCE+EEs3dPSpUtp6NChnVoD5iQQpAcPHkwuwk1F152S8ZCPP8TSPRUUFLQbK5itAfMRKINrUH0NBTdMug5Ihgwot6mt72tBLNzTunXrjLkKKB8kgAzVGhAbYjwfESous247BG9/ZAAoFGazbyuIlXtCCWTHjh1UW1vrBWuQwGLLVgpQjPVHRimT8XU0ru78+fPt3NOsWbNo5cqVdObMGa9Yg4orio4tkSHLIVikjU7IEVujgRVDCMrSPU2dOpUWLFjgNWuQuMQ6pUAlp0DLyBDA8fDzF5EkA9Omcv0csHv3bi9ag0QJu6iAyVEgMn5kMrAyEwstHX8QGosZ1aVbsu2RbtaARmXoHIeWG3KtonxtA3BLFxXd2iKjkesnaN7yqdNkwD1hVakZOloDGgqADNwsUpBsFBUV0cyZlnsnQ4dNrNNGu2QA3zEZZ4X8ghzsX252T5gMgjVEcMVQyMDa9YULF7Z7D60rHj+23PD5LusQ+L6zX0wIUsx6wK/RoP3DSLgnrCrFKDpCa+hCAtbGo6UGjuh3guQCDWhGjRpldH2Ai0LDGouA7p6wLmtCJUPWUTL5hFgcWOiUe4I1YJ21w8t7HQEGnGhRAaDfCa4bloyH50AGYobFbnJfsu6kLikcMup5xDhcyIlwyZDuSUdrkGUXjPplPywZrMeNG2e8J5MMtc1fEEBnmO++QxY2RbHSc+iKciwOxz2h/oQ7bteuXdoRAeTk5NCwYcOMjA6Bu7y8nPbt22dYR0JCArW0tD3MkZKS0q6IGQDFiu7+Z+XvW+nEhitAWzd0FEOfH5RI8+26JwQ9h/pwOIr6+nqjGRnu9uzsbKMznIobN24Y1w8CJNA5LkiycYV11cq6a3GKDOITysfYDzAxlvsU9ujRI5TGWVHB7du3jZIMXBDiAO5+dI9bvHix0bAMzczMZARBM73Za6OcbOxGY6cXOlwaOovhMXbcFn8gj+Lw4cPGHMmUKVNo7969NGPGDMNiECdAThB8JOQIjytOkI1m9Xb61OGkspMYOoud8SoZaiNktc2fBSLOsG6IQtjGwW7TQOTJshPlPnJwIw+doHaTw9y6xZnEEtZJC+vIdsP3hBCu9SrHi+FskiB0vNcso6KiwniNJxQt4CvWRQMPBa6G8ncTQrze/9KbRTX7+Tz5XiEDHeMsuCQ1c9rPI+xK1k1og80wNjOBRWAzk4HUvZkJaiOYqrxAYewu4+Q2P5mcYXWlbX4+YouI+TY/KiFdbQOsc0xEHWm0AZYKuTUc4sdvhCzyKBF/x1CE2hYXabc1nIruTRM1IoOo43aiC4T80uVE4DHGf5LLthOVMG+0C4vBXLobN9o9zhbgyo12VahbUKMrwAwWN2xB/QmLXH/n2i2ozVZi3py9iFNi3drvlXKKepY8uDm7CixBzeXxCIAhLjbUmqjB2ASuBw+Z4XEaOYWH8QOmSuujdRHRJON1tYEzrExlnJLD1jOWotfCFQ8hf8t3/S1lnPCAM6eo7+wYCzIkUNsaRe3btsZzPAFZI9iSnFq0U8F3+k1W9l3TQA2pKh4wi9nS61iSoaI/x49sP6N7uQvaEE6bMeOYzAlBmpIM3OW7GQG3gUfHSD/v05tZN/Mo+R6T81gHJehChopkLq2AhEEOn7uKSakkP+sjuskIjp5MUBonASkc/HtypibbBLWwNHMQfsLBt4YV36z7P+oGMroMusnQCP8XYACgtQtbAKLiKwAAAABJRU5ErkJggg=="></div><div id="melown-compass-frame2"><img id="melown-compass-compass2" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAABjCAYAAACPO76VAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABG9JREFUeNrtnM9LFGEcxkeEPCQVmbkh7EXoEgW6noIQzQwKoQ5Lkgh7SA8iddlCQfAQFApdghAxooJCsEMe9JAEek8i81YQCIEYQvgHZM9L37Fpmpl9Z3d+rs8DDw7unuaz3+ddX+d9DIOiKIqiKIqiKIqiKIqiKIqiKIqiKMpTQ0NDyqNwTq7/MRUNAKsfwL2EER+MLHxBru/BA4QR3zR0wY/lWmmEMKKHcVh+tsEv5PoGPE4Y0cP4LD9b4AW57oC/whvwB3gZfgN3886FG1EmjAZ41WEa6uAm+DTcyLsXPAz11fWkDUYtvAVPwHfgAnwdbmVMhQtjDj4jN3gNPiTXF+E8fAsuwvfhQScIuVwuMusK762H69IGYwY+LwDew+3wcZkOQ2fhThoMvK8TnkrjZEzCV+RGF2XhXoE/wuvwJ7jGK5aSAkOm4Qm8DTemEcYYfNNtCnTWiCTAkGn4Bu/B+bSuGcPwF3gJfg1Pww/l661uLMQGwzINe+L5tH+1PSpbIOdkG0TtRWWSDsM2Dco/UhlPQSpqGA7TsJfqeEorDLjHNg3pj6cUwjgCzzpAYDxFDENNw6YLCOU+Uggfhtc0mH5LAuHDKDUNyjtwhgTCg6EzDab7effDg6EzDYynkGH4mQbGU4gw/EwD4ykkGMfgZz4hMJ5CgHEV/l4GCMZTgDDUNDwvAwLjKeD1odxp2I8nP/92JQx3P6oAwn48EUYw64N5U3+VG09+H0ggDOc1woymn/Bl2WH1A2KhnKdDCON/WxfrgvzurA8gCmAzYVQOwxpPi7bXdIEUyn1uijDc46nZ4T2lgCxW8hAbYfz1U69PtwYQN4AE4BNGT6lPtwaQQqWPdxLGn93XzVKfbgff1QVI6cOY1Ywnt+2RkgApPRh+48m+PaJA9Ab1FPpBhuEnnpw2Cxd1I40qDUM3npymoRDG+YyDCsMaT0thTANh6MGwxtMunA1jGghDD4Y1ngY1pkH9T+JUFMfIDhoMazy9g2s8pmHHug1OGMHCcIunBvilwzRkoj5geZBgOMXTNXgrjGkgDHcYl2zxdAJ+FeY0EIYziHrLQRUVT7ejmAbCcIZhPbq1G9U06MIo97RuGkF0ejy50Z9LwDlwuekZOSB6QQ6MZuUAaVXGU+TT4BNGixydnpaj1EtytHq4GuPJPEPXF/HBSkcYOmUCUjowVo3xNK8OM8YBwgNGjdRqrEvNxorUbhTldVXHMVlN8aSmIR8XBDsMjymolSKadimmMaSoZqZa4mnePNqbMBiDUr1UlCqmvFQzGVLVtCbXqsJpLu3xtG1vHYgThMMUtEopWUFKyiaktKzWVmamys1G0xxPU04H3RMAo1Fq+Zqkps8OaFVq/aww0vt3hleDWQJgdEth5bIUWG5IoWWHvL5gNgJZYVABy2PRHpfKV0MqYNts1bC8eRHCGJEyZEPKkbvYwRsfjAGpCTdkGyRLAPHB6JUCfU5DAmDkpJ+XN4miKIqiKIqiKIqiKIqiKIqiKIpKpn4DKrVAiBFUfdUAAAAASUVORK5CYII="></div><div id="melown-compass-frame3"><img id="melown-compass-compass3" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAABjCAYAAACPO76VAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABG9JREFUeNrtnM9LFGEcxkeEPCQVmbkh7EXoEgW6noIQzQwKoQ5Lkgh7SA8iddlCQfAQFApdghAxooJCsEMe9JAEek8i81YQCIEYQvgHZM9L37Fpmpl9Z3d+rs8DDw7unuaz3+ddX+d9DIOiKIqiKIqiKIqiKIqiKIqiKIqiKMpTQ0NDyqNwTq7/MRUNAKsfwL2EER+MLHxBru/BA4QR3zR0wY/lWmmEMKKHcVh+tsEv5PoGPE4Y0cP4LD9b4AW57oC/whvwB3gZfgN3886FG1EmjAZ41WEa6uAm+DTcyLsXPAz11fWkDUYtvAVPwHfgAnwdbmVMhQtjDj4jN3gNPiTXF+E8fAsuwvfhQScIuVwuMusK762H69IGYwY+LwDew+3wcZkOQ2fhThoMvK8TnkrjZEzCV+RGF2XhXoE/wuvwJ7jGK5aSAkOm4Qm8DTemEcYYfNNtCnTWiCTAkGn4Bu/B+bSuGcPwF3gJfg1Pww/l661uLMQGwzINe+L5tH+1PSpbIOdkG0TtRWWSDsM2Dco/UhlPQSpqGA7TsJfqeEorDLjHNg3pj6cUwjgCzzpAYDxFDENNw6YLCOU+Uggfhtc0mH5LAuHDKDUNyjtwhgTCg6EzDab7effDg6EzDYynkGH4mQbGU4gw/EwD4ykkGMfgZz4hMJ5CgHEV/l4GCMZTgDDUNDwvAwLjKeD1odxp2I8nP/92JQx3P6oAwn48EUYw64N5U3+VG09+H0ggDOc1woymn/Bl2WH1A2KhnKdDCON/WxfrgvzurA8gCmAzYVQOwxpPi7bXdIEUyn1uijDc46nZ4T2lgCxW8hAbYfz1U69PtwYQN4AE4BNGT6lPtwaQQqWPdxLGn93XzVKfbgff1QVI6cOY1Ywnt+2RkgApPRh+48m+PaJA9Ab1FPpBhuEnnpw2Cxd1I40qDUM3npymoRDG+YyDCsMaT0thTANh6MGwxtMunA1jGghDD4Y1ngY1pkH9T+JUFMfIDhoMazy9g2s8pmHHug1OGMHCcIunBvilwzRkoj5geZBgOMXTNXgrjGkgDHcYl2zxdAJ+FeY0EIYziHrLQRUVT7ejmAbCcIZhPbq1G9U06MIo97RuGkF0ejy50Z9LwDlwuekZOSB6QQ6MZuUAaVXGU+TT4BNGixydnpaj1EtytHq4GuPJPEPXF/HBSkcYOmUCUjowVo3xNK8OM8YBwgNGjdRqrEvNxorUbhTldVXHMVlN8aSmIR8XBDsMjymolSKadimmMaSoZqZa4mnePNqbMBiDUr1UlCqmvFQzGVLVtCbXqsJpLu3xtG1vHYgThMMUtEopWUFKyiaktKzWVmamys1G0xxPU04H3RMAo1Fq+Zqkps8OaFVq/aww0vt3hleDWQJgdEth5bIUWG5IoWWHvL5gNgJZYVABy2PRHpfKV0MqYNts1bC8eRHCGJEyZEPKkbvYwRsfjAGpCTdkGyRLAPHB6JUCfU5DAmDkpJ+XN4miKIqiKIqiKIqiKIqiKIqiKIpKpn4DKrVAiBFUfdUAAAAASUVORK5CYII="></div> </div>',b);
var c=this.aa.ma("melown-compass");c.pm(!0);c.K("drag",this.zf.bind(this));c.K("dblclick",this.gp.bind(this));this.Ra=this.aa.ma("melown-compass-compass");this.wv=this.aa.ma("melown-compass-compass2");this.xv=this.aa.ma("melown-compass-compass3");this.Vr=""}df.prototype.update=function(){var a=this.B.J();null!=a&&(a=a.sa(),a="rotateX("+.7*(a[6]+90)+"deg) rotateZ("+(a[5]-45)+"deg)",a!=this.Vr&&(this.Vr=a,this.Ra.cb(p.C.Jm,a),this.wv.cb(p.C.Jm,a),this.xv.cb(p.C.Jm,a)))};
df.prototype.zf=function(a){var b=this.B.J();null!=b&&(b.sa(),a=a.Ln(),b=ef(this.B.rc),b.Xh&&b.Xh.push([.8*-a[0],.8*-a[1],0]))};df.prototype.gp=function(a){var b=this.B.J();if(null!=b){var c=b.sa(),d=b.Xb(c);d[0]=0;d[1]=-90;c=b.pd(c,d);b.setPosition(c);p.C.stopPropagation(a)}};function ff(a,b){this.G=a;this.B=a.B;this.aa=this.G.Ub("credits",'<div id="melown-credits" class="melown-credits"> </div>',b);this.Tr=this.Sr=this.Do="";this.L=this.aa.ma("melown-credits")}
function gf(a,b,c,d){a=a.B.J();for(var e="",f=b.length,g="",k=!1,h=0;h<f;h++){var m=a.Kn(b[h]);m.plain&&(g+=m.plain)}g&&30<g.length&&1<f&&!d&&(f=1,k=!0);for(h=0;h<f;h++)m=a.Kn(b[h]),m.html&&(e+=m.html),h+1<f&&(e+=c);return[e,k]}
ff.prototype.update=function(){var a=this.B.J();if(null!=a){var b="",c="",d="",a=a.bj();if(0<a.imagery.length)var e=gf(this,a.imagery,", "),b=b+"<div class='melown-credits-supercell'>"+("<div class='melown-credits-cell'>Imagery: "+e[0]+"</div>"),b=b+(e[1]?"<div class='melown-credits-cell-button' id='melown-credits-imagery-more'>and others</div>":""),b=b+"<div class='melown-credits-separator'></div></div>",c="<div class='melown-credits-list'>"+(gf(this,a.imagery,"<br/>",!0)[0]+"</div>");0<a.mapdata.length&&
(e=gf(this,a.mapdata,", "),b=b+"<div class='melown-credits-supercell'>"+("<div class='melown-credits-cell'>Map Data: "+e[0]+"</div>"),b+=e[1]?"<div class='melown-credits-cell-button' id='melown-credits-mapdata-more'>and others</div>":"",b+="<div class='melown-credits-separator'></div></div>",d="<div class='melown-credits-list'>"+(gf(this,a.mapdata,"<br/>",!0)[0]+"</div>"));b+="<div class='melown-credits-supercell'><div class='melown-credits-cell'>Powered by <a class='melown-logo' href='https://melown.com' target='_blank'>MELOWN</a></div><div class='melown-credits-separator'></div></div>";
this.Do!=b&&(this.Do=b,this.L.Mg(b),(b=this.aa.ma("melown-credits-imagery-more"))&&b.K("click",this.ys.bind(this,b,"2")),(b=this.aa.ma("melown-credits-mapdata-more"))&&b.K("click",this.ys.bind(this,b,"3")));this.Sr=c;this.Tr=d}};ff.prototype.ys=function(a,b){var c=a.xr();b="2"==b?this.Sr:this.Tr;this.G.hm.show({right:Math.max(0,c.fromRight-c.width)+"px",bottom:c.fromBottom+7+"px"},b)};function hf(a,b){this.G=a;this.aa=this.G.Ub("layers",'<div class="melown-layers"</div>',b)}
function jf(a){this.G=a;this.aa=this.G.Ub("fallback",'<div class="melown-fallback"><div class="melown-fallback-text"><p>Melown Maps is <a href="http://get.webgl.org/">WebGL</a> dependent service.</p><p>You can read more about Melown Maps in our <a/ href="https://www.melown.com/maps/about.html">About section</a>.</p></div> </div>',void 0)}
function kf(a,b,c){this.G=a;this.Hr=b;this.An=[];this.uq=null!=c?c:!0;this.ba=document.createElement("div");this.pi(this.uq);this.Mg(b);this.G.ba.appendChild(this.ba)}kf.prototype.Mg=function(a){this.ba.innerHTML=a;a=this.ba.getElementsByTagName("*");for(var b=0,c=a.length;b<c;b++){var d=a[b].getAttribute("id");null!==d&&(this.An[d]=new lf(this,a[b]))}};kf.prototype.ma=function(a){return this.An[a]};kf.prototype.pi=function(a){this.ba.style.display=a?"block":"none";this.uq=a};kf.prototype.zr=function(){return this.uq};
kf.prototype.setHtml=kf.prototype.Mg;kf.prototype.getElement=kf.prototype.ma;kf.prototype.setVisible=kf.prototype.pi;kf.prototype.getVisible=kf.prototype.zr;function mf(a){this.G=a;this.B=a.B;this.aa=this.G.Ub("map",'<div id="melown-map" class="melown-map"> </div>');this.lf().pm(!0)}mf.prototype.lf=function(){return this.aa.ma("melown-map")};
function nf(a,b){this.G=a;this.B=a.B;this.aa=this.G.Ub("zoom",'<div id="melown-zoom" class="melown-zoom"><div id="melown-zoom-plus" class="melown-zoom-plus"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAASUlEQVRIx+2Tyw0AIAhDq0d2KsMzFFddQBO9+En6rqR5kFBAiBVINpJtJ1NPLCbJe5IyG7j78IMyEwBgZsNcRJQrl6gnkgjxIx12Cg3wDaLBUAAAAABJRU5ErkJggg=="></div><div id="melown-zoom-minus" class="melown-zoom-minus"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAALUlEQVRIx2NgGAWjYBSMAqoCRlwSdnZ2/8kx8NChQxhmMo2G8ygYBaNgFGAHAElYBARpOBYqAAAAAElFTkSuQmCC"></div> </div>',b);
var c=this.aa.ma("melown-zoom-plus");c.K("click",this.Hw.bind(this));c.K("dblclick",this.xg.bind(this));c=this.aa.ma("melown-zoom-minus");c.K("click",this.Iw.bind(this));c.K("dblclick",this.xg.bind(this))}nf.prototype.xg=function(a){p.C.stopPropagation(a)};nf.prototype.Hw=function(){this.repeat(7,.96,50)};nf.prototype.Iw=function(){this.repeat(7,1.04,50)};
nf.prototype.repeat=function(a,b,c){if(!(0>=a)&&null!=this.B.J()){var d=ef(this.B.rc);d.bh&&d.bh.push(b);setTimeout(this.repeat.bind(this,--a,b,c),c)}};function of(a,b){this.G=a;this.B=a.B;this.aa=this.G.Ub("popup",'<div class="melown-popup-background" id="melown-popup-background"><div id="melown-popup"</div></div>',b);this.Do="";this.hm=this.aa.ma("melown-popup");this.mk=this.aa.ma("melown-popup-background");this.mk.K("click",this.po.bind(this))}
of.prototype.show=function(a,b){this.aa.pi(!0);for(var c in a)this.hm.cb(c,a[c]);this.hm.Mg(b)};of.prototype.po=function(){this.aa.pi(!1)};
function pf(a,b){this.G=a;this.B=a.B;this.aa=this.G.Ub("space",'<div id="melown-space" class="melown-space"><img id="melown-space-2d" class="melown-space-button" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAABqElEQVRIx+2UsWoUURSGv3Nn1sIiaKMBSbD0AdRBdmbdB7DMA0gaSSVRbFRYiGAaUWJhEAQVEey10yacO/gAwqZNSKWwhShs4ew9NtewTDI6sRCE/at7h8P/nfnvuRdmmum/lkxvut1u5pwbAOfNrAMMzWy9LMt3v2qKorCaRwC+A9vApqq+bITkeX4Z+CAiab3IzJa9988bIPXaR977G9Pf3NT6joikZvYmSZL5JElOAPcBRORu3UxVRVVlNBodCyEsmtkAMBFZjQ3va79rETluZl+rqrrpvf8c41t3zt0GFpo6Hw6HP4A9YK0oinlgRUSuAVsHIKqaH8hSJIsR7LQ54KqqNtI0XTGzS01xURuCBeBZhD1pAzGz3Vh/+o+QXq93zjnnReSsmb1W1Y0jTm3yW0ie5xdDCB5YNLMX4/H4KmAtzc/EP/py6MHH8bwAvAfmgDXv/eAo7Xc6nSsxro+HQrIsO2Vmb0VkDrilqg9aert+v39yMpksAfciZLPpMj4UkdUmJ1WVNpcReKyq15viWvrLp8mAb8CnEMLTsixfzV7rmf6dfgKmzKAWE7bqxgAAAABJRU5ErkJggg=="><img id="melown-space-3d" class="melown-space-button" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAB8klEQVRIx+1Uv4sTQRT+3mRygyDInYXFabaxsRNOIiG7mEPQxsJCLQVF8AeiaCNWigrWiniCVfA/0Eo4ONnZ4P4FURAL9yyCEMQfRMzs7LOZk2HZxNgIQr7qzbw373t838wAc8zxX4P8RbvdPimEuMLM+4loAcAmM3eTJLkHgAEgiiIu9SgAfAfwBsCa1rpbJqltBWEYXhBCdAE0HEENwBIRrQZBQFmWvQKAIAhuVwyqAOwGcLzRaOzIsuylXyB+VxKdc+FTY8yyMWZbURSn3N7l8nRaa9Ja03A4XCiKosHMtwAwEV0Lw/BQJYnW+oAxZu9oNLqUpulASrmdiPa49GCS3v1+3/R6vc0kSe4AeOIGPu/XSH+Rpul7J906ER0GAGYeADgzi8F5nj+QUl5k5tZEEk+6fV6sfO+mgZk/uDO7KuUqYcUYswTgGYBFAPf/8tbW/kiitR6kafqZma+7CVdmbL7s6j9VyhVF0QtmbuV5fnDLm/F4rJRSICKehaFerx9zcr2uJGHmn0S0U0r5uNlsnlVKWQCPXG5jSm/R6XQWrbUnANx1JGuTjL/JzEeJ6IhS6qNH/kUIcaPc2X/51lo/9TCO441KT5IkeWetXQWwDuAHgG/M/BxAK47jt9MuFYCvAHpFUZzWWl+d/9Zz/Dv8ApJPyD0fWCwOAAAAAElFTkSuQmCC"> </div>',b);
this.hh=this.aa.ma("melown-space-2d");this.hh.K("click",this.fm.bind(this));this.hh.K("dblclick",this.xg.bind(this));this.ih=this.aa.ma("melown-space-3d");this.ih.K("click",this.fm.bind(this));this.ih.K("dblclick",this.xg.bind(this));this.Yq=this.ri=!0,this.hh.cb("display","block"),this.ih.cb("display","none")}pf.prototype.xg=function(a){p.C.stopPropagation(a)};
pf.prototype.fm=function(){this.ri=!this.ri;var a=this.B.J();if(null!=a){var b=a.sa(),c=a.Xb(b);this.ri?(c[0]=45,c[1]=-60):(c[0]=0,c[1]=-90);b=a.pd(b,c);b=p.Mq(this.B,b);a.setPosition(b);this.update()}};pf.prototype.update=function(){var a=this.B.J();if(null!=a){var b=a.sa(),a=a.Xb(b),a=.1<Math.abs(a[1]+90);a!=this.Yq&&(a?(this.hh.cb("display","block"),this.ih.cb("display","none")):(this.hh.cb("display","none"),this.ih.cb("display","block")),this.Yq=this.ri=a)}};
function qf(a,b){this.G=a;this.B=a.B;this.aa=this.G.Ub("search",'<div class="melown-search"><div class="melown-search-input"><input type="text" id="melown-search-input" autocomplete="off" spellcheck="false" placeholder="Search location..."></div><div id="melown-search-list" class="melown-search-list"></div></div>',b);this.Je=this.aa.ma("melown-search-input");this.Je.K("input",this.jw.bind(this));this.Je.K("keydown",this.Af.bind(this));this.Je.K("focus",this.ow.bind(this));this.Je.K("mousedown",this.us.bind(this));
this.Je.K("mousewheel",this.zf.bind(this));this.tj=this.aa.ma("melown-search-list");this.tj.K("mousedown",this.us.bind(this));this.tj.K("mousewheel",this.zf.bind(this));this.Qo=this.G.c;this.kd=this.Qo.lf();this.kd.K("mousedown",this.zf.bind(this),window);this.kd.K("mousewheel",this.zf.bind(this),window);this.ro=!1;this.Dy="https://www.windytv.com/search/get/v1.0/{value}?lang=en-US&hash=b0f07fGWSGdsx-l";this.Ia=[];this.qg="";this.jd=-1;this.Np=0;this.gu="+proj=longlat +datum=WGS84 +no_defs"}
function rf(a,b){return a.replace(/\{([_$a-zA-Z0-9][_$a-zA-Z0-9]*)\}/g,function(a,d){return d in b?b[d]:a})}function sf(a){a.tj.cb("display","none")}function tf(a,b){a.jd+=b;a.jd>=a.Ia.length&&(a.jd=a.Ia.length-1);0>a.jd&&(a.jd=0);uf(a,{data:a.Ia})}
function uf(a,b){if(b.data){var c="",d=b.data,d=d.slice(0,10);a.Ia=d;for(var e=0,f=d.length;e<f;e++)var g=d[e],c=a.jd==e?c+('<div id="melown-search-item'+e+'" class="melown-search-listitem-selected">'+g.title+" "+(g.region?g.region:"")+"</div>"):c+('<div id="melown-search-item'+e+'" class="melown-search-listitem">'+g.title+" "+(g.region?g.region:"")+"</div>");a.tj.Mg(c);e=0;for(f=d.length;e<f;e++)if(g=a.aa.ma("melown-search-item"+e))g.K("click",a.Bs.bind(a,e)),g.K("mouseenter",a.pw.bind(a,e));a.tj.cb("display",
"block")}else sf(a)}l=qf.prototype;l.Bs=function(a){var b=this.B.J();if(null!=b){var c=b.sa(),d=this.Ia[a];if(d){var e=[d.lon,d.lat],f=b.mf().navigationSrs,f=b.fc(f),e=this.B.Ge()(this.gu,f.srsDef,e),c=b.Ng(c,e),e=1E4;switch(d.type){case "peak":e=2E4;break;case "city":e=3E4;break;case "street":e=4E3;break;case "residential":e=3E3}c=b.Og(c,e);c=b.pd(c,[0,-60,0]);b.setPosition(c);this.jd=a;this.qg=d.title;a=this.Je.ma();a.value=this.qg;a.blur()}sf(this)}};
l.pw=function(a){this.jd!=a&&(this.jd=a,uf(this,{data:this.Ia}))};l.rw=function(a,b){this.Np==a&&uf(this,b)};l.qw=function(){};l.ow=function(){this.qg="";this.Je.ma().value=this.qg;sf(this)};l.dm=function(a){console.log("press");this.Af(a)};l.Af=function(a){switch(a.tr()){case 38:tf(this,-1);p.C.preventDefault(a);p.C.stopPropagation(a);break;case 40:tf(this,1);p.C.preventDefault(a);p.C.stopPropagation(a);break;case 9:case 13:this.Bs(Math.max(0,this.jd))}};
l.jw=function(){var a=this.Je.ma().value,a=a.trim();a!=this.qg&&(this.qg=a,""==a&&sf(this),a=rf(this.Dy,{value:a}),this.Np++,this.jd=-1,p.Jd(a,this.rw.bind(this,this.Np),this.qw.bind(this)))};l.us=function(){this.ro=!0};l.zf=function(){if(this.ro)this.ro=!1;else{var a=this.Je.ma();a.value=this.qg;a.blur();sf(this)}};l.update=function(){};
function vf(a,b){this.G=a;this.B=a.B;this.aa=this.G.Ub("link",'<div id="melown-link" class="melown-link"><div id="melown-link-button" class="melown-link-button"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAABrUlEQVRIx+2VMWtUQRSFz5nZjVrpD9gNVhpLQbZZ5vWaIoUECayNRSpbo9UiJI1pBRs7DVjYGBC1ntm3yHaiwgYsZP+EmMe7x8K3YJEH+xYLwT3NcGe483HvnJkBVvovxWWSsiy7BeAxgGuSpmY2zPP8/V+DhBAekDysQgPgAMDMbo5Gow9n5bgmgF6vd47kAYBC0t0Y45qkPQAguV+X1wgymUx+ShqUZZmllI4AlEVRPJckkht1ea1FNu/3+1ve+31JV0h+dc49mq+12+0dkpQ0XfpMQgh7JJ9U4SmANf3WZUnXvfevAbQBbMYY3zVu1x+Awsx2YoznzewOgKcke3OApId1AADwCwIGJG90u12f5/nx+vr6Jefc0RyQUjpsfE9CCJsk3wIoyrLcljRttVrznv8AcAEAFgHUtovksNrkXp7nx+Px+ETSbQBfKrN8NrOtRQC17pK0QbJMKb2az5nZd+fc/ZRSBKAm1q+r5ASADyHsVuPAe/+R5JtlnqEzIWY2rGDPsiw7JfmysulB0ypq3TWbzb51Op0JyaskLwL4BGA3xvhi9aes9G/pF4AdwlhUZ8RfAAAAAElFTkSuQmCC"></div><div id="melown-link-text-holder" class="melown-link-text-holder"><div class="melown-link-text"><textarea id="melown-link-text-input" rows="4" cols="50" wrap="hard"></textarea></div></div> </div>',b);
this.ee=this.aa.ma("melown-link");var c=this.aa.ma("melown-link-button");c.K("click",this.fm.bind(this));c.K("dblclick",this.xg.bind(this));this.Qv=this.aa.ma("melown-link-text-holder");this.Gl=this.aa.ma("melown-link-text-input");this.Io=!1;this.update()}vf.prototype.xg=function(a){p.C.stopPropagation(a)};vf.prototype.fm=function(){this.Io=!this.Io;wf(this);this.update()};
vf.prototype.update=function(){this.ee.cb("left",10+(this.G.f.lh?70:0)+(this.G.f.kh?35:0)+"px");this.Qv.cb("display",this.Io?"block":"none")};function wf(a){var b=xf(a.B);a.Gl.ma().value!=b&&(a.Gl.ma().value=b)}
function yf(a,b){this.G=a;this.aa=this.G.Ub("loading",'<div id="melown-loading" class="melown-loading"><div class="melown-loading-progress"><div id="melown-loading-dot1" class="melown-loading-dot"></div><div id="melown-loading-dot2" class="melown-loading-dot"></div><div id="melown-loading-dot3" class="melown-loading-dot"></div><div id="melown-loading-dot4" class="melown-loading-dot"></div><div id="melown-loading-dot5" class="melown-loading-dot"></div></div> </div>',b);this.Il=this.aa.ma("melown-loading");
this.qu=[this.aa.ma("melown-loading-dot1"),this.aa.ma("melown-loading-dot2"),this.aa.ma("melown-loading-dot3"),this.aa.ma("melown-loading-dot4"),this.aa.ma("melown-loading-dot5")];this.Am=Date.now();this.ql=null}yf.prototype.show=function(){this.ql=null;this.G.bb("compass",!1);this.G.bb("zoom",!1);this.G.bb("space",!1);this.G.bb("search",!1);this.G.bb("link",!1);this.G.bb("credits",!1);this.G.bb("loading",!0)};
yf.prototype.po=function(){this.ql=Date.now();var a=this.G.f.Ki;if(a){var b=this.G.B.J();b&&(a="melown2015"==b.mf().id)}this.G.bb("compass",this.G.f.Hi);this.G.bb("zoom",this.G.f.lh);this.G.bb("space",this.G.f.kh);this.G.bb("search",a);this.G.bb("link",this.G.f.Ji);this.G.bb("credits",this.G.f.Ii);this.G.bb("loading",!1)};
yf.prototype.update=function(){var a=Date.now();if(this.ql){var b=.001*(a-this.ql);this.Il.cb("opacity",1-Math.min(1,2*b)+"");.5<b&&this.aa.pi(!1)}for(var b=.001*(a-this.Am),c=0;5>c;c++)this.qu[c].cb("opacity",.6*Math.sin(1.5*Math.PI/5*c-b*Math.PI*2)+.2);b=this.G.B.J();null!=b&&(b=b.getStats(),(0==b.surfaces&&0==b.freeLayers||0==b.downloading&&0<b.lastDownload&&1E3<a-b.lastDownload||0!=b.bestMeshTexelSize&&b.bestMeshTexelSize<=3*b.texelSizeFit||("fit"==b.loadMode||"fitonly"==b.loadMode)&&1<b.drawnTiles-
b.drawnGeodataTiles)&&this.po())};function lf(a,b){this.aa=a;this.G=this.aa.G;this.ba=b;this.Wf=[];this.ef=this.lw.bind(this);this.gf=this.nw.bind(this);this.ff=this.mw.bind(this);this.Cl=this.uh=0;this.hn=[0,0];this.rh=[0,0];this.ed=[0,0];this.Uf=[0,0];this.hk=!1}l=lf.prototype;l.cb=function(a,b){this.ba.style[a]=b};l.$u=function(a){return this.ba.style[a]};l.Rj=function(a){p.C.Rj(this.ba,a);return this};l.aj=function(){return this};l.ml=function(a){return p.C.ml(this.ba,a)};
l.Lm=function(a){p.C.Lm(this.ba,a);return this};l.Cp=function(a){p.C.Cp(this.ba,a);return this};l.xr=function(){var a=this.ba.getBoundingClientRect(),b=this.G.c.lf().ba.getBoundingClientRect(),c=window.pageXOffset||0,d=window.pageYOffset||0;return{left:a.left+c-(b.left+c),top:a.top+d-(b.top+d),fromRight:b.right-(a.left+c-(b.left+c)),fromBottom:b.height-(a.top+d-(b.top+d)),width:a.width,height:a.height}};
l.Mg=function(a){this.ba.innerHTML=a;a=this.ba.getElementsByTagName("*");for(var b=0,c=a.length;b<c;b++){var d=a[b].getAttribute("id");null!==d&&(this.aa.An[d]=new lf(this,a[b]))}};l.Uu=function(){return this.ba.innerHTML};l.ma=function(){return this.ba};lf.prototype.setHtml=lf.prototype.Mg;lf.prototype.getHtml=lf.prototype.Uu;lf.prototype.getElement=lf.prototype.ma;lf.prototype.setClass=lf.prototype.Rj;lf.prototype.getClass=lf.prototype.aj;lf.prototype.setStyle=lf.prototype.cb;
lf.prototype.getStyle=lf.prototype.$u;lf.prototype.addClass=lf.prototype.Lm;lf.prototype.hasClass=lf.prototype.ml;lf.prototype.getRect=lf.prototype.xr;lf.prototype.removeClass=lf.prototype.Cp;l=lf.prototype;
l.pm=function(a){a?(this.K("mousedown",this.ef),this.K("touchstart",this.ef)):this.Hk&&(this.Ob("mousedown",this.ef),this.Ob("mousemove",this.gf,document),this.Ob("mouseup",this.ff,document),this.Ob("touchstart",this.ef),this.Ob("touchmove",this.gf,document),this.Ob("touchend",this.ff,document),this.Be=!1);this.hn=[0,0];this.rh=[0,0];this.ed=[0,0];this.Uf=[0,0];this.ar=0;this.Hk=a;this.yb={left:!1,right:!1,middle:!1}};l.Su=function(){return this.Hk};
l.sr=function(){return{dragging:this.Be,buttonLeft:this.yb.left,buttonRight:this.yb.right,buttonMiddle:this.yb.middle,startPos:this.hn.slice(),lastPos:this.ed.slice(),currentPos:this.rh.slice(),absMoved:this.Uf.slice()}};
l.lw=function(a){this.yb[a.Nn()]=!0;this.Cl=this.uh=0;this.hk=!1;if(1!=this.Be){this.Be=!0;var b=a.dg(!0);this.hn=[b[0],b[1]];this.rh=[b[0],b[1]];this.ed=[b[0],b[1]];this.Uf=[0,0];this.K("mousemove",this.gf,document);this.K("mouseup",this.ff,document);this.K("touchmove",this.gf,document);this.K("touchend",this.ff,document);p.C.pu();p.C.ou();p.C.preventDefault(a);this.Qk("dragstart",{clientX:b[0],clientY:b[1]})}else this.ed=b=a.dg()};
l.nw=function(a){var b=a.dg();-1!=a.ej()&&zf(this,a,!0);p.C.preventDefault(a);var c=0,d=a.ej();d!=this.ar&&(this.ed[0]=b[0],this.ed[1]=b[1],this.ar=d);if(2==d){var e=a.Pn(0),f=a.Pn(1);a=f[0]-e[0];e=f[1]-e[1];e=Math.sqrt(a*a+e*e);0==this.uh&&(this.uh=e);!this.hk&&25<Math.abs(this.uh-e)?(this.hk=!0,this.uh=e):c=this.hk?e/this.Cl:0;this.Cl=e}this.Qk("drag",{clientX:b[0],clientY:b[1],deltaX:b[0]-this.ed[0],deltaY:b[1]-this.ed[1],left:this.yb.left,right:this.yb.right,middle:this.yb.middle,zoom:c,touches:d});
this.ed=this.rh;this.rh=[b[0],b[1]];this.Uf[0]+=Math.abs(b[0]-this.ed[0]);this.Uf[1]+=Math.abs(b[1]-this.ed[1])};
l.mw=function(a){var b=this.yb.left,c=this.yb.right,d=this.yb.middle;zf(this,a,!1);this.Cl=this.uh=0;this.hk=!1;if(1==this.Be){var e=a.dg();this.ed=e;this.yb.left||this.yb.right||this.yb.middle||(this.Be=!1,e=this.rh,this.Ob("mousemove",this.gf,document),this.Ob("mouseup",this.ff,document),this.Ob("touchmove",this.gf,document),this.Ob("touchend",this.ff,document),p.C.Cu(),p.C.Bu(),p.C.preventDefault(a),this.Qk("dragend",{clientX:e[0],clientY:e[1],left:b,right:c,middle:d}))}};
function zf(a,b,c){switch(b.ej()){case -1:a.yb[b.Nn()]=c;break;case 0:a.yb={left:!1,right:!1,middle:!1};break;case 1:a.yb={left:!0,right:!1,middle:!1};break;case 2:a.yb={left:!1,right:!0,middle:!1};break;case 3:a.yb={left:!1,right:!1,middle:!0}}}
l.pm=function(a){a?(this.K("mousedown",this.ef),this.K("touchstart",this.ef)):this.Hk&&(this.Ob("mousedown",this.ef),this.Ob("mousemove",this.gf,document),this.Ob("mouseup",this.ff,document),this.Ob("touchstart",this.ef),this.Ob("touchmove",this.gf,document),this.Ob("touchend",this.ff,document),this.Be=!1);this.Hk=a;this.yb={left:!1,right:!1,middle:!1}};lf.prototype.setDraggableState=lf.prototype.pm;lf.prototype.getDraggableState=lf.prototype.Su;lf.prototype.getDraggingState=lf.prototype.sr;
function Oe(a,b,c){this.R=a;this.Aa=c;this.ba=b}l=Oe.prototype;l.Nn=function(){switch(this.R){case "touchstart":case "touchend":case "touchmove":var a=this.Aa.touches;if(a)switch(a.length){case 1:return"left";case 2:return"right";case 3:return"middle"}default:if(this.Aa.which)switch(this.Aa.which){case 1:return"left";case 2:return"middle";case 3:return"right"}else if(this.Aa.button)switch(this.Aa.button){case 1:return"left";case 2:return"right";case 3:return"middle"}}return""};
l.dg=function(a){switch(this.R){case "touchstart":case "touchend":case "touchmove":var b=this.Aa.touches;if(!b||0==b.length)break;for(var c=[0,0],d=0,b=b.length;d<b;d++){var e=Af(this,this.Aa.touches[d],a);c[0]+=e[0];c[1]+=e[1]}c[0]/=b;c[1]/=b;return c;case "mousedown":case "mouseup":case "mousemove":case "dblclick":case "dragstart":case "dragend":case "drag":return Af(this,this.Aa,a)}return[0,0]};
function Af(a,b,c){if(null==a.ba.getBoundingClientRect||c)return[b.clientX,b.clientY];a=a.ba.getBoundingClientRect();return[b.clientX-a.left,b.clientY-a.top]}l.Ln=function(){switch(this.R){case "drag":return[this.Aa.deltaX,this.Aa.deltaY]}return[0,0]};l.rr=function(){switch(this.R){case "drag":return this.Aa.zoom}return 1};
l.dl=function(a){switch(this.R){case "mouseup":case "mousedown":case "dblclick":case "keyup":case "keydown":case "keypress":switch(a){case "alt":return this.Aa.altKey;case "ctrl":return this.Aa.ctrlKey;case "shift":return this.Aa.shiftKey}}return!1};l.tr=function(){switch(this.R){case "keyup":case "keydown":case "keypress":return this.Aa.keyCode?this.Aa.keyCode:this.Aa.which?this.Aa.which:this.Aa.charCode}return null};
l.$k=function(a){switch(a){case "left":case "right":case "middle":switch(this.ej()){case -1:return this.Aa[a];case 1:return"left"==a;case 2:return"right"==a;case 3:return"middle"==a}}return!1};l.Sn=function(){switch(this.R){case "mousewheel":var a=0;this.Aa.wheelDelta&&(a=this.Aa.wheelDelta/120);this.Aa.detail&&(a=-this.Aa.detail/3);return a}return 0};l.ej=function(){switch(this.R){case "touchstart":case "touchend":case "touchmove":if(this.Aa.touches)return this.Aa.touches.length}return-1};
l.Pn=function(a,b){switch(this.R){case "touchstart":case "touchend":case "touchmove":if(this.Aa.touches){var c=this.Aa.touches[a];if(c){if(null==this.ba.getBoundingClientRect||b)return[c.clientX,c.clientY];var d=this.ba.getBoundingClientRect();return[c.clientX-d.left,c.clientY-d.top]}}}return[0,0]};l.bv=function(){return this.R};Oe.prototype.getMouseButton=Oe.prototype.Nn;Oe.prototype.getMouseCoords=Oe.prototype.dg;Oe.prototype.getDragDelta=Oe.prototype.Ln;Oe.prototype.getModifierKey=Oe.prototype.dl;
Oe.prototype.getKeyCode=Oe.prototype.tr;Oe.prototype.getDragButton=Oe.prototype.$k;Oe.prototype.getWheelDelta=Oe.prototype.Sn;Oe.prototype.getDragZoom=Oe.prototype.rr;Oe.prototype.getDragTuches=Oe.prototype.ez;Oe.prototype.getTouchesCount=Oe.prototype.ej;Oe.prototype.getTouchCoords=Oe.prototype.Pn;Oe.prototype.getType=Oe.prototype.bv;lf.prototype.K=function(a,b,c){Bf(this,a,b,c)};lf.prototype.Jw=function(a,b,c){var d=function(){Cf(this,a,b,c)}.bind(this);Bf(this,a,function(a){b(a);d()},c)};
lf.prototype.Ob=function(a,b,c){Cf(this,a,b,c)};lf.prototype.Qk=function(a,b){var c=this.Wf[a];if(null!=c)for(var d in c)c[d](b)};function Bf(a,b,c,d){var e=b+"-"+p.C.tm(c)+(d?"-"+p.C.tm(d):""),f=function(a){this.G.N||c(new Oe(b,this,a||window.event))}.bind(a);d=d||a.ba;d.addEventListener(b,f,!1);"mousewheel"==b&&d.addEventListener("DOMMouseScroll",f,!1);a.Wf[b]=a.Wf[b]||[];a.Wf[b][e]=f}
function Cf(a,b,c,d){c=b+"-"+p.C.tm(c)+(d?"-"+p.C.tm(d):"");var e=a.Wf[b]&&a.Wf[b][c];null!=e&&(delete a.Wf[b][c],(d||a.ba).removeEventListener(b,e,!1))}lf.prototype.on=lf.prototype.K;lf.prototype.once=lf.prototype.Jw;lf.prototype.off=lf.prototype.Ob;lf.prototype.fire=lf.prototype.Qk;function Sf(a,b){this.B=a;this.f=a.f;this.Ts=b;this.ba=null;this.be=[];this.N=!1;this.Eb();p.My++}l=Sf.prototype;
l.Eb=function(){this.ba=document.createElement("div");this.ba.className="melown-browser";this.Ts.appendChild(this.ba);this.c=new mf(this);var a=this.f.yk;this.fu=new df(this,!a&&this.f.Hi);this.L=new ff(this,!a&&this.f.Ii);new nf(this,!a&&this.f.lh);this.Jf=new pf(this,!a&&this.f.kh);this.Qx=new qf(this,!a&&this.f.Ki);this.Gl=new vf(this,!a&&this.f.Ji);this.ta=new hf(this,!a&&this.f.xk);new jf(this);this.hm=new of(this,!1);this.Il=new yf(this,this.f.yk);p.C.nu(this.ba)};
l.I=function(){this.N=!0;for(var a in this.be)delete this.be[a];this.Ts.removeChild(this.ba);delete this.ba;this.ba=null};l.Ub=function(a,b,c){b=new kf(this,b,c);return this.be[a]=b};l.Pj=function(a){null!=this.be[a]&&delete this.be[a]};l.Rx=function(a,b){null!=this.be[a]&&this.be[a].Fz(b)};l.bb=function(a,b){null!=this.be[a]&&this.be[a].pi(b)};l.Pu=function(){};l.pr=function(a){return this.be[a]};
l.Pp=function(a){switch(a){case "controlCompass":this.bb("comapss",this.f.Hi);break;case "controlZoom":this.bb("zoom",this.f.lh);break;case "controlScale":this.bb("scale",this.f.Ym);break;case "controlLayers":this.bb("layers",this.f.xk);break;case "controlSpace":this.bb("space",this.f.kh);break;case "controlSearch":this.bb("search",this.f.Ki);break;case "controlLink":this.bb("link",this.f.Ji);break;case "controlLogo":this.bb("logo",this.f.Nq);break;case "controlCredits":this.bb("credits",this.f.Ii)}};
l.Zg=function(a){a&&(this.fu.update(),this.Jf.update(),this.L.update(),wf(this.Gl),this.Qx.update());this.Il.aa.zr()&&this.Il.update()};Sf.prototype.addControl=Sf.prototype.Ub;Sf.prototype.removeControl=Sf.prototype.Pj;Sf.prototype.setControlHtml=Sf.prototype.Rx;Sf.prototype.setControlVisible=Sf.prototype.bb;Sf.prototype.getControlVisible=Sf.prototype.Pu;Sf.prototype.getControlById=Sf.prototype.pr;
function Tf(a){this.B=a;this.G=a.G;this.Qo=this.G.c;this.kd=this.Qo.lf();this.Dk=this.rm=this.kk=!1;this.kd.K("drag",this.zf.bind(this));this.kd.K("mousedown",this.kw.bind(this));this.kd.K("mouseup",this.Fw.bind(this));this.kd.K("mousewheel",this.Gw.bind(this));this.kd.K("keyup",this.Af.bind(this),window);this.kd.K("keydown",this.hp.bind(this),window);this.kd.K("keypress",this.dm.bind(this),window);this.kd.K("dblclick",this.gp.bind(this),window);this.B.K("tick",this.jp.bind(this));this.zk={};Uf(this,
"map-observer",new Vf(a));Uf(this,"disabled",new Wf);Uf(this,"pano",new Xf(a));cf(this,"map-observer")}Melown_ControlMode_Drag="drag";Melown_ControlMode_Down="down";Melown_ControlMode_Up="up";Melown_ControlMode_KeyUp="keyup";Melown_ControlMode_KeyDown="keydown";Melown_ControlMode_KeyPress="keypress";Melown_ControlMode_Wheel="wheel";Melown_ControlMode_Tick="tick";Melown_ControlMode_Reset="reset";Melown_ControlMode_DoubleClick="doubleclick";
function Uf(a,b,c){if("string"!==typeof b||null===c||"object"!==typeof c)throw Error("Melown.ControlMode.addControlMode function has (String, Object) prototype.");a.zk[b]=c}function cf(a,b){var c=a.zk[b];if(null===c||"object"!==typeof c)throw Error("Melown.ControlMode.setCurrentControlMode: Try tu use unregistered control mode "+b+".");a.dn=b;if("function"===typeof c[Melown_ControlMode_Reset])c[Melown_ControlMode_Reset](void 0)}l=Tf.prototype;l.zf=function(a){Yf(this);if("function"===typeof Zf(this)[Melown_ControlMode_Drag])Zf(this)[Melown_ControlMode_Drag](a)};
l.kw=function(a){Yf(this);$f(this,a);if("function"===typeof Zf(this)[Melown_ControlMode_Down])Zf(this)[Melown_ControlMode_Down](a)};l.Fw=function(a){$f(this,a);if("function"===typeof Zf(this)[Melown_ControlMode_Up])Zf(this)[Melown_ControlMode_Up](a)};l.Gw=function(a){Yf(this);if("function"===typeof Zf(this)[Melown_ControlMode_Wheel])Zf(this)[Melown_ControlMode_Wheel](a)};l.Af=function(a){$f(this,a);if("function"===typeof Zf(this)[Melown_ControlMode_KeyUp])Zf(this)[Melown_ControlMode_KeyUp](a)};
l.hp=function(a){$f(this,a);if("function"===typeof Zf(this)[Melown_ControlMode_KeyDown])Zf(this)[Melown_ControlMode_KeyDown](a)};l.dm=function(a){$f(this,a);if("function"===typeof Zf(this)[Melown_ControlMode_KeyPress])Zf(this)[Melown_ControlMode_KeyPress](a)};l.gp=function(a){$f(this,a);if("function"===typeof Zf(this)[Melown_ControlMode_DoubleClick])Zf(this)[Melown_ControlMode_DoubleClick](a)};l.jp=function(a){"function"===typeof Zf(this)[Melown_ControlMode_Tick]&&(a.Zy=this.kd.sr(),Zf(this)[Melown_ControlMode_Tick](a))};
function ef(a){return a.zk[a.dn]}function $f(a,b){a.kk=b.dl("alt");a.rm=b.dl("shift");a.Dk=b.dl("ctrl")}function Zf(a){return a.zk[a.dn]}function Yf(a){a.B.Da&&(a.B.Da.Ue(0),a.B.Da.li(0,0))}function Wf(){}function Vf(a){this.B=a;this.f=a.f;this.Ck=[];this.Xh=[];this.bh=[];this.drag=this.Si;this.wheel=this.vq;this.tick=this.Zg;this.reset=this.reset;this.keyup=this.yo;this.keydown=this.wo;this.keypress=this.xo;this.doubleclick=this.ru}l=Vf.prototype;
l.Si=function(a){var b=this.B.J();if(b){var c=b.sa(),d=b.Ee(c),e=a.Ln(),f=a.rr(),g;a:{switch(a.R){case "drag":g=a.Aa.touches;break a}g=0}var k;k=e[0];var h=e[1],m=this.B.J(),n=m.sa(),q=m.Cd(n),y=.5*m.ke(n),q=.5*q*Math.tan(p.Ga(y))/800;k*=q;h*=q;q=Math.sqrt(k*k+h*h);k=[p.Pi(Math.atan2(k,h))+m.Xb(n)[0],q];h=this.B.rc.kk||this.B.rc.rm||this.B.rc.Dk;2==g&&0!=f&&this.f.Gm?"obj"==b.Fe(c)&&(this.bh.push(1+.01*(1<f?-1:1)),ag(this,.8),this.B.pb("map-position-zoomed",{})):a.$k("left")&&!h&&this.f.op?"fix"==
b.dj(c)?(d=b.Rf(c,"float",!0),null!=d&&this.setPosition(d)):(a=this.f.Qj[0],b=b.ke(c),c=p.Ga(k[0]),this.Ck.push([-Math.sin(c),Math.cos(c),k[1]*(.01<b&&179>b?1/Math.tan(p.Ga(.5*b)):1)*a,k[0],d[0],d[1]]),ag(this,.9),this.B.pb("map-position-panned",{})):(1>=g&&a.$k("right")||a.$k("middle")||h)&&this.f.Lp&&(a=this.f.Qj[1],this.Xh.push([-e[0]*a,-e[1]*a,0]),this.B.pb("map-position-rotated",{}))}};
l.vq=function(a){var b=this.B.J();if(b&&this.f.Gm){var c=b.sa(),d=1+(0<a.Sn()?-1:1)*this.f.Qj[2];this.B.rc.kk&&this.B.rc.rm&&this.B.rc.Dk?(p.C.preventDefault(a),a=p.dd(b.ke(c)*d,1,179),c=b.Sj(c,a),b.setPosition(c)):"obj"==b.Fe(c)&&(this.bh.push(d),ag(this,.8),this.B.pb("map-position-zoomed",{}))}};
l.ru=function(a){var b=this.B.J();if(b&&this.f.vo)if(this.B.rc.kk&&this.B.rc.rm&&this.B.rc.Dk)this.B.f.Zl=.5;else if(a=a.dg(),a=b.cg(a[0],a[1],"fix")){var c=b.sa(),c=b.Ng(c,a),c=b.Rf(c,"fix"),c=b.Tj(c,a[2]);this.B.Da.vh(c,{mode:"direct",maxDuration:2E3})}};l.yo=function(){};l.wo=function(){};l.xo=function(){};l.setPosition=function(a){a=p.Mq(this.B,a);this.B.J().setPosition(a)};
function ag(a,b){var c=a.B.J(),d=c.sa(),e=c.Ee(d);"float"==c.dj(d)&&"obj"==c.Fe(d)&&0!=e[2]&&(e[2]*=b,.1>Math.abs(e[2])&&(e[2]=0),d=c.Ng(d,e),a.setPosition(d))}function bg(a){a=a.B.J();var b=a.mf();return(a=a.fc(b.navigationSrs))?"projected"==a.type:!1}
l.Zg=function(){var a=this.B.J();if(null!=a){var b=a.sa(),c=!1,d=this.f.so;if(0<this.Ck.length){for(var c=this.Ck,e=[0,0],f=a.Ee(b),g=0;g<c.length;g++){var k=c[g],h=k[3],h=h+0,h=p.Ga(h);e[0]+=-Math.sin(h)*k[2];e[1]+=Math.cos(h)*k[2];k[2]*=d[0];.01>k[2]&&(c.splice(g,1),g--)}g=Math.sqrt(e[0]*e[0]+e[1]*e[1]);h=p.Pi(Math.atan2(e[0],e[1]));"free"==this.f.ep?(e=a.Xb(b)[0],b=a.xf(b,(bg(this)?-1:1)*h,g)):(e=a.Xb(b)[0],b=a.xf(b,(bg(this)?-1:1)*h,g,75>Math.abs(f[1])?0:1));e=a.Xb(b)[0]-e;for(g=0;g<c.length;g++)k=
c[g],k[3]+=e;c=!0}if(0<this.Xh.length){c=this.Xh;f=a.Xb(b);for(g=0;g<c.length;g++)k=c[g],f[0]+=k[0],f[1]+=k[1],f[2]+=k[2],k[0]*=d[1],k[1]*=d[1],k[2]*=d[1],.1>k[0]*k[0]+k[1]*k[1]+k[2]*k[2]&&(c.splice(g,1),g--);b=a.pd(b,f);c=!0}if(0<this.bh.length){c=this.bh;f=a.Cd(b);for(g=0;g<c.length;g++)f*=c[g],c[g]+=(1-c[g])*(1-d[2]),.001>Math.abs(1-c[g])&&(c.splice(g,1),g--);f=Math.max(1,f);b=a.Og(b,f);c=!0}c&&this.setPosition(b)}};l.reset=function(){this.Ck=[];this.Xh=[];this.bh=[]};
p.Mq=function(a,b){if(!a.f.Xm)return b;var c=a.f.Zl,d=a.f.bp,e=a.J(),d=p.dd(e.Cd(b),c,d);b=e.Og(b,d);d=.5*e.Cd(b)/Math.tan(p.Ga(.5*e.ke(b)));if("obj"==e.Fe(b)){var f=e.mf(),f=e.fc(f.navigationSrs);if(f.a){var f=20+-110*Math.min(d/(.5*f.a),1),g=e.Xb(b);g[1]>f&&(g[1]=f);-90>g[1]&&(g[1]=-90);b=e.pd(b,g)}}var f=e.Ah(b,"float"),c=.5*c/Math.tan(p.Ga(.5*e.ke(b))),k=Math.max(.5*c,d*Math.tan(p.Ga(3)));if(f[2]<k){var g=e.Xb(b),h=function(a,c,d){var f=.5*(a+c);if(20<d)return f;g[1]=f;b=e.pd(b,g);return e.Ah(b,
"float")[2]<k?h(a,f,d+1):h(f,c,d+1)};g[1]=h(-90,Math.min(-1,g[1]),0);b=e.pd(b,g)}return b};function Xf(a){this.B=a;this.f=null;this.Kc=[0,0];this.Be=!1;this.rd=[0,0];this.Jr=[0,0];this.up=this.down=this.drag=this.Si;this.wheel=this.vq;this.tick=this.Zg;this.reset=this.reset;this.keyup=this.yo;this.keydown=this.wo;this.keypress=this.xo}l=Xf.prototype;
l.Si=function(a){this.Be&&(a=a.dg(),a=[a[0]-this.Kc[0],a[1]-this.Kc[1]],this.rd[0]=.008*a[0],this.rd[1]=.008*a[1],this.Jr[0]=.008*a[0],this.Jr[1]=.008*a[1])};l.vq=function(a){var b=this.B.J();if(null!=b){var c=b.sa();c[9]=p.dd(c[9]+1*(0<a.Sn()?-1:1),1,179);b.setPosition(c)}};l.yo=function(){};l.wo=function(){};l.xo=function(){};
l.Zg=function(){if(0!=this.rd[0]||0!=this.rd[1]){var a=this.B.J();if(null!=a){var b=a.sa();b[5]-=this.rd[0];b[6]-=this.rd[1];a.setPosition(b);this.Be||(this.rd[0]=5E-4>Math.abs(this.rd[0])?0:.9*this.rd[0],this.rd[1]=5E-4>Math.abs(this.rd[1])?0:.9*this.rd[1])}}};l.reset=function(a){this.f=a};
function cg(a,b){this.N=!1;this.jh={};this.to();this.Fc(b,!0);this.Nw=JSON.parse(JSON.stringify(b));this.ba="string"===typeof a?document.getElementById(a):a;this.G=new Sf(this,this.ba);this.l=p.Hm(this.G.c.lf().ma(),b);null==this.l?this.G.Ez("fallback",!0):(this.Ml=this.Xr=this.Dm=!1,this.Da=new af(this),this.rc=new Tf(this),this.vb=new Pe(this,b),this.K("map-loaded",this.uw.bind(this)),this.K("map-unloaded",this.Aw.bind(this)),this.K("map-update",this.ip.bind(this)),this.K("map-position-changed",
this.vw.bind(this)),this.K("map-position-fixed-height-changed",this.ww.bind(this)),this.K("map-position-panned",this.xw.bind(this)),this.K("map-position-rotated",this.yw.bind(this)),this.K("map-position-zoomed",this.zw.bind(this)),this.K("tick",this.jp.bind(this)))}l=cg.prototype;l.J=function(){return this.l?this.l.J():null};l.Dd=function(){return this.l?this.l.Dd():null};l.Ge=function(){return this.l?this.l.Ge():null};l.yr=function(){return this.G};l.xh=function(){return this.rc};
l.K=function(a,b){this.l.K(a,b)};l.pb=function(a,b){this.l.pb(a,b)};l.uw=function(a){a=a.browserOptions||{};var b=this.Nw,c;for(c in b)"undefined"!==typeof a[c]&&(a[c]=b[c]);this.Fc(a);this.Da&&(this.Da.Ue(this.f.sd),this.Da.li(this.f.we[0],this.f.we[1]))};
function xf(a){var b=a.J();if(null==b)return"";var c=p.Ha.vr(window.location.href),d=b.sa(),d=b.Rf(d,"fix",!0),e;e=""+(b.Fe(d)+",");var f=b.Ee(d);e+=f[0].toFixed(6)+","+f[1].toFixed(6)+","+b.dj(d)+","+f[2].toFixed(2)+",";f=b.Xb(d);e+=f[0].toFixed(2)+","+f[1].toFixed(2)+","+f[2].toFixed(2)+",";e+=b.Cd(d).toFixed(2)+","+b.ke(d).toFixed(2);c.pos=e;if(a.Ml){if(c.rotate||a.uc("rotate"))c.rotate="0";e=a.uc("pan");if(c.pan||e&&(e[0]||e[1]))c.pan="0,0"}e="";for(var g in c)e+=(0<e.length?"&":"")+g+"="+c[g];
c=window.location.href.split("?");return 1<c.length?c[0]+"?"+e+(c[1].split("#")[1]||""):c[0]+"?"+e}l.vw=function(){this.f.im&&(this.Dm=!0)};l.xw=function(){this.Ml=!0};l.yw=function(){this.Ml=!0};l.zw=function(){this.Ml=!0};l.ww=function(){this.f.im&&(this.Dm=!0)};l.Aw=function(){};l.ip=function(){this.Ea=!0};
l.jp=function(){if(!this.N&&(this.Da.Zg(),this.G.Zg(this.Ea),this.Ea=!1,this.Dm)){var a=performance.now();1E3<a-this.Xr&&(window.history.replaceState&&window.history.replaceState({},null,xf(this)),this.Dm=!1,this.Xr=a)}};l.to=function(){this.f={op:!0,Lp:!0,Gm:!0,vo:!1,Qj:[1,.12,.05],so:[.81,.9,.7],im:!1,Gs:!1,Xm:!0,ep:"free",Hi:!0,lh:!0,kh:!0,Ki:!1,Oq:!1,Ji:!1,Ym:!0,xk:!1,Ii:!0,yk:!0,Zl:75,bp:Number.$c,sd:0,we:[0,0]}};l.Fc=function(a){if("object"===typeof a&&null!==a)for(var b in a)this.mc(b,a[b])};
function dg(a,b){null!=a.G&&a.G.Pp(b)}
l.mc=function(a,b,c){switch(a){case "pos":case "position":this.f.pa=b;this.c&&this.c.setPosition(this.f.pa);break;case "view":this.f.fk=b;this.c&&this.c.Rd(this.f.fk);break;case "panAllowed":this.f.op=p.C.ea(b,!0);break;case "rotationAllowed":this.f.Lp=p.C.ea(b,!0);break;case "zoomAllowed":this.f.Gm=p.C.ea(b,!0);break;case "jumpAllowed":this.f.vo=p.C.ea(b,!1);break;case "constrainCamera":this.f.Xm=p.C.ea(b,!0);break;case "navigationMode":this.f.ep=b;break;case "positionInUrl":this.f.im=p.C.ea(b,!1);
break;case "positionUrlHistory":this.f.Gs=p.C.ea(b,!1);break;case "controlCompass":this.f.Hi=p.C.ea(b,!0);dg(this,a);break;case "controlZoom":this.f.lh=p.C.ea(b,!0);dg(this,a);break;case "controlMeasure":this.f.Oq=p.C.ea(b,!1);dg(this,a);break;case "controlScale":this.f.Ym=p.C.ea(b,!0);dg(this,a);break;case "controlLayers":this.f.xk=p.C.ea(b,!1);dg(this,a);break;case "controlSpace":this.f.kh=p.C.ea(b,!1);dg(this,a);break;case "controlSearch":this.f.Ki=p.C.ea(b,!1);dg(this,a);break;case "controlLink":this.f.Ji=
p.C.ea(b,!1);dg(this,a);break;case "controlLogo":this.f.Nq=p.C.ea(b,!1);dg(this,a);break;case "controlCredits":this.f.Ii=p.C.ea(b,!0);dg(this,a);break;case "controlLoading":this.f.yk=p.C.ea(b,!0);dg(this,a);break;case "minViewExtent":this.f.Zl=p.C.oc(b,.01,Number.$c,100);break;case "maxViewExtent":this.f.bp=p.C.oc(b,.01,Number.$c,Number.$c);break;case "sensitivity":this.f.Qj=p.C.Jt(b,[10,10,10],[1,.12,.05]);break;case "inertia":this.f.so=p.C.Jt(b,[.99,.99,.99],[.85,.9,.7]);break;case "rotate":this.f.sd=
p.C.oc(b,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,0);this.c&&this.Da&&this.Da.Ue(this.f.sd);break;case "pan":Array.isArray(b)&&2==b.length&&(this.f.we=[p.C.oc(b[0],Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,0),p.C.oc(b[1],-360,360,0)]),this.c&&this.Da&&this.Da.Ue(this.f.sd)}1==c&&(0!=a.indexOf("map")&&0!=a.indexOf("mario")&&0!=a.indexOf("authorization")||!this.l.J()||this.l.J().mc(a,b),0==a.indexOf("renderer")&&this.l.Dd().mc(a,b))};
l.uc=function(a){switch(a){case "pos":case "position":if(this.c)this.c.sa();else return this.f.pa;break;case "view":return this.c?this.c.pf():this.f.fk;case "panAllowed":return this.f.op;case "rotationAllowed":return this.f.Lp;case "zoomAllowed":return this.f.Gm;case "jumpAllowed":return this.f.vo;case "sensitivity":return this.f.Qj;case "inertia":return this.f.so;case "navigationMode":return this.f.ep;case "constrainCamera":return this.f.Xm;case "positionInUrl":return this.f.im;case "positionUrlHistory":return this.f.Gs;
case "controlCompass":return this.f.Hi;case "controlZoom":return this.f.lh;case "controlMeasure":return this.f.Oq;case "controlScale":return this.f.Ym;case "controlLayers":return this.f.xk;case "controlSpace":return this.f.kh;case "controlSearch":return this.f.Ki;case "controlLink":return this.f.Ji;case "controlLogo":return this.f.Nq;case "controlCredits":return this.f.Ii;case "controlLoading":return this.f.yk;case "minViewExtent":return this.f.Zl;case "maxViewExtent":return this.f.bp;case "rotate":return this.f.sd;
case "pan":return this.f.we}if(1==ignoreCore_){if(0==a.indexOf("map")&&this.l.J())return this.l.J().uc(a,value_);if(0==a.indexOf("renderer"))return this.l.Dd().uc(a,value_)}};p.xq=function(a,b){var c=new Z(a,b);return c.l?c:null};function Z(a,b){this.B=new cg(a,b);this.l=this.B.l;this.c=null;this.G=this.B.G;this.Da=this.B.Da;this.vb=this.B.vb;this.N=!1;this.l.K("map-loaded",function(){this.c=this.l.J()}.bind(this));this.l.K("map-unloaded",function(){this.c=null}.bind(this))}l=Z.prototype;l.Zu=function(){if(!this.N)return this.vb};
l.Dd=function(){if(!this.N)return this.l.Dd()};l.Ge=function(){if(!this.N)return this.l.Ge()};l.yr=function(){if(!this.N)return this.G};l.oh=function(){if(!this.N)return this.l.oh(),this.c=null,this.B.N=!0,this.G.I(),this.l=this.G=null,this.N=!0,null};l.Sx=function(a){if(!this.N)return this.B.rc=a,this};l.xh=function(){if(!this.N)return this.B.rc};l.sg=function(a){if(!this.N)return this.l.sg(a),this};l.df=function(){if(!this.N)return this.l.df(),this.c=null,this};
l.setPosition=function(a){if(this.c)return this.c.setPosition(a),this};l.sa=function(){if(this.c)return this.c.sa()};l.bj=function(){if(this.c)return this.c.bj()};l.Rd=function(a){if(this.c)return this.c.Rd(a),this};l.pf=function(){if(this.c)return this.c.pf()};l.yh=function(){if(this.c)return this.c.yh()};l.Qu=function(a){if(this.c)return a=this.c.cz(a),null!=a?a.gb():null};l.Rn=function(){if(this.c)return this.c.gz()};l.Qn=function(a){if(this.c)return a=this.c.fz(a),null!=a?a.gb():null};l.kf=function(){if(this.c)return this.c.kf()};
l.Yk=function(a){if(this.c)return a=this.c.bz(a),null!=a?a.gb():null};l.bg=function(){if(this.c)return this.c.bg()};l.Mn=function(a){if(this.c)return a=this.c.fa[a],null!=a?a.gb():null};l.eg=function(){if(this.c)return this.c.eg()};l.On=function(a){if(this.c)return a=this.c.fa[a],null!=a?a.gb():null};l.Dh=function(){if(this.c)return this.c.Dh()};l.fc=function(a){if(this.c)return this.c.fc(a)};l.mf=function(){if(this.c)return this.c.mf()};l.Bk=function(a,b){if(this.c)return this.c.Bk(a,b)};
l.Rf=function(a,b){if(this.c)return this.c.Rf(a,b)};l.Pa=function(a,b,c){if(this.c)return this.c.Pa(a,b,c)};l.Li=function(a,b,c){if(this.c)return this.c.Li(a,b,c)};l.Qf=function(a){if(this.c)return this.c.Qf(a)};l.Ak=function(a,b,c){if(this.c)return this.c.Ak(a,b,c)};l.mh=function(a,b,c){if(this.c)return this.c.mh(a,b,c)};l.wk=function(a){if(this.c)return this.c.wk(a)};l.Pm=function(a,b){if(this.c)return this.c.Pm(a,b)};l.Ng=function(a,b){if(this.c)return this.c.Ng(a,b)};l.Ee=function(a){if(this.c)return this.c.Ee(a)};
l.Tj=function(a,b){if(this.c)return this.c.Tj(a,b)};l.gl=function(a){if(this.c)return this.c.gl(a)};l.pd=function(a){if(this.c)return this.c.pd(a)};l.Xb=function(a){if(this.c)return this.c.Xb(a)};l.Og=function(a,b){if(this.c)return this.c.Og(a,b)};l.Cd=function(a){if(this.c)return this.c.Cd(a)};l.Sj=function(a,b){if(this.c)return this.c.Sj(a,b)};l.ke=function(a){if(this.c)return this.c.ke(a)};l.Fe=function(a){if(this.c)return this.c.Fe(a)};l.Yu=function(a){if(this.c)return this.c.dj(a)};
l.fl=function(a,b){if(this.c)return this.c.fl(a,b)};l.Ah=function(a,b){if(this.c)return this.c.Ah(a,b)};l.xf=function(a,b,c){if(this.c)return this.c.xf(a,b,c)};l.vc=function(a,b){if(this.c)return this.c.vc(a,b)};l.zh=function(a,b,c){if(this.c)return this.c.zh(a,b,c)};l.wh=function(a,b){if(this.c)return this.c.wh(a,b)};l.ie=function(){if(this.c)return this.c.ie()};l.Vu=function(){if(this.c)return this.c.getStats()};l.wl=function(a){if(this.c)return this.c.wl(a)};l.vl=function(a){if(this.c)return this.c.vl(a)};
l.$f=function(a,b,c){if(this.c)return this.c.$f(a,b,c)};l.Oj=function(){if(this.c)return this.c.Oj(),this};l.Pf=function(a,b,c){if(this.c)return this.c.Pf(a,b,c)};l.Vh=function(a,b){if(this.c)return this.c.Vh(a,b),this};l.Uh=function(a,b){if(this.c)return this.c.Uh(a,b),this};l.ei=function(a){if(this.c)return this.c.ei(a),this};l.oi=function(a,b){if(this.c)return this.c.oi(a,b),this};l.Bh=function(a){if(this.c)return this.c.Bh(a)};l.qm=function(a){if(this.c)return this.c.qm(a),this};l.bl=function(){if(this.c)return this.c.bl()};
l.al=function(){if(this.c)return this.c.al()};l.cg=function(a,b,c,d){if(this.c)return this.c.cg(a,b,c,d)};l.vh=function(a,b){if(this.c)return this.Da.vh(a,b),this};l.$f=function(a,b,c){if(this.c)return this.c.$f(a,b,c)};l.Dn=function(a,b){if(this.c&&this.Da)return this.Da.Dn(a,b),this};l.Wm=function(){if(this.c&&this.Da)return this.Da.Wm(),this};l.Ue=function(a){if(this.c&&this.Da)return this.Da.Ue(a),this};l.In=function(){return this.c&&this.Da?this.Da.In():0};
l.li=function(a,b){if(this.c&&this.Da)return this.Da.li(a,b),this};l.Hn=function(){if(this.c&&this.Da)return this.Da.Hn()};l.K=function(a,b){this.l.K(a,b);return this};l.lf=function(){return this.G.c.lf()};l.Ou=function(a){return this.G.pr(a)};l.Ub=function(a,b,c){return this.G.Ub(a,b,c)};l.Pj=function(a){this.G.Pj(a);return this};l.Qp=function(a){this.Fc(a);return this};l.Pp=function(a,b){this.mc(a,b);return this};l.Xu=function(a){return this.uc(a,value_)};
p.Jn=function(){return"Browser: 1.14, Core: "+p.qr()};p.MapBrowser=p.xq;p.mapBrowser=p.xq;Z.prototype.getRenderer=Z.prototype.Dd;Z.prototype.getPresenter=Z.prototype.Zu;Z.prototype.getProj4=Z.prototype.Ge;Z.prototype.getUI=Z.prototype.yr;Z.prototype.destroy=Z.prototype.oh;Z.prototype.setControlMode=Z.prototype.Sx;Z.prototype.getControlMode=Z.prototype.xh;Z.prototype.loadMap=Z.prototype.sg;Z.prototype.destroyMap=Z.prototype.df;Z.prototype.setPosition=Z.prototype.setPosition;
Z.prototype.getPosition=Z.prototype.sa;Z.prototype.getCurrentCredits=Z.prototype.bj;Z.prototype.setView=Z.prototype.Rd;Z.prototype.getView=Z.prototype.pf;Z.prototype.getCredits=Z.prototype.yh;Z.prototype.getCreditsInfo=Z.prototype.Qu;Z.prototype.getViews=Z.prototype.Rn;Z.prototype.getViewInfo=Z.prototype.Qn;Z.prototype.getBoundLayers=Z.prototype.kf;Z.prototype.getBoundLayerInfo=Z.prototype.Yk;Z.prototype.getFreeLayers=Z.prototype.bg;Z.prototype.getFreeLayerInfo=Z.prototype.Mn;
Z.prototype.getSurfaces=Z.prototype.eg;Z.prototype.getSurfaceInfo=Z.prototype.On;Z.prototype.getSrses=Z.prototype.Dh;Z.prototype.getSrsInfo=Z.prototype.fc;Z.prototype.getReferenceFrame=Z.prototype.mf;Z.prototype.convertPositionViewMode=Z.prototype.Bk;Z.prototype.convertPositionHeightMode=Z.prototype.Rf;Z.prototype.convertCoords=Z.prototype.Pa;Z.prototype.convertCoordsFromNavToCanvas=Z.prototype.Li;Z.prototype.convertCoordsFromPhysToCanvas=Z.prototype.Qf;
Z.prototype.convertCoordsFromNavToCameraSpace=Z.prototype.Ak;Z.prototype.convertCoordsFromPhysToCameraSpace=Z.prototype.mh;Z.prototype.clonePosition=Z.prototype.wk;Z.prototype.arePositionsSame=Z.prototype.Pm;Z.prototype.setPositionCoords=Z.prototype.Ng;Z.prototype.getPositionCoords=Z.prototype.Ee;Z.prototype.setPositionHeight=Z.prototype.Tj;Z.prototype.getPositionHeight=Z.prototype.gl;Z.prototype.setPositionOrientation=Z.prototype.pd;Z.prototype.getPositionOrientation=Z.prototype.Xb;
Z.prototype.setPositionViewExtent=Z.prototype.Og;Z.prototype.getPositionViewExtent=Z.prototype.Cd;Z.prototype.setPositionFov=Z.prototype.Sj;Z.prototype.getPositionFov=Z.prototype.ke;Z.prototype.getPositionViewMode=Z.prototype.Fe;Z.prototype.getPositionHeigthMode=Z.prototype.Yu;Z.prototype.getPositionCanvasCoords=Z.prototype.fl;Z.prototype.getPositionCameraCoords=Z.prototype.Ah;Z.prototype.movePositionCoordsTo=Z.prototype.xf;Z.prototype.getSurfaceHeight=Z.prototype.vc;Z.prototype.getDistance=Z.prototype.zh;
Z.prototype.getAzimuthCorrection=Z.prototype.wh;Z.prototype.getCameraInfo=Z.prototype.ie;Z.prototype.getMapStats=Z.prototype.Vu;Z.prototype.isPointInsideCameraFrustum=Z.prototype.wl;Z.prototype.isBBoxInsideCameraFrustum=Z.prototype.vl;Z.prototype.generateTrajectory=Z.prototype.$f;Z.prototype.redraw=Z.prototype.Oj;Z.prototype.addRenderSlot=Z.prototype.Pf;Z.prototype.moveRenderSlotBefore=Z.prototype.Vh;Z.prototype.moveRenderSlotAfter=Z.prototype.Uh;Z.prototype.removeRenderSlot=Z.prototype.ei;
Z.prototype.setRenderSlotEnabled=Z.prototype.oi;Z.prototype.getRenderSlotEnabled=Z.prototype.Bh;Z.prototype.setLoaderSuspended=Z.prototype.qm;Z.prototype.getLoaderSuspended=Z.prototype.bl;Z.prototype.getGpuCache=Z.prototype.al;Z.prototype.getHitCoords=Z.prototype.cg;Z.prototype.flyTo=Z.prototype.vh;Z.prototype.flyTrajectory=Z.prototype.Dn;Z.prototype.setAutorotate=Z.prototype.Ue;Z.prototype.getAutorotate=Z.prototype.In;Z.prototype.setAutopan=Z.prototype.li;Z.prototype.getAutopan=Z.prototype.Hn;
Z.prototype.cancelFlight=Z.prototype.Wm;Z.prototype.on=Z.prototype.K;Z.prototype.getMapElement=Z.prototype.lf;Z.prototype.getControl=Z.prototype.Ou;Z.prototype.addControl=Z.prototype.Ub;Z.prototype.removeControl=Z.prototype.Pj;Z.prototype.setParams=Z.prototype.Qp;Z.prototype.setParam=Z.prototype.Pp;Z.prototype.getParam=Z.prototype.Xu;p.getBrowserVersion=p.Jn;
